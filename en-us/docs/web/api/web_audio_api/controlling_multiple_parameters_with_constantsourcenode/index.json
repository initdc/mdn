{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"Controlling multiple parameters with ConstantSourceNode","mdn_url":"/en-US/docs/Web/API/Web_Audio_API/Controlling_multiple_parameters_with_ConstantSourceNode","locale":"en-US","native":"English (US)","sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/Web_Audio_API\">Web Audio API</a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Guides</summary><ol><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Using_Web_Audio_API\">Using the Web Audio API</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Basic_concepts_behind_Web_Audio_API\">Basic concepts behind Web Audio API</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Best_practices\">Web Audio API best practices</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Advanced_techniques\">Advanced techniques: Creating and sequencing audio</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Using_AudioWorklet\">Background audio processing using AudioWorklet</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Controlling_multiple_parameters_with_ConstantSourceNode\">Controlling multiple parameters with ConstantSourceNode</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Migrating_from_webkitAudioContext\">Migrating from webkitAudioContext</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Simple_synth\">Example and tutorial: Simple synth keyboard</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Tools\">Tools for analyzing Web Audio usage</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Using_IIR_filters\">Using IIR filters</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Visualizations_with_Web_Audio_API\">Visualizations with Web Audio API</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics\">Web audio spatialization basics</a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Interfaces</summary><ol><li><a href=\"/en-US/docs/Web/API/AnalyserNode\"><code>AnalyserNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioBuffer\"><code>AudioBuffer</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioBufferSourceNode\"><code>AudioBufferSourceNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioContext\"><code>AudioContext</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioDestinationNode\"><code>AudioDestinationNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioListener\"><code>AudioListener</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioNode\"><code>AudioNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioParam\"><code>AudioParam</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioProcessingEvent\"><code>AudioProcessingEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioScheduledSourceNode\"><code>AudioScheduledSourceNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioWorklet\"><code>AudioWorklet</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioWorkletGlobalScope\"><code>AudioWorkletGlobalScope</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioWorkletNode\"><code>AudioWorkletNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioWorkletProcessor\"><code>AudioWorkletProcessor</code></a></li><li><a href=\"/en-US/docs/Web/API/BaseAudioContext\"><code>BaseAudioContext</code></a></li><li><a href=\"/en-US/docs/Web/API/BiquadFilterNode\"><code>BiquadFilterNode</code></a></li><li><a href=\"/en-US/docs/Web/API/ChannelMergerNode\"><code>ChannelMergerNode</code></a></li><li><a href=\"/en-US/docs/Web/API/ChannelSplitterNode\"><code>ChannelSplitterNode</code></a></li><li><a href=\"/en-US/docs/Web/API/ConstantSourceNode\"><code>ConstantSourceNode</code></a></li><li><a href=\"/en-US/docs/Web/API/ConvolverNode\"><code>ConvolverNode</code></a></li><li><a href=\"/en-US/docs/Web/API/DelayNode\"><code>DelayNode</code></a></li><li><a href=\"/en-US/docs/Web/API/DynamicsCompressorNode\"><code>DynamicsCompressorNode</code></a></li><li><a href=\"/en-US/docs/Web/API/GainNode\"><code>GainNode</code></a></li><li><a href=\"/en-US/docs/Web/API/IIRFilterNode\"><code>IIRFilterNode</code></a></li><li><a href=\"/en-US/docs/Web/API/MediaElementAudioSourceNode\"><code>MediaElementAudioSourceNode</code></a></li><li><a href=\"/en-US/docs/Web/API/MediaStreamAudioDestinationNode\"><code>MediaStreamAudioDestinationNode</code></a></li><li><a href=\"/en-US/docs/Web/API/MediaStreamAudioSourceNode\"><code>MediaStreamAudioSourceNode</code></a></li><li><a href=\"/en-US/docs/Web/API/OfflineAudioCompletionEvent\"><code>OfflineAudioCompletionEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/OfflineAudioContext\"><code>OfflineAudioContext</code></a></li><li><a href=\"/en-US/docs/Web/API/OscillatorNode\"><code>OscillatorNode</code></a></li><li><a href=\"/en-US/docs/Web/API/PannerNode\"><code>PannerNode</code></a></li><li><a href=\"/en-US/docs/Web/API/PeriodicWave\"><code>PeriodicWave</code></a></li><li><a href=\"/en-US/docs/Web/API/WaveShaperNode\"><code>WaveShaperNode</code></a></li><li><a href=\"/en-US/docs/Web/API/StereoPannerNode\"><code>StereoPannerNode</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>This article demonstrates how to use a <a href=\"/en-US/docs/Web/API/ConstantSourceNode\"><code>ConstantSourceNode</code></a> to link multiple parameters together so they share the same value, which can be changed by setting the value of the <a href=\"/en-US/docs/Web/API/ConstantSourceNode/offset\"><code>ConstantSourceNode.offset</code></a> parameter.</p>\n<p>You may sometimes want multiple audio parameters to be linked so they share the same value while being changed somehow. For example, perhaps you have a set of oscillators, two of which need to share the same configurable volume, or you have a filter applied to specific inputs but not all of them. You could use a loop and change the value of each affected <a href=\"/en-US/docs/Web/API/AudioParam\"><code>AudioParam</code></a> one at a time. Still, there are two drawbacks to doing it that way: first, that's extra code that, as you're about to see, you don't have to write; and second, that loop uses valuable CPU time on your thread (likely the main thread), and there's a way to offload all that work to the audio rendering thread, which is optimized for this kind of work and may run at a more appropriate priority level than your code.</p>\n<p>The solution is simple, and it involves using an audio node type that, at first glance, doesn't look all that useful: <a href=\"/en-US/docs/Web/API/ConstantSourceNode\"><code>ConstantSourceNode</code></a>.</p>"}},{"type":"prose","value":{"id":"the_technique","title":"The technique","isH3":false,"content":"<p>Using a <code>ConstantSourceNode</code> is an effortless way to do something that sounds like it might be hard. You need to create a <a href=\"/en-US/docs/Web/API/ConstantSourceNode\"><code>ConstantSourceNode</code></a> and connect it to all of the <a href=\"/en-US/docs/Web/API/AudioParam\"><code>AudioParam</code></a>s whose values should be linked to always match each other. Since <code>ConstantSourceNode</code>'s <a href=\"/en-US/docs/Web/API/ConstantSourceNode/offset\" title=\"offset\"><code>offset</code></a> value is sent straight through to all of its outputs, it acts as a splitter for that value, sending it to each connected parameter.</p>\n<p>The diagram below shows how this works; an input value, <code>N</code>, is set as the value of the <a href=\"/en-US/docs/Web/API/ConstantSourceNode/offset\"><code>ConstantSourceNode.offset</code></a> property. The <code>ConstantSourceNode</code> can have as many outputs as necessary; in this case, we've connected it to three nodes: two <a href=\"/en-US/docs/Web/API/GainNode\"><code>GainNode</code></a>s and a <a href=\"/en-US/docs/Web/API/StereoPannerNode\"><code>StereoPannerNode</code></a>. So <code>N</code> becomes the value of the specified parameter (<a href=\"/en-US/docs/Web/API/GainNode/gain\" title=\"gain\"><code>gain</code></a> for the <a href=\"/en-US/docs/Web/API/GainNode\"><code>GainNode</code></a>s and pan for the <a href=\"/en-US/docs/Web/API/StereoPannerNode\"><code>StereoPannerNode</code></a>.</p>\n<p>\n  <img src=\"/en-US/docs/Web/API/Web_Audio_API/Controlling_multiple_parameters_with_ConstantSourceNode/customsourcenode-as-splitter.svg\" alt=\"Diagram in SVG showing how ConstantSourceNode can be used to split an input parameter to share it with multiple nodes.\" width=\"773\" height=\"461\" loading=\"lazy\">\n</p>\n<p>As a result, every time you change <code>N</code> (the value of the input <a href=\"/en-US/docs/Web/API/AudioParam\"><code>AudioParam</code></a>, the values of the two <code>GainNode.gain</code> properties and the value of the <code>StereoPannerNode</code> 's <code>pan</code> properties are all set to <code>N</code> as well.</p>"}},{"type":"prose","value":{"id":"example","title":"Example","isH3":false,"content":"<p>Let's take a look at this technique in action. In this simple example, we create three <a href=\"/en-US/docs/Web/API/OscillatorNode\"><code>OscillatorNode</code></a> objects. Two of them have adjustable gain, controlled using a shared input control. The other oscillator has a fixed volume.</p>"}},{"type":"prose","value":{"id":"html","title":"HTML","isH3":true,"content":"<p>The HTML content for this example is primarily a checkbox, shaped as an actual button, to toggle the oscillator tones on and off and an <a href=\"/en-US/docs/Web/HTML/Element/input\"><code>&lt;input&gt;</code></a> element of type <code>range</code> to control the volume of two of the three oscillators.</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>controls<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>checkbox<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>playButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>playButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Activate: <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>volumeControl<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Volume: <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>range<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">min</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0.0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">max</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1.0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">step</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0.01<span class=\"token punctuation\">\"</span></span>\n           <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0.8<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>volume<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>volumeControl<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span>Toggle the checkbox above to start and stop the tones, and use the volume control to\nchange the volume of the notes E and G in the chord.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<div class=\"code-example\"><pre class=\"brush: css hidden notranslate\"><code><span class=\"token selector\">.controls</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 400px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">vertical-align</span><span class=\"token punctuation\">:</span> middle<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 44px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">#playButton:checked + label::after</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⏸\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">#playButton:not(checked) + label::after</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"▶️\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">#playButton + label::after</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">cursor</span><span class=\"token punctuation\">:</span> pointer<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">#playButton</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">vertical-align</span><span class=\"token punctuation\">:</span> middle<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">#volumeControl</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">vertical-align</span><span class=\"token punctuation\">:</span> bottom<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">label</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">vertical-align</span><span class=\"token punctuation\">:</span> middle<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"javascript","title":"JavaScript","isH3":true,"content":"<p>Now let's look at the JavaScript code, a piece at a time.</p>\n<h4 id=\"setting_up\">Setting up</h4>\n<p>Let's start by looking at the global variable initialization.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Useful UI elements</span>\n<span class=\"token keyword\">const</span> playButton <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#playButton\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> volumeControl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#volumeControl\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// The audio context and the node will be initialized after the first request</span>\n<span class=\"token keyword\">let</span> context <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> oscNode1 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> oscNode2 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> oscNode3 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> constantNode <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> gainNode1 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> gainNode2 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> gainNode3 <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>These variables are:</p>\n<dl>\n  <dt id=\"context\"><code>context</code></dt>\n  <dd>\n    <p>The <a href=\"/en-US/docs/Web/API/AudioContext\"><code>AudioContext</code></a> in which all the audio nodes live; it will be initialized during after a user-action.</p>\n  </dd>\n  <dt id=\"playbutton\"><code>playButton</code> and <code>volumeControl</code></dt>\n  <dd>\n    <p>References to the play button and volume control elements.</p>\n  </dd>\n  <dt id=\"oscnode1\"><code>oscNode1</code>, <code>oscNode2</code>, and <code>oscNode3</code></dt>\n  <dd>\n    <p>The three <a href=\"/en-US/docs/Web/API/OscillatorNode\"><code>OscillatorNode</code></a>s used to generate the chord.</p>\n  </dd>\n  <dt id=\"gainnode1\"><code>gainNode1</code>, <code>gainNode2</code>, and <code>gainNode3</code></dt>\n  <dd>\n    <p>The three <a href=\"/en-US/docs/Web/API/GainNode\"><code>GainNode</code></a> instances which provide the volume levels for each of the three oscillators. <code>gainNode2</code> and <code>gainNode3</code> will be linked together to have the same, adjustable, value using the <a href=\"/en-US/docs/Web/API/ConstantSourceNode\"><code>ConstantSourceNode</code></a>.</p>\n  </dd>\n  <dt id=\"constantnode\"><code>constantNode</code></dt>\n  <dd>\n    <p>The <a href=\"/en-US/docs/Web/API/ConstantSourceNode\"><code>ConstantSourceNode</code></a> used to control the values of <code>gainNode2</code> and <code>gainNode3</code> together.</p>\n  </dd>\n</dl>\n<p>Now let's look at the <code>setup()</code> function, called when the user toggles the play button for the first time; it handles all the initialization tasks to set up the audio graph.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  context <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AudioContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  gainNode1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GainNode</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">gain</span><span class=\"token operator\">:</span> <span class=\"token number\">0.5</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gainNode2 <span class=\"token operator\">=</span>  <span class=\"token keyword\">new</span> <span class=\"token class-name\">GainNode</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">gain</span><span class=\"token operator\">:</span> gainNode1<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">.</span>value\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gainNode3 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GainNode</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">gain</span><span class=\"token operator\">:</span> gainNode1<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">.</span>value\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  volumeControl<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> gainNode1<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n\n  constantNode <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ConstantSourceNode</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">offset</span><span class=\"token operator\">:</span> volumeControl<span class=\"token punctuation\">.</span>value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  constantNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>gainNode2<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  constantNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>gainNode3<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  constantNode<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  gainNode1<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gainNode2<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gainNode3<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// All is set up. We can hook the volume control.</span>\n  volumeControl<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">,</span> changeVolume<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>First, we get access to the window's <a href=\"/en-US/docs/Web/API/AudioContext\"><code>AudioContext</code></a>, stashing the reference in <code>context</code>. Then we get references to the control widgets, setting <code>playButton</code> to reference the play button and <code>volumeControl</code> to reference the slider control that the user will use to adjust the gain on the linked pair of oscillators.</p>\n<p>Next, the <a href=\"/en-US/docs/Web/API/GainNode\"><code>GainNode</code></a> <code>gainNode1</code> is created to handle the volume for the non-linked oscillator (<code>oscNode1</code>). We set that gain to 0.5. We also create <code>gainNode2</code> and <code>gainNode3</code>, set their values to match <code>gainNode1</code>, then set the value of the volume slider to the same value, so it stays synchronized with the gain level it controls.</p>\n<p>Once all the gain nodes are created, we create the <a href=\"/en-US/docs/Web/API/ConstantSourceNode\"><code>ConstantSourceNode</code></a>, <code>constantNode</code>. We connect its output to the <code>gain</code> <a href=\"/en-US/docs/Web/API/AudioParam\"><code>AudioParam</code></a> on both <code>gainNode2</code> and <code>gainNode3</code>, and we start the constant node running by calling its <a href=\"/en-US/docs/Web/API/AudioScheduledSourceNode/start\" title=\"start()\"><code>start()</code></a> method; now it's sending the value 0.5 to the two gain nodes' values, and any change to <a href=\"/en-US/docs/Web/API/ConstantSourceNode/offset\" title=\"constantNode.offset\"><code>constantNode.offset</code></a> will automatically set the gain of both <code>gainNode2</code> and <code>gainNode3</code> (affecting their audio inputs as expected).</p>\n<p>Finally, we connect all the gain nodes to the <a href=\"/en-US/docs/Web/API/AudioContext\"><code>AudioContext</code></a>'s <a href=\"/en-US/docs/Web/API/BaseAudioContext/destination\" title=\"destination\"><code>destination</code></a>, so that any sound delivered to the gain nodes will reach the output, whether that output be speakers, headphones, a recording stream, or any other destination type.</p>\n<p>Then we assign a handler for the volume slider's <a href=\"/en-US/docs/Web/API/HTMLElement/input_event\" title=\"input\"><code>input</code></a> event (see <a href=\"#controlling_the_linked_oscillators\">Controlling the linked oscillators</a> to see the very short <code>changeVolume()</code> method).</p>\n<p>Right after declaring the <code>setup()</code> function, we add a handler to the play checkbox's <a href=\"/en-US/docs/Web/API/HTMLElement/change_event\" title=\"change\"><code>change</code></a> event (see <a href=\"#toggling_the_oscillators_on_and_off\">Toggling the oscillators on and off</a> for more on the <code>togglePlay()</code> method), and the stage is set. Let's see how the action plays out.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>playButton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"change\"</span><span class=\"token punctuation\">,</span> togglePlay<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h4 id=\"toggling_the_oscillators_on_and_off\">Toggling the oscillators on and off</h4>\n<p>Because <a href=\"/en-US/docs/Web/API/OscillatorNode\"><code>OscillatorNode</code></a> doesn't support the notion of being in a paused state, we have to simulate it by terminating the oscillators and starting them again when the user clicks on the play checkbox again to toggle them back on. Let's look at the code.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">togglePlay</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>playButton<span class=\"token punctuation\">.</span>checked<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">stopOscillators</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// If it is the first start, initialize the audio graph</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">startOscillators</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>If the <code>playButton</code> widget is checked, we're already playing the oscillators, and we call <code>stopOscillators()</code> to shut down the oscillators. See <a href=\"#stopping_the_oscillators\">Stopping the oscillators</a> below for that code.</p>\n<p>If the <code>playButton</code> widget is checked, indicating that we're currently paused, we call <code>startOscillators()</code> to start the oscillators playing their tones. Below, we describe that code under <a href=\"#starting_the_oscillators\">Starting the oscillators</a>.</p>\n<h4 id=\"controlling_the_linked_oscillators\">Controlling the linked oscillators</h4>\n<p>The <code>changeVolume()</code> function, the event handler for the slider control for the gain on the linked oscillator pair, looks like this:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">changeVolume</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  constantNode<span class=\"token punctuation\">.</span>offset<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> volumeControl<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>That simple function controls the gain on both nodes. All we have to do is set the value of the <a href=\"/en-US/docs/Web/API/ConstantSourceNode\"><code>ConstantSourceNode</code></a>'s <a href=\"/en-US/docs/Web/API/ConstantSourceNode/offset\" title=\"offset\"><code>offset</code></a> parameter. That value becomes the node's constant output value, fed to all its outputs, <code>gainNode2</code> and <code>gainNode3</code>.</p>\n<p>While this is an elementary example, imagine having a 32 oscillator synthesizer with multiple linked parameters in play across many patched nodes. Shortening the number of operations to adjust them all will prove invaluable for both code size and performance.</p>\n<h4 id=\"starting_the_oscillators\">Starting the oscillators</h4>\n<p>When the user clicks the play/pause toggle button while the oscillators aren't playing, the <code>startOscillators()</code> function gets called.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">startOscillators</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  oscNode1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OscillatorNode</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sine\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">frequency</span><span class=\"token operator\">:</span> <span class=\"token number\">261.625565300598634</span> <span class=\"token comment\">// middle C$</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  oscNode1<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>gainNode1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  oscNode2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OscillatorNode</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sine\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">frequency</span><span class=\"token operator\">:</span> <span class=\"token number\">329.627556912869929</span> <span class=\"token comment\">// E</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  oscNode2<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>gainNode2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  oscNode3 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OscillatorNode</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sine\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">frequency</span><span class=\"token operator\">:</span> <span class=\"token number\">391.995435981749294</span> <span class=\"token comment\">// G</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  oscNode3<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>gainNode3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  oscNode1<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  oscNode2<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  oscNode3<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Each of the three oscillators is set up the same way, creating the <a href=\"/en-US/docs/Web/API/OscillatorNode\"><code>OscillatorNode</code></a> by calling the <a href=\"/en-US/docs/Web/API/OscillatorNode/OscillatorNode\" title=\"OscillatorNode()\"><code>OscillatorNode()</code></a> constructor with two options:</p>\n<ol>\n  <li>Set the oscillator's <code>type</code> to <code>\"sine\"</code> to use a sine wave as the audio waveform.</li>\n  <li>Set the oscillator's <code>frequency</code> to the desired value; in this case, <code>oscNode1</code> is set to a middle C, while <code>oscNode2</code> and <code>oscNode3</code> round out the chord by playing the E and G notes.</li>\n</ol>\n<p>Then, we connect the new oscillator to the corresponding gain node.</p>\n<p>Once all three oscillators have been created, they're started by calling each one's <a href=\"/en-US/docs/Web/API/AudioScheduledSourceNode/start\" title=\"ConstantSourceNode.start()\"><code>ConstantSourceNode.start()</code></a> method in turn.</p>\n<h4 id=\"stopping_the_oscillators\">Stopping the oscillators</h4>\n<p>Stopping the oscillators when the user toggles the play state to pause the tones is as simple as stopping each node.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">stopOscillators</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  oscNode1<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  oscNode2<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  oscNode3<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Each node is stopped by calling its <a href=\"/en-US/docs/Web/API/AudioScheduledSourceNode/stop\" title=\"ConstantSourceNode.stop()\"><code>ConstantSourceNode.stop()</code></a> method.</p>"}},{"type":"prose","value":{"id":"result","title":"Result","isH3":true,"content":"<iframe class=\"sample-code-frame\" title=\"Example sample\" id=\"frame_example\" width=\"600\" height=\"120\" src=\"https://yari-demos.prod.mdn.mozit.cloud/en-US/docs/Web/API/Web_Audio_API/Controlling_multiple_parameters_with_ConstantSourceNode/_sample_.example.html\" loading=\"lazy\"></iframe>"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/API/Web_Audio_API\">Web Audio API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Using_Web_Audio_API\">Using the Web Audio API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Simple_synth\">Simple synth keyboard</a> (example)</li>\n  <li><a href=\"/en-US/docs/Web/API/OscillatorNode\"><code>OscillatorNode</code></a></li>\n  <li><a href=\"/en-US/docs/Web/API/ConstantSourceNode\"><code>ConstantSourceNode</code></a></li>\n</ul>"}}],"toc":[{"text":"The technique","id":"the_technique"},{"text":"Example","id":"example"},{"text":"See also","id":"see_also"}],"summary":"This article demonstrates how to use a ConstantSourceNode to link multiple parameters together so they share the same value, which can be changed by setting the value of the ConstantSourceNode.offset parameter.","popularity":0.0003,"modified":"2022-09-13T07:59:37.000Z","other_translations":[{"title":"ConstantSourceNode로 다수의 파라미터 제어하기","locale":"ko","native":"한국어"}],"source":{"folder":"en-us/web/api/web_audio_api/controlling_multiple_parameters_with_constantsourcenode","github_url":"https://github.com/mdn/content/blob/style/old/files/en-us/web/api/web_audio_api/controlling_multiple_parameters_with_constantsourcenode/index.md","last_commit_url":"https://github.com/mdn/content/commit/c09b8e9dd0022a33cf84355704ca281d6a5f29f5","filename":"index.md"},"parents":[{"uri":"/en-US/docs/Web","title":"Web technology for developers"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/Web_Audio_API","title":"Web Audio API"},{"uri":"/en-US/docs/Web/API/Web_Audio_API/Controlling_multiple_parameters_with_ConstantSourceNode","title":"Controlling multiple parameters with ConstantSourceNode"}],"pageTitle":"Controlling multiple parameters with ConstantSourceNode - Web APIs | MDN","noIndexing":false}}