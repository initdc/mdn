{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"TaskSignal: prioritychange event","mdn_url":"/en-US/docs/Web/API/TaskSignal/prioritychange_event","locale":"en-US","native":"English (US)","sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/Prioritized_Task_Scheduling_API\">Prioritized Task Scheduling API</a></strong></li><li><strong><a href=\"/en-US/docs/Web/API/TaskSignal\"><code>TaskSignal</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Properties</summary><ol><li><a href=\"/en-US/docs/Web/API/TaskSignal/priority\"><code>priority</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Events</summary><ol><li><em><code>prioritychange</code></em></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Inheritance:</summary><ol><li><a href=\"/en-US/docs/Web/API/AbortSignal\"><code>AbortSignal</code></a></li><li><a href=\"/en-US/docs/Web/API/EventTarget\"><code>EventTarget</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Related pages for Prioritized Task Scheduling API</summary><ol><li><a href=\"/en-US/docs/Web/API/AbortSignal\"><code>AbortSignal</code></a></li><li><a href=\"/en-US/docs/Web/API/Scheduler\"><code>Scheduler</code></a></li><li><a href=\"/en-US/docs/Web/API/TaskController\"><code>TaskController</code></a></li><li><a href=\"/en-US/docs/Web/API/TaskPriorityChangeEvent\"><code>TaskPriorityChangeEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/Window/scheduler\"><code>Window.scheduler</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>The <strong><code>prioritychange</code></strong> event is sent to a <a href=\"/en-US/docs/Web/API/TaskSignal\"><code>TaskSignal</code></a> if its <a href=\"/en-US/docs/Web/API/Prioritized_Task_Scheduling_API#task_priorities\">priority</a> is changed.</p>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<p>Use the event name in methods like <a href=\"/en-US/docs/Web/API/EventTarget/addEventListener\" title=\"addEventListener()\"><code>addEventListener()</code></a>, or set an event handler property.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'prioritychange'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function-variable function\">onprioritychange</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"event_type","title":"Event type","isH3":false,"content":"<p>A <a href=\"/en-US/docs/Web/API/TaskPriorityChangeEvent\"><code>TaskPriorityChangeEvent</code></a>. Inherits from <a href=\"/en-US/docs/Web/API/Event\"><code>Event</code></a>.</p><svg viewBox=\"-1 -1 650 42\" preserveAspectRatio=\"xMinYMin meet\">\n  <a style=\"text-decoration: none;\" xlink:href=\"/en-US/docs/Web/API/Event\">\n    <rect x=\"0\" y=\"0\" width=\"75\" height=\"25\" fill=\"#fff\" stroke=\"#D4DDE4\" stroke-width=\"2px\"></rect>\n    <text x=\"37.5\" y=\"16\" font-size=\"10px\" fill=\"#4D4E53\" text-anchor=\"middle\">\n      Event\n    </text>\n  </a>\n  <line x1=\"75\" y1=\"14\" x2=\"105\" y2=\"14\" stroke=\"#D4DDE4\" \"=\"\"></line>\n  <polyline points=\"75,14 85,9 85,19 75,14\" stroke=\"#D4DDE4\" fill=\"#fff\"></polyline>\n  <a style=\"text-decoration: none;\" xlink:href=\"/en-US/docs/Web/API/TaskPriorityChangeEvent\">\n    <rect x=\"105\" y=\"0\" width=\"184\" height=\"25\" fill=\"#F4F7F8\" stroke=\"#D4DDE4\" stroke-width=\"2px\"></rect>\n    <text x=\"197\" y=\"16\" font-size=\"10px\" fill=\"#4D4E53\" text-anchor=\"middle\">\n      TaskPriorityChangeEvent\n    </text>\n  </a></svg>"}},{"type":"prose","value":{"id":"event_properties","title":"Event properties","isH3":false,"content":"<dl>\n  <dt id=\"taskprioritychangeevent.previouspriority\"><a href=\"/en-US/docs/Web/API/TaskPriorityChangeEvent/previousPriority\"><code>TaskPriorityChangeEvent.previousPriority</code></a></dt>\n  <dd>\n    <p>\n      Indicates the previous priority of the task (before it was changed).\n      The new/updated priority is read from <code>event.target.priority</code> (<a href=\"/en-US/docs/Web/API/TaskSignal/priority\"><code>TaskSignal.priority</code></a>).\n    </p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<p>The example below shows how to listen for the <code>prioritychange</code> event on a <a href=\"/en-US/docs/Web/API/TaskSignal\"><code>TaskSignal</code></a>.</p>\n<div class=\"code-example\"><pre class=\"brush: html hidden notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>textarea</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>log<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value css language-css\"><span class=\"token property\">min-height</span><span class=\"token punctuation\">:</span> 70px<span class=\"token punctuation\">;</span> <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 95%</span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>textarea</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<div class=\"code-example\"><pre class=\"brush: js hidden notranslate\"><code><span class=\"token keyword\">let</span> log <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'log'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">mylog</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">text</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> log<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>text<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>\n  First we create a controller, and add an event listener to its signal.\n  When handling the event we use <a href=\"/en-US/docs/Web/API/TaskPriorityChangeEvent/previousPriority\" title=\"previousPriority\"><code>previousPriority</code></a> on the event to get the original priority and <a href=\"/en-US/docs/Web/API/TaskSignal/priority\"><code>TaskSignal.priority</code></a> on the event target to get the new/current priority.\n</p>\n<p>The task is then posted, passing in the signal, and then we immediately change the priority.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'scheduler'</span> <span class=\"token keyword\">in</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Declare a TaskController, setting its signal priority to 'user-blocking'</span>\n  <span class=\"token keyword\">const</span> controller <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TaskController</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">priority</span><span class=\"token operator\">:</span> <span class=\"token string\">'user-blocking'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Listen for 'prioritychange' events on the controller's signal.</span>\n  controller<span class=\"token punctuation\">.</span>signal<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'prioritychange'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> previousPriority <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>previousPriority<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> newPriority <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>priority<span class=\"token punctuation\">;</span>\n      <span class=\"token function\">mylog</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Priority changed from </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>previousPriority<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> to </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>newPriority<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Post task using the controller's signal.</span>\n  <span class=\"token comment\">// The signal priority sets the initial priority of the task</span>\n  scheduler<span class=\"token punctuation\">.</span><span class=\"token function\">postTask</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span> <span class=\"token function\">mylog</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Task 1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">signal</span><span class=\"token operator\">:</span> controller<span class=\"token punctuation\">.</span>signal<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Change the priority to 'background' using the controller</span>\n  controller<span class=\"token punctuation\">.</span><span class=\"token function\">setPriority</span><span class=\"token punctuation\">(</span><span class=\"token string\">'background'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect1\">\n  <p>\n    <strong>Note:</strong> The code above uses a custom logging function <code>mylog()</code> to log to the text area below.\n    This is hidden as it isn't relevant to the example.\n  </p>\n</div>\n<p>\n  The output below demonstrates shows that the <a href=\"/en-US/docs/Web/API/Prioritized_Task_Scheduling_API#task_priorities\">task's priority</a> changed from <code>user-blocking</code> to <code>background</code>.\n  This happens before the task is executed, but could also happen when the task is running.\n</p><iframe class=\"sample-code-frame\" title=\"Examples sample\" id=\"frame_examples\" width=\"400px\" height=\"130px\" src=\"https://yari-demos.prod.mdn.mozit.cloud/en-US/docs/Web/API/TaskSignal/prioritychange_event/_sample_.examples.html\" loading=\"lazy\"></iframe>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://wicg.github.io/scheduling-apis/#ref-for-eventdef-tasksignal-prioritychange","title":"Prioritized Task Scheduling"},{"bcdSpecificationURL":"https://wicg.github.io/scheduling-apis/#dom-tasksignal-onprioritychange","title":"Prioritized Task Scheduling"}],"query":"api.TaskSignal.prioritychange_event"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.TaskSignal.prioritychange_event","dataURL":"/en-US/docs/Web/API/TaskSignal/prioritychange_event/bcd.json"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"Event type","id":"event_type"},{"text":"Event properties","id":"event_properties"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"}],"summary":"The prioritychange event is sent to a TaskSignal if its priority is changed.","popularity":0,"modified":"2022-09-09T05:19:45.000Z","source":{"folder":"en-us/web/api/tasksignal/prioritychange_event","github_url":"https://github.com/mdn/content/blob/style/old/files/en-us/web/api/tasksignal/prioritychange_event/index.md","last_commit_url":"https://github.com/mdn/content/commit/f7dae62645a2c735ed6f6ed63f664bf279fdfc4b","filename":"index.md"},"parents":[{"uri":"/en-US/docs/Web","title":"Web technology for developers"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/TaskSignal","title":"TaskSignal"},{"uri":"/en-US/docs/Web/API/TaskSignal/prioritychange_event","title":"TaskSignal: prioritychange event"}],"pageTitle":"TaskSignal: prioritychange event - Web APIs | MDN","noIndexing":false}}