{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"RTCRtpSender.setParameters()","mdn_url":"/en-US/docs/Web/API/RTCRtpSender/setParameters","locale":"en-US","native":"English (US)","sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/RTCRtpSender\"><code>RTCRtpSender</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Properties</summary><ol><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/dtmf\"><code>dtmf</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/track\"><code>track</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/transport\"><code>transport</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Methods</summary><ol><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/getCapabilities\"><code>getCapabilities() static function</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/getParameters\"><code>getParameters()</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/getStats\"><code>getStats()</code></a></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/replaceTrack\"><code>replaceTrack()</code></a></li><li><em><code>setParameters()</code></em></li><li><a href=\"/en-US/docs/Web/API/RTCRtpSender/setStreams\"><code>setStreams()</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>\n  The <strong><code>setParameters()</code></strong> method of\n  the <a href=\"/en-US/docs/Web/API/RTCRtpSender\"><code>RTCRtpSender</code></a> interface applies changes the configuration of\n  sender's <a href=\"/en-US/docs/Web/API/RTCRtpSender/track\" title=\"track\"><code>track</code></a>, which is the\n  <a href=\"/en-US/docs/Web/API/MediaStreamTrack\"><code>MediaStreamTrack</code></a> for which the <code>RTCRtpSender</code> is\n  responsible.\n</p>\n<p>\n  In other words, <code>setParameters()</code> updates the configuration of the\n  <a href=\"/en-US/docs/Glossary/RTP\">RTP</a> transmission as well as the encoding configuration for a specific\n  outgoing media track on the <a href=\"/en-US/docs/Web/API/WebRTC_API\">WebRTC</a>\n  connection.\n</p>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<div class=\"code-example\"><pre class=\"brush: js-nolint notranslate\">setParameters(parameters)\n</pre></div>"}},{"type":"prose","value":{"id":"parameters","title":"Parameters","isH3":true,"content":"<dl>\n  <dt id=\"parameters_2\"><code>parameters</code></dt>\n  <dd>\n    <p>\n      A parameters object previously obtained by calling the same\n      sender's <a href=\"/en-US/docs/Web/API/RTCRtpSender/getParameters\" title=\"getParameters()\"><code>getParameters()</code></a> method, with\n      the desired changes to the sender's configuration parameters. These parameters\n      include potential codecs that could be use for encoding the sender's\n      <a href=\"/en-US/docs/Web/API/RTCRtpSender/track\" title=\"track\"><code>track</code></a>. The available parameters are:\n    </p>\n    <dl>\n      <dt id=\"encodings\"><code>encodings</code></dt>\n      <dd>\n        <p>An array of <a href=\"/en-US/docs/Web/API/RTCRtpEncodingParameters\"><code>RTCRtpEncodingParameters</code></a> objects, each specifying the parameters for a single codec that could be used to encode the track's media.</p>\n      </dd>\n      <dt id=\"transactionid\"><code>transactionId</code></dt>\n      <dd>\n        <p>A string containing a unique ID for the last set of parameters applied; this value is used to ensure that <a href=\"/en-US/docs/Web/API/RTCRtpSender/setParameters\" title=\"setParameters()\" aria-current=\"page\"><code>setParameters()</code></a> can only be called to alter changes made by a specific previous call to <a href=\"/en-US/docs/Web/API/RTCRtpSender/getParameters\" title=\"getParameters()\"><code>getParameters()</code></a>. Once this parameter is initially set, it cannot be changed.</p>\n      </dd>\n      <dt id=\"degradationpreference\"><code>degradationPreference</code> <svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg></dt>\n      <dd>\n        <p>Specifies the preferred way the WebRTC layer should handle optimizing bandwidth against quality in constrained-bandwidth situations; the possible values are <code>maintain-framerate</code>, <code>maintain-resolution</code>, or <code>balanced</code>. The default value is <code>balanced</code>.</p>\n      </dd>\n      <dt id=\"priority\"><code>priority</code> <svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg></dt>\n      <dd>\n        <p>A string that indicates the encoding's priority. It is one of: <code>very-low</code>, <code>low</code>, <code>medium</code>, or <code>high</code>. The default value is <code>low</code>.</p>\n      </dd>\n    </dl>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"return_value","title":"Return value","isH3":true,"content":"<p>\n  A <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a> that resolves when the <a href=\"/en-US/docs/Web/API/RTCRtpSender/track\"><code>RTCRtpSender.track</code></a>\n  property is updated with the given parameters.\n</p>"}},{"type":"prose","value":{"id":"exceptions","title":"Exceptions","isH3":true,"content":"<p>\n  If an error occurs, the returned promise is rejected with the appropriate exception\n  from the list below.\n</p>\n<dl>\n  <dt id=\"invalidmodificationerror\"><code>InvalidModificationError</code> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a></dt>\n  <dd>\n    <p>Returned if one of the following problems is detected:</p>\n    <ul>\n      <li>\n        The number of encodings specified in the <code>parameters</code> object's\n        <a href=\"/en-US/docs/Web/API/RTCRtpSendParameters/encodings\" title=\"encodings\"><code>encodings</code></a> property does not match\n        the number of encodings currently listed for the <code>RTCRtpSender</code>. You\n        cannot change the number of encoding options after the sender has been created.\n      </li>\n      <li>\n        The order of the specified <code>encodings</code> has changed from the current\n        list's order.\n      </li>\n      <li>\n        An attempt has been made to alter a property that cannot be changed after the\n        sender is first created.\n      </li>\n    </ul>\n  </dd>\n  <dt id=\"invalidstateerror\"><code>InvalidStateError</code> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a></dt>\n  <dd>\n    <p>\n      Returned if the transceiver, of which the <code>RTCRtpSender</code> is a part, is not running or\n      has no parameters to set.\n    </p>\n  </dd>\n  <dt id=\"operationerror\"><code>OperationError</code> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a></dt>\n  <dd>\n    <p>Returned if an error occurs that does not match the ones specified here.</p>\n  </dd>\n  <dt id=\"rangeerror\"><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/RangeError\"><code>RangeError</code></a></dt>\n  <dd>\n    <p>Returned if the value specified for <a class=\"page-not-created\" title=\"The documentation about this has not yet been written; please consider contributing!\"><code>scaleResolutionDownBy</code></a> is less than 1.0 â€” which would result in scaling up rather than down, which is not allowed; or if one or more of the specified <code>encodings</code> <a href=\"/en-US/docs/Web/API/RTCRtpEncodingParameters/maxFramerate\" title=\"maxFramerate\"><code>maxFramerate</code></a> values is less than 0.0.</p>\n  </dd>\n</dl>\n<p>In addition, if a WebRTC error occurs while configuring or accessing the media, an <a href=\"/en-US/docs/Web/API/RTCError\"><code>RTCError</code></a> is thrown with its <a href=\"/en-US/docs/Web/API/RTCError/errorDetail\" title=\"errorDetail\"><code>errorDetail</code></a> set to <code>hardware-encoder-error</code>.</p>"}},{"type":"prose","value":{"id":"description","title":"Description","isH3":false,"content":"<p>\n  It's important to keep in mind that you can't create an\n  <a href=\"/en-US/docs/Web/API/RTCRtpSendParameters\"><code>RTCRtpSendParameters</code></a> object yourself and expect it to work. Instead, you\n  <em>must</em> first call <a href=\"/en-US/docs/Web/API/RTCRtpSender/getParameters\" title=\"getParameters()\"><code>getParameters()</code></a>,\n  modify the received parameters object, then pass that object into\n  <code>setParameters()</code>. WebRTC uses the parameters object's\n  <code>transactionId</code> property to ensure that when you set parameters, your changes\n  are based on the most recent parameters rather than an out of date configuration.\n</p>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<p>\n  One use case for <code>setParameters()</code> is to try to reduce network bandwidth use\n  in constrained environments by altering the resolution and/or bit rate of the media\n  being transmitted by the <a href=\"/en-US/docs/Web/API/RTCRtpSender\"><code>RTCRtpSender</code></a>.\n</p>\n<p>\n  Currently, some browsers have limitations on their implementations that may cause\n  issues. For that reason, two examples are given here. The first shows how to use\n  <code>setParameters()</code> when all browsers fully support the parameters being used,\n  while the second example demonstrates workarounds to help solve limitations in browsers\n  with incomplete support for the <a href=\"/en-US/docs/Web/API/RTCRtpEncodingParameters/maxBitrate\" title=\"maxBitrate\"><code>maxBitrate</code></a> and <a href=\"/en-US/docs/Web/API/RTCRtpEncodingParameters/scaleResolutionDownBy\" title=\"scaleResolutionDownBy\"><code>scaleResolutionDownBy</code></a> parameters.\n</p>"}},{"type":"prose","value":{"id":"by_the_specification","title":"By the specification","isH3":true,"content":"<p>\n  Once all browsers implement the spec fully, this implementation of\n  <code>setVideoParams()</code> will do the job. This demonstrates how everything\n  <em>should</em> work. You should probably use the second example, below, for now. But\n  this is a clearer demonstration of the basic concept of first fetching the parameters,\n  then altering them, then setting them.\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">setVideoParams</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sender<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> bitrate</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> scaleRatio <span class=\"token operator\">=</span> sender<span class=\"token punctuation\">.</span>track<span class=\"token punctuation\">.</span><span class=\"token function\">getSettings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>height<span class=\"token operator\">/</span>height<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> params <span class=\"token operator\">=</span> sender<span class=\"token punctuation\">.</span><span class=\"token function\">getParameters</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  params<span class=\"token punctuation\">.</span>encodings<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>scaleResolutionDownBy <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span>scaleRatio<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  params<span class=\"token punctuation\">.</span>encodings<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>maxBitrate <span class=\"token operator\">=</span> bitrate<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">await</span> sender<span class=\"token punctuation\">.</span><span class=\"token function\">setParameters</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>\n  In calling this function, you specify a sender, as well as the height you wish to\n  scale the sender's video to, as well as a maximum bitrate to permit the sender to\n  transmit. A scaling factor for the size of the video, <code>scaleRatio</code>, is\n  computed. Then the sender's current parameters are fetched using\n  <a href=\"/en-US/docs/Web/API/RTCRtpSender/getParameters\" title=\"getParameters()\"><code>getParameters()</code></a>.\n</p>\n<p>\n  The parameters are then altered by changing the first\n  <a href=\"/en-US/docs/Web/API/RTCRtpSendParameters/encodings\" title=\"encodings\"><code>encodings</code></a> object's\n  <a href=\"/en-US/docs/Web/API/RTCRtpEncodingParameters/scaleResolutionDownBy\" title=\"scaleResolutionDownBy\"><code>scaleResolutionDownBy</code></a>\n  and <a href=\"/en-US/docs/Web/API/RTCRtpEncodingParameters/maxBitrate\" title=\"maxBitrate\"><code>maxBitrate</code></a> to the calculated\n  scaling factor and the specified maximum <code>bitrate</code>.\n</p>\n<p>\n  The changed parameters are then saved by calling the sender's\n  <code>setParameters()</code> method.\n</p>"}},{"type":"prose","value":{"id":"currently_compatible_implementation","title":"Currently compatible implementation","isH3":true,"content":"<p>\n  As mentioned above, the previous example shows how things are meant to work.\n  Unfortunately, there are implementation issues preventing this in many browsers right\n  now. For that reason, if you want to be compatible with iPhone and other devices running\n  Safari, and with Firefox, use code more like this:\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">setVideoParams</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sender<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> bitrate</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> scaleRatio <span class=\"token operator\">=</span> sender<span class=\"token punctuation\">.</span>track<span class=\"token punctuation\">.</span><span class=\"token function\">getSettings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>height<span class=\"token operator\">/</span>height<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> params <span class=\"token operator\">=</span> sender<span class=\"token punctuation\">.</span><span class=\"token function\">getParameters</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// If encodings is null, create it</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>params<span class=\"token punctuation\">.</span>encodings<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    params<span class=\"token punctuation\">.</span>encodings <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  params<span class=\"token punctuation\">.</span>encodings<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>scaleResolutionDownBy <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span>scaleRatio<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  params<span class=\"token punctuation\">.</span>encodings<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>maxBitrate <span class=\"token operator\">=</span> bitrate<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">await</span> sender<span class=\"token punctuation\">.</span><span class=\"token function\">setParameters</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// If the newly changed value of scaleResolutionDownBy is 1,</span>\n  <span class=\"token comment\">// use applyConstraints() to be sure the height is constrained,</span>\n  <span class=\"token comment\">// since scaleResolutionDownBy may not be implemented</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sender<span class=\"token punctuation\">.</span><span class=\"token function\">getParameters</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>encodings<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>scaleResolutionDownBy <span class=\"token operator\">===</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> sender<span class=\"token punctuation\">.</span>track<span class=\"token punctuation\">.</span><span class=\"token function\">applyConstraints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> height <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>The differences here:</p>\n<ul>\n  <li>\n    If <code>encodings</code> is <code>null</code>, we create it, in order to ensure\n    that we can then set the parameters successfully without crashing.\n  </li>\n  <li>\n    If, after setting the parameters, the value of <code>scaleResolutionDownBy</code> is\n    still 1, we call the sender's track's <a href=\"/en-US/docs/Web/API/MediaStreamTrack/applyConstraints\" title=\"applyConstraints()\"><code>applyConstraints()</code></a> method to constrain the track's height to <code>height</code>.\n    This compensates for an unimplemented <code>scaleResolutionDownBy</code> (as is the\n    case in Safari as of this writing).\n  </li>\n</ul>\n<p>\n  This code will cleanly fall back and work the normal way if the browser fully\n  implements the used features.\n</p>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender-setparameters","title":"WebRTC 1.0: Real-Time Communication Between Browsers"}],"query":"api.RTCRtpSender.setParameters"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.RTCRtpSender.setParameters","dataURL":"/en-US/docs/Web/API/RTCRtpSender/setParameters/bcd.json"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/API/WebRTC_API\">WebRTC API</a></li>\n  <li><a href=\"/en-US/docs/Web/Media/Formats/WebRTC_codecs\">Codecs used by WebRTC</a></li>\n  <li><a href=\"/en-US/docs/Web/Media\">Web media technologies</a></li>\n</ul>"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"Description","id":"description"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The setParameters() method of\n  the RTCRtpSender interface applies changes the configuration of\n  sender's track, which is the\n  MediaStreamTrack for which the RTCRtpSender is\n  responsible.","popularity":0.0003,"modified":"2022-09-13T06:27:50.000Z","source":{"folder":"en-us/web/api/rtcrtpsender/setparameters","github_url":"https://github.com/mdn/content/blob/style/old/files/en-us/web/api/rtcrtpsender/setparameters/index.md","last_commit_url":"https://github.com/mdn/content/commit/16e398809d62247dbadc89ff4024a0ffa4781f0e","filename":"index.md"},"parents":[{"uri":"/en-US/docs/Web","title":"Web technology for developers"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/RTCRtpSender","title":"RTCRtpSender"},{"uri":"/en-US/docs/Web/API/RTCRtpSender/setParameters","title":"RTCRtpSender.setParameters()"}],"pageTitle":"RTCRtpSender.setParameters() - Web APIs | MDN","noIndexing":false}}