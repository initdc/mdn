{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"SubtleCrypto.deriveKey()","mdn_url":"/en-US/docs/Web/API/SubtleCrypto/deriveKey","locale":"en-US","native":"English (US)","sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/Web_Crypto_API\">Web Crypto API</a></strong></li><li><strong><a href=\"/en-US/docs/Web/API/SubtleCrypto\"><code>SubtleCrypto</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Methods</summary><ol><li><a href=\"/en-US/docs/Web/API/SubtleCrypto/decrypt\"><code>decrypt()</code></a></li><li><a href=\"/en-US/docs/Web/API/SubtleCrypto/deriveBits\"><code>deriveBits()</code></a></li><li><em><code>deriveKey()</code></em></li><li><a href=\"/en-US/docs/Web/API/SubtleCrypto/digest\"><code>digest()</code></a></li><li><a href=\"/en-US/docs/Web/API/SubtleCrypto/encrypt\"><code>encrypt()</code></a></li><li><a href=\"/en-US/docs/Web/API/SubtleCrypto/exportKey\"><code>exportKey()</code></a></li><li><a href=\"/en-US/docs/Web/API/SubtleCrypto/generateKey\"><code>generateKey()</code></a></li><li><a href=\"/en-US/docs/Web/API/SubtleCrypto/importKey\"><code>importKey()</code></a></li><li><a href=\"/en-US/docs/Web/API/SubtleCrypto/sign\"><code>sign()</code></a></li><li><a href=\"/en-US/docs/Web/API/SubtleCrypto/unwrapKey\"><code>unwrapKey()</code></a></li><li><a href=\"/en-US/docs/Web/API/SubtleCrypto/verify\"><code>verify()</code></a></li><li><a href=\"/en-US/docs/Web/API/SubtleCrypto/wrapKey\"><code>wrapKey()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Related pages for Web Crypto API</summary><ol><li><a href=\"/en-US/docs/Web/API/Crypto\"><code>Crypto</code></a></li><li><a href=\"/en-US/docs/Web/API/CryptoKey\"><code>CryptoKey</code></a></li><li><a href=\"/en-US/docs/Web/API/crypto_property\"><code>crypto_property</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div class=\"notecard secure\" id=\"sect1\"><p><strong>Secure context:</strong> This feature is available only in <a href=\"/en-US/docs/Web/Security/Secure_Contexts\">secure contexts</a> (HTTPS), in some or all <a href=\"#browser_compatibility\">supporting browsers</a>.</p></div>\n<p>\n  The <strong><code>deriveKey()</code></strong> method of the <a href=\"/en-US/docs/Web/API/SubtleCrypto\"><code>SubtleCrypto</code></a>\n  interface can be used to derive a secret key from a master key.\n</p>\n<p>\n  It takes as arguments some initial key material, the derivation algorithm to use, and\n  the desired properties for the key to derive. It returns a <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a>\n  which will be fulfilled with a <a href=\"/en-US/docs/Web/API/CryptoKey\"><code>CryptoKey</code></a> object representing the new key.\n</p>\n<p>\n  It's worth noting that the three key derivation algorithms you can use have quite\n  different characteristics and are appropriate in quite different situations. See <a href=\"#supported_algorithms\">Supported algorithms</a> for some more detail on this.\n</p>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<div class=\"code-example\"><pre class=\"brush: js-nolint notranslate\">deriveKey(algorithm, baseKey, derivedKeyAlgorithm, extractable, keyUsages)\n</pre></div>"}},{"type":"prose","value":{"id":"parameters","title":"Parameters","isH3":true,"content":"<dl>\n  <dt id=\"algorithm\"><code>algorithm</code></dt>\n  <dd>\n    <p>An object defining the <a href=\"#supported_algorithms\">derivation algorithm</a> to use.</p>\n    <ul>\n      <li>\n        To use <a href=\"#ecdh\">ECDH</a>, pass an\n        <a href=\"/en-US/docs/Web/API/EcdhKeyDeriveParams\"><code>EcdhKeyDeriveParams</code></a> object.\n      </li>\n      <li>\n        To use <a href=\"#hkdf\">HKDF</a>, pass\n        an <a href=\"/en-US/docs/Web/API/HkdfParams\"><code>HkdfParams</code></a> object.\n      </li>\n      <li>\n        To use <a href=\"#pbkdf2\">PBKDF2</a>, pass\n        a <a href=\"/en-US/docs/Web/API/Pbkdf2Params\"><code>Pbkdf2Params</code></a> object.\n      </li>\n    </ul>\n  </dd>\n  <dt id=\"basekey\"><code>baseKey</code></dt>\n  <dd>\n    <p>\n      A <a href=\"/en-US/docs/Web/API/CryptoKey\"><code>CryptoKey</code></a> representing the input\n      to the derivation algorithm. If <code>algorithm</code> is ECDH, then this will be the\n      ECDH private key. Otherwise it will be the initial key material for the derivation\n      function: for example, for PBKDF2 it might be a password, imported as a\n      <code>CryptoKey</code> using\n      <a href=\"/en-US/docs/Web/API/SubtleCrypto/importKey\"><code>SubtleCrypto.importKey()</code></a>.\n    </p>\n  </dd>\n  <dt id=\"derivedkeyalgorithm\"><code>derivedKeyAlgorithm</code></dt>\n  <dd>\n    <p>An object defining the algorithm the derived key will be used for.</p>\n    <ul>\n      <li>\n        For <a href=\"/en-US/docs/Web/API/SubtleCrypto/sign#hmac\">HMAC</a>: pass an\n        <a href=\"/en-US/docs/Web/API/HmacKeyGenParams\"><code>HmacKeyGenParams</code></a> object.\n      </li>\n      <li>\n        For <a href=\"/en-US/docs/Web/API/SubtleCrypto/encrypt#aes-ctr\">AES-CTR</a>, <a href=\"/en-US/docs/Web/API/SubtleCrypto/encrypt#aes-cbc\">AES-CBC</a>,\n        <a href=\"/en-US/docs/Web/API/SubtleCrypto/encrypt#aes-gcm\">AES-GCM</a>, or <a href=\"/en-US/docs/Web/API/SubtleCrypto/wrapKey#aes-kw\">AES-KW</a>: pass an\n        <a href=\"/en-US/docs/Web/API/AesKeyGenParams\"><code>AesKeyGenParams</code></a> object.\n      </li>\n    </ul>\n  </dd>\n  <dt id=\"extractable\"><code>extractable</code></dt>\n  <dd>\n    <p>\n      A boolean value indicating whether it\n      will be possible to export the key using <a href=\"/en-US/docs/Web/API/SubtleCrypto/exportKey\"><code>SubtleCrypto.exportKey()</code></a> or\n      <a href=\"/en-US/docs/Web/API/SubtleCrypto/wrapKey\"><code>SubtleCrypto.wrapKey()</code></a>.\n    </p>\n  </dd>\n  <dt id=\"keyusages\"><code>keyUsages</code></dt>\n  <dd>\n    <p>\n      An <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array\"><code>Array</code></a> indicating what can be\n      done with the derived key. Note that the key usages must be allowed by the algorithm\n      set in <code>derivedKeyAlgorithm</code>. Possible values of the array are:\n    </p>\n    <ul>\n      <li><code>encrypt</code>: The key may be used to <a href=\"/en-US/docs/Web/API/SubtleCrypto/encrypt\" title=\"encrypt\"><code>encrypt</code></a> messages.</li>\n      <li><code>decrypt</code>: The key may be used to <a href=\"/en-US/docs/Web/API/SubtleCrypto/decrypt\" title=\"decrypt\"><code>decrypt</code></a> messages.</li>\n      <li><code>sign</code>: The key may be used to <a href=\"/en-US/docs/Web/API/SubtleCrypto/sign\" title=\"sign\"><code>sign</code></a> messages.</li>\n      <li><code>verify</code>: The key may be used to <a href=\"/en-US/docs/Web/API/SubtleCrypto/verify\" title=\"verify\"><code>verify</code></a> signatures.</li>\n      <li><code>deriveKey</code>: The key may be used in <a href=\"/en-US/docs/Web/API/SubtleCrypto/deriveKey\" title=\"deriving a new key\" aria-current=\"page\"><code>deriving a new key</code></a>.</li>\n      <li><code>deriveBits</code>: The key may be used in <a href=\"/en-US/docs/Web/API/SubtleCrypto/deriveBits\" title=\"deriving bits\"><code>deriving bits</code></a>.</li>\n      <li><code>wrapKey</code>: The key may be used to <a href=\"/en-US/docs/Web/API/SubtleCrypto/wrapKey\" title=\"wrap a key\"><code>wrap a key</code></a>.</li>\n      <li><code>unwrapKey</code>: The key may be used to <a href=\"/en-US/docs/Web/API/SubtleCrypto/unwrapKey\" title=\"unwrap a key\"><code>unwrap a key</code></a>.</li>\n    </ul>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"return_value","title":"Return value","isH3":true,"content":"<p>A <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a> that fulfills with a <a href=\"/en-US/docs/Web/API/CryptoKey\"><code>CryptoKey</code></a>.</p>"}},{"type":"prose","value":{"id":"exceptions","title":"Exceptions","isH3":true,"content":"<p>The promise is rejected when one of the following exceptions are encountered:</p>\n<dl>\n  <dt id=\"invalidaccesserror\"><code>InvalidAccessError</code> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a></dt>\n  <dd>\n    <p>\n      Raised when the master key is not a key for the requested derivation algorithm\n      or if the <code>keyUsages</code> value of that key doesn't contain <code>deriveKey</code>.\n    </p>\n  </dd>\n  <dt id=\"notsupported\"><code>NotSupported</code> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a></dt>\n  <dd>\n    <p>\n      Raised when trying to use an algorithm that is either unknown or isn't suitable for\n      derivation, or if the algorithm requested for the derived key doesn't define a key\n      length.\n    </p>\n  </dd>\n  <dt id=\"syntaxerror\"><code>SyntaxError</code> <a href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code></a></dt>\n  <dd>\n    <p>\n      Raised when <code>keyUsages</code> is empty but the unwrapped key is of\n      type <code>secret</code> or <code>private</code>.\n    </p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"supported_algorithms","title":"Supported algorithms","isH3":false,"content":"<p>\n  The three algorithms supported by <code>deriveKey()</code> have quite different\n  characteristics and are appropriate in different situations.\n</p>"}},{"type":"prose","value":{"id":"ecdh","title":"ECDH","isH3":true,"content":"<p>\n  ECDH (Elliptic Curve Diffie-Hellman) is a <em>key-agreement algorithm</em>. It enables\n  two people who each have an ECDH public/private key pair to generate a shared secret:\n  that is, a secret that they — and no one else — share. They can then use this shared\n  secret as a symmetric key to secure their communication, or can use the secret as an\n  input to derive such a key (for example, using the HKDF algorithm).\n</p>\n<p>ECDH is specified in <a href=\"https://datatracker.ietf.org/doc/html/rfc6090\" class=\"external\" rel=\" noopener\">RFC 6090</a>.</p>"}},{"type":"prose","value":{"id":"hkdf","title":"HKDF","isH3":true,"content":"<p>\n  HKDF is a <em>key derivation function</em>. It's designed to derive key material from\n  some high-entropy input, such as the output of an ECDH key agreement operation.\n</p>\n<p>\n  It's <em>not</em> designed to derive keys from relatively low-entropy inputs such as\n  passwords. For that, use PBKDF2.\n</p>\n<p>HKDF is specified in <a href=\"https://datatracker.ietf.org/doc/html/rfc5869\" class=\"external\" rel=\" noopener\">RFC 5869</a>.</p>"}},{"type":"prose","value":{"id":"pbkdf2","title":"PBKDF2","isH3":true,"content":"<p>\n  PBKDF2 is also a <em>key derivation function</em>. It's designed to derive key material\n  from some relatively low-entropy input, such as a password. It derives key material by\n  applying a function such as HMAC to the input password along with some salt, and\n  repeating this process many times. The more times the process is repeated, the more\n  computationally expensive key derivation is: this makes it harder for an attacker to use\n  brute-force to discover the key using a dictionary attack.\n</p>\n<p>PBKDF2 is specified in <a href=\"https://datatracker.ietf.org/doc/html/rfc2898\" class=\"external\" rel=\" noopener\">RFC 2898</a>.</p>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note:</strong> You can <a href=\"https://mdn.github.io/dom-examples/web-crypto/derive-key/index.html\" class=\"external\" rel=\" noopener\">try the working examples</a> on GitHub.</p>\n</div>"}},{"type":"prose","value":{"id":"ecdh_2","title":"ECDH","isH3":true,"content":"<p>\n  In this example Alice and Bob each generate an ECDH key pair, then exchange public\n  keys. They then use <code>deriveKey()</code> to derive a shared AES key, that they could\n  use to encrypt messages. <a href=\"https://github.com/mdn/dom-examples/blob/main/web-crypto/derive-key/ecdh.js\" class=\"external\" rel=\" noopener\">See the complete code on GitHub.</a>\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">/*\nDerive an AES key, given:\n- our ECDH private key\n- their ECDH public key\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">deriveSecretKey</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">privateKey<span class=\"token punctuation\">,</span> publicKey</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> window<span class=\"token punctuation\">.</span>crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">deriveKey</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ECDH\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token keyword\">public</span><span class=\"token operator\">:</span> publicKey\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    privateKey<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"AES-GCM\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">length</span><span class=\"token operator\">:</span> <span class=\"token number\">256</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">\"encrypt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"decrypt\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">agreeSharedSecretKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Generate 2 ECDH key pairs: one for Alice and one for Bob</span>\n  <span class=\"token comment\">// In more normal usage, they would generate their key pairs</span>\n  <span class=\"token comment\">// separately and exchange public keys securely</span>\n  <span class=\"token keyword\">let</span> alicesKeyPair <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">generateKey</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ECDH\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">namedCurve</span><span class=\"token operator\">:</span> <span class=\"token string\">\"P-384\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">\"deriveKey\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> bobsKeyPair <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">generateKey</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ECDH\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">namedCurve</span><span class=\"token operator\">:</span> <span class=\"token string\">\"P-384\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">\"deriveKey\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Alice then generates a secret key using her private key and Bob's public key.</span>\n  <span class=\"token keyword\">let</span> alicesSecretKey <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">deriveSecretKey</span><span class=\"token punctuation\">(</span>alicesKeyPair<span class=\"token punctuation\">.</span>privateKey<span class=\"token punctuation\">,</span> bobsKeyPair<span class=\"token punctuation\">.</span>publicKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Bob generates the same secret key using his private key and Alice's public key.</span>\n  <span class=\"token keyword\">let</span> bobsSecretKey <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">deriveSecretKey</span><span class=\"token punctuation\">(</span>bobsKeyPair<span class=\"token punctuation\">.</span>privateKey<span class=\"token punctuation\">,</span> alicesKeyPair<span class=\"token punctuation\">.</span>publicKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Alice can then use her copy of the secret key to encrypt a message to Bob.</span>\n  <span class=\"token keyword\">let</span> encryptButton <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".ecdh .encrypt-button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  encryptButton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>alicesSecretKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Bob can use his copy to decrypt the message.</span>\n  <span class=\"token keyword\">let</span> decryptButton <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".ecdh .decrypt-button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  decryptButton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">decrypt</span><span class=\"token punctuation\">(</span>bobsSecretKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"pbkdf2_2","title":"PBKDF2","isH3":true,"content":"<p>\n  In this example we ask the user for a password, then use it to derive an AES key using\n  PBKDF2, then use the AES key to encrypt a message.\n  <a href=\"https://github.com/mdn/dom-examples/blob/main/web-crypto/derive-key/pbkdf2.js\" class=\"external\" rel=\" noopener\">See the complete code on GitHub.</a>\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">/*\nGet some key material to use as input to the deriveKey method.\nThe key material is a password supplied by the user.\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getKeyMaterial</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> password <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">prompt</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Enter your password\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> enc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextEncoder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> window<span class=\"token punctuation\">.</span>crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">importKey</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"raw\"</span><span class=\"token punctuation\">,</span>\n    enc<span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"PBKDF2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">\"deriveBits\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"deriveKey\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">plaintext<span class=\"token punctuation\">,</span> salt<span class=\"token punctuation\">,</span> iv</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> keyMaterial <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getKeyMaterial</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> key <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">deriveKey</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"PBKDF2\"</span><span class=\"token punctuation\">,</span>\n      salt<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">iterations</span><span class=\"token operator\">:</span> <span class=\"token number\">100000</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">hash</span><span class=\"token operator\">:</span> <span class=\"token string\">\"SHA-256\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    keyMaterial<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token string-property property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"AES-GCM\"</span><span class=\"token punctuation\">,</span> <span class=\"token string-property property\">\"length\"</span><span class=\"token operator\">:</span> <span class=\"token number\">256</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">\"encrypt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"decrypt\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> window<span class=\"token punctuation\">.</span>crypto<span class=\"token punctuation\">.</span>subtle<span class=\"token punctuation\">.</span><span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"AES-GCM\"</span><span class=\"token punctuation\">,</span> iv <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    key<span class=\"token punctuation\">,</span>\n    plaintext<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/webcrypto/#SubtleCrypto-method-deriveKey","title":"Web Cryptography API"}],"query":"api.SubtleCrypto.deriveKey"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.SubtleCrypto.deriveKey","dataURL":"/en-US/docs/Web/API/SubtleCrypto/deriveKey/bcd.json"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"https://datatracker.ietf.org/doc/html/rfc5869\" class=\"external\" rel=\" noopener\">HKDF specification</a>.</li>\n  <li><a href=\"https://csrc.nist.gov/publications/detail/sp/800-132/final\" class=\"external\" rel=\" noopener\">NIST guidelines for password-based key derivation</a>.</li>\n  <li><a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html\" class=\"external\" rel=\" noopener\">Password storage cheat sheet</a>.</li>\n  <li><a href=\"https://security.stackexchange.com/questions/3959/recommended-of-iterations-when-using-pbkdf2-sha256/3993#3993\" class=\"external\" rel=\" noopener\">Advice on choosing an iteration count for PBKDF2</a>.</li>\n</ul>"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"Supported algorithms","id":"supported_algorithms"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The deriveKey() method of the SubtleCrypto\n  interface can be used to derive a secret key from a master key.","popularity":0.001,"modified":"2022-09-13T06:27:50.000Z","other_translations":[{"title":"SubtleCrypto.deriveKey()","locale":"pt-BR","native":"Português (do Brasil)"}],"source":{"folder":"en-us/web/api/subtlecrypto/derivekey","github_url":"https://github.com/mdn/content/blob/style/old/files/en-us/web/api/subtlecrypto/derivekey/index.md","last_commit_url":"https://github.com/mdn/content/commit/16e398809d62247dbadc89ff4024a0ffa4781f0e","filename":"index.md"},"parents":[{"uri":"/en-US/docs/Web","title":"Web technology for developers"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/SubtleCrypto","title":"SubtleCrypto"},{"uri":"/en-US/docs/Web/API/SubtleCrypto/deriveKey","title":"SubtleCrypto.deriveKey()"}],"pageTitle":"SubtleCrypto.deriveKey() - Web APIs | MDN","noIndexing":false}}