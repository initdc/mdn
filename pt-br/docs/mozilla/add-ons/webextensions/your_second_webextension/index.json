{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Passo-a-Passo","mdn_url":"/pt-BR/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension","locale":"pt-BR","native":"Português (do Brasil)","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>Neste artigo iremos criar uma Extensão para Firefox do início ao fim.</p>\n<p>A extensão adicionará um novo botão na barra de ferramentas do Firefox. Quando clicar no botão se exibirá um popup habilitando a escolha de um animal. Uma vez que o usuário escolher um animal, a página atual do navegador será substituida por uma imagem do animal escolhido.</p>\n<p>Para implementar esse extensão, será necessário:</p>\n<ul>\n  <li>\n    <strong>definir a ação do navegador, que é um botão ligado a barra de ferramentas</strong>.\n    Para o botão nós iremos fornecer:\n    <ul>\n      <li>um icone chamado \"beasts.png\"</li>\n      <li>um popup para abrir quando o botão for pressionado. O popup irá ter incluso HTML, CSS e JavaScript.</li>\n    </ul>\n  </li>\n  <li>\n    <strong>escrever um content script, \"beastify.js\" que irá ser injetado na página web</strong>.\n    Este é o código que irá modificar a página.\n  </li>\n  <li>\n    <strong>empacotar alguma imagens de animais para substituir na página</strong>.\n    Nós iremos criar as imagens \"web accessible resources\" então a página poderá referenciar eles.\n  </li>\n</ul>\n<p>Você pode visualizar toda a estrutura da extensão da seguinte forma:</p>\n<p>\n  <img src=\"https://mdn.mozillademos.org/files/11467/beastify-anatomy.svg\" alt=\"\" loading=\"lazy\">\n</p>\n<p>É uma extensão extremamente simples, mas mostra muitos conceitos básicos da API de Extensões:</p>\n<ul>\n  <li>adicionando um botão na barra de ferramentas</li>\n  <li>Definindo um panel de popup usando HTML, CSS e JavaScript</li>\n  <li>Injetando content scripts nas páginas</li>\n  <li>comunicação entre content scripts e o resto das extensões</li>\n  <li>empacotando recursos com sua extensão que serão usadas nas páginas</li>\n</ul>\n<p>Você pode encontrar o código completo da extensão no <a href=\"https://github.com/mdn/webextensions-examples/tree/master/beastify\" class=\"external\" rel=\" noopener\">GitHub</a>.</p>\n<p>Para criar essa extensão você precisará do Firefox 45 ou mais recente.</p>"}},{"type":"prose","value":{"id":"escrevendo_a_webextension","title":"Escrevendo a WebExtension","isH3":false,"content":"<p>Crie um novo diretório e navegue até ele:</p>\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code><span class=\"token function\">mkdir</span> beastify\n<span class=\"token builtin class-name\">cd</span> beastify\n</code></pre></div>"}},{"type":"prose","value":{"id":"manifest.json","title":"manifest.json","isH3":true,"content":"<p>Agora crie um novo arquivo chamado \"manifest.json\", e insira o seguinte conteúdo:</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n\n  <span class=\"token property\">\"manifest_version\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Beastify\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0\"</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"applications\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"gecko\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"beastify@mozilla.org\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"permissions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"http://*/*\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"https://*/*\"</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"browser_action\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"default_icon\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"button/beasts.png\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"default_title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Beastify\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"default_popup\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"popup/choose_beast.html\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"web_accessible_resources\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"beasts/frog.jpg\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"beasts/turtle.jpg\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"beasts/snake.jpg\"</span>\n  <span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<ul>\n  <li>As primeiras três chaves : <strong><code>manifest_version</code></strong>, <strong><code>name</code></strong>, e <strong><code>version</code></strong>, são obrigatórias e contém metadados básicos para a extensão.</li>\n  <li><strong><code>permissions</code></strong> lista as permisões que a extensão precisa. Nós iremos apenas perguntar se pediremos permissão para modificar todas as páginas HTTP e HTTPS : veja a documentação para as chaves de <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\"><code>permissions</code></a>. Nós prefirimos por usar a permissão <code>activeTab</code> aqui , mas atualmente não é suportada pela Firefox.</li>\n  <li><strong><code>browser_action</code></strong> especifica o botão da barra de ferramentas. Iremos fornecer três informações aqui:\n    <ul>\n      <li><strong><code>default_icon</code></strong> é obrigatório, e aponta para o icone do botão</li>\n      <li><strong><code>default_title</code></strong> é opicional, e mostra a mensagem em um tooltip</li>\n      <li><strong><code>default_popup</code></strong> é usado se você quer que um popup seja mostrado quando o usuário clicar no botão. Nós fazemos isto, então incluímos esta chave e apontamos para um arquivo HTML incluído na extensão.</li>\n    </ul>\n  </li>\n  <li><strong><code>web_accessible_resources</code></strong> lista arquivos que queremos criar tornar acessível para as páginas. Uma vez que a extensão substitui as imagens da página com imagens que já empacotamos com a extensão , nós precisamos fazer estas imagens acessíveis à página.</li>\n</ul>\n<p>Perceba que todos os caminhos são relativos ao manifest.json.</p>"}},{"type":"prose","value":{"id":"o_botão_na_barra_de_ferramentas","title":"O Botão na barra de ferramentas","isH3":true,"content":"<p>O botão na barra de ferramentas precisa de um icone, e nosso manifest.json informa que nós teriamos um icone em \"button/beasts.png\".</p>\n<p>Crie o diretório \"button\" e copie o icone com o nome \"beasts.png\". Você poderá usar um dos nossos <a href=\"https://github.com/mdn/webextensions-examples/blob/master/beastify/button/beasts.png\" class=\"external\" rel=\" noopener\">exemplo,</a> que é retirado do <a href=\"https://www.iconfinder.com/iconsets/free-retina-icon-set\" class=\"external\" rel=\" noopener\">Aha-Soft’s Free Retina iconset</a> e usado sob os termos de sua <a href=\"http://www.iconbeast.com/faq/\" class=\"external\" rel=\" noopener\">licença</a>.</p>\n<p>Se você não fornecer um popup, então um evento de click é lançado para sua extensão quando o usuário clicar no botão. Se você fornecer um popup, o evento de click não envia, mas ao invés disso, o popup é aberto. Nós queremos abrir um popup, então vamos criá-lo na próxima etapa.</p>"}},{"type":"prose","value":{"id":"o_popup","title":"O popup","isH3":true,"content":"<p>A função do popup é ativar a escolha do usuário para um dos três animais.</p>\n<p>Crie um novo diretório chamado \"popup\" na raiz do projeto. Aqui é onde nós criar os códigos para o popup. O popup irá ser constituido em três arquivos :</p>\n<ul>\n  <li><strong><code>choose_beast.html</code></strong> Define o conteúdo do panel</li>\n  <li><strong><code>choose_beast.css</code></strong> Estilo do conteúdo</li>\n  <li><strong><code>choose_beast.js</code></strong> Captura a escolha do usuário executando um content script a aba ativa</li>\n</ul>\n<h4 id=\"choose_beast.html\">choose_beast.html</h4>\n<p>O arquivo HTML criado é este:</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>choose_beast.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>beast<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Frog<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>beast<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Turtle<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>beast<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Snake<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>choose_beast.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>Nós temos um elemento para cada escolha de animal. Perceba que nós incluimos os arquivo CSS e JS nesse arquivo, igual a uma página web.</p>\n<h4 id=\"choose_beast.css\">choose_beast.css</h4>\n<p>O CSS ajusta o tamanho do popup, garantindo que as três escolhas irão preencher o espaço, e daremos a eles algum estilo básico:</p>\n<div class=\"code-example\"><pre class=\"brush: css notranslate\"><code><span class=\"token selector\">html, body</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 100px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.beast</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 30%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 90%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 3% auto<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">padding-top</span><span class=\"token punctuation\">:</span> 6%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">text-align</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 1.5em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #E5F2F2<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">cursor</span><span class=\"token punctuation\">:</span> pointer<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.beast:hover</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #CFF2F2<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h4 id=\"choose_beast.js\">choose_beast.js</h4>\n<p>No JavaScript para o popup, nós iremos \"escutar\" o evento de click . Se o clique foi em uma das três escolhas de animais, nós iremos injetar um content script na aba ativa. Um vez que o content script é carregado , nós enviaremos uma mensagem com o animal escolhido:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"beast\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">var</span> chosenBeast <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>textContent<span class=\"token punctuation\">;</span>\n\n  chrome<span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span><span class=\"token function\">executeScript</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">file</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/content_scripts/beastify.js\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  chrome<span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">active</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">currentWindow</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tabs</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    chrome<span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span><span class=\"token function\">sendMessage</span><span class=\"token punctuation\">(</span>tabs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">beast</span><span class=\"token operator\">:</span> chosenBeast<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>É usado três funções da API WebExtension:</p>\n<ul>\n  <li><strong><code>chrome.tabs.executeScript</code></strong> Para injetar um content script que se encontra em \"content_scripts/beastify.js\" na aba ativa</li>\n  <li><strong><code>chrome.tabs.query</code></strong> Obter a aba ativa</li>\n  <li><strong><code>chrome.tabs.sendMessage</code></strong> para enviar uma mensagem para o content scripts executando na aba ativa. A mensagem irá conter as propriedades do animal escolhido.</li>\n</ul>"}},{"type":"prose","value":{"id":"o_content_script","title":"O content script","isH3":true,"content":"<p>Crie a novo diretório na pasta root do projeto chamado \"content_scripts\" e crie um novo arquivo com o nome \"beastify.js\", com o seguinte conteúdo:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Assign beastify() as a listener for messages from the extension.</span>\nchrome<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span>onMessage<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>beastify<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">beastify</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">request<span class=\"token punctuation\">,</span> sender<span class=\"token punctuation\">,</span> sendResponse</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">removeEverything</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">insertBeast</span><span class=\"token punctuation\">(</span><span class=\"token function\">beastNameToURL</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>beast<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  chrome<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span>onMessage<span class=\"token punctuation\">.</span><span class=\"token function\">removeListener</span><span class=\"token punctuation\">(</span>beastify<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">removeEverything</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>firstChild<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>firstChild<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">insertBeast</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">beastURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> beastImage <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"img\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  beastImage<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"src\"</span><span class=\"token punctuation\">,</span> beastURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  beastImage<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"style\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"width: 100vw\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  beastImage<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"style\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"height: 100vh\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>beastImage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">beastNameToURL</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">beastName</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>beastName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">\"Frog\"</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> chrome<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span><span class=\"token function\">getURL</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"beasts/frog.jpg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">\"Snake\"</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> chrome<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span><span class=\"token function\">getURL</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"beasts/snake.jpg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">\"Turtle\"</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> chrome<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span><span class=\"token function\">getURL</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"beasts/turtle.jpg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>O content script adiciona um listener da mensagem para a extensão (especificamente , para \"choose_beast.js\"). No listener:</p>\n<ul>\n  <li>remover todos os elementos em <code>document.body</code></li>\n  <li>transforma os nomes dos animais em uma URL para ser usada na imagem</li>\n  <li>Cria uma tag <code>&lt;img&gt;</code>, e insere no DOM</li>\n  <li>Remove a mensagem da listener</li>\n</ul>"}},{"type":"prose","value":{"id":"os_animais","title":"Os animais","isH3":true,"content":"<p>Finalmente, nós precisamos incluir as imagens dos animais.</p>\n<p>Crie um novo diretório chamado \"beasts\", e adicione as três imagens nos diretório, com os nomes apropriados. Você pode obter as imagens aqui no <a href=\"https://github.com/mdn/webextensions-examples/tree/master/beastify/beasts\" class=\"external\" rel=\" noopener\">GitHub</a>, ou aqui:</p>\n<p>\n  <img src=\"https://mdn.mozillademos.org/files/11459/frog.jpg\" alt=\"\" loading=\"lazy\">\n  <img src=\"https://mdn.mozillademos.org/files/11461/snake.jpg\" alt=\"\" loading=\"lazy\">\n  <img src=\"https://mdn.mozillademos.org/files/11463/turtle.jpg\" alt=\"\" loading=\"lazy\">\n</p>"}},{"type":"prose","value":{"id":"empacotando_e_instalando","title":"Empacotando e instalando","isH3":false,"content":"<p>Verifique se os seus arquivos estão estruturados de acordo com as informações abaixo:</p>\n<pre class=\"notranslate\">beastify/\n\n    beasts/\n        frog.jpg\n        snake.jpg\n        turtle.jpg\n\n    button/\n        beasts.png\n\n    content_scripts/\n        beastify.js\n\n    popup/\n        choose_beast.css\n        choose_beast.html\n        choose_beast.js\n\n    manifest.json\n</pre>\n<p>Extensões Firefox são empacotados como arquivos XPI, que são apenas arquivos ZIP com a extensão \"XPI\".</p>\n<p>Um truque é que o arquivo ZIP deve ser um dos arquivos de extensão . Portanto, para criar um XPI a partir dos arquivos beastify , navegue até o diretório \" beastify \" em um shell de comando e digite:</p>\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code>   <span class=\"token comment\"># in beastify/</span>\n   <span class=\"token function\">zip</span> -r <span class=\"token punctuation\">..</span>/beastify.xpi *\n</code></pre></div>\n<p>Ou você pode compactar com alguma ferramenta do tipo WinRar escolhe a forma de empacotação ZIP e subistituir .zip para XPI</p>\n<p>Para instalar o XPI, você apenas irá abrir o Firefox:</p>\n<ul>\n  <li>Vá até o Arquivos, seleciona Abrir arquivo, ou pressione Ctrl/Cmd+O</li>\n  <li>selecione \"beastify.xpi\" na caixa de dialógo que abriu</li>\n</ul>\n<p>Você deverá receber um aviso de que você está instalando uma extensão não assinada. Aceite o aviso de advertência.</p>\n<p>Você poderá ver o icone aparecer na barra de ferramentas. Abra uma nova página web, então click no icone, selecione um animal e veja a imagem que você escolheu na página.</p>"}}],"toc":[{"text":"Escrevendo a WebExtension","id":"escrevendo_a_webextension"},{"text":"Empacotando e instalando","id":"empacotando_e_instalando"}],"summary":"Neste artigo iremos criar uma Extensão para Firefox do início ao fim.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Your second extension","locale":"en-US","native":"English (US)"},{"title":"Tu segunda extensión","locale":"es","native":"Español"},{"title":"Votre deuxième WebExtension","locale":"fr","native":"Français"},{"title":"2 つめの拡張機能","locale":"ja","native":"日本語"},{"title":"Your second extension","locale":"ko","native":"한국어"},{"title":"Ваш второй WebExtension","locale":"ru","native":"Русский"},{"title":"你的第二个 WebExtension","locale":"zh-CN","native":"中文 (简体)"},{"title":"你的第二個 WebExtension","locale":"zh-TW","native":"正體中文 (繁體)"}],"source":{"folder":"pt-br/mozilla/add-ons/webextensions/your_second_webextension","github_url":"https://github.com/mdn/translated-content/blob/main/files/pt-br/mozilla/add-ons/webextensions/your_second_webextension/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/pt-BR/docs/Mozilla","title":"Mozilla"},{"uri":"/pt-BR/docs/Mozilla/Add-ons","title":"Complementos"},{"uri":"/pt-BR/docs/Mozilla/Add-ons/WebExtensions","title":"Extensões do navegador"},{"uri":"/pt-BR/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension","title":"Passo-a-Passo"}],"pageTitle":"Passo-a-Passo - Mozilla | MDN","noIndexing":false}}