<!DOCTYPE html><html lang="en-US" prefix="og: https://ogp.me/ns#"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon-48x48.97046865.png"><link rel="apple-touch-icon" href="/apple-touch-icon.0ea0fa02.png"><meta name="theme-color" content="#ffffff"><link rel="manifest" href="/manifest.56b1cedc.json"><link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="MDN Web Docs"><script>Array.prototype.flat&&Array.prototype.includes||document.write('<script src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.flat%2Ces6"><\/script>')</script><title>Компиляция Rust в WebAssembly - WebAssembly | MDN</title><link rel="preload" as="font" type="font/woff2" crossorigin="" href="/static/media/ZillaSlab-Bold.subset.0beac26b.woff2"><link rel="alternate" title="Компиляция Rust в WebAssembly" href="https://developer.mozilla.org/ru/docs/WebAssembly/Rust_to_wasm" hreflang="ru"><link rel="alternate" title="编译 Rust 为 WebAssembly" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly/Rust_to_wasm" hreflang="zh"><link rel="alternate" title="Rust를 WebAssembly로 컴파일하기" href="https://developer.mozilla.org/ko/docs/WebAssembly/Rust_to_wasm" hreflang="ko"><link rel="alternate" title="Rust から WebAssembly にコンパイルする" href="https://developer.mozilla.org/ja/docs/WebAssembly/Rust_to_wasm" hreflang="ja"><link rel="alternate" title="Compiling from Rust to WebAssembly" href="https://developer.mozilla.org/en-US/docs/WebAssembly/Rust_to_wasm" hreflang="en"><meta name="description" content="Если уже вы написали некоторый код на Rust, вы можете скомпилировать его в WebAssembly! Из этого руководства вы узнаете всё, что вам нужно знать, чтобы скомпилировать проект на Rust в wasm и использовать его в существующем веб-приложении."><meta property="og:url" content="https://developer.mozilla.org/ru/docs/WebAssembly/Rust_to_wasm"><meta property="og:title" content="Компиляция Rust в WebAssembly - WebAssembly | MDN"><meta property="og:description" content="Если уже вы написали некоторый код на Rust, вы можете скомпилировать его в WebAssembly! Из этого руководства вы узнаете всё, что вам нужно знать, чтобы скомпилировать проект на Rust в wasm и использовать его в существующем веб-приложении."><meta property="og:locale" content="ru"><meta property="og:image" content="https://developer.mozilla.org/mdn-social-share.0ca9dbda.png"><meta property="twitter:card" content="summary_large_image"><meta name="robots" content="index, follow"><link rel="canonical" href="https://developer.mozilla.org/ru/docs/WebAssembly/Rust_to_wasm"><style media="print">.breadcrumbs-container,.document-toc-container,.language-menu,.language-toggle,.on-github,.page-footer,.page-header-main,nav.sidebar,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style><link href="/static/css/main.55b68e13.chunk.css" rel="stylesheet"><script src="/static/js/runtime-main.4bb4c356.js" defer=""></script><script src="/static/js/4.a756dea3.chunk.js" defer=""></script><script src="/static/js/main.d4d565e0.chunk.js" defer=""></script></head><body><div id="root"><ul id="nav-access" class="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-search" href="#main-q">Skip to search</a></li><li><a id="skip-select-language" href="#select-language">Skip to select language</a></li></ul><div class="page-wrapper document-page"><header class="page-header"><a href="/ru/" class="logo" aria-label="MDN Web Docs"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451.74 135"><path d="M7.14 8.35v111.06h111.05V8.35zm103.71 56c-.48.92-1 1.79-1.46 2.71a3.44 3.44 0 01-3.54 2 2.4 2.4 0 00-1.55.5c-1.37.9-2.76 1.79-4.18 2.63a7.33 7.33 0 01-6.35.34 29.71 29.71 0 00-10.63-2 11.7 11.7 0 00-9.46 4.31 14.84 14.84 0 00-2.13 4.29c-1.24 3.07-2.3 21.38-2.3 26.05 0 0-17.62-3.42-34.15-20.34l4.31-11.32h-13.5l9.76-10.35h-16.8l9.77-10.34H12.69L30.45 34a40.9 40.9 0 0119.77-10.83c7.1-1.22 8.93-.53 13.31.77l2.43.73.85.25 3.1.95a12.56 12.56 0 006.21.09 11.37 11.37 0 018.25 1 8.24 8.24 0 014.1 6.22 7.29 7.29 0 003.61 5.49 59.45 59.45 0 009.32 4.11c2.27.86 4.54 1.84 6.79 2.72a6.81 6.81 0 012.86 2.06 4.81 4.81 0 011.1 2.73c.14 2 .37 4 .47 6a15.24 15.24 0 01-1.77 8.03zM320.12 39.62a5.42 5.42 0 00-4.53 2.13 7.36 7.36 0 00-1.7 4.43v2.36a6.28 6.28 0 001.7 4.46 5.63 5.63 0 004.3 1.82 5.12 5.12 0 004.57-2.27A9.7 9.7 0 00326 47a8.11 8.11 0 00-1.67-5.52 5.36 5.36 0 00-4.21-1.86zM387.38 39.53a5.52 5.52 0 00-4.7 2.15 8.8 8.8 0 00-1.63 5.49 9.23 9.23 0 001.58 5.45 5.38 5.38 0 004.7 2.25 5.61 5.61 0 004.74-2.2 8.91 8.91 0 001.68-5.59 8.24 8.24 0 00-1.75-5.52 5.76 5.76 0 00-4.62-2.03zM299.47 41.35a4.34 4.34 0 00-4-1.92 4.55 4.55 0 00-3.89 1.73 8.37 8.37 0 00-1.58 4.17h10.48a6.3 6.3 0 00-1.01-3.98zM357.74 30.75H352v23.31h5.72q5.47 0 8.35-3t2.93-8.65q0-5.43-2.88-8.55t-8.38-3.11z"></path><path d="M121.55 8.35v70.8h323V8.35zm42.21 22.45h-4V54h3.68v3.73h-11.25V54h3.31V36.79h-.19l-9.63 19.12h-2.12l-10-19.4h-.19V54h3.45v3.73h-11.15V54h3.68V30.8h-4v-3.73H133l11.66 22.56h.19l11.18-22.56h7.7zm29.12 22.67q-4.11 4.28-11.38 4.28h-14.06v-3.69h3.73V30.75h-3.73v-3.68h13.83q7.59 0 11.66 4.29a15.4 15.4 0 014 11 15.33 15.33 0 01-4.05 11.11zm38.89-22.67h-3.68v27h-2.6L208.08 35h-.19v19h4.67v3.73h-12.22V54h3.49V30.8h-4v-3.73h7.08l16.9 22.09h.19V30.8h-4.58v-3.73h12.32zm43.8 27h-3.31l-7.83-23.18h-.19l-7.55 23.18h-3.35l-8.78-27h-2.65v-3.73H253v3.73h-3.87L255 50.71h.23l6.61-19.91H259v-3.73h11v3.73h-2.78l6.61 20.1h.23l5.43-20.1h-4.15v-3.73h11v3.73h-2.54zm26.71-1.51a9.66 9.66 0 01-6.42 2 10.2 10.2 0 01-7.41-2.74c-1.89-1.82-2.83-4.47-2.83-7.93a12.37 12.37 0 012.64-8.12 9 9 0 017.32-3.21 8.62 8.62 0 016.75 2.69 9.65 9.65 0 012.45 6.52 13.67 13.67 0 01-.28 2.69H290q.29 6.71 6.18 6.7a5.2 5.2 0 003.71-1.18 5.82 5.82 0 001.67-2.83l3.45.71a7.21 7.21 0 01-2.73 4.65zm25.77-1.63c-1.51 2.4-3.92 3.61-7.22 3.61s-5.84-1.29-7.22-3.87c0 .25-.1.82-.21 1.7s-.19 1.44-.22 1.7H309c.16-1 .31-2 .47-3.07a21.42 21.42 0 00.24-3.16v-23h-3.4v-3.3h7.55V40.9a9.76 9.76 0 012.67-3.28 7.33 7.33 0 014.74-1.4 8.48 8.48 0 016.5 2.78q2.55 2.74 2.55 7.74a14.6 14.6 0 01-2.27 7.87zm41.39-1.14q-4.11 4.28-11.37 4.28H344v-3.74h3.73V30.75H344v-3.68h13.83q7.59 0 11.66 4.29a15.41 15.41 0 014.06 11 15.34 15.34 0 01-4.11 11.11zm25.65 1.68a10.53 10.53 0 01-7.9 3.07 10 10 0 01-7.63-3 10.93 10.93 0 01-2.8-7.83 12.13 12.13 0 012.69-7.93q2.69-3.3 8-3.3t8 3.28a12 12 0 012.64 7.76 10.86 10.86 0 01-3 7.9zm22.61.57c-1.4 1.66-3.63 2.5-6.68 2.5a9.58 9.58 0 01-7.15-2.76q-2.72-2.76-2.71-7.91a12.25 12.25 0 012.69-8 9.17 9.17 0 017.5-3.28 15 15 0 013.82.48 10.37 10.37 0 013.5 1.65l.85 5.47-3.35.38-.76-3.54a8.07 8.07 0 00-4.11-1 4.9 4.9 0 00-4.39 2.15 9.93 9.93 0 00-1.41 5.55 8.9 8.9 0 001.5 5.38 5.23 5.23 0 004.44 2c2.92 0 4.67-1.7 5.23-5.1l3.5.71a10.34 10.34 0 01-2.47 5.27zm20.48.75a11.68 11.68 0 01-6.63 1.75 15.52 15.52 0 01-8.26-2.08L424 51l3.26.33-.1 2.74a7 7 0 002.06.66 12.63 12.63 0 002.19.19 8.68 8.68 0 003.66-.75 2.5 2.5 0 001.63-2.36 2.25 2.25 0 00-1.32-2.2 12.65 12.65 0 00-3.28-1 47.39 47.39 0 01-3.9-.82 7.5 7.5 0 01-3.25-1.7 4.67 4.67 0 01-1.33-3.66c0-2.36.88-4 2.62-4.91a12 12 0 015.6-1.37 15 15 0 014.08.55 16.65 16.65 0 013.47 1.39l.47 5.1-3.3.37-.48-3.3a9.5 9.5 0 00-4.06-.9 5.62 5.62 0 00-2.87.66 2.33 2.33 0 00-1.15 2.25 2.13 2.13 0 001.3 2.07 11.91 11.91 0 003.21.92 36.69 36.69 0 013.82.83 7.46 7.46 0 013.21 1.74 4.9 4.9 0 011.3 3.73 5.56 5.56 0 01-2.66 4.91z"></path><path d="M181.17 30.75h-5.71v23.31h5.71q5.47 0 8.36-3t2.88-8.61q0-5.43-2.88-8.55t-8.36-3.15zM121.63 119.32V81.74h114.91v37.58zM153.22 109h-2v-6.85a4.8 4.8 0 00-1.58-4 5.57 5.57 0 00-3.55-1.26 5 5 0 00-4.92 3.26 4.19 4.19 0 00-1.88-2.46 5.82 5.82 0 00-3-.8 4.89 4.89 0 00-4.56 2.56v-2.21h-6.28v3.26h2v8.5h-2v3.23h9.11V109h-2.86v-5.25a4.4 4.4 0 01.69-2.56 2.47 2.47 0 012.21-1q2.57 0 2.56 3.63v8.41h6.29V109h-2v-5.25a4.47 4.47 0 01.67-2.56 2.42 2.42 0 012.19-1q2.63 0 2.63 3.63v8.41h6.28zm9.88-12.07q-4 0-6 2.36a8.41 8.41 0 00-2 5.66 7.25 7.25 0 002.17 5.62 8 8 0 005.65 2 8.54 8.54 0 005.94-2.11 7.27 7.27 0 002.34-5.67 8.21 8.21 0 00-2-5.51q-2.07-2.34-6.1-2.34zm-.1 12.35a3 3 0 01-2.63-1.33 5.68 5.68 0 01-.9-3.26 5 5 0 011-3.28 3.23 3.23 0 012.61-1.18 3.5 3.5 0 012.59 1.08 4.56 4.56 0 011.07 3.31 5.21 5.21 0 01-1 3.41 3.33 3.33 0 01-2.74 1.25zm25-2.3l-3.39-.29-.7 2.32H179l8.32-9.54-.32-2.23h-13.19l-.53 5.25 3.16.34.67-2.36h4.65l-8.25 9.53.44 2.26h13.13zm7.62-9.74h-4.46v5.39h4.46zm0 9.61h-4.46v5.39h4.46zm13.54-17.49h-4.23l-6.48 22.88h4.22zm8.68 0h-4.23l-6.45 22.88h4.19zm15 22.51l-.07-2.26a1.22 1.22 0 01-.56.1c-.69 0-1-.39-1-1.16v-6.49a4.39 4.39 0 00-1.8-3.84 7 7 0 00-4.16-1.28 14.55 14.55 0 00-3.16.3 24.14 24.14 0 00-3.29 1.06l-.56 3.46 3.39.4.5-1.69a2.78 2.78 0 011.08-.37 11.3 11.3 0 011.25-.07c1.19 0 1.89.37 2.09 1.1a8.55 8.55 0 01.3 2.26v.5a8.91 8.91 0 00-1.18-.11h-1.21a12.64 12.64 0 00-4.81.88 3.53 3.53 0 00-2.18 3.64 3.66 3.66 0 001.48 3.33 5.63 5.63 0 003.11 1 4.67 4.67 0 003-.91 6.78 6.78 0 001.8-2 3 3 0 003.33 3 5.54 5.54 0 002.66-.85zm-9.25-2.32a1.69 1.69 0 01-1.36-.52 1.81 1.81 0 01-.43-1.21 1.67 1.67 0 01.86-1.68 4.63 4.63 0 012-.42 7.69 7.69 0 011.07.07l1.06.13a3.58 3.58 0 01-1.08 2.74 3.24 3.24 0 01-2.11.89z"></path></svg></a><button type="button" class="ghost main-menu-toggle" aria-haspopup="true" aria-label="Show Menu"></button><div class="page-header-main "><nav class="main-nav" aria-label="Main menu"><ul class="main-menu nojs"><li class="top-level-entry-container"><button id="technologies-button" type="button" class="top-level-entry" aria-haspopup="menu" aria-expanded="false">Technologies</button><ul class="technologies " role="menu" aria-labelledby="technologies-button"><li role="none"><a tabindex="-1" href="/ru/docs/Web" role="menuitem">Technologies Overview</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web/HTML" role="menuitem">HTML</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web/CSS" role="menuitem">CSS</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web/JavaScript" role="menuitem">JavaScript</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web/Guide/Graphics" role="menuitem">Graphics</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web/HTTP" role="menuitem">HTTP</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web/API" role="menuitem">APIs</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Mozilla/Add-ons/WebExtensions" role="menuitem">Browser Extensions</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web/MathML" role="menuitem">MathML</a></li></ul></li><li class="top-level-entry-container"><button id="references-guides-button" type="button" class="top-level-entry" aria-haspopup="menu" aria-expanded="false">References &amp; Guides</button><ul class="references-guides " role="menu" aria-labelledby="references-guides-button"><li role="none"><a tabindex="-1" href="/ru/docs/Learn" role="menuitem">Learn web development</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web/Tutorials" role="menuitem">Tutorials</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web/Reference" role="menuitem">References</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web/Guide" role="menuitem">Developer Guides</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web/Accessibility" role="menuitem">Accessibility</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Games" role="menuitem">Game development</a></li><li role="none"><a tabindex="-1" href="/ru/docs/Web" role="menuitem">...more docs</a></li></ul></li><li class="top-level-entry-container"><button id="feedback-button" type="button" class="top-level-entry" aria-haspopup="menu" aria-expanded="false">Feedback</button><ul class="feedback " role="menu" aria-labelledby="feedback-button"><li role="none"><a tabindex="-1" href="/ru/docs/MDN/Contribute/Feedback" role="menuitem">Send Feedback</a></li><li role="none"><a tabindex="-1" href="/ru/docs/MDN/Contribute" role="menuitem">Contribute to MDN</a></li><li role="none"><a tabindex="-1" target="_blank" rel="noopener noreferrer" href="https://github.com/mdn/content/issues/new" role="menuitem">Report a content issue<!-- --> 🌐</a></li><li role="none"><a tabindex="-1" target="_blank" rel="noopener noreferrer" href="https://github.com/mdn/yari/issues/new" role="menuitem">Report a platform issue<!-- --> 🌐</a></li></ul></li></ul></nav><div class="header-search"><form action="/ru/search" class="search-form search-widget" role="search"><label for="main-q" class="visually-hidden">Search MDN</label><input type="search" name="q" id="main-q" class="search-input-field" placeholder="Site search... (Press &quot;/&quot; to focus)" pattern="(.|\s)*\S(.|\s)*" required="" value=""><input type="submit" class="ghost search-button" value="" aria-label="Search"></form></div><div class="auth-container"></div></div></header><div class="breadcrumb-locale-container"><nav class="breadcrumbs-container" aria-label="Breadcrumb navigation"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-penultimate" property="item" typeof="WebPage" href="/ru/docs/WebAssembly"><span property="name">WebAssembly</span></a><meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-current-page" property="item" typeof="WebPage" href="/ru/docs/WebAssembly/Rust_to_wasm"><span property="name">Компиляция Rust в WebAssembly</span></a><meta property="position" content="2"></li></ol></nav><ul class="language-toggle"><li><a href="#select-language" class="language-icon"><span class="show-desktop">Change language</span></a></li><li><a class="view-in-english" href="/en-US/docs/WebAssembly/Rust_to_wasm"><span class="show-desktop">View in</span> English</a></li></ul></div><div class="localized-content-note notecard inline neutral"><a href="/en-US/docs/MDN/Contribute/Localize#active_locales">Эта страница была переведена с английского языка силами сообщества. Вы тоже можете внести свой вклад, присоединившись к русскоязычному сообществу MDN Web Docs.</a></div><aside class="document-toc-container"><section class="document-toc"><header><h2>Table of contents</h2><button type="button" class="ghost toc-trigger-mobile" aria-controls="toc-entries" aria-expanded="false">Table of contents</button></header><ul id="toc-entries"><li><a href="#примеры_использования_rust_и_webassembly">Примеры использования Rust и WebAssembly</a></li><li><a href="#настройка_окружения_rust">Настройка окружения Rust</a></li><li><a href="#создание_webassembly_npm-пакета">Создание WebAssembly npm-пакета</a></li><li><a href="#использование_пакета_в_web">Использование пакета в web</a></li><li><a href="#заключение">Заключение</a></li></ul></section></aside><main id="content" class="main-content" role="main"><article class="main-page-content" lang="ru"><h1>Компиляция Rust в WebAssembly</h1><div><div id="sect1"></div>

<p class="summary">Если уже вы написали некоторый код на Rust, вы можете скомпилировать его в WebAssembly! Из этого руководства вы узнаете всё, что вам нужно знать, чтобы скомпилировать проект на Rust в wasm и использовать его в существующем веб-приложении.</p></div><h2 id="примеры_использования_rust_и_webassembly"><a href="#примеры_использования_rust_и_webassembly" title="Permalink to Примеры использования Rust и WebAssembly">Примеры использования Rust и WebAssembly</a></h2><div><p>Существует два основных варианта использования Rust и WebAssembly:</p>

<ul>
 <li>Чтобы создать целое приложение — целое веб-приложение, основанное на Rust!</li>
 <li>Чтобы построить часть приложения — используйте Rust в существующем интерфейсе JavaScript.</li>
</ul>

<p>На данный момент команда Rust фокусируется на последнем примере,  его мы рассмотрим здесь. Для первого примера, посмотрите проекты, такие как <a href="https://github.com/DenisKolodin/yew" class="external" rel=" noopener"><code>yew</code></a>.</p>

<p>В этом руководстве вы создадите npm-пакет, используя <code>wasm-pack</code>, инструмент построения npm-пакетов в Rust. Этот пакет будет содержать только код WebAssembly и JavaScript, так что его пользователям не нужен будет установщик Rust. Они могут даже не заметить, что он был написан на WebAssembly!</p></div><h2 id="настройка_окружения_rust"><a href="#настройка_окружения_rust" title="Permalink to Настройка окружения Rust">Настройка окружения Rust</a></h2><div><p>Давайте пройдёмся по всем пунктам, необходимым для настройки нашего окружения.</p></div><h3 id="установка_rust"><a href="#установка_rust" title="Permalink to Установка Rust">Установка Rust</a></h3><div><p>Чтобы установить Rust, посетите <a href="https://www.rust-lang.org/install.html" class="external" rel=" noopener">Install Rust</a> страницу и проследуйте всем инструкциям. Так вы установите тулзу, называемую "rustup", которая позволит вам управлять несколькими версиями Rust. По умолчанию, она устанавливает последний стабильный релиз Rust, который вы будете использовать для стандартной разработки на Rust. Rustup устанавливает <code>rustc</code>, компилятор Rust, вместе с <code>cargo</code>, Rust-овским пакетным менеджером, <code>rust-std</code>, стандартной  библиотекой Rust, и несколькими вспомогательными доками — <code>rust-docs</code>.</p>

<div class="note notecard" id="sect2">
<p><strong>Примечание</strong>: Обратите внимание на пост-установочную заметку о необходимости добавить cargo <code>bin</code> директорию в список <code>PATH</code>. Она должна быть добавлена автоматически, но вам нужно будет перезапустить терминал, чтобы изменения вступили в силу.</p>
</div></div><h3 id="wasm-pack"><a href="#wasm-pack" title="Permalink to wasm-pack">wasm-pack</a></h3><div><p>Чтобы собрать наш пакет, вам понадобится дополнительный инструмент, <code>wasm-pack</code>. Он поможет нам скомпилировать наш код в WebAssembly и создаст правильный контейнер для нашего пакета для <code>npm</code>. Чтобы скачать и установить, введите в терминале следующую команду:</p>

<div class="code-example"><pre class="brush: bash notranslate"><code>$ cargo <span class="token function">install</span> wasm-pack
</code></pre></div></div><h3 id="установка_node.js_и_получение_npm-аккаунта"><a href="#установка_node.js_и_получение_npm-аккаунта" title="Permalink to Установка Node.js и получение npm-аккаунта">Установка Node.js и получение npm-аккаунта</a></h3><div><p>В этом руководстве мы будем собирать npm-пакет, поэтому вам понадобится установить Node.js и npm. Дополнительно, мы опубликуем наш пакет на npm, так что вам так же понадобится ваш npm-аккаунт. Они бесплатны! <em>Технически</em>, вы не обязаны ничего публиковать, но так будет проще, так что будем считать, что вы сделаете это в этом руководстве.</p>

<p>Чтобы получить Node.js и npm, посетите <a href="https://www.npmjs.com/get-npm" class="external" rel=" noopener">Get npm!</a> страницу и проследуйте инструкциям. Когда настанет время выбрать версию, выберите любую, которая вам нравится; это руководство не зависит от версии.</p>

<p>Чтобы создать npm-аккаунт, посетите <a href="https://www.npmjs.com/signup" class="external" rel=" noopener">npm signup</a> станицу и заполните форму.</p>

<p>Дальше запустите в командой строке <code>npm adduser</code>:</p>

<div class="code-example"><pre class="brush: bash notranslate"><code><span class="token operator">&gt;</span> <span class="token function">npm</span> adduser
Username: yournpmusername
Password:
Email: <span class="token punctuation">(</span>this IS public<span class="token punctuation">)</span> you@example.com
</code></pre></div>

<p>Вам понадобится ввести своё пользовательское имя, пароль и email. Если все получится, вы увидите:</p>

<div class="code-example"><pre class="brush: bash notranslate"><code>Logged <span class="token keyword">in</span> as yournpmusername on https://registry.npmjs.org/.
</code></pre></div>

<p>Если что-то пойдёт не так, свяжитесь с командой npm, чтобы разобраться.</p></div><h2 id="создание_webassembly_npm-пакета"><a href="#создание_webassembly_npm-пакета" title="Permalink to Создание WebAssembly npm-пакета">Создание WebAssembly npm-пакета</a></h2><div><p>Хватит установок, давайте создадим новый пакет на Rust. Перейдите в любое место, где вы держите свои личные проекты, и сделайте следующее:</p>

<div class="code-example"><pre class="brush: bash notranslate"><code>$ cargo new --lib hello-wasm
     Создаст проектную библиотеку <span class="token variable"><span class="token variable">`</span>hello-wasm<span class="token variable">`</span></span>
</code></pre></div>

<p>Это создаст новую библиотеку в под-директории, называемой <code>hello-wasm</code>, со всем, что вам нужно:</p>

<pre class="notranslate">+-- Cargo.toml
+-- src
    +-- lib.rs
</pre>

<p>Для начала, у нас есть <code>Cargo.toml</code>; с его помощью мы можем сконфигурировать наш билд. Если вы пользуетесь <code>Gemfile</code> из Bundler или <code>package.json</code> из npm, то вы почувствуете себя, как дома; Cargo работает аналогично обоим.</p>

<p>Дальше, Cargo сгенерировал кое-какой код для нас на Rust в <code>src/lib.rs</code>:</p>

<pre class="notranslate">#[cfg(test)]
mod tests {
    #[test]
    fn it_works() {
        assert_eq!(2 + 2, 4);
    }
}
</pre>

<p>Мы не будем использовать этот тестовый код вообще, так что можете просто удалить его.</p></div><h3 id="давайте_попишем_немного_на_rust!"><a href="#давайте_попишем_немного_на_rust!" title="Permalink to Давайте попишем немного на Rust!">Давайте попишем немного на Rust!</a></h3><div><p>Вместо этого поместите этот код в <code>src/lib.rs</code>:</p>

<pre class="notranslate">extern crate wasm_bindgen;

use wasm_bindgen::prelude::*;

#[wasm_bindgen]
extern {
    pub fn alert(s: &amp;str);
}

#[wasm_bindgen]
pub fn greet(name: &amp;str) {
    alert(&amp;format!("Hello, {}!", name));
}
</pre>

<p>Это содержимое нашего проекта на Rust. У него есть три основные части, давайте пройдёмся по ним по очереди. Мы дадим здесь обобщённое пояснение и поясним некоторые детали; чтобы узнать больше о Rust, пожалуйста, просмотрите бесплатную online-книгу <a href="https://doc.rust-lang.org/book/" class="external" rel=" noopener">The Rust Programming Language</a>.</p>

<h4 id="использование_wasm-bindgen_для_коммуникации_между_rust_и_javascript">Использование <code>wasm-bindgen</code> для коммуникации между Rust и JavaScript</h4>

<p>Первая часть выглядит вот так:</p>

<pre class="notranslate">extern crate wasm_bindgen;

use wasm_bindgen::prelude::*;
</pre>

<p>Первая строка гласит: "эй, Rust, мы используем библиотеку, называемую wasm_bindgen." Библиотеки в Rust называются "<code>crates</code>" (контейнеры), а так как мы используем внешнюю, то "<code>extern</code>".</p>

<p>Поняли? <strong>Cargo поставляет контейнеры</strong>.</p>

<p>Третья строка содержит команду <code>use</code>, которая импортирует код из библиотеки в наш код. В нашем случае, мы импортируем все из модуля <code>wasm_bindgen::prelude</code>. Мы будем использовать его функции в следующей секции.</p>

<p>Прежде чем перейти к следующей секции, давайте поговорим немного о <code>wasm-bindgen</code>.</p>

<p><code>wasm-pack</code> использует <code>wasm-bindgen</code>, другую тулзу, чтобы предоставить соединение между типами в JavaScript и Rust. Это позволяет JavaScript вызывать Rust-API со строками или функциям Rust перехватывать исключения JavaScript.</p>

<p>Мы будем использовать функциональность <code>wasm-bindgen</code> в нашем пакете. По факту, это следующая секция!</p>

<h4 id="вызов_внешних_функций_javascript_из_rust">Вызов внешних функций JavaScript из Rust</h4>

<p>Следующая часть выглядит так:</p>

<pre class="notranslate">#[wasm_bindgen]
extern {
    pub fn alert(s: &amp;str);
}
</pre>

<p>Частичка внутри <code>#[]</code> называется "атрибутом", и она кое-как модифицирует следующее за ней утверждение. В нашем случае, это утверждение <code>extern</code>, которое говорит Rust-у, что мы хотим вызвать некоторую функцию, определённую во внешнем пространстве. Атрибут говорит: "wasm-bindgen знает, как найти эти функции".</p>

<p>Третья строка это имя функции, написанной на Rust. Она говорит: "функция <code>alert</code>  принимает один аргумент, строку с именем <code>s</code>."</p>

<p>У вас, возможно, есть предположение, что это за функция, и, возможно, ваше предположение верное: это функция<a href="/en-US/docs/Web/API/Window/alert"> <code>alert</code>, предоставляемая JavaScript</a>! Мы будем вызывать эту функцию в следующей секции.</p>

<p>Когда бы вы не захотели вызвать новую функцию JavaScript, вы можете написать её здесь, и <code>wasm-bindgen</code> позаботится о том, чтобы настроить все для вас. Пока ещё поддерживается не все, но мы работаем над этим! Пожалуйста, <a href="https://github.com/rustwasm/wasm-bindgen/issues/new" class="external" rel=" noopener">сообщайте о проблемах</a>, если что-то было упущено.</p>

<h4 id="создание_функций_rust_который_может_вызывать_javascript">Создание функций Rust, который может вызывать JavaScript</h4>

<p>Финальная часть следующая:</p>

<pre class="notranslate">#[wasm_bindgen]
pub fn greet(name: &amp;str) {
    alert(&amp;format!("Hello, {}!", name));
}
</pre>

<p>Ещё раз, мы видим <code>#[wasm_bindgen]</code> атрибут. В этом случае, он модифицирует не блок <code>extern</code>, а <code>fn</code>; это значит, что мы хотим, чтобы эта функция на Rust была доступна для JavaScript. Прямо противоположно <code>extern</code>: это не те функции, которые нам нужны, а те, что мы предоставляем миру!</p>

<p>Наша функция называется <code>greet</code>, и она принимает один аргумент, строку (пишется <code>&amp;str</code>), <code>name</code>. Затем она вызывает функцию <code>alert</code>, которую мы запросили в блоке <code>extern</code> выше. Она передаёт вызов макросу <code>format!</code>, который позволяет нам соединить строки.</p>

<p><code>format!</code> принимает два аргумента в нашем случае: форматируемую строку и переменную, которую должен в неё поместить. Форматируемая строка это <code>"Hello, {}!"</code> часть. Она содержит <code>{}</code>, куда будет вставлена переменная. Переменная, которую мы передаём, это <code>name</code>, аргумент функции, так что если мы вызовем <code>greet("Steve")</code>, то увидим <code>"Hello, Steve!".</code></p>

<p>Все это передаётся в <code>alert()</code>, так что когда мы вызовем функцию, мы увидим алерт с "Hello, Steve!" внутри него!</p>

<p>Теперь, когда наша библиотека написана, давайте соберём её.</p></div><h3 id="компиляция_кода_в_webassembly"><a href="#компиляция_кода_в_webassembly" title="Permalink to Компиляция кода в WebAssembly">Компиляция кода в WebAssembly</a></h3><div><p>Чтобы правильно скомпилить наш код, сначала нам надо сконфигурировать его с помощью <code>Cargo.toml</code>. Откройте этот файл и измените его так, чтобы он выглядел следующим образом:</p>

<pre class="notranslate"><code class="toml language-toml">[package]
name = "hello-wasm"
version = "0.1.0"
authors = ["Your Name &lt;you@example.com&gt;"]
description = "A sample project with wasm-pack"
license = "MIT/Apache-2.0"
repository = "https://github.com/yourgithubusername/hello-wasm"

[lib]
crate-type = ["cdylib"]

[dependencies]
wasm-bindgen = "0.2"
</code></pre>

<p>Вам нужно будет ввести свой личный репозиторий, а Cargo заполнит <code>authors</code>, основываясь на информации <code>git</code>.</p>

<p>Главная часть находится внизу. Первая — <code>[lib]</code> — говорит Rust собрать <code>cdylib</code> версию нашего пакета; мы не будем вдаваться в то, что это значит в этом руководстве. Чтобы узнать больше, просмотрите <a href="https://doc.rust-lang.org/cargo/guide/" class="external" rel=" noopener">Cargo</a> и <a href="https://doc.rust-lang.org/reference/linkage.html" class="external" rel=" noopener">Rust Linkage</a> документацию.</p>

<p>Вторая часть это секция <code>[dependencies]</code> . Тут мы говорим Cargo, от какой версии <code>wasm-bindgen</code> мы хотим зависеть; в нашем случае, это любая версия <code>0.2.z</code> (но не <code>0.3.0</code> или выше).</p></div><h3 id="сборка_пакета"><a href="#сборка_пакета" title="Permalink to Сборка пакета">Сборка пакета</a></h3><div><p>Теперь, когда мы все установили, давайте соберём проект! Введите это в терминале:</p>

<div class="code-example"><pre class="brush: bash notranslate"><code>$ wasm-pack build --scope mynpmusername
</code></pre></div>

<p>Здесь мы сделали несколько вещей (и они займут много времени, особенно если вы запустили <code>wasm-pack</code> впервые). Чтобы изучить их детальней, прочитайте <a href="https://hacks.mozilla.org/2018/04/hello-wasm-pack/" class="external" rel=" noopener">этот блог-пост на Mozilla Hacks</a>. Вкратце, <code>wasm-pack build</code>:</p>

<ol>
 <li>Компилирует ваш Rust-код в WebAssembly.</li>
 <li><code>Запускает wasm-bindgen</code> с этим WebAssembly, генерируя JavaScript файл, который оборачивает WebAssembly файл в модуль. который может понять npm.</li>
 <li>Создаёт папку <code>pkg</code>, куда перемещает этот JavaScript файл и ваш код WebAssembly.</li>
 <li>Читает ваш <code>Cargo.toml</code> и создаёт эквивалентный <code>package.json</code>.</li>
 <li>Копирует ваш <code>README.md</code> (если есть) в пакет.</li>
</ol>

<p>Конечный результат? У вас есть npm-пакет внутри папки <code>pkg</code>.</p>

<h4 id="отступление_о_размере_кода">Отступление о размере кода</h4>

<p>Если вы посмотрите на размер кода, сгенерированного для WebAssembly, это может быть около сотни килобайт. Мы вообще не инструктировали Rust оптимизировать размер, и он <em>сильно</em> его снизил. Это не является частью этого руководства, но если вам интересно, прочитайте документацию Rust WebAssembly Working Group на <a href="https://rustwasm.github.io/book/game-of-life/code-size.html#shrinking-wasm-size" class="external" rel=" noopener">Shrinking .wasm Size</a>.</p></div><h3 id="публикация_нашего_пакета_на_npm"><a href="#публикация_нашего_пакета_на_npm" title="Permalink to Публикация нашего пакета на npm">Публикация нашего пакета на npm</a></h3><div><p>Давайте опубликуем наш новый пакет на npm:</p>

<div class="code-example"><pre class="brush: bash notranslate"><code>$ <span class="token builtin class-name">cd</span> pkg
$ <span class="token function">npm</span> publish --access<span class="token operator">=</span>public
</code></pre></div>

<p>Теперь у нас есть npm-пакет, написанный на Rust, но скомпилированный в WebAssembly. Он готов к использованию из JavaScript, и его пользователь не нуждается в установке Rust; код внутри пакета написан на WebAssembly, не на Rust!</p></div><h2 id="использование_пакета_в_web"><a href="#использование_пакета_в_web" title="Permalink to Использование пакета в web">Использование пакета в web</a></h2><div><p>Давайте создадим сайт, который будет использовать наш пакет! Многие пользуются пакетами npm с помощью разных сборщиков, и мы будем использовать один из них, <code>webpack</code>, в этом руководстве. Он только немного более усложнённый, но описывает более реалистичный вариант использования.</p>

<p>Давайте выйдем из нашей папки <code>pkg</code> и создадим новую, <code>site</code>, чтобы попробовать в ней следующее:</p>

<div class="code-example"><pre class="brush: bash notranslate"><code>$ <span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>
$ <span class="token function">mkdir</span> site
$ <span class="token builtin class-name">cd</span> site
</code></pre></div>

<p>Создайте новый файл, <code>package.json</code>, и поместите в него следующий код:</p>

<div class="code-example"><pre class="brush: json notranslate"><code><span class="token punctuation">{</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"serve"</span><span class="token operator">:</span> <span class="token string">"webpack-dev-server"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"@mynpmusername/hello-wasm"</span><span class="token operator">:</span> <span class="token string">"^0.1.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"webpack"</span><span class="token operator">:</span> <span class="token string">"^4.25.1"</span><span class="token punctuation">,</span>
    <span class="token property">"webpack-cli"</span><span class="token operator">:</span> <span class="token string">"^3.1.2"</span><span class="token punctuation">,</span>
    <span class="token property">"webpack-dev-server"</span><span class="token operator">:</span> <span class="token string">"^3.1.10"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>

<p>Заметьте, что вам нужно ввести своё пользовательское имя после <code>@</code> в секции зависимостей.</p>

<p>Дальше нам нужно сконфигурировать Webpack. Создайте <code>webpack.config.js</code> и введите следующее:</p>

<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">"./index.js"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">"index.js"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">"development"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>

<p>Теперь нам нужен HTML-файл; создайте <code>index.html</code> и поместите в него:</p>

<pre class="notranslate"><code class="html language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;hello-wasm example&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;script src="./index.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Наконец, создайте <code>index.js</code>, на который мы сослались в HTML-файле, и вставьте:</p>

<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> js <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"./node_modules/@yournpmusername/hello-wasm/hello_wasm.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
js<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">js</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  js<span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token string">"WebAssembly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>

<p>Заметьте, что вам нужно будет снова ввести ваше имя для npm.</p>

<p>Так мы импортируем наш модуль из папки <code>node_modules</code>. Это не считается лучшей практикой, но это пример, так что пока сойдёт. Как только файл загрузится, он вызовет функцию <code>greet</code> из этого модуля, передав <code>"WebAssembly"</code>, как строку. Обратите внимание, что здесь нет ничего особенного, и всё же мы вызываем код на Rust! Насколько JavaScript-код может судить, это просто обычный модуль.</p>

<p>Мы закончили! Давайте попробуем:</p>

<div class="code-example"><pre class="brush: bash notranslate"><code>$ <span class="token function">npm</span> <span class="token function">install</span>
$ <span class="token function">npm</span> run serve
</code></pre></div>

<p>Так мы запустим сервер. Откройте <a href="http://localhost:8080" class="external" rel=" noopener">http://localhost:8080</a> и вы увидите алерт с надписью <code>Hello, WebAssembly!</code>  в нем! Мы успешно обратились из JavaScript в Rust и из Rust в JavaScript.</p></div><h2 id="заключение"><a href="#заключение" title="Permalink to Заключение">Заключение</a></h2><div><p>На этом руководство заканчивается, мы надеемся, что вы сочли его для себя полезным.</p>

<p>В этом направлении кипит бурная и при этом очень интересная деятельность, так что если вы бы хотели помочь что-то улучшить, то загляните в <a href="https://fitzgeraldnick.com/2018/02/27/wasm-domain-working-group.html" class="external" rel=" noopener">the Rust Webassembly Working Group</a>.</p></div></article><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h3>Found a problem with this page?</h3><ul><li><a href="https://github.com/mdn/translated-content/edit/main/files/ru/webassembly/rust_to_wasm/index.html" title="You're going to need to sign in to GitHub first (Opens in a new tab)" target="_blank" rel="noopener noreferrer">Edit on <b>GitHub</b></a></li><li><a href="https://github.com/mdn/translated-content/blob/main/files/ru/webassembly/rust_to_wasm/index.html" title="Folder: ru/webassembly/rust_to_wasm (Opens in a new tab)" target="_blank" rel="noopener noreferrer">Source on <b>GitHub</b></a></li><li><a href="https://github.com/mdn/translated-content/issues/new?body=MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fru%2Fdocs%2FWebAssembly%2FRust_to_wasm%0A%0A%23%23%23%23+What+information+was+incorrect%2C+unhelpful%2C+or+incomplete%3F%0A%0A%0A%23%23%23%23+Specific+section+or+headline%3F%0A%0A%0A%23%23%23%23+What+did+you+expect+to+see%3F%0A%0A%0A%23%23%23%23+Did+you+test+this%3F+If+so%2C+how%3F%0A%0A%0A%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EMDN+Content+page+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60ru%2Fwebassembly%2Frust_to_wasm%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fru%2Fdocs%2FWebAssembly%2FRust_to_wasm%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Ftranslated-content%2Fblob%2Fmain%2Ffiles%2Fru%2Fwebassembly%2Frust_to_wasm%2Findex.html%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Ftranslated-content%2Fcommit%2F921c46a374ab0a9f4cc809af0370f8c412e54701%0A*+Document+last+modified%3A+2022-10-01T03%3A41%3A16.000Z%0A%0A%3C%2Fdetails%3E&amp;title=Issue+with+%22%D0%9A%D0%BE%D0%BC%D0%BF%D0%B8%D0%BB%D1%8F%D1%86%D0%B8%D1%8F+Rust+%D0%B2+WebAssembly%22%3A+%28short+summary+here+please%29&amp;labels=needs-triage%2Cl10n-ru" title="This will take you to https://github.com/mdn/content to file a new issue" target="_blank" rel="noopener noreferrer">Report a problem with this content on <b>GitHub</b></a></li><li>Want to fix the problem yourself? See<!-- --> <a href="https://github.com/mdn/content/blob/main/README.md" target="_blank" rel="noopener noreferrer">our Contribution guide</a>.</li></ul></div><p class="last-modified-date"><b>Last modified:</b> <time datetime="2022-10-01T03:41:16.000Z">Oct 1, 2022</time>,<!-- --> <a href="/ru/docs/WebAssembly/Rust_to_wasm/contributors.txt">by MDN contributors</a></p><form class="language-menu"><fieldset id="select-language"><legend>Change your language</legend><label for="language-selector" class="visually-hidden">Select your preferred language</label> <select id="language-selector" name="language"><option selected="" value="ru">Русский</option><option value="en-US">English (US)</option><option value="ja">日本語</option><option value="ko">한국어</option><option value="zh-CN">中文 (简体)</option></select> <button type="submit" class="button minimal">Change language</button></fieldset></form></div></aside></main><nav id="sidebar-quicklinks" class="sidebar"><h4>Related Topics</h4><div>

<ol>
  <li data-default-state="open"><a href="/ru/docs/WebAssembly"><strong>WebAssembly home page</strong></a>
  </li><li class="toggle">
    <details open="">
      <summary>Tutorials</summary>
      <ol>
        <li><a href="/ru/docs/WebAssembly/Concepts">WebAssembly concepts</a></li>
        <li><a href="/ru/docs/WebAssembly/C_to_wasm">Compiling from C/C++ to WebAssembly</a></li>
        <li><a href="/ru/docs/WebAssembly/Rust_to_wasm">Compiling from Rust to WebAssembly</a></li>
        <li><a href="/ru/docs/WebAssembly/Using_the_JavaScript_API">Using the WebAssembly JavaScript API</a></li>
        <li><a href="/ru/docs/WebAssembly/Understanding_the_text_format">Understanding WebAssembly text format</a></li>
        <li><a href="/ru/docs/WebAssembly/Text_format_to_wasm">Converting WebAssembly text format to wasm</a></li>
        <li><a href="/ru/docs/WebAssembly/Loading_and_running">Loading and running WebAssembly code</a></li>
        <li><a href="/ru/docs/WebAssembly/Caching_modules">Caching compiled WebAssembly modules</a></li>
        <li><a href="/ru/docs/WebAssembly/Exported_functions">Exported WebAssembly functions</a></li>
      </ol>
    </details>
  </li>
  <li class="toggle">
    <details open="">
      <summary>Object reference</summary>
      <ol>
        <li><a href="/ru/docs/WebAssembly/JavaScript_interface"><code>WebAssembly</code></a></li>
        <li><a class="only-in-en-us" title="Currently only available in English (US)" href="/en-US/docs/WebAssembly/JavaScript_interface/Module"><code>WebAssembly.Module</code> <small>(en-US)</small></a></li>
        <li><a class="only-in-en-us" title="Currently only available in English (US)" href="/en-US/docs/WebAssembly/JavaScript_interface/Global"><code>WebAssembly.Global</code> <small>(en-US)</small></a></li>
        <li><a class="only-in-en-us" title="Currently only available in English (US)" href="/en-US/docs/WebAssembly/JavaScript_interface/Instance"><code>WebAssembly.Instance</code> <small>(en-US)</small></a></li>
        <li><a class="only-in-en-us" title="Currently only available in English (US)" href="/en-US/docs/WebAssembly/JavaScript_interface/Memory"><code>WebAssembly.Memory</code> <small>(en-US)</small></a></li>
        <li><a href="/ru/docs/WebAssembly/JavaScript_interface/Table"><code>WebAssembly.Table</code></a></li>
        <li><a class="only-in-en-us" title="Currently only available in English (US)" href="/en-US/docs/WebAssembly/JavaScript_interface/CompileError"><code>WebAssembly.CompileError</code> <small>(en-US)</small></a></li>
        <li><a class="only-in-en-us" title="Currently only available in English (US)" href="/en-US/docs/WebAssembly/JavaScript_interface/LinkError"><code>WebAssembly.LinkError</code> <small>(en-US)</small></a></li>
        <li><a class="only-in-en-us" title="Currently only available in English (US)" href="/en-US/docs/WebAssembly/JavaScript_interface/RuntimeError"><code>WebAssembly.RuntimeError</code> <small>(en-US)</small></a></li>
      </ol>
    </details>
  </li>
</ol>

</div></nav></div><footer id="nav-footer" class="page-footer"><div class="content-container"><div class="page-footer-logo"><a href="/ru/" class="logo" aria-label="MDN Web Docs"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451.74 135" fill="#fff"><path d="M7.14 8.35v111.06h111.05V8.35zm103.71 56c-.48.92-1 1.79-1.46 2.71a3.44 3.44 0 01-3.54 2 2.4 2.4 0 00-1.55.5c-1.37.9-2.76 1.79-4.18 2.63a7.33 7.33 0 01-6.35.34 29.71 29.71 0 00-10.63-2 11.7 11.7 0 00-9.46 4.31 14.84 14.84 0 00-2.13 4.29c-1.24 3.07-2.3 21.38-2.3 26.05 0 0-17.62-3.42-34.15-20.34l4.31-11.32h-13.5l9.76-10.35h-16.8l9.77-10.34H12.69L30.45 34a40.9 40.9 0 0119.77-10.83c7.1-1.22 8.93-.53 13.31.77l2.43.73.85.25 3.1.95a12.56 12.56 0 006.21.09 11.37 11.37 0 018.25 1 8.24 8.24 0 014.1 6.22 7.29 7.29 0 003.61 5.49 59.45 59.45 0 009.32 4.11c2.27.86 4.54 1.84 6.79 2.72a6.81 6.81 0 012.86 2.06 4.81 4.81 0 011.1 2.73c.14 2 .37 4 .47 6a15.24 15.24 0 01-1.77 8.03zM320.12 39.62a5.42 5.42 0 00-4.53 2.13 7.36 7.36 0 00-1.7 4.43v2.36a6.28 6.28 0 001.7 4.46 5.63 5.63 0 004.3 1.82 5.12 5.12 0 004.57-2.27A9.7 9.7 0 00326 47a8.11 8.11 0 00-1.67-5.52 5.36 5.36 0 00-4.21-1.86zM387.38 39.53a5.52 5.52 0 00-4.7 2.15 8.8 8.8 0 00-1.63 5.49 9.23 9.23 0 001.58 5.45 5.38 5.38 0 004.7 2.25 5.61 5.61 0 004.74-2.2 8.91 8.91 0 001.68-5.59 8.24 8.24 0 00-1.75-5.52 5.76 5.76 0 00-4.62-2.03zM299.47 41.35a4.34 4.34 0 00-4-1.92 4.55 4.55 0 00-3.89 1.73 8.37 8.37 0 00-1.58 4.17h10.48a6.3 6.3 0 00-1.01-3.98zM357.74 30.75H352v23.31h5.72q5.47 0 8.35-3t2.93-8.65q0-5.43-2.88-8.55t-8.38-3.11z"></path><path d="M121.55 8.35v70.8h323V8.35zm42.21 22.45h-4V54h3.68v3.73h-11.25V54h3.31V36.79h-.19l-9.63 19.12h-2.12l-10-19.4h-.19V54h3.45v3.73h-11.15V54h3.68V30.8h-4v-3.73H133l11.66 22.56h.19l11.18-22.56h7.7zm29.12 22.67q-4.11 4.28-11.38 4.28h-14.06v-3.69h3.73V30.75h-3.73v-3.68h13.83q7.59 0 11.66 4.29a15.4 15.4 0 014 11 15.33 15.33 0 01-4.05 11.11zm38.89-22.67h-3.68v27h-2.6L208.08 35h-.19v19h4.67v3.73h-12.22V54h3.49V30.8h-4v-3.73h7.08l16.9 22.09h.19V30.8h-4.58v-3.73h12.32zm43.8 27h-3.31l-7.83-23.18h-.19l-7.55 23.18h-3.35l-8.78-27h-2.65v-3.73H253v3.73h-3.87L255 50.71h.23l6.61-19.91H259v-3.73h11v3.73h-2.78l6.61 20.1h.23l5.43-20.1h-4.15v-3.73h11v3.73h-2.54zm26.71-1.51a9.66 9.66 0 01-6.42 2 10.2 10.2 0 01-7.41-2.74c-1.89-1.82-2.83-4.47-2.83-7.93a12.37 12.37 0 012.64-8.12 9 9 0 017.32-3.21 8.62 8.62 0 016.75 2.69 9.65 9.65 0 012.45 6.52 13.67 13.67 0 01-.28 2.69H290q.29 6.71 6.18 6.7a5.2 5.2 0 003.71-1.18 5.82 5.82 0 001.67-2.83l3.45.71a7.21 7.21 0 01-2.73 4.65zm25.77-1.63c-1.51 2.4-3.92 3.61-7.22 3.61s-5.84-1.29-7.22-3.87c0 .25-.1.82-.21 1.7s-.19 1.44-.22 1.7H309c.16-1 .31-2 .47-3.07a21.42 21.42 0 00.24-3.16v-23h-3.4v-3.3h7.55V40.9a9.76 9.76 0 012.67-3.28 7.33 7.33 0 014.74-1.4 8.48 8.48 0 016.5 2.78q2.55 2.74 2.55 7.74a14.6 14.6 0 01-2.27 7.87zm41.39-1.14q-4.11 4.28-11.37 4.28H344v-3.74h3.73V30.75H344v-3.68h13.83q7.59 0 11.66 4.29a15.41 15.41 0 014.06 11 15.34 15.34 0 01-4.11 11.11zm25.65 1.68a10.53 10.53 0 01-7.9 3.07 10 10 0 01-7.63-3 10.93 10.93 0 01-2.8-7.83 12.13 12.13 0 012.69-7.93q2.69-3.3 8-3.3t8 3.28a12 12 0 012.64 7.76 10.86 10.86 0 01-3 7.9zm22.61.57c-1.4 1.66-3.63 2.5-6.68 2.5a9.58 9.58 0 01-7.15-2.76q-2.72-2.76-2.71-7.91a12.25 12.25 0 012.69-8 9.17 9.17 0 017.5-3.28 15 15 0 013.82.48 10.37 10.37 0 013.5 1.65l.85 5.47-3.35.38-.76-3.54a8.07 8.07 0 00-4.11-1 4.9 4.9 0 00-4.39 2.15 9.93 9.93 0 00-1.41 5.55 8.9 8.9 0 001.5 5.38 5.23 5.23 0 004.44 2c2.92 0 4.67-1.7 5.23-5.1l3.5.71a10.34 10.34 0 01-2.47 5.27zm20.48.75a11.68 11.68 0 01-6.63 1.75 15.52 15.52 0 01-8.26-2.08L424 51l3.26.33-.1 2.74a7 7 0 002.06.66 12.63 12.63 0 002.19.19 8.68 8.68 0 003.66-.75 2.5 2.5 0 001.63-2.36 2.25 2.25 0 00-1.32-2.2 12.65 12.65 0 00-3.28-1 47.39 47.39 0 01-3.9-.82 7.5 7.5 0 01-3.25-1.7 4.67 4.67 0 01-1.33-3.66c0-2.36.88-4 2.62-4.91a12 12 0 015.6-1.37 15 15 0 014.08.55 16.65 16.65 0 013.47 1.39l.47 5.1-3.3.37-.48-3.3a9.5 9.5 0 00-4.06-.9 5.62 5.62 0 00-2.87.66 2.33 2.33 0 00-1.15 2.25 2.13 2.13 0 001.3 2.07 11.91 11.91 0 003.21.92 36.69 36.69 0 013.82.83 7.46 7.46 0 013.21 1.74 4.9 4.9 0 011.3 3.73 5.56 5.56 0 01-2.66 4.91z"></path><path d="M181.17 30.75h-5.71v23.31h5.71q5.47 0 8.36-3t2.88-8.61q0-5.43-2.88-8.55t-8.36-3.15zM121.63 119.32V81.74h114.91v37.58zM153.22 109h-2v-6.85a4.8 4.8 0 00-1.58-4 5.57 5.57 0 00-3.55-1.26 5 5 0 00-4.92 3.26 4.19 4.19 0 00-1.88-2.46 5.82 5.82 0 00-3-.8 4.89 4.89 0 00-4.56 2.56v-2.21h-6.28v3.26h2v8.5h-2v3.23h9.11V109h-2.86v-5.25a4.4 4.4 0 01.69-2.56 2.47 2.47 0 012.21-1q2.57 0 2.56 3.63v8.41h6.29V109h-2v-5.25a4.47 4.47 0 01.67-2.56 2.42 2.42 0 012.19-1q2.63 0 2.63 3.63v8.41h6.28zm9.88-12.07q-4 0-6 2.36a8.41 8.41 0 00-2 5.66 7.25 7.25 0 002.17 5.62 8 8 0 005.65 2 8.54 8.54 0 005.94-2.11 7.27 7.27 0 002.34-5.67 8.21 8.21 0 00-2-5.51q-2.07-2.34-6.1-2.34zm-.1 12.35a3 3 0 01-2.63-1.33 5.68 5.68 0 01-.9-3.26 5 5 0 011-3.28 3.23 3.23 0 012.61-1.18 3.5 3.5 0 012.59 1.08 4.56 4.56 0 011.07 3.31 5.21 5.21 0 01-1 3.41 3.33 3.33 0 01-2.74 1.25zm25-2.3l-3.39-.29-.7 2.32H179l8.32-9.54-.32-2.23h-13.19l-.53 5.25 3.16.34.67-2.36h4.65l-8.25 9.53.44 2.26h13.13zm7.62-9.74h-4.46v5.39h4.46zm0 9.61h-4.46v5.39h4.46zm13.54-17.49h-4.23l-6.48 22.88h4.22zm8.68 0h-4.23l-6.45 22.88h4.19zm15 22.51l-.07-2.26a1.22 1.22 0 01-.56.1c-.69 0-1-.39-1-1.16v-6.49a4.39 4.39 0 00-1.8-3.84 7 7 0 00-4.16-1.28 14.55 14.55 0 00-3.16.3 24.14 24.14 0 00-3.29 1.06l-.56 3.46 3.39.4.5-1.69a2.78 2.78 0 011.08-.37 11.3 11.3 0 011.25-.07c1.19 0 1.89.37 2.09 1.1a8.55 8.55 0 01.3 2.26v.5a8.91 8.91 0 00-1.18-.11h-1.21a12.64 12.64 0 00-4.81.88 3.53 3.53 0 00-2.18 3.64 3.66 3.66 0 001.48 3.33 5.63 5.63 0 003.11 1 4.67 4.67 0 003-.91 6.78 6.78 0 001.8-2 3 3 0 003.33 3 5.54 5.54 0 002.66-.85zm-9.25-2.32a1.69 1.69 0 01-1.36-.52 1.81 1.81 0 01-.43-1.21 1.67 1.67 0 01.86-1.68 4.63 4.63 0 012-.42 7.69 7.69 0 011.07.07l1.06.13a3.58 3.58 0 01-1.08 2.74 3.24 3.24 0 01-2.11.89z"></path></svg></a></div><ul class="link-list-mdn"><li><a href="/ru/docs/Web">Web Technologies</a></li><li><a href="/ru/docs/Learn">Learn Web Development</a></li><li><a href="/ru/docs/MDN/About">About MDN</a></li><li><a href="/ru/docs/MDN/Feedback">Feedback</a></li></ul><ul class="link-list-moz"><li><a href="https://www.mozilla.org/about/" target="_blank" rel="noopener noreferrer">About</a></li><li><a href="https://shop.spreadshirt.com/mdn-store/" target="_blank" rel="noopener noreferrer">MDN Web Docs Store</a></li><li><a href="https://www.mozilla.org/contact/" target="_blank" rel="noopener noreferrer">Contact Us</a></li><li><a href="https://www.mozilla.org/firefox/?utm_source=developer.mozilla.org&amp;utm_campaign=footer&amp;utm_medium=referral" target="_blank" rel="noopener noreferrer">Firefox</a></li></ul><div class="social social-mdn"><h4>MDN</h4><ul><li><a class="social-icon twitter" href="https://twitter.com/mozdevnet" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on Twitter</span></a></li><li><a class="social-icon github" href="https://github.com/mdn/" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on Github</span></a></li></ul></div><div class="social social-moz"><h4>Mozilla</h4><ul><li><a class="social-icon twitter" href="https://twitter.com/mozilla" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">Mozilla on Twitter</span></a></li><li><a class="social-icon instagram" href="https://www.instagram.com/mozillagram/" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">Mozilla on Instagram</span></a></li></ul></div><p id="license" class="footer-license">© 2005-<!-- -->2022<!-- --> Mozilla and individual contributors. Content is available under<!-- --> <a href="/docs/MDN/About#Copyrights_and_licenses">these licenses</a>.</p><ul class="footer-legal"><li><a href="https://www.mozilla.org/about/legal/terms/mozilla" target="_blank" rel="noopener noreferrer">Terms</a></li><li><a href="https://www.mozilla.org/privacy/websites/" target="_blank" rel="noopener noreferrer">Privacy</a></li><li><a href="https://www.mozilla.org/privacy/websites/#cookies" target="_blank" rel="noopener noreferrer">Cookies</a></li></ul></div></footer><div class="page-overlay hidden"></div></div><script type="application/json" id="hydration">{"doc":{"isMarkdown":false,"isTranslated":true,"isActive":true,"flaws":{},"title":"Компиляция Rust в WebAssembly","mdn_url":"/ru/docs/WebAssembly/Rust_to_wasm","locale":"ru","native":"Русский","sidebarHTML":"\n\n<ol>\n  <li data-default-state=\"open\"><a href=\"/ru/docs/WebAssembly\"><strong>WebAssembly home page</strong></a>\n  </li><li class=\"toggle\">\n    <details open=\"\">\n      <summary>Tutorials</summary>\n      <ol>\n        <li><a href=\"/ru/docs/WebAssembly/Concepts\">WebAssembly concepts</a></li>\n        <li><a href=\"/ru/docs/WebAssembly/C_to_wasm\">Compiling from C/C++ to WebAssembly</a></li>\n        <li><a href=\"/ru/docs/WebAssembly/Rust_to_wasm\">Compiling from Rust to WebAssembly</a></li>\n        <li><a href=\"/ru/docs/WebAssembly/Using_the_JavaScript_API\">Using the WebAssembly JavaScript API</a></li>\n        <li><a href=\"/ru/docs/WebAssembly/Understanding_the_text_format\">Understanding WebAssembly text format</a></li>\n        <li><a href=\"/ru/docs/WebAssembly/Text_format_to_wasm\">Converting WebAssembly text format to wasm</a></li>\n        <li><a href=\"/ru/docs/WebAssembly/Loading_and_running\">Loading and running WebAssembly code</a></li>\n        <li><a href=\"/ru/docs/WebAssembly/Caching_modules\">Caching compiled WebAssembly modules</a></li>\n        <li><a href=\"/ru/docs/WebAssembly/Exported_functions\">Exported WebAssembly functions</a></li>\n      </ol>\n    </details>\n  </li>\n  <li class=\"toggle\">\n    <details open=\"\">\n      <summary>Object reference</summary>\n      <ol>\n        <li><a href=\"/ru/docs/WebAssembly/JavaScript_interface\"><code>WebAssembly</code></a></li>\n        <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/WebAssembly/JavaScript_interface/Module\"><code>WebAssembly.Module</code> <small>(en-US)</small></a></li>\n        <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/WebAssembly/JavaScript_interface/Global\"><code>WebAssembly.Global</code> <small>(en-US)</small></a></li>\n        <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/WebAssembly/JavaScript_interface/Instance\"><code>WebAssembly.Instance</code> <small>(en-US)</small></a></li>\n        <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/WebAssembly/JavaScript_interface/Memory\"><code>WebAssembly.Memory</code> <small>(en-US)</small></a></li>\n        <li><a href=\"/ru/docs/WebAssembly/JavaScript_interface/Table\"><code>WebAssembly.Table</code></a></li>\n        <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/WebAssembly/JavaScript_interface/CompileError\"><code>WebAssembly.CompileError</code> <small>(en-US)</small></a></li>\n        <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/WebAssembly/JavaScript_interface/LinkError\"><code>WebAssembly.LinkError</code> <small>(en-US)</small></a></li>\n        <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/WebAssembly/JavaScript_interface/RuntimeError\"><code>WebAssembly.RuntimeError</code> <small>(en-US)</small></a></li>\n      </ol>\n    </details>\n  </li>\n</ol>\n\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div id=\"sect1\"></div>\n\n<p class=\"summary\">Если уже вы написали некоторый код на Rust, вы можете скомпилировать его в WebAssembly! Из этого руководства вы узнаете всё, что вам нужно знать, чтобы скомпилировать проект на Rust в wasm и использовать его в существующем веб-приложении.</p>"}},{"type":"prose","value":{"id":"примеры_использования_rust_и_webassembly","title":"Примеры использования Rust и WebAssembly","isH3":false,"content":"<p>Существует два основных варианта использования Rust и WebAssembly:</p>\n\n<ul>\n <li>Чтобы создать целое приложение — целое веб-приложение, основанное на Rust!</li>\n <li>Чтобы построить часть приложения — используйте Rust в существующем интерфейсе JavaScript.</li>\n</ul>\n\n<p>На данный момент команда Rust фокусируется на последнем примере,  его мы рассмотрим здесь. Для первого примера, посмотрите проекты, такие как <a href=\"https://github.com/DenisKolodin/yew\" class=\"external\" rel=\" noopener\"><code>yew</code></a>.</p>\n\n<p>В этом руководстве вы создадите npm-пакет, используя <code>wasm-pack</code>, инструмент построения npm-пакетов в Rust. Этот пакет будет содержать только код WebAssembly и JavaScript, так что его пользователям не нужен будет установщик Rust. Они могут даже не заметить, что он был написан на WebAssembly!</p>"}},{"type":"prose","value":{"id":"настройка_окружения_rust","title":"Настройка окружения Rust","isH3":false,"content":"<p>Давайте пройдёмся по всем пунктам, необходимым для настройки нашего окружения.</p>"}},{"type":"prose","value":{"id":"установка_rust","title":"Установка Rust","isH3":true,"content":"<p>Чтобы установить Rust, посетите <a href=\"https://www.rust-lang.org/install.html\" class=\"external\" rel=\" noopener\">Install Rust</a> страницу и проследуйте всем инструкциям. Так вы установите тулзу, называемую \"rustup\", которая позволит вам управлять несколькими версиями Rust. По умолчанию, она устанавливает последний стабильный релиз Rust, который вы будете использовать для стандартной разработки на Rust. Rustup устанавливает <code>rustc</code>, компилятор Rust, вместе с <code>cargo</code>, Rust-овским пакетным менеджером, <code>rust-std</code>, стандартной  библиотекой Rust, и несколькими вспомогательными доками — <code>rust-docs</code>.</p>\n\n<div class=\"note notecard\" id=\"sect2\">\n<p><strong>Примечание</strong>: Обратите внимание на пост-установочную заметку о необходимости добавить cargo <code>bin</code> директорию в список <code>PATH</code>. Она должна быть добавлена автоматически, но вам нужно будет перезапустить терминал, чтобы изменения вступили в силу.</p>\n</div>"}},{"type":"prose","value":{"id":"wasm-pack","title":"wasm-pack","isH3":true,"content":"<p>Чтобы собрать наш пакет, вам понадобится дополнительный инструмент, <code>wasm-pack</code>. Он поможет нам скомпилировать наш код в WebAssembly и создаст правильный контейнер для нашего пакета для <code>npm</code>. Чтобы скачать и установить, введите в терминале следующую команду:</p>\n\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code>$ cargo <span class=\"token function\">install</span> wasm-pack\n</code></pre></div>"}},{"type":"prose","value":{"id":"установка_node.js_и_получение_npm-аккаунта","title":"Установка Node.js и получение npm-аккаунта","isH3":true,"content":"<p>В этом руководстве мы будем собирать npm-пакет, поэтому вам понадобится установить Node.js и npm. Дополнительно, мы опубликуем наш пакет на npm, так что вам так же понадобится ваш npm-аккаунт. Они бесплатны! <em>Технически</em>, вы не обязаны ничего публиковать, но так будет проще, так что будем считать, что вы сделаете это в этом руководстве.</p>\n\n<p>Чтобы получить Node.js и npm, посетите <a href=\"https://www.npmjs.com/get-npm\" class=\"external\" rel=\" noopener\">Get npm!</a> страницу и проследуйте инструкциям. Когда настанет время выбрать версию, выберите любую, которая вам нравится; это руководство не зависит от версии.</p>\n\n<p>Чтобы создать npm-аккаунт, посетите <a href=\"https://www.npmjs.com/signup\" class=\"external\" rel=\" noopener\">npm signup</a> станицу и заполните форму.</p>\n\n<p>Дальше запустите в командой строке <code>npm adduser</code>:</p>\n\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code><span class=\"token operator\">&gt;</span> <span class=\"token function\">npm</span> adduser\nUsername: yournpmusername\nPassword:\nEmail: <span class=\"token punctuation\">(</span>this IS public<span class=\"token punctuation\">)</span> you@example.com\n</code></pre></div>\n\n<p>Вам понадобится ввести своё пользовательское имя, пароль и email. Если все получится, вы увидите:</p>\n\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code>Logged <span class=\"token keyword\">in</span> as yournpmusername on https://registry.npmjs.org/.\n</code></pre></div>\n\n<p>Если что-то пойдёт не так, свяжитесь с командой npm, чтобы разобраться.</p>"}},{"type":"prose","value":{"id":"создание_webassembly_npm-пакета","title":"Создание WebAssembly npm-пакета","isH3":false,"content":"<p>Хватит установок, давайте создадим новый пакет на Rust. Перейдите в любое место, где вы держите свои личные проекты, и сделайте следующее:</p>\n\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code>$ cargo new --lib hello-wasm\n     Создаст проектную библиотеку <span class=\"token variable\"><span class=\"token variable\">`</span>hello-wasm<span class=\"token variable\">`</span></span>\n</code></pre></div>\n\n<p>Это создаст новую библиотеку в под-директории, называемой <code>hello-wasm</code>, со всем, что вам нужно:</p>\n\n<pre class=\"notranslate\">+-- Cargo.toml\n+-- src\n    +-- lib.rs\n</pre>\n\n<p>Для начала, у нас есть <code>Cargo.toml</code>; с его помощью мы можем сконфигурировать наш билд. Если вы пользуетесь <code>Gemfile</code> из Bundler или <code>package.json</code> из npm, то вы почувствуете себя, как дома; Cargo работает аналогично обоим.</p>\n\n<p>Дальше, Cargo сгенерировал кое-какой код для нас на Rust в <code>src/lib.rs</code>:</p>\n\n<pre class=\"notranslate\">#[cfg(test)]\nmod tests {\n    #[test]\n    fn it_works() {\n        assert_eq!(2 + 2, 4);\n    }\n}\n</pre>\n\n<p>Мы не будем использовать этот тестовый код вообще, так что можете просто удалить его.</p>"}},{"type":"prose","value":{"id":"давайте_попишем_немного_на_rust!","title":"Давайте попишем немного на Rust!","isH3":true,"content":"<p>Вместо этого поместите этот код в <code>src/lib.rs</code>:</p>\n\n<pre class=\"notranslate\">extern crate wasm_bindgen;\n\nuse wasm_bindgen::prelude::*;\n\n#[wasm_bindgen]\nextern {\n    pub fn alert(s: &amp;str);\n}\n\n#[wasm_bindgen]\npub fn greet(name: &amp;str) {\n    alert(&amp;format!(\"Hello, {}!\", name));\n}\n</pre>\n\n<p>Это содержимое нашего проекта на Rust. У него есть три основные части, давайте пройдёмся по ним по очереди. Мы дадим здесь обобщённое пояснение и поясним некоторые детали; чтобы узнать больше о Rust, пожалуйста, просмотрите бесплатную online-книгу <a href=\"https://doc.rust-lang.org/book/\" class=\"external\" rel=\" noopener\">The Rust Programming Language</a>.</p>\n\n<h4 id=\"использование_wasm-bindgen_для_коммуникации_между_rust_и_javascript\">Использование <code>wasm-bindgen</code> для коммуникации между Rust и JavaScript</h4>\n\n<p>Первая часть выглядит вот так:</p>\n\n<pre class=\"notranslate\">extern crate wasm_bindgen;\n\nuse wasm_bindgen::prelude::*;\n</pre>\n\n<p>Первая строка гласит: \"эй, Rust, мы используем библиотеку, называемую wasm_bindgen.\" Библиотеки в Rust называются \"<code>crates</code>\" (контейнеры), а так как мы используем внешнюю, то \"<code>extern</code>\".</p>\n\n<p>Поняли? <strong>Cargo поставляет контейнеры</strong>.</p>\n\n<p>Третья строка содержит команду <code>use</code>, которая импортирует код из библиотеки в наш код. В нашем случае, мы импортируем все из модуля <code>wasm_bindgen::prelude</code>. Мы будем использовать его функции в следующей секции.</p>\n\n<p>Прежде чем перейти к следующей секции, давайте поговорим немного о <code>wasm-bindgen</code>.</p>\n\n<p><code>wasm-pack</code> использует <code>wasm-bindgen</code>, другую тулзу, чтобы предоставить соединение между типами в JavaScript и Rust. Это позволяет JavaScript вызывать Rust-API со строками или функциям Rust перехватывать исключения JavaScript.</p>\n\n<p>Мы будем использовать функциональность <code>wasm-bindgen</code> в нашем пакете. По факту, это следующая секция!</p>\n\n<h4 id=\"вызов_внешних_функций_javascript_из_rust\">Вызов внешних функций JavaScript из Rust</h4>\n\n<p>Следующая часть выглядит так:</p>\n\n<pre class=\"notranslate\">#[wasm_bindgen]\nextern {\n    pub fn alert(s: &amp;str);\n}\n</pre>\n\n<p>Частичка внутри <code>#[]</code> называется \"атрибутом\", и она кое-как модифицирует следующее за ней утверждение. В нашем случае, это утверждение <code>extern</code>, которое говорит Rust-у, что мы хотим вызвать некоторую функцию, определённую во внешнем пространстве. Атрибут говорит: \"wasm-bindgen знает, как найти эти функции\".</p>\n\n<p>Третья строка это имя функции, написанной на Rust. Она говорит: \"функция <code>alert</code>  принимает один аргумент, строку с именем <code>s</code>.\"</p>\n\n<p>У вас, возможно, есть предположение, что это за функция, и, возможно, ваше предположение верное: это функция<a href=\"/en-US/docs/Web/API/Window/alert\"> <code>alert</code>, предоставляемая JavaScript</a>! Мы будем вызывать эту функцию в следующей секции.</p>\n\n<p>Когда бы вы не захотели вызвать новую функцию JavaScript, вы можете написать её здесь, и <code>wasm-bindgen</code> позаботится о том, чтобы настроить все для вас. Пока ещё поддерживается не все, но мы работаем над этим! Пожалуйста, <a href=\"https://github.com/rustwasm/wasm-bindgen/issues/new\" class=\"external\" rel=\" noopener\">сообщайте о проблемах</a>, если что-то было упущено.</p>\n\n<h4 id=\"создание_функций_rust_который_может_вызывать_javascript\">Создание функций Rust, который может вызывать JavaScript</h4>\n\n<p>Финальная часть следующая:</p>\n\n<pre class=\"notranslate\">#[wasm_bindgen]\npub fn greet(name: &amp;str) {\n    alert(&amp;format!(\"Hello, {}!\", name));\n}\n</pre>\n\n<p>Ещё раз, мы видим <code>#[wasm_bindgen]</code> атрибут. В этом случае, он модифицирует не блок <code>extern</code>, а <code>fn</code>; это значит, что мы хотим, чтобы эта функция на Rust была доступна для JavaScript. Прямо противоположно <code>extern</code>: это не те функции, которые нам нужны, а те, что мы предоставляем миру!</p>\n\n<p>Наша функция называется <code>greet</code>, и она принимает один аргумент, строку (пишется <code>&amp;str</code>), <code>name</code>. Затем она вызывает функцию <code>alert</code>, которую мы запросили в блоке <code>extern</code> выше. Она передаёт вызов макросу <code>format!</code>, который позволяет нам соединить строки.</p>\n\n<p><code>format!</code> принимает два аргумента в нашем случае: форматируемую строку и переменную, которую должен в неё поместить. Форматируемая строка это <code>\"Hello, {}!\"</code> часть. Она содержит <code>{}</code>, куда будет вставлена переменная. Переменная, которую мы передаём, это <code>name</code>, аргумент функции, так что если мы вызовем <code>greet(\"Steve\")</code>, то увидим <code>\"Hello, Steve!\".</code></p>\n\n<p>Все это передаётся в <code>alert()</code>, так что когда мы вызовем функцию, мы увидим алерт с \"Hello, Steve!\" внутри него!</p>\n\n<p>Теперь, когда наша библиотека написана, давайте соберём её.</p>"}},{"type":"prose","value":{"id":"компиляция_кода_в_webassembly","title":"Компиляция кода в WebAssembly","isH3":true,"content":"<p>Чтобы правильно скомпилить наш код, сначала нам надо сконфигурировать его с помощью <code>Cargo.toml</code>. Откройте этот файл и измените его так, чтобы он выглядел следующим образом:</p>\n\n<pre class=\"notranslate\"><code class=\"toml language-toml\">[package]\nname = \"hello-wasm\"\nversion = \"0.1.0\"\nauthors = [\"Your Name &lt;you@example.com&gt;\"]\ndescription = \"A sample project with wasm-pack\"\nlicense = \"MIT/Apache-2.0\"\nrepository = \"https://github.com/yourgithubusername/hello-wasm\"\n\n[lib]\ncrate-type = [\"cdylib\"]\n\n[dependencies]\nwasm-bindgen = \"0.2\"\n</code></pre>\n\n<p>Вам нужно будет ввести свой личный репозиторий, а Cargo заполнит <code>authors</code>, основываясь на информации <code>git</code>.</p>\n\n<p>Главная часть находится внизу. Первая — <code>[lib]</code> — говорит Rust собрать <code>cdylib</code> версию нашего пакета; мы не будем вдаваться в то, что это значит в этом руководстве. Чтобы узнать больше, просмотрите <a href=\"https://doc.rust-lang.org/cargo/guide/\" class=\"external\" rel=\" noopener\">Cargo</a> и <a href=\"https://doc.rust-lang.org/reference/linkage.html\" class=\"external\" rel=\" noopener\">Rust Linkage</a> документацию.</p>\n\n<p>Вторая часть это секция <code>[dependencies]</code> . Тут мы говорим Cargo, от какой версии <code>wasm-bindgen</code> мы хотим зависеть; в нашем случае, это любая версия <code>0.2.z</code> (но не <code>0.3.0</code> или выше).</p>"}},{"type":"prose","value":{"id":"сборка_пакета","title":"Сборка пакета","isH3":true,"content":"<p>Теперь, когда мы все установили, давайте соберём проект! Введите это в терминале:</p>\n\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code>$ wasm-pack build --scope mynpmusername\n</code></pre></div>\n\n<p>Здесь мы сделали несколько вещей (и они займут много времени, особенно если вы запустили <code>wasm-pack</code> впервые). Чтобы изучить их детальней, прочитайте <a href=\"https://hacks.mozilla.org/2018/04/hello-wasm-pack/\" class=\"external\" rel=\" noopener\">этот блог-пост на Mozilla Hacks</a>. Вкратце, <code>wasm-pack build</code>:</p>\n\n<ol>\n <li>Компилирует ваш Rust-код в WebAssembly.</li>\n <li><code>Запускает wasm-bindgen</code> с этим WebAssembly, генерируя JavaScript файл, который оборачивает WebAssembly файл в модуль. который может понять npm.</li>\n <li>Создаёт папку <code>pkg</code>, куда перемещает этот JavaScript файл и ваш код WebAssembly.</li>\n <li>Читает ваш <code>Cargo.toml</code> и создаёт эквивалентный <code>package.json</code>.</li>\n <li>Копирует ваш <code>README.md</code> (если есть) в пакет.</li>\n</ol>\n\n<p>Конечный результат? У вас есть npm-пакет внутри папки <code>pkg</code>.</p>\n\n<h4 id=\"отступление_о_размере_кода\">Отступление о размере кода</h4>\n\n<p>Если вы посмотрите на размер кода, сгенерированного для WebAssembly, это может быть около сотни килобайт. Мы вообще не инструктировали Rust оптимизировать размер, и он <em>сильно</em> его снизил. Это не является частью этого руководства, но если вам интересно, прочитайте документацию Rust WebAssembly Working Group на <a href=\"https://rustwasm.github.io/book/game-of-life/code-size.html#shrinking-wasm-size\" class=\"external\" rel=\" noopener\">Shrinking .wasm Size</a>.</p>"}},{"type":"prose","value":{"id":"публикация_нашего_пакета_на_npm","title":"Публикация нашего пакета на npm","isH3":true,"content":"<p>Давайте опубликуем наш новый пакет на npm:</p>\n\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code>$ <span class=\"token builtin class-name\">cd</span> pkg\n$ <span class=\"token function\">npm</span> publish --access<span class=\"token operator\">=</span>public\n</code></pre></div>\n\n<p>Теперь у нас есть npm-пакет, написанный на Rust, но скомпилированный в WebAssembly. Он готов к использованию из JavaScript, и его пользователь не нуждается в установке Rust; код внутри пакета написан на WebAssembly, не на Rust!</p>"}},{"type":"prose","value":{"id":"использование_пакета_в_web","title":"Использование пакета в web","isH3":false,"content":"<p>Давайте создадим сайт, который будет использовать наш пакет! Многие пользуются пакетами npm с помощью разных сборщиков, и мы будем использовать один из них, <code>webpack</code>, в этом руководстве. Он только немного более усложнённый, но описывает более реалистичный вариант использования.</p>\n\n<p>Давайте выйдем из нашей папки <code>pkg</code> и создадим новую, <code>site</code>, чтобы попробовать в ней следующее:</p>\n\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code>$ <span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span>/<span class=\"token punctuation\">..</span>\n$ <span class=\"token function\">mkdir</span> site\n$ <span class=\"token builtin class-name\">cd</span> site\n</code></pre></div>\n\n<p>Создайте новый файл, <code>package.json</code>, и поместите в него следующий код:</p>\n\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"webpack-dev-server\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"@mynpmusername/hello-wasm\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^0.1.0\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"devDependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"webpack\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^4.25.1\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"webpack-cli\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^3.1.2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"webpack-dev-server\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^3.1.10\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n\n<p>Заметьте, что вам нужно ввести своё пользовательское имя после <code>@</code> в секции зависимостей.</p>\n\n<p>Дальше нам нужно сконфигурировать Webpack. Создайте <code>webpack.config.js</code> и введите следующее:</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">entry</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">output</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"dist\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">filename</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">mode</span><span class=\"token operator\">:</span> <span class=\"token string\">\"development\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n\n<p>Теперь нам нужен HTML-файл; создайте <code>index.html</code> и поместите в него:</p>\n\n<pre class=\"notranslate\"><code class=\"html language-html\">&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;title&gt;hello-wasm example&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;script src=\"./index.js\"&gt;&lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Наконец, создайте <code>index.js</code>, на который мы сослались в HTML-файле, и вставьте:</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> js <span class=\"token operator\">=</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./node_modules/@yournpmusername/hello-wasm/hello_wasm.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\njs<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">js</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  js<span class=\"token punctuation\">.</span><span class=\"token function\">greet</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"WebAssembly\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n\n<p>Заметьте, что вам нужно будет снова ввести ваше имя для npm.</p>\n\n<p>Так мы импортируем наш модуль из папки <code>node_modules</code>. Это не считается лучшей практикой, но это пример, так что пока сойдёт. Как только файл загрузится, он вызовет функцию <code>greet</code> из этого модуля, передав <code>\"WebAssembly\"</code>, как строку. Обратите внимание, что здесь нет ничего особенного, и всё же мы вызываем код на Rust! Насколько JavaScript-код может судить, это просто обычный модуль.</p>\n\n<p>Мы закончили! Давайте попробуем:</p>\n\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code>$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span>\n$ <span class=\"token function\">npm</span> run serve\n</code></pre></div>\n\n<p>Так мы запустим сервер. Откройте <a href=\"http://localhost:8080\" class=\"external\" rel=\" noopener\">http://localhost:8080</a> и вы увидите алерт с надписью <code>Hello, WebAssembly!</code>  в нем! Мы успешно обратились из JavaScript в Rust и из Rust в JavaScript.</p>"}},{"type":"prose","value":{"id":"заключение","title":"Заключение","isH3":false,"content":"<p>На этом руководство заканчивается, мы надеемся, что вы сочли его для себя полезным.</p>\n\n<p>В этом направлении кипит бурная и при этом очень интересная деятельность, так что если вы бы хотели помочь что-то улучшить, то загляните в <a href=\"https://fitzgeraldnick.com/2018/02/27/wasm-domain-working-group.html\" class=\"external\" rel=\" noopener\">the Rust Webassembly Working Group</a>.</p>"}}],"toc":[{"text":"Примеры использования Rust и WebAssembly","id":"примеры_использования_rust_и_webassembly"},{"text":"Настройка окружения Rust","id":"настройка_окружения_rust"},{"text":"Создание WebAssembly npm-пакета","id":"создание_webassembly_npm-пакета"},{"text":"Использование пакета в web","id":"использование_пакета_в_web"},{"text":"Заключение","id":"заключение"}],"summary":"Если уже вы написали некоторый код на Rust, вы можете скомпилировать его в WebAssembly! Из этого руководства вы узнаете всё, что вам нужно знать, чтобы скомпилировать проект на Rust в wasm и использовать его в существующем веб-приложении.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Compiling from Rust to WebAssembly","locale":"en-US","native":"English (US)"},{"title":"Rust から WebAssembly にコンパイルする","locale":"ja","native":"日本語"},{"title":"Rust를 WebAssembly로 컴파일하기","locale":"ko","native":"한국어"},{"title":"编译 Rust 为 WebAssembly","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"ru/webassembly/rust_to_wasm","github_url":"https://github.com/mdn/translated-content/blob/main/files/ru/webassembly/rust_to_wasm/index.html","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.html"},"parents":[{"uri":"/ru/docs/WebAssembly","title":"WebAssembly"},{"uri":"/ru/docs/WebAssembly/Rust_to_wasm","title":"Компиляция Rust в WebAssembly"}],"pageTitle":"Компиляция Rust в WebAssembly - WebAssembly | MDN","noIndexing":false}}</script></body></html>