{"doc":{"isMarkdown":false,"isTranslated":true,"isActive":true,"flaws":{},"title":"Время загрузки страницы и ресурсов","mdn_url":"/ru/docs/Web/Performance/Navigation_and_resource_timings","locale":"ru","native":"Русский","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p><strong>Тайминги навигации (Navigation timings) </strong>- это показатели, указывающие временные метки, в которые произошли события навигации. <strong>Тайминги ресурсов (Resource timings) </strong>- это детальные показатели по времени загрузки ресурсов. </p>\n\n<p>В этой статье мы рассмотрим как <a href=\"/en-US/docs/Web/API/PerformanceTiming\">Performance Timing API</a>, так и Performance Entry API. И хотя первый API считается устаревшим, он все ещё поддерживается всеми браузерами, он прост и о нем полезно знать. В свою очередь, Performance Entry API является более продвинутым инструментом, который позволяет не только получить более сложные данные, но и позволяет разработчику измерять другие показатели, в дополнение к данным о навигации и загрузке ресурсов.</p>"}},{"type":"prose","value":{"id":"performance_timing_api","title":"<strong>Performance Timing</strong> API","isH3":false,"content":"<p><a href=\"/en-US/docs/Web/API/PerformanceTiming\">PerformanceTiming API</a> - это JavaScript API для измерения времени загрузки страницы. Этот API считается устаревшим, но поддерживается во всех браузерах. На текущий момент рекомендуется использовать <a href=\"/en-US/docs/Web/API/PerformanceNavigationTiming\">performanceNavigationTiming</a> API.</p>\n\n<p><a href=\"/en-US/docs/Web/API/PerformanceTiming\">PerformanceTiming API </a>предоставляет собой read only данные в виде объекта, где значениями полей являются числа, указывающие на количество миллисекунд, которые прошли к моменту срабатывания того или иного события. Как показано на изображении ниже, процесс навигации можно разбить на следующие этапы: <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/navigationStart\">navigationStart</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/unloadEventStart\">unloadEventStart</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/unloadEventEnd\">unloadEventEnd</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/redirectStart\">redirectStart</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/redirectEnd\">redirectEnd</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/fetchStart\">fetchStart</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/domainLookupStart\">domainLookupStart</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/domainLookupEnd\">domainLookupEnd</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/connectStart\">connectStart</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/connectEnd\">connectEnd</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/secureConnectionStart\">secureConnectionStart</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/requestStart\">requestStart</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/responseStart\">responseStart</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/responseEnd\">responseEnd</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/domLoading\">domLoading</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/domInteractive\">domInteractive</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/domContentLoadedEventStart\">domContentLoadedEventStart</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/domContentLoadedEventEnd\">domContentLoadedEventEnd</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/domComplete\">domComplete</a></code>, <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/loadEventStart\">loadEventStart</a></code>, и <code><a href=\"/en-US/docs/Web/API/PerformanceTiming/loadEventEnd\">loadEventEnd</a></code>.</p>\n\n<p><img alt=\"Navigation Timing event metrics\" src=\"https://mdn.mozillademos.org/files/16620/Screen_Shot_2019-05-03_at_1.06.27_PM.png\" loading=\"lazy\"></p>\n\n<p>Благодаря этим метрикам и небольшим вычислениям мы можем определить важные показатели, например <a href=\"/en-US/docs/Glossary/time_to_first_byte\">время до первого байта (time to first byte</a>), скорость загрузки страницы, поиска записи dns и даже узнать, является ли соединение безопасным.</p>\n\n<p>Чтобы получить доступ к этим данным, обратитесь к следующему объекту:</p>\n\n<pre class=\"notranslate\">let time = window.performance.timing</pre>\n\n<p>Мы можем использовать эти данные, чтобы понять, как быстро работает приложение:</p>\n\n<p><img alt=\"entering window.performance.timing in the console lists all the timings in the PerformanceNavigationTiming interface\" src=\"https://mdn.mozillademos.org/files/16824/navigatortiming.png\" loading=\"lazy\"></p>\n\n<p>Описание показателей:</p>\n\n<table>\n <thead>\n  <tr>\n   <th>Показатель</th>\n   <th>Пояснение</th>\n  </tr>\n </thead>\n <tbody>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/navigationStart\"><code>navigationStart</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Момент, когда предыдущий документ в том же контексте (табе) запускает событие unload. Если предыдущего документа не было, значение этого показателя будет таким же, как и <code>PerformanceTiming.fetchStart</code>.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/secureConnectionStart\"><code>secureConnectionStart</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Началась установка (handshake) безопасного соединения. Если безопасного соединения нет, то значение равно <code>0</code>.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/redirectStart\"><code>redirectStart</code> <small>(en-US)</small></a></td>\n   <td>Начало первого HTTP редиректа. Если никаких редиректов не было, или один из редиректов перевёл документ на другой origin, то значение равно <code>0</code>.</td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/redirectEnd\"><code>redirectEnd</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Последний HTTP редирект завершён, то есть последний байт HTTP-ответа был получен. Если никаких редиректов не было, или один из редиректов перевёл документ на другой origin, то значение равно <code>0</code>.</p>\n   </td>\n  </tr>\n  <tr>\n   <td>\n    <p><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/connectStart\"><code>connectStart</code> <small>(en-US)</small></a></p>\n   </td>\n   <td>\n    <p>Запрос на открытие соединения отправлен в сеть. Если транспортный уровень модели OSI сообщает об ошибке и установка соединения запускаются заново, то возвращается время старта последней попытки соединения. Если используется постоянное соединение, то значение показателя будет таким же, как и <code>PerformanceTiming.fetchStart</code>.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/connectEnd\"><code>connectEnd</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Момент, когда соединение открыто для передачи данных. Если транспортный уровень модели OSI сообщает об ошибке и установка соединения запускаются заново, то возвращается время  завершения последней попытки соединения. Если используется постоянное соединение, то значение показателя будет таким же, как и <code>PerformanceTiming.fetchStart</code>. Соединение считается открытым, когда завершены все этапы установление безопасного соединения, например TLS Handshake или SOCKS Authentication.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/domainLookupEnd\"><code>domainLookupEnd</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Поиск домена завершён. Если используется постоянное соединение, или используются данные, сохранённые в локальном кеше, то значение показателя будет таким же, как и <code>PerformanceTiming.fetchStart</code>.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/domainLookupStart\"><code>domainLookupStart</code> <small>(en-US)</small></a></td>\n   <td>Начался поиск домена. Если используется постоянное соединение, или используются данные, сохранённые в локальном кеше, то значение показателя будет таким же, как и <code>PerformanceTiming.fetchStart</code>.</td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/fetchStart\"><code>fetchStart</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Браузер готов к загрузке документа с помощью HTTP-запроса. Этот этап всегда <strong>срабатывает до проверки</strong> кеша приложения.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/requestStart\"><code>requestStart</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Браузер посылает запрос на получение документа с сервера или из кеша. Если транспортный уровень сообщает об ошибке отправки запроса, а соединение переоткрывается - этот показатель будет перезаписан данными нового запроса.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/responseStart\"><code>responseStart</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Браузер получает первый байт ответа от сервера, кеша или локального ресурса.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/responseEnd\"><code>responseEnd</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Браузер получает последний байт ответа от сервера, кеша или локального ресурса. Если соединение закрывается раньше получения последнего байта - значение параметра указывает на момент закрытия соединения.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/domLoading\"><code>domLoading</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Парсер HTML начинает работу. В этот момент <a href=\"/ru/docs/Web/API/Document/readyState\"><code>Document.readyState</code></a> изменяется на <code>'loading'</code> и срабатывает событие <a href=\"/ru/docs/Web/API/Document/readystatechange_event\" title=\"readystatechange\"><code>readystatechange</code></a>.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/unloadEventStart\"><code>unloadEventStart</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Срабатывает событие <a href=\"/ru/docs/Web/API/Window/unload_event\" title=\"unload\"><code>unload</code></a>&gt;, что говорит о времени, когда предыдущий документ начал выгружаться. Если предыдущего документа не было или переход к текущей странице подразумевал изменение origin (в т.ч. из-за редиректов), значение параметра равно <code>0</code>.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/unloadEventEnd\"><code>unloadEventEnd</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Обработчик события  <code><a href=\"/en-US/docs/Web/API/Window/unload_event\">unload</a></code> завершил свою работу. Если предыдущего документа не было или переход к текущей странице подразумевал изменение origin (в т.ч. из-за редиректов), значение параметра равно <code>0</code>.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/domInteractive\"><code>domInteractive</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>HTML парсер завершил работу над основным документом. В этот момент <a href=\"/en-US/docs/Web/API/Document/readyState\"><code>Document.readyState</code></a> изменяется на <code>'interactive'</code> и срабатывает событие <code><a href=\"/en-US/docs/Web/API/Document/readystatechange_event\">readystatechange</a></code></p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/domContentLoadedEventStart\"><code>domContentLoadedEventStart</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Момент сразу перед тем, как парсер запускает событие <code><a href=\"/en-US/docs/Web/API/Window/DOMContentLoaded_event\">DOMContentLoaded</a></code>. Это событие запускается после того, как все скрипты, которые должны исполниться сразу после парсинга, выполнены.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/domContentLoadedEventEnd\"><code>domContentLoadedEventEnd</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Момент сразу после исполнения всех скриптов, которые должны были исполниться.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/domComplete\"><code>domComplete</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Парсер HTML завершил работу над основным документом. В этот момент <a href=\"/en-US/docs/Web/API/Document/readyState\"><code>Document.readyState</code></a> изменяется на <code>'complete'</code> и срабатывает событие <code><a href=\"/en-US/docs/Web/API/Document/readystatechange_event\">readystatechange</a></code>.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/loadEventStart\"><code>loadEventStart</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Событие <code><a href=\"/en-US/docs/Web/API/Window/load_event\">load</a></code> было отправлено текущему документу. Если это событие на момент измерения не было отправлено документу, значение параметра равно <code>0.</code></p>\n   </td>\n  </tr>\n  <tr>\n   <td><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceTiming/loadEventEnd\"><code>loadEventEnd</code> <small>(en-US)</small></a></td>\n   <td>\n    <p>Обработка события <code><a href=\"/en-US/docs/Web/API/Window/load_event\">load</a></code> завершена, то есть загрузка завершена. Если это событие ещё не произошло или не было послано документу, значение параметра равно <code>0</code>.</p>\n   </td>\n  </tr>\n </tbody>\n</table>","titleAsText":"Performance Timing API"}},{"type":"prose","value":{"id":"вычисление_таймингов","title":"Вычисление таймингов","isH3":true,"content":"<p>Мы можем использовать все эти значения, чтобы вычислить, сколько времени потребовалось на тот или иной этап:</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span>\n    dns  <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>domainLookupEnd <span class=\"token operator\">-</span> time<span class=\"token punctuation\">.</span>domainLookupStart<span class=\"token punctuation\">,</span>\n    tcp  <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>connectEnd <span class=\"token operator\">-</span> time<span class=\"token punctuation\">.</span>connectStart<span class=\"token punctuation\">,</span>\n    ssl <span class=\"token operator\">!=</span> time<span class=\"token punctuation\">.</span>secureConnectionStart<span class=\"token punctuation\">,</span></code></pre></div>"}},{"type":"prose","value":{"id":"время_до_первого_байта","title":"Время до первого байта","isH3":true,"content":"<p><a href=\"/en-US/docs/Glossary/time_to_first_byte\">Время до первого байта (Time to First Byte)</a> - это время между <code>navigationStart</code> и <code>responseStart</code> (момент, когда получен первый байт от сервера / кеша). Доступно в <code>performanceTiming</code> API</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> ttfb <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>responseStart <span class=\"token operator\">-</span> time<span class=\"token punctuation\">.</span>navigationStart<span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"время_загрузки_страницы","title":"Время загрузки страницы","isH3":true,"content":"<p><a href=\"/en-US/docs/Glossary/Page_load_time\">Время загрузки страницы (Page load time)</a> - это время между <code>navigationStart</code> и моментом, когда событие <code>load</code> отправлено текущему документу. Доступно только в <code>performanceTiming</code> API</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> pageloadtime <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>loadEventStart <span class=\"token operator\">-</span> time<span class=\"token punctuation\">.</span>navigationStart<span class=\"token punctuation\">;</span></code></pre></div>"}},{"type":"prose","value":{"id":"время_поиска_записи_dns","title":"Время поиска записи DNS","isH3":true,"content":"<p>Время поиска записи DNS (DNS lookup) - это время между <code><a href=\"/en-US/docs/Web/API/PerformanceResourceTiming/domainLookupStart\">domainLookupStart</a></code> и <code><a href=\"/en-US/docs/Web/API/PerformanceResourceTiming/domainLookupEnd\">domainLookupEnd</a></code>. Оба эти параметра доступны как в <code>performanceTiming</code>, так и в <code>performanceNavigationTiming</code>.</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> dns  <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>domainLookupEnd <span class=\"token operator\">-</span> time<span class=\"token punctuation\">.</span>domainLookupStart<span class=\"token punctuation\">;</span></code></pre></div>"}},{"type":"prose","value":{"id":"tcp","title":"TCP","isH3":true,"content":"<p>Время установки соединения <a href=\"/en-US/docs/Glossary/TCP\">TCP</a> - это время между началом и окончанием попытки соединения:</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>tcp  <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>connectEnd <span class=\"token operator\">-</span> time<span class=\"token punctuation\">.</span>connectStart<span class=\"token punctuation\">;</span></code></pre></div>"}},{"type":"prose","value":{"id":"установка_безопасного_подключения_ssl_negotiation","title":"Установка безопасного подключения (SSL negotiation)","isH3":true,"content":"<p><code><a href=\"/en-US/docs/Web/API/PerformanceResourceTiming/secureConnectionStart\">secureConnectionStart</a></code> будет равен <code>undefined</code>, если SSL не доступен, <code>0</code> если <a href=\"/en-US/docs/Glossary/https\">https</a> не используется или если временная метка доступна и используется. Другими словами, если безопасное соединение было использовано, то значение<code> secureConnectionStart</code> будет правдиво (<a href=\"/en-US/docs/Glossary/Truthy\">truthy</a>), а время между<code> secureConnectionStart</code> и <code>requestStart</code> будет больше 0.</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>ssl <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>requestStart <span class=\"token operator\">-</span> time<span class=\"token punctuation\">.</span>secureConnectionStart<span class=\"token punctuation\">;</span></code></pre></div>"}},{"type":"prose","value":{"id":"performance_entry_api","title":"Performance Entry API","isH3":false,"content":"<p>Основные показатели производительности, рассмотренные выше, считаются устаревшими, но полностью поддерживаются современными браузерами. Взамен предлагается использовать <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceEntry\"><code>Performance Entry API</code> <small>(en-US)</small></a>, который предоставляет инструмент для пометок и измерений времени одновременно с событиями navigation и загрузкой resource. Вы также можете создавать свои маркеры:</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>performance<span class=\"token punctuation\">.</span><span class=\"token function\">getEntriesByType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'navigation'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">navigation</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">dir</span><span class=\"token punctuation\">(</span>navigation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nperformance<span class=\"token punctuation\">.</span><span class=\"token function\">getEntriesByType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resource'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resource</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">dir</span><span class=\"token punctuation\">(</span>resource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nperformance<span class=\"token punctuation\">.</span><span class=\"token function\">getEntriesByType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mark'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mark</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">dir</span><span class=\"token punctuation\">(</span>mark<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nperformance<span class=\"token punctuation\">.</span><span class=\"token function\">getEntriesByType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"measure\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">measure</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">dir</span><span class=\"token punctuation\">(</span>measure<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nperformance<span class=\"token punctuation\">.</span><span class=\"token function\">getEntriesByType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'paint'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">paint</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">dir</span><span class=\"token punctuation\">(</span>paint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nperformance<span class=\"token punctuation\">.</span><span class=\"token function\">getEntriesByType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'frame'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">frame</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">dir</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n\n<p>В некоторых браузерах вы можете использовать<code> performance.getEntriesByType('paint')</code>, чтобы запросить измерения для  <code>first-paint</code> и <code>first-contentful-paint</code>. Мы используем  <code>performance.getEntriesByType('navigation')</code> и  <code>performance.getEntriesByType('resource')</code> для запроса данных по навигации и загрузки ресурсов, соответственно.</p>"}},{"type":"prose","value":{"id":"navigation","title":"Navigation","isH3":false,"content":"<p>Когда пользователь запрашивает веб-приложение,<a href=\"/en-US/docs/Web/Performance/How_browsers_work\"> браузер должен получить некоторые мета-данные</a>, чтобы начать загрузку. Для этого пользовательский агент проходит серию шагов, такие как поиск записи DNS (<a href=\"/ru/docs/Glossary/DNS\">DNS</a> lookup), TCP рукопожатие <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Glossary/TCP_handshake\">TCP handshake <small>(en-US)</small></a>, и установку безопасного соединения (SSL negotiation). Как только браузер установил соединение, происходит первый полезный запрос данных на сервера. Как только начинают поступать данные от сервера, браузер начинает парсить полученные данные, строит DOM, CSSOM, создаёт деревья рендера (render trees), чтобы в конце концов отрендерить страницу. В тот момент, когда браузер перестаёт парсить входящие данные, документ переходит в интерактивную стадию. Если в документе существуют отложенные к загрузке ресурсы (deferred scripts), которые должны быть обработаны, браузер парсит их. После этого запускается событие <a href=\"/en-US/docs/Web\">DOMContentLoaded</a>, после которого готовность страницы завершена. Теперь документ может обрабатывать пост-загрузочные задачи. После этого документ маркируется, как полностью загруженный.</p>\n\n<pre class=\"notranslate\">let navigationTimings = performance.getEntriesByType('navigation');</pre>\n\n<p>Метод <code>performance.getEntriesByType('navigation')</code> возвращает массив <a href=\"/en-US/docs/Web/API/PerformanceEntry\">PerformanceEntry</a>, в котором содержатся объекты Navigation Timing.</p>\n\n<p><img alt=\"The results of when performance.getEntriesByType('navigation'); is entered into the console for this document\" src=\"https://mdn.mozillademos.org/files/16825/perfgentrybytypenavigation.png\" loading=\"lazy\"></p>\n\n<p>Из этих данных можно многое извлечь. На изображении выше вы видите, что помимо самих таймингов, данные содержат имя документа и некоторую другую полезную информацию.</p>\n\n<pre class=\"notranslate\">let timing = performance.getEntriesByType('navigation')[0];</pre>"}},{"type":"prose","value":{"id":"протокол","title":"Протокол","isH3":true,"content":"<p>Мы можем проверить протокол, который используется дл получения ресурсов:</p>\n\n<pre class=\"notranslate\">let protocol = timing.nextHopProtocol</pre>\n\n<p>В текущем случае в ответ будет <code>h2</code> для <code>http/2</code>.</p>"}},{"type":"prose","value":{"id":"сжатие","title":"Сжатие","isH3":true,"content":"<p>Чтобы узнать, как эффективно сжимаются данные при передаче, мы можем разделить  <code>transferSize</code> на <code>decodedBodySize</code>, а затем вычесть результат из 100%. Для текущей страницы сжатие составляет до 74%.</p>\n\n<pre class=\"notranslate\">let compressionSavings = 1 - (timing.transferSize / timing.decodedBodySize)</pre>\n\n<p>Мы могли бы использовать</p>\n\n<pre class=\"notranslate\">let compressionSavings = 1 - (timing.encodedBodySize / timing.decodedBodySize)</pre>\n\n<p>но <code>transfersize</code> так же включает в себя байты заголовков.</p>\n\n<p>Для сравнение, мы можем посмотреть на вкладку Network, где увидим, что было передано 22.04KB для файла, который в разархивированном виде занимает 87.24KB. </p>\n\n<p><img alt=\"View of the bytes transferred and the size via the network tab\" src=\"https://mdn.mozillademos.org/files/16826/bytesdownloaded.png\" loading=\"lazy\"></p>\n\n<p>Если мы проверим вычисления, то результат получится схожим: <code>1 - (22.04 / 87.24) = 0.747</code>. Тайминги навигации позволяют нам получить такие данные программно.</p>\n\n<p>Обратите внимание, что это данные для одного единственно документа, а не для всех ресурсов вместе взятых. В то же время, длительность загрузки, события-обработчики и тайминги построения DOM / CSSOM влияют на продолжительность загрузки всего приложения, не только одного конкретного ресурса. Клиентские приложения, выполняющиеся в браузере, могут выглядеть быстрее, если данные объёмом 300КБ вы передаёте сжатыми до 100КБ, но это все не значит, что JavaScript, CSS или другие медиа-ресурсы не раздувают приложение и не делают его медленнее. Проверка уровня сжатия - это очень важно, но не менее важно проверять длительность парсинга ресурсов и время между тем, как завершён DOMContentLoaded и DOM готов к работе. Может случиться так, что время парсинга скриптов и обработка скриптами результатов в основном потоке (main thread) приведёт к зависанию интерфейса.</p>"}},{"type":"prose","value":{"id":"время_запроса","title":"Время запроса","isH3":true,"content":"<p>API не предоставляет все измерения, которые разработчик хочет получить. Например, как долго продлилось выполнение запроса? Отдельного поля в объекте данных нет. Однако, мы можем использовать измерения, чтобы вычислить то, что нам нужно.</p>\n\n<p>Чтобы определить время ответа, вычтите время старта запроса из времени старта получения ответа. Запрос стартует ровно в тот момент, когда клиент запрашивает ресурс с сервера (или из кеша). Ответ начинается ровно в тот момент, когда клиент получает первый байт.</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>request <span class=\"token operator\">=</span> timing<span class=\"token punctuation\">.</span>responseStart <span class=\"token operator\">-</span> timing<span class=\"token punctuation\">.</span>requestStart</code></pre></div>"}},{"type":"prose","value":{"id":"длительность_события_загрузки","title":"Длительность события загрузки","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>load <span class=\"token operator\">=</span> timing<span class=\"token punctuation\">.</span>loadEventEnd <span class=\"token operator\">-</span> timing<span class=\"token punctuation\">.</span>loadEventStart </code></pre></div>"}},{"type":"prose","value":{"id":"domcontentloaded_event","title":"DOMContentLoaded event","isH3":true,"content":"<p>Длительность события DOMContentLoaded определяется разностью моментов, когда клиент запускает событие DOMContentLoaded и когда это событие завершено. Старайтесь держать эту величину меньше 50ms - тогда ваш интерфейс будет отзывчивым.</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>DOMContentLoaded <span class=\"token operator\">=</span> timing<span class=\"token punctuation\">.</span>domContentLoadedEventEnd <span class=\"token operator\">-</span> timing<span class=\"token punctuation\">.</span>domContentLoadedEventStart</code></pre></div>"}},{"type":"prose","value":{"id":"длительность_duration","title":"Длительность (Duration)","isH3":true,"content":"<p>В объекте данных есть поле Длительность (<code>Duration</code>). Длительность - это разница между <a href=\"/en-US/docs/Web/API/PerformanceNavigationTiming/loadEventEnd\">PerformanceNavigationTiming.loadEventEnd</a> и <a href=\"/en-US/docs/Web/API/PerformanceEntry/startTime\">PerformanceEntry.startTime</a> properties.</p>\n\n<p>Интерфейс PerformanceNavigationTiming, кроме того, даёт информацию о том, какой тип навигации вы измеряете, возвращая <code>navigate</code>, <code>reload</code>, <code>back_forward</code> или <code>prerender</code>.</p>"}},{"type":"prose","value":{"id":"resource","title":"Resource","isH3":false,"content":"<p>В то время, как тайминги навигации измеряют производительность загрузки и парсинга основного файла HTML, этот файл служит лишь точкой входа для загрузки других ресурсов. Поэтому нам так же важно знать, как быстро загружаются дополнительные ресурсы. Для измерения этих данных нужно использовать Resource Timing. Большая часть измерений в этом объекте похожи: здесь и поиск домена в DNS, и TCP установка соединения и т.д.</p>\n\n<p><img alt=\"Graphic of Resource Timing timestamps\" src=\"https://mdn.mozillademos.org/files/12093/ResourceTiming-TimeStamps.jpg\" loading=\"lazy\"></p>\n\n<p>Для того, чтобы получить эти данные, выполните команду:</p>\n\n<pre class=\"syntaxbox notranslate\"><code>performance.getEntriesByType(\"resource\")</code></pre>"}},{"type":"prose","value":{"id":"смотрите_также","title":"Смотрите также","isH3":false,"content":"<ul>\n <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceNavigationTiming\"><code>PerformanceNavigationTiming</code> <small>(en-US)</small></a></li>\n <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceResourceTiming\"><code>PerformanceResourceTiming</code> <small>(en-US)</small></a>,</li>\n <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceMark\"><code>PerformanceMark</code> <small>(en-US)</small></a></li>\n <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformanceMeasure\"><code>PerformanceMeasure</code> <small>(en-US)</small></a></li>\n <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PerformancePaintTiming\"><code>PerformancePaintTiming</code> <small>(en-US)</small></a></li>\n</ul>"}}],"toc":[{"text":"<strong>Performance Timing</strong> API","id":"performance_timing_api"},{"text":"Performance Entry API","id":"performance_entry_api"},{"text":"Navigation","id":"navigation"},{"text":"Resource","id":"resource"},{"text":"Смотрите также","id":"смотрите_также"}],"summary":"Тайминги навигации (Navigation timings) - это показатели, указывающие временные метки, в которые произошли события навигации. Тайминги ресурсов (Resource timings) - это детальные показатели по времени загрузки ресурсов.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Navigation and resource timings","locale":"en-US","native":"English (US)"}],"source":{"folder":"ru/web/performance/navigation_and_resource_timings","github_url":"https://github.com/mdn/translated-content/blob/main/files/ru/web/performance/navigation_and_resource_timings/index.html","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.html"},"parents":[{"uri":"/ru/docs/Web","title":"Веб-технологии для разработчиков"},{"uri":"/ru/docs/Web/Performance","title":"Web Performance"},{"uri":"/ru/docs/Web/Performance/Navigation_and_resource_timings","title":"Время загрузки страницы и ресурсов"}],"pageTitle":"Время загрузки страницы и ресурсов - Web Performance | MDN","noIndexing":false}}