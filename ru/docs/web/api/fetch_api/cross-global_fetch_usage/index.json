{"doc":{"isMarkdown":false,"isTranslated":true,"isActive":true,"flaws":{},"title":"Cross-global fetch usage","mdn_url":"/ru/docs/Web/API/Fetch_API/Cross-global_fetch_usage","locale":"ru","native":"Русский","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p class=\"summary\">Эта статья объясняет крайний случай, который случается с fetch (и потенциально с другими API, предоставляющими такой же способ получения данных). Когда cross-origin fetch, включающий относительный URL, инициируется из <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/HTML/Element/iframe\"><code>&lt;iframe&gt;</code> <small>(en-US)</small></a>, относительный URL может использовать текущий глобальный location вместо того что задаётся в iframe.</p>"}},{"type":"prose","value":{"id":"крайний_случай","title":"Крайний случай","isH3":false,"content":"<p>Многие сайты никогда не столкнутся с таким поведением. Чтобы увидеть его:</p>\n\n<ul>\n <li>Вам понадобится same-origin iframe</li>\n <li>Этот same-origin iframe должен располагаться с другим base URL</li>\n <li>Вы должны использовать функцию fetch cross-global, т. е. <code>frame.contentWindow.fetch()</code></li>\n <li>Переданный в fetch URL должен быть относительным</li>\n</ul>"}},{"type":"prose","value":{"id":"проблема","title":"Проблема","isH3":false,"content":"<p>В прошлом мы разрешали относительный URL адрес вместо текущего глобального, для примера:</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> absolute <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">URL</span><span class=\"token punctuation\">(</span>relative<span class=\"token punctuation\">,</span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">)</span></code></pre></div>\n\n<p>Это не проблема как таковая. Просто разные API, демонстрирующие такое поведение, делали его несовместимым с поведением, определённым в спецификации, что может привести к проблемам в дальнейшем.</p>"}},{"type":"prose","value":{"id":"решение","title":"Решение","isH3":false,"content":"<p>В Firefox 60 и далее, Mozilla сопоставляет относительный URL с глобальным, которой принадлежит используемой функции <code>fetch()</code> (смотри <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1432272\" class=\"external\" rel=\" noopener\">баг&nbsp;1432272</a>). Таким образом в случае описанном выше, он разрешается в зависимости от расположения iframe:</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> absolute <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">URL</span><span class=\"token punctuation\">(</span>relative<span class=\"token punctuation\">,</span> frame<span class=\"token punctuation\">.</span>contentWindow<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">)</span></code></pre></div>\n\n<p>Ведётся много дискуссий о том, как привести новые спецификации в соответствие с этим изменением поведения, для того чтобы уменьшить возможные проблемы в будущем.</p>"}}],"toc":[{"text":"Крайний случай","id":"крайний_случай"},{"text":"Проблема","id":"проблема"},{"text":"Решение","id":"решение"}],"summary":"Эта статья объясняет крайний случай, который случается с fetch (и потенциально с другими API, предоставляющими такой же способ получения данных). Когда cross-origin fetch, включающий относительный URL, инициируется из <iframe> (en-US), относительный URL может использовать текущий глобальный location вместо того что задаётся в iframe.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Cross-global fetch usage","locale":"en-US","native":"English (US)"},{"title":"グローバル間フェッチの使用","locale":"ja","native":"日本語"},{"title":"Uso de busca Cross-global","locale":"pt-BR","native":"Português (do Brasil)"},{"title":"Cross-global fetch usage","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"ru/web/api/fetch_api/cross-global_fetch_usage","github_url":"https://github.com/mdn/translated-content/blob/main/files/ru/web/api/fetch_api/cross-global_fetch_usage/index.html","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.html"},"parents":[{"uri":"/ru/docs/Web","title":"Веб-технологии для разработчиков"},{"uri":"/ru/docs/Web/API","title":"Интерфейсы веб API"},{"uri":"/ru/docs/Web/API/Fetch_API","title":"Fetch API"},{"uri":"/ru/docs/Web/API/Fetch_API/Cross-global_fetch_usage","title":"Cross-global fetch usage"}],"pageTitle":"Cross-global fetch usage - Интерфейсы веб API | MDN","noIndexing":false}}