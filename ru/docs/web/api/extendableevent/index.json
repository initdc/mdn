{"doc":{"isMarkdown":false,"isTranslated":true,"isActive":true,"flaws":{},"title":"ExtendableEvent","mdn_url":"/ru/docs/Web/API/ExtendableEvent","locale":"ru","native":"Русский","sidebarHTML":"<ol><li><strong><a href=\"/ru/docs/Web/API/Service_Worker_API\">Service Worker API</a></strong></li><li><strong><a href=\"/ru/docs/Web/API/ExtendableEvent\"><code>ExtendableEvent</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Конструктор</summary><ol><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/ExtendableEvent/ExtendableEvent\"><code>ExtendableEvent()</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Методы</summary><ol><li><a href=\"/ru/docs/Web/API/ExtendableEvent/waitUntil\"><code>waitUntil()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Наследование:</summary><ol><li><a href=\"/ru/docs/Web/API/Event\"><code>Event</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Похожие страницы для Service Workers API</summary><ol><li><a href=\"/ru/docs/Web/API/Cache\"><code>Cache</code></a></li><li><a href=\"/ru/docs/Web/API/CacheStorage\"><code>CacheStorage</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Client\"><code>Client</code> <small>(en-US)</small></a></li><li><a href=\"/ru/docs/Web/API/Clients\"><code>Clients</code></a></li><li><a href=\"/ru/docs/Web/API/FetchEvent\"><code>FetchEvent</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/InstallEvent\"><code>InstallEvent</code> <small>(en-US)</small></a></li><li><a href=\"/ru/docs/Web/API/Navigator/serviceWorker\"><code>Navigator.serviceWorker</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/NotificationEvent\"><code>NotificationEvent</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PeriodicSyncEvent\"><code>PeriodicSyncEvent</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PeriodicSyncManager\"><code>PeriodicSyncManager</code> <small>(en-US)</small></a></li><li><a href=\"/ru/docs/Web/API/ServiceWorker\"><code>ServiceWorker</code></a></li><li><a href=\"/ru/docs/Web/API/ServiceWorkerContainer\"><code>ServiceWorkerContainer</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope\"><code>ServiceWorkerGlobalScope</code> <small>(en-US)</small></a></li><li><a href=\"/ru/docs/Web/API/ServiceWorkerRegistration\"><code>ServiceWorkerRegistration</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/SyncEvent\"><code>SyncEvent</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/SyncManager\"><code>SyncManager</code> <small>(en-US)</small></a></li><li><a href=\"/ru/docs/Web/API/WindowClient\"><code>WindowClient</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div id=\"sect1\"></div>\n\n<p>The <strong><code>ExtendableEvent</code></strong> interface extends the lifetime of the <code><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/install_event\">install</a></code> and <code><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/activate_event\">activate</a></code> events dispatched on the global scope as part of the service worker lifecycle. This ensures that any functional events (like <a href=\"/ru/docs/Web/API/FetchEvent\"><code>FetchEvent</code></a>) are not dispatched until it upgrades database schemas and deletes the outdated cache entries.</p>\n\n<p>If <a href=\"/ru/docs/Web/API/ExtendableEvent/waitUntil\" title=\"waitUntil()\"><code>waitUntil()</code></a> is called outside of the <code>ExtendableEvent</code> handler, the browser should throw an <code>InvalidStateError</code>; note also that multiple calls will stack up, and the resulting promises will be added to the list of <a href=\"https://w3c.github.io/ServiceWorker/#extendableevent-extend-lifetime-promises\" class=\"external\" rel=\" noopener\">extend lifetime promises</a>.</p>\n\n<div class=\"note notecard\" id=\"sect2\">\n<p><strong>Note</strong>: The behaviour described in the above paragraph was fixed in Firefox 43 (see <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1180274\" class=\"external\" rel=\" noopener\">баг&nbsp;1180274</a>.)</p>\n</div>\n\n<p>This interface inherits from the <a href=\"/ru/docs/Web/API/Event\"><code>Event</code></a> interface.</p>\n\n<p></p>\n\n<div class=\"note notecard\" id=\"sect3\">\n<p><strong>Note</strong>: This interface is only available when the global scope is a <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope\"><code>ServiceWorkerGlobalScope</code> <small>(en-US)</small></a>. It is not available when it is a <a href=\"/ru/docs/Web/API/Window\"><code>Window</code></a>, or the scope of another kind of worker.</p>\n</div>"}},{"type":"prose","value":{"id":"constructor","title":"Constructor","isH3":false,"content":"<dl>\n <dt id=\"extendableevent_en-us\"><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/ExtendableEvent/ExtendableEvent\"><code>ExtendableEvent()</code> <small>(en-US)</small></a></dt>\n <dd>Creates a new <code>ExtendableEvent</code> object.</dd>\n</dl>"}},{"type":"prose","value":{"id":"properties","title":"Properties","isH3":false,"content":"<p><em>Doesn't implement any specific properties, but inherits properties from its parent, <a href=\"/ru/docs/Web/API/Event\"><code>Event</code></a>.</em></p>"}},{"type":"prose","value":{"id":"methods","title":"Methods","isH3":false,"content":"<p><em>Inherits methods from its parent, </em><em><a href=\"/ru/docs/Web/API/Event\"><code>Event</code></a></em>.</p>\n\n<dl>\n <dt id=\"extendableevent.waituntil\"><a href=\"/ru/docs/Web/API/ExtendableEvent/waitUntil\" title=\"ExtendableEvent.waitUntil()\"><code>ExtendableEvent.waitUntil()</code></a></dt>\n <dd>\n <p>Extends the lifetime of the event.  It is intended to be called in the <code><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/install_event\">install</a></code> <code><a href=\"/ru/docs/Web/Reference/Events/Event_handlers\" title=\"This is a link to an unwritten page\" class=\"page-not-created\">event handler</a></code> for the <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/ServiceWorkerRegistration/installing\"><code>installing</code> <small>(en-US)</small></a> worker and on the <code><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/activate_event\">activate</a></code> <code><a href=\"/ru/docs/Web/Reference/Events/Event_handlers\" title=\"This is a link to an unwritten page\" class=\"page-not-created\">event handler</a></code> for the <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/ServiceWorkerRegistration/active\"><code>active</code> <small>(en-US)</small></a> worker.</p>\n </dd>\n</dl>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<p>This code snippet is from the <a href=\"https://github.com/GoogleChrome/samples/blob/gh-pages/service-worker/prefetch/service-worker.js\" class=\"external\" rel=\" noopener\">service worker prefetch sample</a> (see <a href=\"https://googlechrome.github.io/samples/service-worker/prefetch/\" class=\"external\" rel=\" noopener\">prefetch example live</a>.) The code calls <a href=\"/ru/docs/Web/API/ExtendableEvent/waitUntil\"><code>ExtendableEvent.waitUntil()</code></a> in <a class=\"page-not-created\" title=\"Документация об этом ещё не написана; пожалуйста, поспособствуйте её написанию!\"><code>ServiceWorkerGlobalScope.oninstall</code></a>, delaying treating the <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/ServiceWorkerRegistration/installing\"><code>ServiceWorkerRegistration.installing</code> <small>(en-US)</small></a> worker as installed until the passed promise resolves successfully. The promise resolves when all resources have been fetched and cached, or else when any exception occurs.</p>\n\n<p>The code snippet also shows a best practice for versioning caches used by the service worker. Though there's only one cache in this example, the same approach can be used for multiple caches. It maps a shorthand identifier for a cache to a specific, versioned cache name.</p>\n\n<div class=\"note notecard\" id=\"sect4\">\n<p><strong>Note</strong>: In Chrome, logging statements are visible via the \"Inspect\" interface for the relevant service worker accessed via chrome://serviceworker-internals.</p>\n</div>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> <span class=\"token constant\">CACHE_VERSION</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> <span class=\"token constant\">CURRENT_CACHES</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">prefetch</span><span class=\"token operator\">:</span> <span class=\"token string\">'prefetch-cache-v'</span> <span class=\"token operator\">+</span> <span class=\"token constant\">CACHE_VERSION</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'install'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> urlsToPrefetch <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'./static/pre_fetched.txt'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'./static/pre_fetched.html'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'https://www.chromium.org/_/rsrc/1302286216006/config/customLogo.gif'</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Handling install event. Resources to pre-fetch:'</span><span class=\"token punctuation\">,</span> urlsToPrefetch<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">waitUntil</span><span class=\"token punctuation\">(</span>\n    caches<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CURRENT_CACHES</span><span class=\"token punctuation\">[</span><span class=\"token string\">'prefetch'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cache</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">addAll</span><span class=\"token punctuation\">(</span>urlsToPrefetch<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">urlToPrefetch</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Request</span><span class=\"token punctuation\">(</span>urlToPrefetch<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">mode</span><span class=\"token operator\">:</span> <span class=\"token string\">'no-cors'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'All resources have been fetched and cached.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Pre-fetching failed:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n\n<div class=\"note notecard\" id=\"sect5\"><strong>Important</strong>: When fetching resources, it's very important to use <code>{mode: 'no-cors'}</code> if there is any chance that the resources are served off of a server that doesn't support <a href=\"/ru/docs/Glossary/CORS\">CORS</a>. In this example, <a href=\"https://www.chromium.org\" class=\"external\" rel=\" noopener\">www.chromium.org</a> doesn't support CORS.</div>"}},{"type":"prose","value":{"id":"specifications","title":"Specifications","isH3":false,"content":"<table class=\"standard-table\">\n <tbody>\n  <tr>\n   <th scope=\"col\">Specification</th>\n   <th scope=\"col\">Status</th>\n   <th scope=\"col\">Comment</th>\n  </tr>\n  <tr>\n   <td><a href=\"https://w3c.github.io/ServiceWorker/#extendableevent\" hreflang=\"en\" lang=\"en\" class=\"external\" rel=\" noopener\">Service Workers<br><small lang=\"ru\">Определение 'ExtendableEvent' в этой спецификации.</small></a></td>\n   <td><span class=\"spec-wd\">Рабочий черновик</span></td>\n   <td>Initial definition.</td>\n  </tr>\n </tbody>\n</table>"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.ExtendableEvent","dataURL":"/ru/docs/Web/API/ExtendableEvent/bcd.json"}},{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div id=\"sect6\">\n\n\n<p></p><p></p>\n</div>"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n <li><a href=\"/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers\">Using Service Workers</a></li>\n <li><a class=\"external external-icon\" href=\"https://github.com/mdn/sw-test\" rel=\" noopener\">Service workers basic code example</a></li>\n <li><a class=\"external external-icon\" href=\"https://jakearchibald.github.io/isserviceworkerready/\" rel=\" noopener\">Is ServiceWorker ready?</a></li>\n <li><a href=\"/ru/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a></li>\n <li><a href=\"/en-US/docs/Web/API/Web_Workers_API/Using_web_workers\">Using web workers</a></li>\n</ul>"}}],"toc":[{"text":"Constructor","id":"constructor"},{"text":"Properties","id":"properties"},{"text":"Methods","id":"methods"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The ExtendableEvent interface extends the lifetime of the install and activate events dispatched on the global scope as part of the service worker lifecycle. This ensures that any functional events (like FetchEvent) are not dispatched until it upgrades database schemas and deletes the outdated cache entries.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"ExtendableEvent","locale":"en-US","native":"English (US)"},{"title":"ExtendableEvent","locale":"fr","native":"Français"},{"title":"ExtendableEvent","locale":"ja","native":"日本語"},{"title":"ExtendableEvent","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"ru/web/api/extendableevent","github_url":"https://github.com/mdn/translated-content/blob/main/files/ru/web/api/extendableevent/index.html","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.html"},"parents":[{"uri":"/ru/docs/Web","title":"Веб-технологии для разработчиков"},{"uri":"/ru/docs/Web/API","title":"Интерфейсы веб API"},{"uri":"/ru/docs/Web/API/ExtendableEvent","title":"ExtendableEvent"}],"pageTitle":"ExtendableEvent - Интерфейсы веб API | MDN","noIndexing":false}}