{"doc":{"isMarkdown":false,"isTranslated":true,"isActive":true,"flaws":{},"title":"Интернационализация","mdn_url":"/ru/docs/Mozilla/Add-ons/WebExtensions/Internationalization","locale":"ru","native":"Русский","sidebarHTML":"\n  <ol>\n    <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions\"><strong>Browser extensions</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Getting started</summary>\n        <ol>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\">What are extensions?</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\">Your first extension</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\">Your second extension</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\">Anatomy of an extension</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Examples\">Example extensions</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/What_next_\">What next?</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Concepts</summary>\n        <ol>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\">Using the JavaScript APIs</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\">Content scripts</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">Match patterns</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\">Working with files</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Internationalization\">Internationalization</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\">Content Security Policy</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\">Native messaging</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\">Differences between API implementations</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\">Chrome incompatibilities</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>User interface</summary>\n        <ol>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface\">User Interface</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\">Toolbar button</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\">Address bar button</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\">Sidebars</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\">Context menu items</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\">Options page</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\">Extension pages</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\">Notifications</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\">Address bar suggestions</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\">Developer tools panels</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>How to</summary>\n        <ol>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\">Intercept HTTP requests</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\">Modify a web page</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\">Insert external content</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">Share objects with page scripts</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\">Add a button to the toolbar</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\">Implement a settings page</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\">Work with the Tabs API</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\">Work with the Bookmarks API</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\">Work with the Cookies API</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\">Work with contextual identities</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard\">Interact with the clipboard</a></li>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\">Build a cross-browser extension</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\">Firefox differentiators</a></summary>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>JavaScript APIs</summary>\n        <ol><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\">Browser support for JavaScript APIs</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/API/cookies\">cookies</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/API/downloads\">downloads</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/API/runtime\">runtime</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/API/tabs\">tabs</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\">webRequest</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/API/windows\">windows</a></li></ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n      <summary>Manifest keys</summary>\n        <ol>\n          <li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json\">Introduction</a></li>\n        </ol>\n      <ol><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy\">content_security_policy</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description\">description</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\">permissions</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background\">ключ background</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons\">ключ icons</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version\">ключ manifest_version</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name\">ключ name</a></li><li><a href=\"/ru/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version\">ключ version</a></li></ol>\n      </details>\n    </li>\n     <li class=\"toggle\">\n      <details>\n        <summary>Extension Workshop</summary>\n        <ol>\n          <li><a href=\"https://extensionworkshop.com/documentation/develop/\">Develop</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/publish/\">Publish</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/manage/\">Manage</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/enterprise/\">Enterprise</a></li>\n        </ol>\n      </details>\n    </li>\n    <li><a href=\"/ru/docs/Mozilla/Add-ons/Contact_us\"><strong>Contact us</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Channels</summary>\n        <ol>\n          <li><a href=\"https://blog.mozilla.org/addons\">Add-ons blog</a></li>\n          <li><a href=\"https://discourse.mozilla.org/c/add-ons\">Add-ons forum</a></li>\n          <li><a href=\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\">Add-ons chat</a></li>\n        </ol>\n      </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div id=\"sect1\"></div>\n\n<p>API <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions\">WebExtensions</a> предоставляет полезный модуль для интернационализации расширений — <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n\">i18n</a>. В этой статье мы рассмотрим его особенности и пример его работы. Система для расширений, построенных с помощью API WebExtension, i18n похожа на библиотеки JavaScript для i18n, такие как <a href=\"http://i18njs.com/\" class=\"external\" rel=\" noopener\">i18n.js</a>.</p>\n\n<div class=\"note notecard\" id=\"sect2\">\n<p>Расширение, используемое в этой статье в качестве примера, — <a href=\"https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n\" class=\"external\" rel=\" noopener\">notify-link-clicks-i18n</a> — доступно на GitHub. Читая последующие секции этой статьи, вы можете исследовать его исходный код.</p>\n</div>"}},{"type":"prose","value":{"id":"структура_интернализированного_расширения","title":"Структура интернализированного расширения","isH3":false,"content":"<p>Интернационализированное расширение может содержать такие же элементы, как и любое другое расширение — <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#background_scripts\">фоновые скрипты</a>, <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\">встраиваемые скрипты</a>, и т. д. — а также дополнительные инструменты, позволяющие переключаться между разными локализациями. Их можно представить следующим деревом директорий:</p>\n\n<ul>\n <li>корневая-директория-расширения/\n  <ul>\n   <li>_locales\n    <ul>\n     <li>en\n      <ul>\n       <li>messages.json\n        <ul>\n         <li>Сообщения на английском (строки)</li>\n        </ul>\n       </li>\n      </ul>\n     </li>\n     <li>de\n      <ul>\n       <li>messages.json\n        <ul>\n         <li>Сообщения на немецком (строки)</li>\n        </ul>\n       </li>\n      </ul>\n     </li>\n     <li>и т. д.</li>\n    </ul>\n   </li>\n   <li>manifest.json\n    <ul>\n     <li>Метаданные, зависящие от локализации</li>\n    </ul>\n   </li>\n   <li>myJavascript.js\n    <ul>\n     <li>Файл JavaScript, получающий локализацию браузера, сообщения, зависящие от локализации, и т. д.</li>\n    </ul>\n   </li>\n   <li>myStyles.css\n    <ul>\n     <li>CSS, зависящий от локализации</li>\n    </ul>\n   </li>\n  </ul>\n </li>\n</ul>\n\n<p>Давайте отдельно рассмотрим каждый элемент — последующие секции представляют собой шаги, которым стоит следовать во время интернационализации вашего расширения.</p>"}},{"type":"prose","value":{"id":"добавление_локализованных_строк_в__locales","title":"Добавление локализованных строк в _locales","isH3":false,"content":"<div class=\"pull-aside\" id=\"sect3\">\n<div class=\"moreinfo\" id=\"sect4\">Вы можете определить тэг языка при помощи инструмента <em>Find</em>  на <a href=\"https://r12a.github.io/app-subtags/\" class=\"external\" rel=\" noopener\">странице определения языковых тегов</a>. Обратите внимание на то, что при поиске нужно использовать английское название языка</div>\n</div>\n\n<p>Каждая система i18n требует предоставить строки во всех локализациях, которые вы хотите поддерживать. В расширениях они хранятся в директории  <code>_locales</code>, размещённой внутри корневой директории. Строки каждой локализации (также называемые сообщениями) хранятся в файле <code>messages.json</code>, находящемся в поддиректории <code>_locales</code>, название которой - тег языка локализации.</p>\n\n<p>Стоит заметить, что если тег включает в себя и базовый язык, и его региональный вариант, то по конвенции эти язык и вариант разделяются дефисом: например, \"en-US\". Однако в поддиректориях <code>_locales</code>, <strong>вместо дефиса используется нижнее подчёркивание</strong>: \"en_US\".</p>\n\n<p>Таким образом, <a href=\"https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n/_locales\" class=\"external\" rel=\" noopener\">в нашем примере</a> существую директории \"en\" (английский), \"de\" (немецкий), \"nl\" (голландский), and \"ja\" (японский). Внутри каждой из них находится файл <code>messages.json</code> .</p>\n\n<p>Давайте рассмотрим структуру одного из этих файлов (<a href=\"https://github.com/mdn/webextensions-examples/blob/master/notify-link-clicks-i18n/_locales/en/messages.json\" class=\"external\" rel=\" noopener\">_locales/en/messages.json</a>):</p>\n\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"extensionName\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Notify link clicks i18n\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Name of the extension.\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"extensionDescription\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Shows a notification when the user clicks on links.\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Description of the extension.\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"notificationTitle\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Click notification\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Title of the click notification.\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"notificationContent\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"You clicked $URL$.\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Tells the user which link they clicked.\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"placeholders\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"url\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"content\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"$1\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"example\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://developer.mozilla.org\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n\n<p>Это стандартный файл JSON — каждый из его элементов является объектом с именем, содержащим сообщение (<code>message)</code> и описание (<code>description)</code>. Оба предмета - строки; <code>$URL$</code> — это заполнитель, который заменяется подстрокой, когда элемент <code>notificationContent</code> вызывается расширением. Вы научитесь это делать в секции <a href=\"#получение_сообщений_из_javascript\">Получение сообщений из JavaScript</a>.</p>\n\n<div class=\"note notecard\" id=\"sect5\">\n<p><strong>Примечание</strong>: вы можете найти больше информации о структуре <code>messages.json</code> <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n/Locale-Specific_Message_reference\">здесь</a>.</p>\n</div>"}},{"type":"prose","value":{"id":"интернационализация_manifest.json","title":"Интернационализация manifest.json","isH3":false,"content":"<p>Для интернационализации файла manifest.json нужно предпринять несколько шагов.</p>"}},{"type":"prose","value":{"id":"получение_локализованных_строк_в_манифестах","title":"Получение локализованных строк в манифестах","isH3":true,"content":"<p>Ваш файл <a href=\"https://github.com/mdn/webextensions-examples/blob/master/notify-link-clicks-i18n/manifest.json\" class=\"external\" rel=\" noopener\">manifest.json</a> содержит строки, отображаемые пользователю, такие как имя и описание расширения. Если вы интернационализируете эти строки и поместите их переводы в messages.json, то эти переводы будут отображаться пользователю в зависимости от локализации его браузера.</p>\n\n<p>Чтобы интернационализировать строки, их нужно указывать следующим образом:</p>\n\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"__MSG_extensionName__\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"__MSG_extensionDescription__\"</span><span class=\"token punctuation\">,</span></code></pre></div>\n\n<p>Здесь мы получаем сообщения, зависящие от локализации браузера, а не просто статические строки.</p>\n\n<p>Чтобы получить строку сообщения, её нужно указать следующим образом:</p>\n\n<ol>\n <li>Два подчёркивания</li>\n <li>Строка \"MSG\"</li>\n <li>Одно подчёркивание</li>\n <li>Имя сообщения так как оно указано в <code>messages.json</code></li>\n <li>Два подчёркивания</li>\n</ol>\n\n<pre class=\"notranslate\"><strong>__MSG_</strong> + <em>messageName</em> + <strong>__</strong></pre>"}},{"type":"prose","value":{"id":"локализация_по_умолчанию","title":"Локализация по умолчанию","isH3":true,"content":"<p>Ещё одно поле. которое нужно указать в manifest.json — это <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale\">default_locale</a>:</p>\n\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token property\">\"default_locale\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"en\"</span></code></pre></div>\n\n<p>Этот параметр устанавливает локализацию по умолчанию, используемую, если расширение не поддерживает локализацию браузера пользователя. Любые сообщения, недоступные в текущей локализации, будут браться из той локализации, которая установлена по умолчанию. There are some more details to be aware of in terms of how the browser selects strings — see <a href=\"#выбор_локализованной_строки\">Выбор локализованной строки</a>.</p>"}},{"type":"prose","value":{"id":"css_зависящий_от_локализации","title":"CSS, зависящий от локализации","isH3":false,"content":"<p>Локализованные строки также можно получить из CSS-файлов расширения. Например, вы можете создать поля CSS, зависящие от локализации, так:</p>\n\n<div class=\"code-example\"><pre class=\"brush: css notranslate\"><code><span class=\"token selector\">header</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>../images/__MSG_extensionName__/header.png<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n\n<p>Эта функциональность может быть полезна, однако, возможно, для этих целей стоит использовать <a href=\"#заранее_определённые_сообщения\">Заранее определённые сообщения</a>.</p>"}},{"type":"prose","value":{"id":"получение_сообщений_из_javascript","title":"Получение сообщений из JavaScript","isH3":false,"content":"<p>Допустим, вы добавили сообщения в ваш manifest.json. Чтобы ваше расширение начало использовать правильные языки, соответствующие сообщения следует вызывать при помощи JavaScript. <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n\">API i18n</a> достаточно прост и содержит всего 4 основных метода:</p>\n\n<ul>\n <li>Скорее всего, наиболее часто вы будете использовать <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getMessage\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">i18n.getMessage() (en-US)</a> — этот метод используется для получения конкретного сообщения. Примеры его использования можно увидеть ниже.</li>\n <li>Методы <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getAcceptLanguages\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">i18n.getAcceptLanguages() (en-US)</a> и <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getUILanguage\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">i18n.getUILanguage() (en-US)</a> используются, если UI надо менять в зависимости от локализации — например, если вы хотите, чтобы предпочтения, свойственные носителям какого-либо языка, находились выше в списке, или чтобы формат дат соответствовал локализации браузера.</li>\n <li>Метод <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n/detectLanguage\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">i18n.detectLanguage() (en-US)</a> используется для получения языка информации, введённой пользователем, и её форматирования.</li>\n</ul>\n\n<p>В нашем примере <a href=\"https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n\" class=\"external\" rel=\" noopener\">notify-link-clicks-i18n</a> , <a href=\"https://github.com/mdn/webextensions-examples/blob/master/notify-link-clicks-i18n/background-script.js\" class=\"external\" rel=\" noopener\">фоновый скрипт</a> содержит следующие строки:</p>\n\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> title <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>i18n<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"notificationTitle\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> content <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>i18n<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"notificationContent\"</span><span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n\n<p>Первая из них получает поле <code>notificationTitle message</code> из доступного файла <code>messages.json</code>, соответствующее наиболее подходящей локализации . Вторая строка похожа на первую, но в ней метод принимает URL в качестве второго параметра. Зачем? С помощью этого параметра мы указываем, на что нужно заменить заполнитель <code>$URL$</code> в поле <code>notificationContent message</code>:</p>\n\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token property\">\"notificationContent\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"You clicked $URL$.\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Tells the user which link they clicked.\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"placeholders\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"url\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"content\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"$1\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"example\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"https://developer.mozilla.org\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n\n<p>Объект <code>\"placeholders\"</code>  определяет все заполнители и то, откуда их нужно получать. Заполнитель <code>\"url\"</code> указывает, что информация о нем должна содержаться в $1 — первое значение, заданное внутри второго параметра <code>getMessage()</code>. Поскольку заполнитель называется <code>\"url\"</code>,  <code>$URL$</code> используется для его вызова внутри сообщения (то есть для заполнителя <code>\"name\"</code> нужно использовать <code>$NAME$</code>, и т. д.). Если вы хотите задать значения нескольких заполнителей, их можно передавать во второй аргумент <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getMessage\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">i18n.getMessage() (en-US)</a> в виде массива — массив <code>[a, b, c]</code> передаёт значения <code>$1</code>, <code>$2</code> и <code>$3</code>, и т. д. внутрь <code>messages.json</code>.</p>\n\n<p>Давайте посмотрим на пример: изначально сообщение <code>notificationContent</code> в файле <code>en/messages.json</code> такое:</p>\n\n<pre class=\"notranslate\">You clicked $URL$.</pre>\n\n<p>Пусть эта ссылка указывает на <code>https://developer.mozilla.org</code>. После вызова <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getMessage\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">i18n.getMessage() (en-US)</a>, содержание второго параметра становится доступно в messages.json в качестве значения <code>$1</code>, замещающего <code>$URL$</code>, так как это указано в заполнителе  <code>\"url\"</code>. Таким образом, итоговое значение строки:</p>\n\n<pre class=\"notranslate\">You clicked https://developer.mozilla.org.</pre>"}},{"type":"prose","value":{"id":"прямое_использование_заполнителей","title":"Прямое использование заполнителей","isH3":true,"content":"<p>Переменные (<code>$1</code>, <code>$2</code>, <code>$3</code>, и т. д.) можно вставлять напрямую в сообщения. Например, можно переписать объект <code>\"notificationContent\"</code> следующим образом:</p>\n\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token property\">\"notificationContent\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"You clicked $1.\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Tells the user which link they clicked.\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n\n<p>Этот метод может показаться более быстрым и простым, но другой способ (использование <code>\"placeholders\"</code>) считается лучшей практикой. Это вызвано тем, что имена заполнителей (например <code>\"url\"</code>) и примеры помогают понять, что означают заполнители — через неделю после написания кода Вы, наверное, забудете, что обозначают заполнители <code>$1</code>–<code>$8</code>, что менее вероятно, если заполнители именованы.</p>"}},{"type":"prose","value":{"id":"заданные_замены","title":"Заданные замены","isH3":true,"content":"<p>Значения заполнителей можно задавать вручную, если вы хотите, чтобы каждый раз это значение было одним и тем же, а не определялось переменной в коде. Например:</p>\n\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token property\">\"mdn_banner\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"For more information on web technologies, go to $MDN$.\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Tell the user about MDN\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"placeholders\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"mdn\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"content\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://developer.mozilla.org/\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n\n<p>В этом примере мы сами задаём значение заполнителя, а не получаем его из переменной, такой как <code>$1</code>. Это может быть полезно, если сообщение очень сложное, и вы хотите разделить значения, чтобы сделать строки более читаемыми. К тому же, доступ к этим значениям можно получить внутри программы.</p>\n\n<p>Вы также можете использовать такие замены для указания частей строки, не нуждающихся в переводе, таких как имена или названия.</p>"}},{"type":"prose","value":{"id":"выбор_локализованной_строки","title":"Выбор локализованной строки","isH3":false,"content":"<p>Локализации могут быть указаны с помощью кода языка, например <code>fr</code> или <code>en</code>. Они также могут содержать региональный код, например <code>en_US</code> или <code>en_GB</code>, описывающий региональный вариант языка. Когда вы запрашиваете строку у системы i18n, системы возвращает её используя следующий алгоритм:</p>\n\n<ol>\n <li>Если для текущей локализации существует файл <code>messages.json</code>, содержащий требуемую строку, возвращается она.</li>\n <li>Иначе,если текущая локализация — региональный вариант (например <code>en_US</code>) и существует файл <code>messages.json</code> для этого языка, но без указания региона  (например <code>en</code>), содержащий строку, возвращается она.</li>\n <li>Иначе, если существует файл <code>messages.json</code> для <code>default_locale</code>, указанной в <code>manifest.json</code>, и этот файл содержит нужную строку, возвращается она.</li>\n <li>В противном случае возвращается пустая строка.</li>\n</ol>\n\n<p>Рассмотрим следующий пример:</p>\n\n<ul>\n <li>корневая-директория-расширения/\n  <ul>\n   <li>_locales\n    <ul>\n     <li>en_GB\n      <ul>\n       <li>messages.json\n        <ul>\n         <li><code>{ \"colorLocalised\": { \"message\": \"colour\", \"description\": \"Color.\" }, ... }</code></li>\n        </ul>\n       </li>\n      </ul>\n      en\n\n      <ul>\n       <li>messages.json\n        <ul>\n         <li><code>{ \"colorLocalised\": { \"message\": \"color\", \"description\": \"Color.\" }, ... }</code></li>\n        </ul>\n       </li>\n      </ul>\n     </li>\n     <li>fr\n      <ul>\n       <li>messages.json\n        <ul>\n         <li><code>{ \"colorLocalised\": { \"message\": \"couleur\", \"description\": \"Color.\" }, ...}</code></li>\n        </ul>\n       </li>\n      </ul>\n     </li>\n    </ul>\n   </li>\n  </ul>\n </li>\n</ul>\n\n<p>Пусть <code>default_locale</code> установлен как <code>fr</code>, а текущая локализация браузера — <code>en_GB</code>:</p>\n\n<ul>\n <li>Вызов <code>getMessage(\"colorLocalised\")</code> вернёт \"colour\".</li>\n <li>Если бы в <code>en_GB</code> не было \"colorLocalized\", то вызов <code>getMessage(\"colorLocalised\")</code>, вернул бы \"color\", а не \"couleur\".</li>\n</ul>"}},{"type":"prose","value":{"id":"заранее_определённые_сообщения","title":"Заранее определённые сообщения","isH3":false,"content":"<p>Модуль i18n module предоставляет заранее определённые сообщения, которые можно вызвать таким же образом, как мы это делали в разделе <a href=\"#интернационализация_manifest.json\">Интернационализация manifest.json</a>. Например:</p>\n\n<pre class=\"notranslate\">__MSG_extensionName__</pre>\n\n<p>Заранее определённые сообщения используют такой же синтаксис, за исключением <code>@@</code> перед именем сообщения, например:</p>\n\n<pre class=\"notranslate\">__MSG_@@ui_locale__</pre>\n\n<p>Следующая таблица содержит различные заранее определённые сообщения:</p>\n\n<table class=\"standard-table\">\n <thead>\n  <tr>\n   <th scope=\"col\">Message name</th>\n   <th scope=\"col\">Description</th>\n  </tr>\n </thead>\n <tbody>\n  <tr>\n   <td><code>@@extension_id</code></td>\n   <td>\n    <p>Внутренний UUID расширения. Эту строку можно использовать для создания URL ресурсов внутри расширения.Даже нелокализованные расширения могут использовать это сообщения.</p>\n\n    <p>Это сообщения нельзя использовать в manifest.json.</p>\n\n    <p>Также стоит заметить, что этот ID — <em>не</em> ID аддона, которое возвращает <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/id\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">runtime.id (en-US)</a>, и которое может быть установлено с помощью ключа <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\">applications</a> в manifest.json. Это сгенерированный UUID, содержащийся в URL аддона. Это означает, что данную величину нельзя использовать в качестве параметра <code>extensionId</code>  метода <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">runtime.sendMessage() (en-US)</a>, или для проверки поля <code>id</code> объекта <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/MessageSender\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">runtime.MessageSender (en-US)</a>.</p>\n   </td>\n  </tr>\n  <tr>\n   <td><code>@@ui_locale</code></td>\n   <td>Текущая локализация; эту строку можно использовать для создания URL, зависящих от локализации.</td>\n  </tr>\n  <tr>\n   <td><code>@@bidi_dir</code></td>\n   <td>Направления чтения, либо \"ltr\" для языков, таких как английский, где текст читается слева направо, либо \"rtl\" для языков, считающихся справа налево, таких как арабский.</td>\n  </tr>\n  <tr>\n   <td><code>@@bidi_reversed_dir</code></td>\n   <td>Если <code>@@bidi_dir</code> имеет значение \"ltr\", то возвращает \"rtl\"; иначе \"ltr\".</td>\n  </tr>\n  <tr>\n   <td><code>@@bidi_start_edge</code></td>\n   <td>Если <code>@@bidi_dir</code> имеет значение \"ltr\", то возвращает \"left\"; иначе \"right\".</td>\n  </tr>\n  <tr>\n   <td><code>@@bidi_end_edge</code></td>\n   <td>Если <code>@@bidi_dir</code> имеет значение \"ltr\", то возвращает \"right\"; иначе \"left\".</td>\n  </tr>\n </tbody>\n</table>\n\n<p>Возвращаясь к нашему примеру, лучше было бы написать:</p>\n\n<div class=\"code-example\"><pre class=\"brush: css notranslate\"><code><span class=\"token selector\">header</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>../images/__MSG_@@ui_locale__/header.png<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n\n<p>Теперь мы можем хранить изображения в директориях поддерживаемых локализаций — en, de, и т. д. — что выглядит логичней.</p>\n\n<p>Давайте рассмотрим пример использования сообщений <code>@@bidi_*</code> в файле CSS:</p>\n\n<div class=\"code-example\"><pre class=\"brush: css notranslate\"><code><span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">direction</span><span class=\"token punctuation\">:</span> __MSG_@<span class=\"token atrule\"><span class=\"token rule\">@bidi_dir__</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">div#header</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span> 1.05em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">padding-bottom</span><span class=\"token punctuation\">:</span> 1.5em<span class=\"token punctuation\">;</span>\n  padding-__MSG_@<span class=\"token atrule\"><span class=\"token rule\">@bidi_start_edge__</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span></span>\n  padding-__MSG_@<span class=\"token atrule\"><span class=\"token rule\">@bidi_end_edge__</span><span class=\"token punctuation\">:</span> 1.5em<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n\n<p>Для языков, в которых текст читается слева направо, таких как английский, правила CSS, использующие заранее определённые сообщения, сверху задают такие значения:</p>\n\n<div class=\"code-example\"><pre class=\"brush: css notranslate\"><code><span class=\"token property\">direction</span><span class=\"token punctuation\">:</span> ltr<span class=\"token punctuation\">;</span>\n<span class=\"token property\">padding-left</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\n<span class=\"token property\">padding-right</span><span class=\"token punctuation\">:</span> 1.5em<span class=\"token punctuation\">;</span>\n</code></pre></div>\n\n<p>Для языков, читающихся справа налево, значения будут следующими:</p>\n\n<div class=\"code-example\"><pre class=\"brush: css notranslate\"><code><span class=\"token property\">direction</span><span class=\"token punctuation\">:</span> rtl<span class=\"token punctuation\">;</span>\n<span class=\"token property\">padding-right</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\n<span class=\"token property\">padding-left</span><span class=\"token punctuation\">:</span> 1.5em<span class=\"token punctuation\">;</span></code></pre></div>"}},{"type":"prose","value":{"id":"тестирование_расширения","title":"Тестирование расширения","isH3":false,"content":"<p>Начиная с Firefox 45, расширения могут быть временно установлены с диска — подробнее об этом написано в статье <a href=\"/en-US/Add-ons/WebExtensions/Packaging_and_installation#Loading_from_disk\">Loading from disk</a>. Сделайте это и попробуйте протестировать наше расширение <a href=\"https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n\" class=\"external\" rel=\" noopener\">notify-link-clicks-i18n</a>. Перейдите на одну из ваших любимых страниц и нажмите на ссылку, чтобы проверить, появляется ли сообщения, содержащее URL нажатой ссылки.</p>\n\n<p>Затем измените локализацию Firefox на какую-либо поддерживающуюся расширением, которое вы хотите протестировать.</p>\n\n<ol>\n <li>Откройте \"about:config\" в Firefox, и найдите параметр <code>intl.locale.requested</code> (обратите внимание на версию Firefox: в версиях до Firefox 59 этот параметр называется <code>general.useragent.locale</code>).</li>\n <li>Если параметр существует, нажмите на него дважды (или нажмите Return/Enter), чтобы выбрать его, введите языковой код локализации, которую вы хотите протестировать и нажмите \"OK\" (или Return/Enter). Например, в нашем примере расширение поддерживает \"en\" (английский), \"de\" (немецкий), \"nl\" (голландский), and \"ja\" (японский). Вы также можете указать пустую строку (<code>\"\"</code>) в качестве значения. В этом случае браузер выберет язык вашей ОС по умолчанию.</li>\n <li>Если параметр <code>intl.locale.requested</code> не существует, нажмите правой кнопкой мыши на список параметров (или откройте контекстное меню при помощи клавиатуры), и выберите \"New\", а затем \"String\". Введите <code>intl.locale.requested</code> как имя настройки и, \"de\", \"nl\", и т. д. как значение, как это описано в шаге 2.</li>\n <li>Найдите <code>intl.locale.matchOS</code> и, если параметр существует и равен <code>true</code>, дважды нажмите на него и установите на <code>false</code>.</li>\n <li>Перезапустите браузер, чтобы изменения вступили в силу.</li>\n</ol>\n\n<div class=\"note notecard\" id=\"sect6\">\n<p><strong>Примечание</strong>: Этот метод работает, даже если у вас не установлен <a href=\"https://addons.mozilla.org/en-US/firefox/language-tools/\" class=\"external\" rel=\" noopener\">языковой пакет</a> для выбранного языка. В этом случае UI браузера просто будет использовать ваш язык по умолчанию.</p>\n</div>\n\n<ol>\n</ol>\n\n<div class=\"note notecard\" id=\"sect7\">\n<p><strong>Примечание:</strong> Чтобы изменить результат <code>getUILanguage</code> требуется языковой пакет, поскольку он отражает язык UI браузера, а не язык сообщений расширения.</p>\n</div>\n\n<p>Ещё раз загрузите расширение с диска и протестируйте локализацию:</p>\n\n<ul>\n <li>Ещё раз откройте \"about:addons\" — теперь вы должны увидеть ваше расширение, его иконку, имя и описание на выбранном языке.</li>\n <li>Ещё раз протестируйте расширение. Для нашего примера, вам следовало бы посетить другую страницу и, нажав на ссылку, проверить, появляется ли сообщение на нужном языке.</li>\n</ul>\n\n<p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/R7--fp5pPGg\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\" loading=\"lazy\"></iframe></p>"}}],"toc":[{"text":"Структура интернализированного расширения","id":"структура_интернализированного_расширения"},{"text":"Добавление локализованных строк в _locales","id":"добавление_локализованных_строк_в__locales"},{"text":"Интернационализация manifest.json","id":"интернационализация_manifest.json"},{"text":"CSS, зависящий от локализации","id":"css_зависящий_от_локализации"},{"text":"Получение сообщений из JavaScript","id":"получение_сообщений_из_javascript"},{"text":"Выбор локализованной строки","id":"выбор_локализованной_строки"},{"text":"Заранее определённые сообщения","id":"заранее_определённые_сообщения"},{"text":"Тестирование расширения","id":"тестирование_расширения"}],"summary":"API WebExtensions предоставляет полезный модуль для интернационализации расширений — i18n. В этой статье мы рассмотрим его особенности и пример его работы. Система для расширений, построенных с помощью API WebExtension, i18n похожа на библиотеки JavaScript для i18n, такие как i18n.js.","popularity":0.0002,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Internationalization","locale":"en-US","native":"English (US)"},{"title":"Internationalization","locale":"fr","native":"Français"},{"title":"国際化","locale":"ja","native":"日本語"},{"title":"国际化","locale":"zh-CN","native":"中文 (简体)"},{"title":"Internationalization","locale":"zh-TW","native":"正體中文 (繁體)"}],"source":{"folder":"ru/mozilla/add-ons/webextensions/internationalization","github_url":"https://github.com/mdn/translated-content/blob/main/files/ru/mozilla/add-ons/webextensions/internationalization/index.html","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.html"},"parents":[{"uri":"/ru/docs/Mozilla","title":"Mozilla"},{"uri":"/ru/docs/Mozilla/Add-ons","title":"Дополнения"},{"uri":"/ru/docs/Mozilla/Add-ons/WebExtensions","title":"Расширения браузера"},{"uri":"/ru/docs/Mozilla/Add-ons/WebExtensions/Internationalization","title":"Интернационализация"}],"pageTitle":"Интернационализация - Mozilla | MDN","noIndexing":false}}