{"doc":{"isMarkdown":false,"isTranslated":true,"isActive":true,"flaws":{},"title":"базовый ray-caster","mdn_url":"/ru/docs/orphaned/Web/API/Canvas_API/A_basic_ray-caster","locale":"ru","native":"Русский","sidebarHTML":"\n <ol>\n  <li><a href=\"/ru/docs/Web/API/Canvas_API\"><strong>Canvas API</strong></a></li>\n  <li class=\"toggle\">\n    <details open=\"\">\n      <summary>Руководство по Canvas</summary>\n      <ol>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Basic_usage\">Базовое использование</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Drawing_shapes\">Рисование фигур</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Applying_styles_and_colors\">Применение стилей и цветов</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Drawing_text\">Рисование текста</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Using_images\">Использование изображений</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Transformations\">Трансформации</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Compositing\">Композиция и обрезка</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Basic_animations\">Простые анимации</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Advanced_animations\">Расширенные анимации</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Pixel_manipulation_with_canvas\">Манипуляция пикселями</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Optimizing_canvas\">Оптимизация canvas</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Tutorial/Finale\">Заключение</a></li>\n        </ol>\n    </details>\n  </li>\n  <li class=\"toggle\">\n    <details open=\"\">\n      <summary>Примеры</summary>\n      <ol>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/A_basic_ray-caster\">Простой излучатель лучей</a></li>\n        <li><a href=\"/ru/docs/Web/API/Canvas_API/Manipulating_video_using_canvas\">Манипяция видео с помощью canvas</a></li>\n      </ol>\n    </details>\n  </li>\n  <li class=\"toggle\">\n    <details open=\"\">\n      <summary>Интерфейсы</summary>\n      <ol>\n        <li><a href=\"/ru/docs/Web/API/HTMLCanvasElement\"><code>HTMLCanvasElement</code></a></li>\n        <li><a href=\"/ru/docs/Web/API/CanvasRenderingContext2D\"><code>CanvasRenderingContext2D</code></a></li>\n        <li><a href=\"/ru/docs/Web/API/CanvasGradient\"><code>CanvasGradient</code></a></li>\n        <li><a href=\"/ru/docs/Web/API/CanvasPattern\"><code>CanvasPattern</code></a></li>\n        <li><a href=\"/ru/docs/Web/API/ImageBitmap\"><code>ImageBitmap</code></a></li>\n        <li><a href=\"/ru/docs/Web/API/ImageData\"><code>ImageData</code></a></li>\n        <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/TextMetrics\"><code>TextMetrics</code> <small>(en-US)</small></a></li>\n        <li><svg class=\"icon icon-experimental\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-experimental\"></use>\n</svg> <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Path2D\"><code>Path2D</code> <small>(en-US)</small></a></li>\n      </ol>\n    </details>\n  </li>\n  <li><strong><a href=\"/ru/docs/MDN\">Документация:</a></strong></li>\n  <li class=\"toggle\">\n    <details>\n      <summary>Внести свой вклад</summary>\n      <ol>\n        <li><a href=\"/ru/docs/MDN\">Проект MDN</a></li>\n      </ol>\n    </details>\n  </li>\n </ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p></p><p></p>\n\n<p>В этой статье представлен интересный реальный пример использования элемента <a href=\"/ru/docs/Web/HTML/Element/canvas\"><code>&lt;canvas&gt;</code></a> для выполнения программного рендеринга 3D-среды с помощью Ray-casting.</p>\n\n<p><iframe width=\"900\" height=\"300\" src=\"https://mdn.github.io/canvas-raycaster/index.html\" loading=\"lazy\"></iframe></p>\n\n<p><strong><a href=\"https://mdn.github.io/canvas-raycaster/\" class=\"external\" rel=\" noopener\">Открыть в новом окне</a></strong></p>"}},{"type":"prose","value":{"id":"why.3f","title":"Зачем?","isH3":false,"content":"<p>Я попробовал небольшой эксперимент, понимая, к моему восторгу, что стильный элемент <code>&lt;canvas&gt;</code> о котором я <a href=\"https://www.whatwg.org/specs/web-apps/current-work/#dynamic\" class=\"external\" rel=\" noopener\">читал</a>, поддерживается не только в Fierfox, но так же поддерживается последней версией Safari.</p>\n\n<p>Хорошие <a href=\"/en-US/docs/Web/API/Canvas_API\">обзор</a> и <a href=\"/en-US/docs/Web/API/Canvas_API/Tutorial\">руководство</a> по canvas я нашёл в MDN, но никто ещё не писал об анимации, поэтому я решил попробовать базовый порт raycaster, над которым я работал некоторое время назад, и посмотреть, какую производительность мы можем ожидать от управляемого JavaScript-ом пиксельного буфера.</p>"}},{"type":"prose","value":{"id":"how.3f","title":"Как?","isH3":false,"content":"<p>Основная идея заключается в использовании <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/setInterval\"><code>setInterval()</code> <small>(en-US)</small></a> с некоторой произвольной задержкой, соответствующей требуемой частоте кадров. После каждого интервала функция обновления будет перерисовывать холст, и отображать текущий вид. Я знаю, что мог бы начать с более простого примера, но я уверен, что руководство canvas <a href=\"/en-US/docs/Web/API/Canvas_API/Tutorial/Basic_animations\">доберётся до этого</a>, и я хотел посмотреть, смогу ли я это сделать.</p>\n\n<p>Таким образом каждое обновление raycaster смотрит нажимали ли вы какие либо клавиши в последнее время, сохраняет расчёты и останавливается если вы бездействуете. Получив расчёты, холст очищается, земля и небо рисуются, положение камеры и/или ориентация обновляются, а лучи отбрасываются. Когда лучи попадают на стены, они отображают вертикальный кусок холста в цвете стены, на которую они попали, смешанный с более тёмной версией цвета в зависимости от расстояния до стены. Высота этого кусочка также моделируется расстоянием от камеры до стены и рисуется по центру линии горизонта.</p>\n\n<p>Код, который я получил, - это смесь глав raycaster из старой книги Андре Ламотетрикса о гуру программирования игр (ISBN: 0672305070) и  <a class=\"external\" href=\"http://www.shinelife.co.uk/java-maze/\" rel=\" noopener\">java raycaster</a>, которую я нашёл в интернете, отфильтровал, переименовал, и внёс все изменения, которые нужно было внести, чтобы все работало хорошо.</p>"}},{"type":"prose","value":{"id":"results","title":"Результаты","isH3":false,"content":"<p>Холст в Safari 2.0.1 выполнен на удивление хорошо. С коэффициентом блочности, увеличенным до отображения кусочка шириной 8 пикселей, я могу запустить окно 320 x 240 при 24 fps на моем Apple mini. Firefox 1.5 Beta 1 ещё быстрее; я могу запускать 320 x 240 при 24 fps с 4 пиксельным кусочком. Не совсем новый член семейства программного обеспечения ID, но довольно приличный, учитывая, что это полностью интерпретируемая среда, и мне не нужно было беспокоиться о выделении памяти или видеорежимах или кодировании внутренних процедур в ассемблере или чем-то ещё. Код получился очень эффективным, он использует поиск по массиву предварительно вычисленных значений, но я не гуру оптимизации, поэтому все, вероятно, можно было бы написать быстрее.</p>\n\n<p>Кроме того, он оставляет желать лучшего с точки зрения попыток быть игровым движком—нет текстур стен, нет спрайтов, нет дверей, даже нет телепортов, чтобы добраться до другого уровня. Но я уверен, что все эти вещи могут быть добавлены, через некоторое время. Canvas API поддерживает пиксельное копирование изображений, поэтому текстуры могут быть добавлены. Я оставлю это для другой статьи, возможно, от другого человека. =)</p>"}},{"type":"prose","value":{"id":"the_raycaster","title":"ray-caster","isH3":false,"content":"<p>Хорошие люди здесь вручную скопировали мои файлы, чтобы вы могли <a href=\"https://mdn.github.io/canvas-raycaster/\" class=\"external\" rel=\" noopener\">взглянуть</a>, и для вашего удобства я разместил содержимое отдельных файлов в виде списков кодов (см. ниже).</p>\n\n<p>Так что запустите Safari 1.3+ или Firefox 1.5+ или какой-нибудь другой браузер, который поддерживает элемент &lt;canvas&gt; и наслаждайтесь!</p>\n\n<p><small><a href=\"https://github.com/mdn/canvas-raycaster/blob/master/input.js\" class=\"external\" rel=\" noopener\">input.js</a> | <a href=\"https://github.com/mdn/canvas-raycaster/blob/master/Level.js\" class=\"external\" rel=\" noopener\">Level.js</a> | <a href=\"https://github.com/mdn/canvas-raycaster/blob/master/Player.js\" class=\"external\" rel=\" noopener\">Player.js</a> | <a href=\"https://github.com/mdn/canvas-raycaster/blob/master/index.html\" class=\"external\" rel=\" noopener\">RayCaster.html</a> | <a href=\"https://github.com/mdn/canvas-raycaster/blob/master/RayCaster.js\" class=\"external\" rel=\" noopener\">RayCaster.js</a> | <a href=\"https://github.com/mdn/canvas-raycaster/blob/master/trace.css\" class=\"external\" rel=\" noopener\">trace.css</a> | <a href=\"https://github.com/mdn/canvas-raycaster/blob/master/trace.js\" class=\"external\" rel=\" noopener\">trace.js</a> </small></p>"}},{"type":"prose","value":{"id":"see_also","title":"Смотрите также","isH3":false,"content":"<ul>\n <li><a href=\"/en-US/docs/Web/API/Canvas_API/Tutorial\">Canvas руководство</a></li>\n</ul>"}}],"toc":[{"text":"Зачем?","id":"why.3f"},{"text":"Как?","id":"how.3f"},{"text":"Результаты","id":"results"},{"text":"ray-caster","id":"the_raycaster"},{"text":"Смотрите также","id":"see_also"}],"summary":"В этой статье представлен интересный реальный пример использования элемента <canvas> для выполнения программного рендеринга 3D-среды с помощью Ray-casting.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"A basic ray-caster","locale":"es","native":"Español"},{"title":"A basic ray-caster","locale":"ko","native":"한국어"},{"title":"A basic ray-caster","locale":"pt-BR","native":"Português (do Brasil)"}],"source":{"folder":"ru/orphaned/web/api/canvas_api/a_basic_ray-caster","github_url":"https://github.com/mdn/translated-content/blob/main/files/ru/orphaned/web/api/canvas_api/a_basic_ray-caster/index.html","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.html"},"pageTitle":"базовый ray-caster | MDN","noIndexing":true}}