{"version":3,"sources":["../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","site-search/search-results.tsx","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/construct.js","site-search/utils.tsx"],"names":["Class","_cache","Map","undefined","fn","Function","toString","call","indexOf","TypeError","has","get","set","Wrapper","construct","arguments","getPrototypeOf","this","constructor","prototype","Object","create","value","enumerable","writable","configurable","setPrototypeOf","LANGUAGES","entries","LANGUAGES_RAW","map","locale","data","toLowerCase","SORT_OPTIONS","BadRequestError","formErrors","JSON","stringify","Error","ServerOperationalError","statusCode","SearchResults","ga","useGA","useSearchParams","searchParams","useLocale","sp","createSearchParams","getAll","length","fetchURL","useSWR","url","a","fetch","response","status","json","badRequest","errors","ok","xCacheHeaderValue","headers","hitType","eventCategory","eventAction","eventLabel","revalidateOnFocus","process","error","page","React","useState","initialPage","setInitialPage","useEffect","resultsElement","document","querySelector","scrollIntoView","behavior","SearchErrorContainer","ExplainBadRequestError","ExplainServerOperationalError","currentPage","metadata","pageSize","size","hitCount","total","SortOptions","RemoteSearchWarning","Results","Pagination","maxPage","minHeight","message","CRUD_MODE","kumaHost","REACT_APP_KUMA_HOST","className","querySort","i","key","label","to","appendURL","sort","children","keys","messages","code","onClick","window","location","reload","documents","suggestions","ShowTotal","took_ms","suggestion","q","text","highlights","highlight","body","title","href","mdn_url","dangerouslySetInnerHTML","__html","English","summary","score","popularity","relation","toLocaleString","previousPage","nextPage","previousURL","_construct","Parent","args","Reflect","push","apply","instance","bind","overrides","forEach","Array","isArray","delete","v","append"],"mappings":"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","file":"static/js/8.321b4387.chunk.js","sourcesContent":["import getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport setPrototypeOf from \"@babel/runtime/helpers/esm/setPrototypeOf\";\nimport isNativeFunction from \"@babel/runtime/helpers/esm/isNativeFunction\";\nimport construct from \"@babel/runtime/helpers/esm/construct\";\nexport default function _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}","export default function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}","import React from \"react\";\nimport { Link, createSearchParams, useSearchParams } from \"react-router-dom\";\nimport useSWR from \"swr\";\n\nimport { Loading } from \"../ui/atoms/loading\";\nimport { CRUD_MODE } from \"../constants\";\nimport { useLocale } from \"../hooks\";\nimport { appendURL } from \"./utils\";\n\nimport LANGUAGES_RAW from \"../languages.json\";\nimport \"./search-results.scss\";\nimport { useGA } from \"../ga-context\";\n\nconst LANGUAGES = new Map(\n  Object.entries(LANGUAGES_RAW).map(([locale, data]) => {\n    return [locale.toLowerCase(), data];\n  })\n);\n\nconst SORT_OPTIONS = [\n  [\"best\", \"Best\"],\n  [\"relevance\", \"Relevance\"],\n  [\"popularity\", \"Popularity\"],\n];\n\ntype Highlight = {\n  body?: string[];\n  title?: string[];\n};\ninterface Document {\n  mdn_url: string;\n  locale: string;\n  title: string;\n  highlight: Highlight;\n  summary: string;\n  score: number;\n  popularity: number;\n}\n\ntype Total = {\n  value: number;\n  relation: \"eq\" | \"gt\";\n};\n\ninterface Metadata {\n  // The time it took Elasticsearch query\n  took_ms: number;\n  // The time it took Kuma's API to wrap the Elasticsearch query\n  api_took_ms: number;\n  total: Total;\n}\n\ninterface Suggestion {\n  text: string;\n  total: Total;\n}\n\ninterface FormErrorMessage {\n  message: string;\n  code: string;\n}\ntype FormErrors = [{ key: string }, FormErrorMessage[]];\n\nclass BadRequestError extends Error {\n  public formErrors: FormErrors;\n\n  constructor(formErrors: FormErrors) {\n    super(`BadRequestError ${JSON.stringify(formErrors)}`);\n    this.formErrors = formErrors;\n  }\n}\n\nclass ServerOperationalError extends Error {\n  public statusCode: number;\n  constructor(statusCode: number) {\n    super(`ServerOperationalError ${statusCode}`);\n    this.statusCode = statusCode;\n  }\n}\n\nexport default function SearchResults() {\n  const ga = useGA();\n  const [searchParams] = useSearchParams();\n  const locale = useLocale();\n  // A call to `/api/v1/search` will default to mean the same thing as\n  // a call to `/api/v1/search?locale=en-us`. But if they page you're currently\n  // on, (e.g. `/ja/search`) we should supply a more explicit default.\n  const sp = createSearchParams(searchParams);\n  if (!searchParams.getAll(\"locale\").length) {\n    // In other words, if it's not explicitly set by the current query string,\n    // force in the locale based on the current URL (path).\n    sp.set(\"locale\", locale);\n  }\n  const fetchURL = `/api/v1/search?${sp.toString()}`;\n\n  const { data, error } = useSWR(\n    fetchURL,\n    async (url) => {\n      const response = await fetch(url);\n      if (response.status === 400) {\n        const badRequest = await response.json();\n        throw new BadRequestError(badRequest.errors);\n      } else if (response.status >= 500) {\n        throw new ServerOperationalError(response.status);\n      } else if (!response.ok) {\n        throw new Error(`${response.status} on ${url}`);\n      }\n\n      // See docs/experiments/0001_site-search-x-cache.md\n      const xCacheHeaderValue = response.headers.get(\"x-cache\");\n      ga(\"send\", {\n        hitType: \"event\",\n        eventCategory: \"Site-search X-Cache\",\n        eventAction: url,\n        eventLabel: xCacheHeaderValue || \"no value\",\n      });\n\n      return await response.json();\n    },\n    {\n      revalidateOnFocus: process.env.NODE_ENV === \"development\",\n    }\n  );\n\n  const page = searchParams.get(\"page\");\n  const [initialPage, setInitialPage] = React.useState(page);\n  React.useEffect(() => {\n    if (page !== initialPage) {\n      setInitialPage(page);\n      const resultsElement = document.querySelector(\"div.site-search\");\n      if (resultsElement) {\n        resultsElement.scrollIntoView({ behavior: \"smooth\" });\n      }\n    }\n  }, [page, initialPage]);\n\n  if (error) {\n    if (error instanceof BadRequestError) {\n      return (\n        <SearchErrorContainer>\n          <ExplainBadRequestError errors={error.formErrors} />\n        </SearchErrorContainer>\n      );\n    }\n\n    if (error instanceof ServerOperationalError) {\n      return (\n        <SearchErrorContainer>\n          <ExplainServerOperationalError statusCode={error.statusCode} />\n        </SearchErrorContainer>\n      );\n    }\n\n    return (\n      <SearchErrorContainer>\n        <p>Something else when horribly wrong with the search</p>\n        <p>\n          <code>{error.toString()}</code>\n        </p>\n      </SearchErrorContainer>\n    );\n  }\n\n  if (data) {\n    const currentPage = data.metadata.page;\n    const pageSize = data.metadata.size;\n    const hitCount = data.metadata.total.value;\n\n    return (\n      <>\n        {/* It only makes sense to display the sorting options if anything was found */}\n        {hitCount > 1 && <SortOptions />}\n\n        <RemoteSearchWarning />\n\n        <Results {...data} />\n\n        <Pagination\n          currentPage={currentPage}\n          hitCount={hitCount}\n          pageSize={pageSize}\n          maxPage={10}\n        />\n      </>\n    );\n  }\n  // else...\n  return <Loading minHeight={500} message=\"Loading search results...\" />;\n}\n\nfunction RemoteSearchWarning() {\n  if (CRUD_MODE) {\n    // If you're in CRUD_MODE, the search results will be proxied from a remote\n    // Kuma and it might be confusing if a writer is wondering why their\n    // actively worked-on content isn't showing up in searches.\n    // The default value in the server is not accessible from the react app,\n    // so it's hardcoded here in the client.\n    const kumaHost = process.env.REACT_APP_KUMA_HOST || \"developer.mozilla.org\";\n    return (\n      <div className=\"notecard warning\">\n        <h4>Note!</h4>\n        <p>\n          Site-search is proxied to <code>{kumaHost}</code> which means that\n          some content found doesn't reflect what's in your current branch.\n        </p>\n      </div>\n    );\n  }\n  return null;\n}\n\nfunction SortOptions() {\n  const [searchParams] = useSearchParams();\n  const querySort = searchParams.get(\"sort\") || SORT_OPTIONS[0][0];\n  return (\n    <div className=\"sort-options\">\n      <h2>Sort by:</h2>\n      <ul className=\"sort-option-list\">\n        {SORT_OPTIONS.map(([key, label], i) => {\n          return (\n            <li key={key}>\n              {key === querySort ? (\n                label\n              ) : (\n                <Link to={`?${appendURL(searchParams, { sort: key })}`}>\n                  {label}\n                </Link>\n              )}\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n}\n\nfunction SearchErrorContainer({ children }: { children: React.ReactNode }) {\n  return (\n    <div>\n      <h3>Search error</h3>\n      {children}\n    </div>\n  );\n}\n\nfunction ExplainBadRequestError({ errors }: { errors: FormErrors }) {\n  return (\n    <div className=\"notecard warning\">\n      <p>The search didn't work because there were problems with the input.</p>\n      <ul>\n        {Object.keys(errors).map((key) => {\n          const messages: FormErrorMessage[] = errors[key];\n          return (\n            <li key={key}>\n              <code>{key}</code>{\" \"}\n              {messages.map((message) => {\n                return <b key={message.code}>{message.message}</b>;\n              })}\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n}\n\nfunction ExplainServerOperationalError({ statusCode }: { statusCode: number }) {\n  return (\n    <div className=\"notecard warning\">\n      <p>The search failed because the server failed to respond.</p>\n      <p>\n        If you're curious, it was a <b>{statusCode}</b> error.\n      </p>\n      <p>\n        <button\n          onClick={() => {\n            window.location.reload();\n          }}\n        >\n          Try reloading\n        </button>\n      </p>\n    </div>\n  );\n}\n\nfunction Results({\n  documents,\n  metadata,\n  suggestions,\n}: {\n  documents: Document[];\n  metadata: Metadata;\n  suggestions: Suggestion[];\n}) {\n  const locale = useLocale();\n  const [searchParams] = useSearchParams();\n\n  return (\n    <div className=\"search-results\">\n      <p>\n        Found <ShowTotal total={metadata.total} /> in {metadata.took_ms}{\" \"}\n        milliseconds.\n      </p>\n\n      {!!suggestions.length && (\n        <div className=\"search-suggestions\">\n          <p>Did you mean...</p>\n          <ul className=\"search-suggestion-list\">\n            {suggestions.map((suggestion) => {\n              return (\n                <li key={suggestion.text}>\n                  <Link\n                    to={`?${appendURL(searchParams, {\n                      q: suggestion.text,\n                      page: undefined,\n                    })}`}\n                  >\n                    {suggestion.text}\n                  </Link>{\" \"}\n                  <ShowTotal total={suggestion.total} />\n                </li>\n              );\n            })}\n          </ul>\n        </div>\n      )}\n\n      <ul className=\"search-results-list readable-line-length\">\n        {documents.map((document) => {\n          const highlights = document.highlight.body || [];\n          return (\n            <li className=\"search-result-entry\" key={document.mdn_url}>\n              {/* We're using plain <a href> instead of <Link to> here until\n                the bug has been figured out about scrolling to the top on click. */}\n              {document.highlight.title && document.highlight.title.length ? (\n                <h3 className=\"title\">\n                  <a\n                    href={document.mdn_url}\n                    dangerouslySetInnerHTML={{\n                      __html: document.highlight.title[0],\n                    }}\n                  ></a>\n                </h3>\n              ) : (\n                <h3 className=\"title\">\n                  <a href={document.mdn_url}>{document.title}</a>\n                </h3>\n              )}{\" \"}\n              {locale.toLowerCase() !== document.locale &&\n                LANGUAGES.has(document.locale) && (\n                  <span\n                    className=\"locale-indicator\"\n                    title={`The linked document is in ${\n                      LANGUAGES.get(document.locale)?.English\n                    } which is different from your current locale.`}\n                  >\n                    {LANGUAGES.get(document.locale)?.English}\n                  </span>\n                )}\n              <p className=\"search-result-url\">\n                <a href={document.mdn_url}>{document.mdn_url}</a>\n              </p>\n              <p>\n                {highlights.length ? (\n                  highlights.map((highlight, i) => {\n                    return (\n                      <span\n                        key={`${document.mdn_url}${i}`}\n                        className=\"highlight\"\n                        dangerouslySetInnerHTML={{ __html: `…${highlight}…` }}\n                      ></span>\n                    );\n                  })\n                ) : (\n                  <span className=\"summary\">{document.summary}</span>\n                )}\n              </p>\n              {searchParams.get(\"debug\") !== null && (\n                <span className=\"nerd-data\">\n                  <b>score:</b> <code>{document.score}</code>,{\" \"}\n                  <b>popularity:</b> <code>{document.popularity}</code>,{\" \"}\n                </span>\n              )}\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n}\n\nfunction ShowTotal({ total }: { total: Total }) {\n  return (\n    <>\n      {total.relation === \"gt\" && \"more than\"} {total.value.toLocaleString()}{\" \"}\n      {total.value === 1 ? \"match\" : \"matches\"}\n    </>\n  );\n}\n\nfunction Pagination({\n  currentPage,\n  maxPage,\n  hitCount,\n  pageSize,\n}: {\n  currentPage: number;\n  maxPage: number;\n  hitCount: number;\n  pageSize: number;\n}) {\n  const [searchParams] = useSearchParams();\n\n  if (!hitCount) {\n    return null;\n  }\n  if (hitCount <= pageSize) {\n    return null;\n  }\n  let previousPage: number | null = null;\n  let nextPage: number | null = null;\n  if (hitCount > currentPage * pageSize && currentPage < maxPage) {\n    nextPage = currentPage + 1;\n  }\n  if (currentPage > 1) {\n    previousPage = currentPage - 1;\n  }\n\n  if (nextPage || previousPage !== null) {\n    let previousURL = \"\";\n    if (previousPage) {\n      if (previousPage === 1) {\n        previousURL = `?${appendURL(searchParams, {\n          page: undefined,\n        })}`;\n      } else {\n        previousURL = `?${appendURL(searchParams, {\n          page: `${previousPage}`,\n        })}`;\n      }\n    }\n    return (\n      <ul className=\"pagination readable-line-length\">\n        {previousURL ? (\n          <li>\n            <Link to={previousURL} className=\"button\">\n              Previous\n            </Link>\n          </li>\n        ) : null}{\" \"}\n        {nextPage ? (\n          <li>\n            <Link\n              to={`?${appendURL(searchParams, { page: `${nextPage}` })}`}\n              className=\"button\"\n            >\n              Next\n            </Link>\n          </li>\n        ) : null}\n      </ul>\n    );\n  }\n  return null;\n}\n","import setPrototypeOf from \"@babel/runtime/helpers/esm/setPrototypeOf\";\nimport isNativeReflectConstruct from \"@babel/runtime/helpers/esm/isNativeReflectConstruct\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}","import { createSearchParams, URLSearchParamsInit } from \"react-router-dom\";\n\nexport function appendURL(\n  searchParams: URLSearchParamsInit,\n  overrides: Record<string, string | string[] | undefined>\n) {\n  const sp = createSearchParams(searchParams);\n  Object.entries(overrides).forEach(([key, value]) => {\n    if (Array.isArray(value)) {\n      sp.delete(key);\n      value.forEach((v) => sp.append(key, v));\n    } else if (value === undefined) {\n      sp.delete(key);\n    } else {\n      sp.set(key, value);\n    }\n  });\n  return sp;\n}\n"],"sourceRoot":""}