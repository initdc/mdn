(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[12],{114:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var r=n(3),c=n(8),a=n.n(c),u=n(12),i=n(1),s=n(2),o=n(4),l=n(14),d=n(34),j=n(20),b=n(79),f=(n(85),n(0));function h(){var e=Object(s.f)(),t=Object(j.b)(),n="/_document?".concat(new URLSearchParams({url:t}).toString()),c=Object(l.a)(n,function(){var e=Object(u.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("".concat(n.status," on ").concat(t));case 5:return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h=c.data,O=c.error,m=Object(i.useState)(!1),v=Object(r.a)(m,2),p=v[0],x=v[1],g=Object(i.useState)(null),w=Object(r.a)(g,2),S=w[0],y=w[1];function N(){return(N=Object(u.a)(a.a.mark((function n(r,c){var u;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return x(!0),n.prev=1,n.next=4,fetch("/_document?url=".concat(encodeURIComponent(t)),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 4:if((u=n.sent).ok){n.next=8;break}return y(new Error("".concat(u.status," on ").concat(u.url))),n.abrupt("return");case 8:c&&(window.location.href=e.pathname.split("_edit")[0]+"_edit/"+r.metadata.slug),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(1),y(n.t0);case 14:x(!1);case 15:case"end":return n.stop()}}),n,null,[[1,11]])})))).apply(this,arguments)}return Object(f.jsxs)("main",{className:"page-content-container document-edit",role:"main",children:[Object(f.jsxs)("h2",{className:"edit-header",children:["Edit view",Object(f.jsx)(o.b,{to:t,className:"close",children:"close"})]}),!h&&!O&&Object(f.jsx)("p",{children:"Loading source data..."}),O&&Object(f.jsxs)("div",{className:"attention",children:[Object(f.jsx)("h3",{children:"Error loading source"}),Object(f.jsx)("code",{children:O.toString()})]}),Object(f.jsx)("div",{className:"document-edit-forms",children:h&&Object(f.jsx)(b.a,{doc:h,isSaving:p,savingError:S,onSave:function(e,t){return N.apply(this,arguments)}})}),Object(f.jsx)("div",{className:"document-preview",children:Object(f.jsx)(d.a,{isPreview:!0})})]})}},75:function(e,t,n){},79:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(8),c=n.n(r),a=n(12),u=n(3),i=n(1),s=n(73);n(75);var o=n(14),l=n(0);function d(e){var t=e.onSave,n=e.initialSlug,r=e.doc,d=e.isSaving,j=e.savingError,b=Object(s.b)().locale,f=Object(i.useState)(n?n+"/":r?r.metadata.slug:""),h=Object(u.a)(f,2),O=h[0],m=h[1],v=Object(i.useState)(r?r.metadata.title:""),p=Object(u.a)(v,2),x=p[0],g=p[1],w=Object(i.useState)(r?r.rawBody:""),S=Object(u.a)(w,2),y=S[0],N=S[1],k=function(e,t){var n=Object(i.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(r){return console.log(r),t}})),r=Object(u.a)(n,2),c=r[0],a=r[1];return[c,function(t){try{var n=t instanceof Function?t(c):t;a(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(r){console.log(r)}}]}("autosaveEdit",!1),E=Object(u.a)(k,2),R=E[0],C=E[1],T=Object(o.a)("exists:".concat(O),Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/_document?".concat(new URLSearchParams({url:"/".concat(b,"/docs/").concat(O)}).toString()));case 2:return e.abrupt("return",e.sent.ok);case 3:case"end":return e.stop()}}),e)})))).data,_=!r,F=!_&&R,J=Boolean(r&&r.metadata.slug!==O),P=F&&!J,A=!P&&d,B=O.endsWith("/");var D=function(e,t,n){var r=this,c=Object(i.useRef)(null),a=Object(i.useRef)(0),u=Object(i.useRef)(null),s=Object(i.useRef)([]),o=Object(i.useRef)(),l=Object(i.useRef)(),d=Object(i.useRef)(e),j=Object(i.useRef)(!0);d.current=e;var b=!t&&0!==t&&"undefined"!==typeof window;if("function"!==typeof e)throw new TypeError("Expected a function");t=+t||0;var f=!!(n=n||{}).leading,h=!("trailing"in n)||!!n.trailing,O="maxWait"in n,m=O?Math.max(+n.maxWait||0,t):null;return Object(i.useEffect)((function(){return j.current=!0,function(){j.current=!1}}),[]),Object(i.useMemo)((function(){var e=function(e){var t=s.current,n=o.current;return s.current=o.current=null,a.current=e,l.current=d.current.apply(n,t)},n=function(e,t){b&&cancelAnimationFrame(u.current),u.current=b?requestAnimationFrame(e):setTimeout(e,t)},i=function(e){if(!j.current)return!1;var n=e-c.current,r=e-a.current;return!c.current||n>=t||n<0||O&&r>=m},v=function(t){return u.current=null,h&&s.current?e(t):(s.current=o.current=null,l.current)},p=function e(){var r=Date.now();if(i(r))return v(r);if(j.current){var u=r-c.current,s=r-a.current,o=t-u,l=O?Math.min(o,m-s):o;n(e,l)}},x=function(){for(var d=[],b=0;b<arguments.length;b++)d[b]=arguments[b];var h=Date.now(),m=i(h);if(s.current=d,o.current=r,c.current=h,m){if(!u.current&&j.current)return a.current=c.current,n(p,t),f?e(c.current):l.current;if(O)return n(p,t),e(c.current)}return u.current||n(p,t),l.current};return x.cancel=function(){u.current&&(b?cancelAnimationFrame(u.current):clearTimeout(u.current)),a.current=0,s.current=c.current=o.current=u.current=null},x.isPending=function(){return!!u.current},x.flush=function(){return u.current?v(Date.now()):l.current},x}),[f,O,t,m,h,b])}(t,1e3);return Object(i.useEffect)((function(){P&&D({rawBody:y,metadata:{slug:O,title:x,locale:b||""}},J)}),[P,D,O,x,y,J,b]),Object(l.jsxs)("form",{className:"document-form",onSubmit:function(e){e.preventDefault(),t({rawBody:y,metadata:{slug:O,title:x,locale:b||""}},J)},children:[Object(l.jsxs)("div",{children:[Object(l.jsxs)("label",{children:["Slug",Object(l.jsx)("input",{disabled:!_,type:"text",value:O,onChange:function(e){return m(e.target.value)},style:{width:"100%"}})]}),T&&!(r&&r.metadata.slug===O)&&Object(l.jsx)("div",{className:"form-warning",children:"Warning! This slug already exists, creating this document will override the other document using that slug."}),B&&Object(l.jsx)("div",{className:"form-warning",children:"Slugs are not allowed to end in a slash"})]}),J&&F&&Object(l.jsx)("div",{children:"Autosave has been temporarily disabled until the new slug is saved!"}),Object(l.jsx)("p",{children:Object(l.jsxs)("label",{children:["Title",Object(l.jsx)("input",{disabled:A,type:"text",value:x,onChange:function(e){return g(e.target.value)},style:{width:"100%"}})]})}),Object(l.jsx)("textarea",{disabled:A,value:y,onChange:function(e){return N(e.target.value)},rows:20,style:{width:"100%"}}),Object(l.jsxs)("p",{children:[Object(l.jsx)("button",{type:"submit",disabled:A||!x||!O||B||!y,children:_?"Create":"Save"}),!_&&Object(l.jsxs)("span",{className:"action-options",children:[Object(l.jsx)("input",{type:"checkbox",id:"enable_autosave",checked:R,onChange:function(){C(!R)}}),Object(l.jsx)("label",{htmlFor:"enable_autosave",children:"Enable autosave"})]})]}),j&&Object(l.jsxs)("div",{className:"error-message submission-error",children:[Object(l.jsx)("p",{children:"Error saving document"}),Object(l.jsx)("pre",{children:j.toString()})]})]})}},85:function(e,t,n){}}]);
//# sourceMappingURL=12.dc8aca96.chunk.js.map