(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[14],{127:function(e,t,c){"use strict";c.r(t),c.d(t,"default",(function(){return g}));var n=c(15),r=c(8),a=c.n(r),s=c(12);function l(e,t){if(null==e)return{};var c,n,r=function(e,t){if(null==e)return{};var c,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)c=a[n],t.indexOf(c)>=0||(r[c]=e[c]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)c=a[n],t.indexOf(c)>=0||Object.prototype.propertyIsEnumerable.call(e,c)&&(r[c]=e[c])}return r}var i=c(5),o=c(25),j=c(3),u=c(1),b=c(4),d=c(2),h=c(14),O=(c(82),c(74)),f=c(10),p=c(0),x=Object.freeze({mdn_url:"",title:"",popularity:"",fixableFlaws:"",flaws:[],page:1,sort_by:"popularity",sort_reverse:!1,search_flaws:[]});function v(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=Object(j.a)(e,2),c=t[0],n=t[1];return JSON.stringify(x[c])!==JSON.stringify(n)})))}function m(){var e=Object(b.d)(),t=Object(j.a)(e,2),c=t[0],n=t[1];for(var r=Object(u.useMemo)((function(){var e,t=(e=c,Object(o.a)(e.entries()).reduce((function(e,t){var c=Object(j.a)(t,2),n=c[0],r=c[1];return Object.prototype.hasOwnProperty.call(e,n)?Array.isArray(e[n])?e[n]=[].concat(Object(o.a)(e[n]),[r]):e[n]=[e[n],r]:e[n]=r,e}),{}));return t.page&&(t.page=parseInt(t.page)),Object(i.a)(Object(i.a)({},x),t)}),[c]),a=Object(u.useCallback)((function(e){var t=v(Object(i.a)(Object(i.a)({},r),e));n(t)}),[r,n]),s=0,l=["flaws","search_flaws"];s<l.length;s++){var d=l[s];r[d]&&!Array.isArray(r[d])&&(r[d]=[r[d]])}return[r,a]}function g(){var e=Object(d.h)().locale,t=m(),c=Object(j.a)(t,1)[0],n=Object(u.useState)(null),r=Object(j.a)(n,2),o=r[0],O=r[1];Object(u.useEffect)((function(){var e="Documents with flaws";o&&(e="(".concat(o.counts.found.toLocaleString()," found) ").concat(e)),document.title=e}),[o]);var x=Object(u.useCallback)((function(){var t=c.sort_by,n=c.sort_reverse,r=c.page,a=l(c,["sort_by","sort_reverse","page"]),s=Object(b.c)(Object(i.a)(Object(i.a)({},a),{},{page:String(r),locale:e,sort:t,reverse:JSON.stringify(n)}));return"/_flaws?".concat(s.toString())}),[e,c]),v=Object(h.a)(x(),function(){var e=Object(s.a)(a.a.mark((function e(t){var c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:c=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:if(c.ok){e.next=11;break}throw new Error("".concat(c.status," on ").concat(t));case 11:if(c.headers.get("content-type").includes("application/json")){e.next=13;break}throw new Error("Response is not JSON (".concat(c.headers.get("content-type"),")"));case 13:return e.abrupt("return",c.json());case 14:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),{}),g=v.data,N=v.error,F=v.isValidating;Object(u.useEffect)((function(){g&&O(g)}),[g]);var L=Object(p.jsx)("small",{children:"\xa0"});g||N?F&&(L=Object(p.jsx)("small",{children:"Reloading..."})):L=o?Object(p.jsx)("small",{children:"Reloading..."}):Object(p.jsx)("small",{children:"Loading..."});var B=c.page,A=o?o.counts.pages:0;return Object(p.jsx)("div",{className:"all-flaws",children:Object(p.jsxs)(f.b,{children:[L,N&&Object(p.jsx)(y,{error:N}),o&&Object(p.jsxs)("div",{className:"filter-documents",children:[Object(p.jsx)(_,{flawLevels:o.flawLevels}),Object(p.jsx)(S,{locale:e,counts:o.counts,documents:o.documents}),A>1&&Object(p.jsxs)("p",{className:"pagination",children:[Object(p.jsx)(k,{number:1,disabled:1===B,children:"First page"})," ",B>2&&Object(p.jsxs)(k,{number:B-1,children:["Previous page (",B-1,")"]})," ",Object(p.jsxs)(k,{number:B+1,disabled:B+1>A,children:["Next page (",B+1,")"]})]})]}),g&&g.counts&&Object(p.jsx)(C,{counts:g.counts.flaws}),g&&Object(p.jsx)(w,{times:g.times})]})})}function y(e){var t=e.error;return Object(p.jsxs)("div",{className:"error-message search-error",children:[Object(p.jsx)("h3",{children:"Search error"}),Object(p.jsx)("pre",{children:t.toString()})]})}function w(e){var t,c=e.times;return Object(p.jsx)("div",{className:"search-times",children:Object(p.jsxs)("p",{children:["Time to find built documents ",(t=c.built,t>1e3?"".concat((t/1e3).toFixed(1)," seconds"):"".concat(Math.trunc(t)," milliseconds"))]})})}function _(e){var t=e.flawLevels,c=m(),r=Object(j.a)(c,2),a=r[0],s=r[1],l=Object(u.useState)(a),b=Object(j.a)(l,2),d=b[0],h=b[1],f=Object(u.useState)(function(e){var t,c=[],r=Object(n.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value.split(":",2),s=Object(j.a)(a,2),l=s[0],i=s[1];c.push({flaw:l,search:i})}}catch(o){r.e(o)}finally{r.f()}return c}(a.search_flaws)),v=Object(j.a)(f,2),g=v[0],y=v[1];function w(){s(d)}Object(u.useEffect)((function(){var e=Object(o.a)(document.querySelectorAll('ul.search-flaws-rows input[type="search"]')).filter((function(e){return!e.value}));e.length&&e[e.length-1].focus()}),[g]);var _=!function(e,t){var c=new Set(Object.keys(e)),r=new Set(Object.keys(t));if(c.size!==r.size)return!1;var a,s=Object(n.a)(c);try{for(s.s();!(a=s.n()).done;){var l=a.value;if(!r.has(l))return!1}}catch(i){s.e(i)}finally{s.f()}return Object.entries(e).every((function(e){var c=Object(j.a)(e,2),n=c[0],r=c[1],a=t[n];return typeof r===typeof a&&(Array.isArray(r)?r.length===a.length&&r.every((function(e,t){return e===a[t]})):r===a)}))}(x,d),S=g.some((function(e){return!e.search.trim()}));return Object(p.jsxs)("div",{className:"filters",children:[Object(p.jsx)("h3",{children:"Filters"}),Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),w()},children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("h4",{children:"Document"}),Object(p.jsx)("input",{type:"search",placeholder:"Filter by document URI",value:d.mdn_url,onChange:function(e){h(Object(i.a)(Object(i.a)({},d),{},{mdn_url:e.target.value}))},onBlur:w}),Object(p.jsx)("input",{type:"search",placeholder:"Filter by document title",value:d.title,onChange:function(e){h(Object(i.a)(Object(i.a)({},d),{},{title:e.target.value}))},onBlur:w})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h4",{children:"Popularity"}),Object(p.jsx)("input",{type:"search",placeholder:"E.g. < 100",value:d.popularity||"",onChange:function(e){h(Object(i.a)(Object(i.a)({},d),{},{popularity:e.target.value}))},onBlur:w})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h4",{children:"Flaws"}),Object(p.jsx)("select",{multiple:!0,value:d.flaws,onChange:function(e){var t=Object(o.a)(e.target.selectedOptions).map((function(e){return e.value}));h(Object(i.a)(Object(i.a)({},d),{},{flaws:t}))},children:t&&t.map((function(e){return Object(p.jsxs)("option",{value:e.name,children:[Object(O.a)(e.name)," ",e.ignored&&"(ignored)"]},e.name)}))})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h4",{children:"Search inside flaws"}),Object(p.jsx)("ul",{className:"search-flaws-rows",children:g.map((function(e,c){return Object(p.jsxs)("li",{children:[Object(p.jsx)("select",{value:e.flaw,onChange:function(e){var t=Object(o.a)(g);t[c].flaw=e.target.value,y(t)},children:t&&t.filter((function(e){return!e.ignored})).map((function(e){return Object(p.jsx)("option",{value:e.name,children:Object(O.a)(e.name)},e.name)}))}),Object(p.jsx)("input",{type:"search",placeholder:"Search expression (e.g. jsxref)",value:e.search,onChange:function(e){y(g.map((function(t,n){return c===n&&(t.search=e.target.value),t})))},onBlur:function(){var e=g.map((function(e){return"".concat(e.flaw,":").concat(e.search)}));h(Object(i.a)(Object(i.a)({},d),{},{search_flaws:e})),w()}}),Object(p.jsx)("button",{type:"button",title:"Remove search row",onClick:function(){var e=Object(o.a)(g);e.splice(c,1),y(e)},children:"-"})]},"".concat(e.flaw,":").concat(c))}))}),Object(p.jsx)("button",{type:"button",title:"Add search row",disabled:S,onClick:function(){y([].concat(Object(o.a)(g),[{flaw:"macros",search:""}]))},children:"+"})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h4",{children:"Fixable flaws"}),Object(p.jsx)("input",{type:"search",placeholder:"E.g. >0",value:d.fixableFlaws||"",onChange:function(e){h(Object(i.a)(Object(i.a)({},d),{},{fixableFlaws:e.target.value}))},onBlur:w})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h4",{children:"\xa0"}),Object(p.jsx)("button",{type:"submit",children:"Filter now"}),_&&Object(p.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),h(x),s(x)},children:"Reset filters"})]})]})]})}function S(e){var t=e.locale,c=e.counts,n=e.documents,r=m(),a=Object(j.a)(r,2),s=a[0],l=a[1];function i(e){var t=["th","st","nd","rd"],c=e%100;return e.toLocaleString()+(t[(c-20)%10]||t[c]||t[0])}function o(e){var t=e.reduce((function(e,t){return t.countFixable+e}),0),c=e.map((function(e){return"".concat(Object(O.a)(e.name),": ").concat(e.value)}));return"".concat(c.join(", ")," (").concat(t," fixable)")}function u(e){var t=e.id,c=e.title;return Object(p.jsxs)("th",{onClick:function(){return e=t,void l(s.sort_by===e?{sort_reverse:!s.sort_reverse}:{sort_by:e});var e},className:"sortable",children:[c," ",s.sort_by===t?s.sort_reverse?"\ud83d\udd3d":"\ud83d\udd3c":null]})}function d(e,t){var c=e.split(new RegExp("(".concat(t,")"),"gi"));return Object(p.jsxs)("span",{children:[" ",c.map((function(e,c){return Object(p.jsx)("span",{style:e.toLowerCase()===t.toLowerCase()?{fontWeight:"bold"}:{},children:e},c)}))," "]})}function h(e){var t=e.split(/\/docs\//,2),c=Object(j.a)(t,2),n=c[0],r=c[1];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("span",{className:"url-prefix",children:[n,"/docs/"]}),Object(p.jsx)("span",{className:"url-slug",children:s.mdn_url?d(r,s.mdn_url):r})]})}return Object(p.jsxs)("div",{className:"documents",children:[Object(p.jsxs)("h3",{children:["Documents with flaws found (",c.found.toLocaleString(),")"," ",s.page>1&&Object(p.jsxs)("span",{className:"page",children:["page ",s.page]})]}),c.built?Object(p.jsxs)("h4",{className:"subheader",children:[c.built.toLocaleString()," documents built (",t,")"]}):Object(p.jsx)(N,{}),Object(p.jsxs)("table",{children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)(u,{id:"mdn_url",title:"Document"}),Object(p.jsx)(u,{id:"popularity",title:"Popularity"}),Object(p.jsx)(u,{id:"flaws",title:"Flaws"})]})}),Object(p.jsx)("tbody",{children:n.map((function(e){return Object(p.jsxs)("tr",{children:[Object(p.jsxs)("td",{children:[Object(p.jsx)(b.b,{to:"".concat(e.mdn_url,"#_flaws"),title:e.title,target:"_blank",children:h(e.mdn_url)}),Object(p.jsx)("span",{className:"document-title-preview",children:s.title?d(e.title,s.title):e.title})]}),Object(p.jsx)("td",{title:e.popularity.ranking?"Meaning there are ".concat(e.popularity.ranking-1," more popular pages than this"):"Meaning it has no ranking. Most likely a very rare (or new) document",children:e.popularity.ranking?"".concat(i(e.popularity.ranking)):"n/a"}),Object(p.jsx)("td",{children:o(e.flaws)})]},e.mdn_url)}))})]})]})}function k(e){var t=e.number,c=e.disabled,n=e.children,r=m(),a=Object(j.a)(r,1)[0],s=v(Object(i.a)(Object(i.a)({},a),{},{page:t}));return s.page&&(s.page=String(s.page)),Object(p.jsx)(b.b,{to:"?"+Object(b.c)(s).toString(),className:c?"disabled":"",onClick:function(e){c&&e.preventDefault()},children:n})}function N(){return Object(p.jsxs)("div",{className:"attention document-warnings",children:[Object(p.jsx)("h4",{children:"No documents have been built, so no flaws can be found"}),Object(p.jsx)("p",{children:"At the moment, you have to use the command line tools to build documents that we can analyze."})]})}function C(e){var t=e.counts,c=Object.entries(t.type).sort((function(e,t){return e[1]-t[1]})),n=Object.entries(t.macros).sort((function(e,t){return e[1]-t[1]}));return Object(p.jsxs)("div",{className:"flaw-counts",children:[Object(p.jsx)("h3",{children:"Flaws counts"}),Object(p.jsx)("table",{children:Object(p.jsxs)("tbody",{children:[Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:"Total"}),Object(p.jsx)("td",{children:Object(p.jsx)("b",{children:t.total.toLocaleString()})})]}),Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:"Fixable"}),Object(p.jsx)("td",{children:Object(p.jsx)("b",{children:t.fixable.toLocaleString()})})]})]})}),Object(p.jsx)("h4",{children:"Breakdown by type"}),Object(p.jsxs)("table",{children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{children:"Type"}),Object(p.jsx)("th",{children:"Count"})]})}),Object(p.jsx)("tbody",{children:c.map((function(e){var t=Object(j.a)(e,2),c=t[0],n=t[1];return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:Object(O.a)(c)}),Object(p.jsx)("td",{children:Object(p.jsx)("b",{children:n.toLocaleString()})})]},c)}))})]}),Object(p.jsxs)("h4",{children:["Breakdown by ",Object(p.jsx)("code",{children:"macros"})," flaws"]}),Object(p.jsxs)("table",{children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{children:"Name"}),Object(p.jsx)("th",{children:"Count"})]})}),Object(p.jsx)("tbody",{children:n.map((function(e){var t=Object(j.a)(e,2),c=t[0],n=t[1];return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:Object(p.jsx)("code",{children:c})}),Object(p.jsx)("td",{children:Object(p.jsx)("b",{children:n.toLocaleString()})})]},c)}))})]})]})}},74:function(e,t,c){"use strict";function n(e){return{bad_bcd_queries:"Bad BCD queries",bad_bcd_links:"Bad BCD links",bad_pre_tags:"Bad <pre> tags",unsafe_html:"Unsafe HTML"}[e]||e.charAt(0).toUpperCase()+e.slice(1).replace(/_/g," ")}c.d(t,"a",(function(){return n}))},82:function(e,t,c){}}]);
//# sourceMappingURL=14.7e6bf35e.chunk.js.map