{"version":3,"sources":["translations/differences/index.tsx","translations/missing/index.tsx","translations/dashboard/index.tsx","translations/index.tsx","../../node_modules/dayjs/dayjs.min.js","../../node_modules/dayjs/plugin/relativeTime.js"],"names":["dayjs","extend","relativeTime","LOCALSTORAGE_KEY","saveStorage","locale","data","stored","JSON","parse","localStorage","getItem","Object","assign","setItem","stringify","err","console","warn","TranslationDifferences","useParams","useSearchParams","searchParams","navigate","useNavigate","React","useState","lastData","setLastData","useEffect","toLowerCase","title","counts","found","toLocaleString","document","useSWR","url","a","fetch","response","ok","Error","status","text","headers","get","includes","json","revalidateOnFocus","error","isValidating","startTime","useRef","cacheMisses","total","current","lastLoadTime","Date","getTime","lastStorageData","getStorage","defaultSort","defaultSortReverse","sort","sortReverse","Container","style","float","Loading","estimate","textAlign","to","ShowSearchError","className","FilterControls","DocumentsTable","documents","BuildTimes","times","children","toString","ms","took","toFixed","Math","trunc","startLoadingTime","estimateEndTime","setIncrements","interval","setInterval","state","clearInterval","distance","elapsed","percent","id","max","value","margin","aria-label","role","setSearchParams","setTitle","setURL","differences","setDifferences","refreshFilters","reset","filterParams","createSearchParams","key","set","delete","onSubmit","event","preventDefault","type","placeholder","onChange","target","onBlur","onClick","page","parseInt","pageSize","filterTitle","filterURL","filterDifferences","filterDifferencesOperation","expression","parseIntOrThrow","v","parsed","isNaN","startsWith","operation","replace","getNumericOperation","TableHead","filteredDocuments","filter","mdn_url","op","matchNumericOperation","A","B","reverse","edits","modified","popularity","b","localeCompare","pageCount","ceil","length","slice","map","doc","HighlightedText","highlight","BriefURL","uri","ranking","getGetOrdinal","parentRanking","LastModified","PageLink","number","disabled","parentModified","href","commitURL","rel","dateTime","toISOString","fromNow","parentCommitURL","parts","split","RegExp","part","i","fontWeight","left","right","n","s","params","top","querySelector","scrollIntoView","behavior","MissingTranslations","missing","missingDocuments","TranslationDashboard","currentSection","parentSection","arrPathSection","pop","join","ShowError","SectionHeader","l10nKPIs","section","SubsectionTable","sections","detailDocuments","htmlFor","completenessExact","completenessStr","freshnessExact","upToDate","freshnessStr","outOfDate","sectionA","sectionB","sectionHref","encodeURIComponent","name","documentDetail","info","localeInfo","dateLocale","dateDefaultLocale","defaultLocaleInfo","dateDiff","Number","POSITIVE_INFINITY","localePopularity","englishCommitHash","substring","localeCommitHash","nbDays","round","nbMonths","Translations","path","element","PickLocale","dataLocales","errorLocales","ShowLocales","locales","language","English","isActive","count","module","exports","t","e","r","u","o","f","h","c","d","$","l","y","M","weekdays","months","m","String","Array","g","z","utcOffset","abs","floor","date","year","month","clone","add","p","w","D","Q","_","S","args","arguments","O","$L","utc","$u","x","$x","$offset","this","prototype","$d","NaN","test","match","UTC","init","$y","getFullYear","$M","getMonth","$D","getDate","$W","getDay","$H","getHours","$m","getMinutes","$s","getSeconds","$ms","getMilliseconds","$utils","isValid","isSame","startOf","endOf","isAfter","isBefore","$g","unix","valueOf","toDate","apply","$locale","weekStart","$set","min","daysInMonth","subtract","format","invalidDate","substr","meridiem","YY","YYYY","MM","MMM","monthsShort","MMMM","DD","dd","weekdaysMin","ddd","weekdaysShort","dddd","H","HH","hh","mm","ss","SSS","Z","getTimezoneOffset","diff","toJSON","toUTCString","forEach","$i","isDayjs","en","Ls","future","past","yy","fromToBase","thresholds","rounding","from","toNow"],"mappings":"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","file":"static/js/7.5c11ebf6.chunk.js","sourcesContent":["import React from \"react\";\nimport {\n  createSearchParams,\n  Link,\n  useParams,\n  useSearchParams,\n  useNavigate,\n} from \"react-router-dom\";\nimport useSWR from \"swr\";\nimport dayjs from \"dayjs\";\nimport relativeTime from \"dayjs/plugin/relativeTime\";\n\nimport \"./index.scss\";\n\nimport { PageContentContainer } from \"../../ui/atoms/page-content\";\n\ndayjs.extend(relativeTime);\n\ninterface DocumentPopularity {\n  value: number;\n  ranking: number;\n  parentValue: number;\n  parentRanking: number;\n}\n\ntype CountByType = { [key: string]: number };\n\ninterface DocumentDifferences {\n  countByType: CountByType;\n  total: number;\n}\n\ninterface DocumentEdits {\n  modified: string;\n  parentModified: string;\n  commitURL: string;\n  parentCommitURL: string;\n}\n\ninterface Document {\n  mdn_url: string;\n  edits: DocumentEdits;\n  title: string;\n  popularity: DocumentPopularity;\n  differences: DocumentDifferences;\n}\n\ninterface Counts {\n  found: number;\n  total: number;\n  pages: number;\n  noParents: number;\n  cacheMisses: number;\n}\n\ninterface Times {\n  took: number;\n}\n\ninterface FlawLevel {\n  name: string;\n  level: string;\n  ignored: boolean;\n}\n\ninterface Data {\n  counts: Counts;\n  documents: Document[];\n  times: Times;\n  flawLevels: FlawLevel[];\n}\n\ninterface LocaleStorageData {\n  lastLoadTime?: number;\n  defaultSort?: string;\n  defaultSortReverse?: string;\n}\n\ninterface StorageData {\n  [locale: string]: LocaleStorageData;\n}\n\nconst LOCALSTORAGE_KEY = \"translations-dashboard-differences\";\n\nfunction saveStorage(locale: string, data: LocaleStorageData) {\n  try {\n    const stored = JSON.parse(\n      localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\"\n    ) as StorageData;\n    stored[locale] = Object.assign({}, stored[locale] || {}, data);\n    localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(stored));\n  } catch (err) {\n    console.warn(\"Unable to save to localStorage\", err);\n  }\n}\n\nfunction getStorage(locale: string): LocaleStorageData | null {\n  try {\n    const stored = JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\");\n    if (stored) {\n      return stored[locale] as LocaleStorageData;\n    }\n  } catch (err) {\n    console.warn(\"Unable to retrieve from localStorage\", err);\n  }\n  return null;\n}\n\nexport function TranslationDifferences() {\n  const { locale } = useParams();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n\n  const [lastData, setLastData] = React.useState<Data | null>(null);\n\n  React.useEffect(() => {\n    if (locale.toLowerCase() === \"en-us\") {\n      navigate(`/${locale}/_translations`);\n    }\n  }, [locale, navigate]);\n\n  React.useEffect(() => {\n    let title = \"All translations\";\n    if (locale.toLowerCase() !== \"en-us\") {\n      title += ` for ${locale}`;\n    }\n    if (lastData) {\n      title = `(${lastData.counts.found.toLocaleString()} found) ${title}`;\n    }\n    document.title = title;\n  }, [lastData, locale]);\n\n  const { data, error, isValidating } = useSWR<Data, Error>(\n    locale.toLowerCase() !== \"en-us\"\n      ? `/_translations/differences/?locale=${locale}`\n      : null,\n    async (url) => {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`${response.status} (${await response.text()})`);\n      }\n      if (\n        !(response.headers.get(\"content-type\") || \"\").includes(\n          \"application/json\"\n        )\n      ) {\n        throw new Error(\n          `Response is not JSON (${response.headers.get(\"content-type\")})`\n        );\n      }\n      return response.json();\n    },\n    {\n      revalidateOnFocus: false,\n    }\n  );\n\n  // Use this to be able to figure out how long the XHR takes when there's no cache\n  const startTime = React.useRef<Date>();\n  React.useEffect(() => {\n    if (locale) {\n      if (!data) {\n        startTime.current = new Date();\n      } else {\n        if (\n          data.counts.cacheMisses > 0 &&\n          data.counts.cacheMisses === data.counts.total &&\n          startTime.current\n        ) {\n          const lastLoadTime =\n            new Date().getTime() - startTime.current.getTime();\n          saveStorage(locale, { lastLoadTime });\n        }\n      }\n    }\n  }, [locale, data]);\n\n  React.useEffect(() => {\n    if (data) {\n      setLastData(data);\n    }\n  }, [data]);\n\n  const lastStorageData = getStorage(locale);\n  const defaultSort = lastStorageData?.defaultSort || \"modified\";\n  const defaultSortReverse = lastStorageData?.defaultSortReverse || \"false\";\n  const sort = searchParams.get(\"sort\") || defaultSort;\n  const sortReverse = JSON.parse(\n    searchParams.get(\"sortReverse\") || defaultSortReverse\n  );\n\n  React.useEffect(() => {\n    saveStorage(\n      locale,\n      Object.assign({}, lastStorageData, {\n        defaultSort: sort,\n        defaultSortReverse: sortReverse,\n      })\n    );\n  }, [locale, sort, sortReverse, lastStorageData]);\n\n  if (locale.toLowerCase() === \"en-us\") {\n    return null;\n  }\n\n  return (\n    <Container>\n      {lastData && !error && isValidating && (\n        <p style={{ float: \"right\" }}>Reloading...</p>\n      )}\n      {!data && !error && !lastData && (\n        <Loading\n          estimate={\n            (lastStorageData && lastStorageData.lastLoadTime) || 30 * 1000\n          }\n        />\n      )}\n      {lastData && (\n        <p style={{ textAlign: \"right\" }}>\n          Go to{\" \"}\n          <Link to={`/${locale}/_translations/missing`}>\n            Missing translations for <b>{locale}</b>\n          </Link>\n        </p>\n      )}\n      {error && <ShowSearchError error={error} />}\n      {lastData && (\n        <div className=\"filter-documents\">\n          <FilterControls />\n          <DocumentsTable\n            counts={lastData.counts}\n            documents={lastData.documents}\n            sort={sort}\n            sortReverse={sortReverse}\n          />\n        </div>\n      )}\n      {data && <BuildTimes times={data.times} />}\n    </Container>\n  );\n}\n\nfunction Container({ children }: { children: React.ReactNode }) {\n  return (\n    <div className=\"all-translations\">\n      <PageContentContainer>{children}</PageContentContainer>\n    </div>\n  );\n}\n\nfunction ShowSearchError({ error }) {\n  return (\n    <div className=\"error-message search-error\">\n      <h3>Search error</h3>\n      <pre>{error.toString()}</pre>\n    </div>\n  );\n}\n\nfunction BuildTimes({ times }: { times: Times }) {\n  function format(ms: number) {\n    if (ms > 1000) {\n      const s = ms / 1000;\n      return `${s.toFixed(1)} seconds`;\n    } else {\n      return `${Math.trunc(ms)} milliseconds`;\n    }\n  }\n  return (\n    <div className=\"search-times\">\n      <p>Time to find all documents {format(times.took)}</p>\n    </div>\n  );\n}\n\nfunction Loading({ estimate }: { estimate: number }) {\n  const startLoadingTime = new Date();\n  const [estimateEndTime] = React.useState(\n    new Date(startLoadingTime.getTime() + estimate)\n  );\n\n  const [, setIncrements] = React.useState(0);\n  React.useEffect(() => {\n    const interval = setInterval(() => {\n      setIncrements((state) => state + 1);\n    }, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const distance = estimateEndTime.getTime() - startLoadingTime.getTime();\n  const elapsed = new Date().getTime() - startLoadingTime.getTime();\n  const percent = (100 * elapsed) / distance;\n  return (\n    <div className=\"loading\">\n      <progress id=\"progress\" max=\"100\" value={percent} style={{ margin: 20 }}>\n        {percent}%\n      </progress>\n      <br />\n      <small>\n        Estimated time to finish: {((distance - elapsed) / 1000).toFixed(0)}s{\" \"}\n        {elapsed > distance ? (\n          <span aria-label=\"weird\" role=\"img\">\n            \n          </span>\n        ) : null}\n      </small>\n    </div>\n  );\n}\n\nfunction FilterControls() {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [title, setTitle] = React.useState(searchParams.get(\"title\") || \"\");\n  const [url, setURL] = React.useState(searchParams.get(\"url\") || \"\");\n  const [differences, setDifferences] = React.useState(\n    searchParams.get(\"differences\") || \"\"\n  );\n\n  function refreshFilters(reset = false) {\n    const filterParams = createSearchParams(searchParams);\n    for (const [key, value] of [\n      [\"url\", url],\n      [\"title\", title],\n      [\"differences\", differences],\n    ]) {\n      if (!reset && value) {\n        filterParams.set(key, value);\n      } else {\n        filterParams.delete(key);\n      }\n    }\n    filterParams.delete(\"page\");\n    setSearchParams(filterParams);\n  }\n\n  function resetFilters() {\n    setURL(\"\");\n    setTitle(\"\");\n    setDifferences(\"\");\n    refreshFilters(true);\n  }\n\n  return (\n    <div className=\"filters\">\n      <h3>Filters</h3>\n      <form\n        onSubmit={(event) => {\n          event.preventDefault();\n          refreshFilters();\n        }}\n      >\n        <div>\n          <h4>Document</h4>\n          <input\n            type=\"search\"\n            placeholder=\"Filter by document URI\"\n            value={url}\n            onChange={(event) => {\n              setURL(event.target.value);\n            }}\n            onBlur={() => refreshFilters()}\n          />\n          <input\n            type=\"search\"\n            placeholder=\"Filter by document title\"\n            value={title}\n            onChange={(event) => {\n              setTitle(event.target.value);\n            }}\n            onBlur={() => refreshFilters()}\n          />\n        </div>\n        <div>\n          <h4>Differences</h4>\n          <input\n            type=\"text\"\n            placeholder=\"E.g. >0 or >=5\"\n            value={differences}\n            onChange={(event) => {\n              setDifferences(event.target.value);\n            }}\n            onBlur={() => refreshFilters()}\n          />\n        </div>\n\n        <div>\n          <h4>&nbsp;</h4>\n          <button type=\"submit\">Filter now</button>{\" \"}\n          {(url || title) && (\n            <button type=\"button\" onClick={resetFilters}>\n              Reset filters\n            </button>\n          )}\n        </div>\n      </form>\n    </div>\n  );\n}\ntype NumericOperation = {\n  operation: \"eq\" | \"gt\" | \"gte\" | \"lt\" | \"lte\";\n  value: number;\n};\n\nfunction getNumericOperation(expression: string): NumericOperation | null {\n  function parseIntOrThrow(v: string) {\n    if (!v) {\n      throw new Error(\"Can't be empty\");\n    }\n\n    const parsed = parseInt(v, 10);\n    if (isNaN(parsed)) {\n      throw new Error(`'${v}' not a valid number`);\n    }\n    return parsed;\n  }\n  try {\n    if (expression.startsWith(\">=\")) {\n      return {\n        operation: \"gte\",\n        value: parseIntOrThrow(expression.replace(\">=\", \"\")),\n      };\n    } else if (expression.startsWith(\">\")) {\n      return {\n        operation: \"gt\",\n        value: parseIntOrThrow(expression.replace(\">\", \"\")),\n      };\n    } else if (expression.startsWith(\"<=\")) {\n      return {\n        operation: \"lte\",\n        value: parseIntOrThrow(expression.replace(\"<=\", \"\")),\n      };\n    } else if (expression.startsWith(\"<\")) {\n      return {\n        operation: \"lt\",\n        value: parseIntOrThrow(expression.replace(\"<\", \"\")),\n      };\n    } else if (expression.startsWith(\"==\") || expression.startsWith(\"=\")) {\n      return {\n        operation: \"eq\",\n        value: parseIntOrThrow(expression.replace(/=/g, \"\")),\n      };\n    } else if (expression) {\n      return {\n        operation: \"eq\",\n        value: parseIntOrThrow(expression),\n      };\n    } else {\n      return null;\n    }\n  } catch (error) {\n    console.warn(error);\n    return null;\n  }\n}\n\nfunction matchNumericOperation(value: number, op: NumericOperation): boolean {\n  if (op.operation === \"eq\") {\n    if (value !== op.value) {\n      return false;\n    }\n  } else if (op.operation === \"gt\") {\n    if (!(value > op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"gte\") {\n    if (!(value >= op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"lt\") {\n    if (!(value < op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"lte\") {\n    if (!(value <= op.value)) {\n      return false;\n    }\n  } else {\n    throw new Error(`Not implemented operation '${op.operation}'`);\n  }\n  return true;\n}\n\nfunction DocumentsTable({\n  counts,\n  documents,\n  sort,\n  sortReverse,\n}: {\n  counts: Counts;\n  documents: Document[];\n  sort: string;\n  sortReverse: boolean;\n}) {\n  const [searchParams, setSearchParams] = useSearchParams();\n\n  const page = parseInt(searchParams.get(\"page\") || \"1\", 10);\n  const pageSize = parseInt(searchParams.get(\"pageSize\") || \"20\", 10);\n  const filterTitle = searchParams.get(\"title\") || \"\";\n  const filterURL = searchParams.get(\"url\") || \"\";\n  const filterDifferences = searchParams.get(\"differences\") || \"\";\n  const filterDifferencesOperation = getNumericOperation(filterDifferences);\n\n  function TableHead({ id, title }: { id: string; title: string }) {\n    return (\n      <th\n        onClick={() => {\n          if (sort === id) {\n            setSearchParams(\n              createSearchParams({\n                sort: id,\n                sortReverse: JSON.stringify(!sortReverse),\n              })\n            );\n          } else {\n            setSearchParams(createSearchParams({ sort: id }));\n          }\n        }}\n        className={`sortable ${sort === id ? \"active\" : \"\"} ${\n          sort === id && sortReverse ? \"reverse\" : \"\"\n        }`}\n      >\n        {title}\n      </th>\n    );\n  }\n\n  const filteredDocuments = documents\n    .filter((document) => {\n      if (\n        filterTitle &&\n        !document.title.toLowerCase().includes(filterTitle.toLowerCase())\n      ) {\n        return false;\n      }\n\n      if (\n        filterURL &&\n        !document.mdn_url.toLowerCase().includes(filterURL.toLowerCase())\n      ) {\n        return false;\n      }\n\n      if (\n        filterDifferencesOperation &&\n        !matchNumericOperation(\n          document.differences.total,\n          filterDifferencesOperation\n        )\n      ) {\n        return false;\n      }\n\n      return true;\n    })\n    .sort((A, B) => {\n      let reverse = sortReverse ? -1 : 1;\n      if (sort === \"modified\") {\n        const a = new Date(A.edits.modified);\n        const b = new Date(B.edits.modified);\n        return reverse * (b.getTime() - a.getTime());\n      } else if (sort === \"popularity\") {\n        const a = A.popularity.value;\n        const b = B.popularity.value;\n        return reverse * (b - a);\n      } else if (sort === \"differences\") {\n        const a = A.differences.total;\n        const b = B.differences.total;\n        return reverse * (b - a);\n      } else if (sort === \"title\") {\n        const a = A.title;\n        const b = B.title;\n        return reverse * a.localeCompare(b);\n      } else if (sort === \"mdn_url\") {\n        const a = A.mdn_url;\n        const b = B.mdn_url;\n        return reverse * a.localeCompare(b);\n      } else {\n        throw new Error(`Unrecognized sort '${sort}'`);\n      }\n    });\n  const pageCount = Math.ceil(counts.found / pageSize);\n\n  return (\n    <div className=\"documents\">\n      <h3>\n        Documents found ({filteredDocuments.length.toLocaleString()}){\" \"}\n        {page > 1 && <span className=\"page\">page {page}</span>}{\" \"}\n        <small>of {counts.total.toLocaleString()} in total</small>\n      </h3>\n\n      {filterDifferences && !filterDifferencesOperation && (\n        <div className=\"error-message\">\n          <h3>Invalid differences filter</h3>\n          <p>\n            The <i>differences</i> filter can't be parsed.\n            <br />\n            <code>{filterDifferences}</code>\n          </p>\n        </div>\n      )}\n\n      <table>\n        <thead>\n          <tr>\n            <TableHead id=\"title\" title=\"Document\" />\n            <TableHead id=\"popularity\" title=\"Popularity\" />\n            <TableHead id=\"modified\" title=\"Last modified\" />\n            <TableHead id=\"differences\" title=\"Differences\" />\n          </tr>\n        </thead>\n        <tbody>\n          {filteredDocuments\n            .slice((page - 1) * pageSize, page * pageSize)\n            .map((doc: Document) => {\n              return (\n                <tr key={doc.mdn_url}>\n                  <td>\n                    <span className=\"document-title-preview\">\n                      {filterTitle ? (\n                        <HighlightedText\n                          text={doc.title}\n                          highlight={filterTitle}\n                        />\n                      ) : (\n                        doc.title\n                      )}\n                    </span>\n                    <br />\n                    <Link\n                      to={`${doc.mdn_url}#_flaws`}\n                      title={doc.title}\n                      target=\"_blank\"\n                    >\n                      <BriefURL uri={doc.mdn_url} filterURL={filterURL} />\n                    </Link>\n                  </td>\n                  <td\n                    title={\n                      doc.popularity.ranking\n                        ? `Meaning there are ${\n                            doc.popularity.ranking - 1\n                          } more popular pages than this`\n                        : \"Meaning it has no ranking. Most likely a very rare (or new) document\"\n                    }\n                  >\n                    {!doc.popularity.ranking\n                      ? \"n/a\"\n                      : `${getGetOrdinal(doc.popularity.ranking)}`}{\" \"}\n                    <small title=\"For the parent document\">\n                      (\n                      {!doc.popularity.parentRanking\n                        ? \"n/a\"\n                        : `${getGetOrdinal(doc.popularity.parentRanking)}`}\n                      )\n                    </small>\n                  </td>\n                  <td>\n                    <LastModified edits={doc.edits} />\n                  </td>\n                  <td>{doc.differences.total.toLocaleString()}</td>\n                </tr>\n              );\n            })}\n        </tbody>\n      </table>\n      {pageCount > 1 && (\n        <p className=\"pagination\">\n          <PageLink number={1} disabled={page === 1}>\n            First page\n          </PageLink>{\" \"}\n          {page > 2 && (\n            <PageLink number={page - 1}>Previous page ({page - 1})</PageLink>\n          )}{\" \"}\n          <PageLink number={page + 1} disabled={page + 1 > pageCount}>\n            Next page ({page + 1})\n          </PageLink>\n        </p>\n      )}\n    </div>\n  );\n}\n\nfunction LastModified({ edits }: { edits: DocumentEdits }) {\n  const modified = dayjs(edits.modified);\n  const parentModified = dayjs(edits.parentModified);\n  return (\n    <span\n      className={`last_modified ${\n        parentModified < modified ? \"ahead\" : \"behind\"\n      }`}\n    >\n      <a href={edits.commitURL} target=\"_blank\" rel=\"noreferrer\">\n        <time dateTime={modified.toISOString()} title={modified.toISOString()}>\n          {modified.fromNow()}\n        </time>\n      </a>\n      <br />\n      <a href={edits.parentCommitURL} target=\"_blank\" rel=\"noreferrer\">\n        <small>\n          <time\n            dateTime={parentModified.toISOString()}\n            title={parentModified.toISOString()}\n          >\n            en-US {parentModified.fromNow()}\n          </time>\n        </small>\n      </a>\n    </span>\n  );\n}\n\nfunction HighlightedText({\n  text,\n  highlight,\n}: {\n  text: string;\n  highlight: string;\n}) {\n  // Split on highlight term and include term into parts, ignore case\n  const parts = text.split(new RegExp(`(${highlight})`, \"gi\"));\n  return (\n    <span>\n      {\" \"}\n      {parts.map((part, i) => (\n        <span\n          key={i}\n          style={\n            part.toLowerCase() === highlight.toLowerCase()\n              ? { fontWeight: \"bold\" }\n              : {}\n          }\n        >\n          {part}\n        </span>\n      ))}{\" \"}\n    </span>\n  );\n}\n\nfunction BriefURL({ uri, filterURL }: { uri: string; filterURL: string }) {\n  const [left, right] = uri.split(/\\/docs\\//, 2);\n  return (\n    <>\n      <span className=\"url-prefix\">{left}/docs/</span>\n      <span className=\"url-slug\">\n        {filterURL ? (\n          <HighlightedText text={right} highlight={filterURL} />\n        ) : (\n          right\n        )}\n      </span>\n    </>\n  );\n}\n\n// https://gist.github.com/jlbruno/1535691/db35b4f3af3dcbb42babc01541410f291a8e8fac\nfunction getGetOrdinal(n: number) {\n  const s = [\"th\", \"st\", \"nd\", \"rd\"];\n  const v = n % 100;\n  return n.toLocaleString() + (s[(v - 20) % 10] || s[v] || s[0]);\n}\n\nfunction PageLink({\n  number,\n  disabled,\n  children,\n}: {\n  number: number;\n  disabled?: boolean;\n  children: React.ReactNode;\n}) {\n  const [searchParams] = useSearchParams();\n  const params = createSearchParams(searchParams);\n  if (number > 1) {\n    params.set(\"page\", `${number}`);\n  } else {\n    params.delete(\"page\");\n  }\n  return (\n    <Link\n      to={\"?\" + params.toString()}\n      className={disabled ? \"disabled\" : \"\"}\n      onClick={(event) => {\n        if (disabled) {\n          event.preventDefault();\n        }\n        const top = document.querySelector(\"div.all-translations\");\n        if (top) {\n          top.scrollIntoView({ behavior: \"smooth\" });\n        }\n      }}\n    >\n      {children}\n    </Link>\n  );\n}\n","import React from \"react\";\nimport {\n  createSearchParams,\n  Link,\n  useParams,\n  useSearchParams,\n  useNavigate,\n} from \"react-router-dom\";\nimport useSWR from \"swr\";\nimport dayjs from \"dayjs\";\nimport relativeTime from \"dayjs/plugin/relativeTime\";\n\nimport { PageContentContainer } from \"../../ui/atoms/page-content\";\n\ndayjs.extend(relativeTime);\n\ninterface DocumentPopularity {\n  value: number;\n  ranking: number;\n  parentValue: number;\n  parentRanking: number;\n}\n\ntype CountByType = { [key: string]: number };\n\ninterface DocumentDifferences {\n  countByType: CountByType;\n  total: number;\n}\n\ninterface DocumentEdits {\n  modified: string;\n  parentModified: string;\n  commitURL: string;\n  parentCommitURL: string;\n}\n\ninterface Document {\n  mdn_url: string;\n  edits: DocumentEdits;\n  title: string;\n  popularity: DocumentPopularity;\n  differences: DocumentDifferences;\n}\n\ninterface Counts {\n  missing: number;\n  translated: number;\n  total: number;\n  cacheMisses: number;\n}\n\ninterface Times {\n  took: number;\n}\n\ninterface FlawLevel {\n  name: string;\n  level: string;\n  ignored: boolean;\n}\n\ninterface Data {\n  counts: Counts;\n  missingDocuments: Document[];\n  times: Times;\n  flawLevels: FlawLevel[];\n}\n\ninterface LocaleStorageData {\n  lastLoadTime?: number;\n  defaultSort?: string;\n  defaultSortReverse?: string;\n}\n\ninterface StorageData {\n  [locale: string]: LocaleStorageData;\n}\n\nconst LOCALSTORAGE_KEY = \"translations-dashboard-missing\";\n\nfunction saveStorage(locale: string, data: LocaleStorageData) {\n  try {\n    const stored = JSON.parse(\n      localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\"\n    ) as StorageData;\n    stored[locale] = Object.assign({}, stored[locale] || {}, data);\n    localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(stored));\n  } catch (err) {\n    console.warn(\"Unable to save to localStorage\", err);\n  }\n}\n\nfunction getStorage(locale: string): LocaleStorageData | null {\n  try {\n    const stored = JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\");\n    if (stored) {\n      return stored[locale] as LocaleStorageData;\n    }\n  } catch (err) {\n    console.warn(\"Unable to retrieve from localStorage\", err);\n  }\n  return null;\n}\n\nexport function MissingTranslations() {\n  const { locale } = useParams();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n\n  const [lastData, setLastData] = React.useState<Data | null>(null);\n\n  React.useEffect(() => {\n    if (locale.toLowerCase() === \"en-us\") {\n      navigate(`/${locale}/_translations`);\n    }\n  }, [locale, navigate]);\n\n  React.useEffect(() => {\n    let title = \"Missing translations\";\n    if (locale.toLowerCase() !== \"en-us\") {\n      title += ` for ${locale}`;\n    }\n    if (lastData) {\n      title = `(${lastData.counts.missing.toLocaleString()} found) ${title}`;\n    }\n    document.title = title;\n  }, [lastData, locale]);\n\n  const { data, error, isValidating } = useSWR<Data, Error>(\n    locale.toLowerCase() !== \"en-us\"\n      ? `/_translations/missing/?locale=${locale}`\n      : null,\n    async (url) => {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`${response.status} (${await response.text()})`);\n      }\n      if (\n        !(response.headers.get(\"content-type\") || \"\").includes(\n          \"application/json\"\n        )\n      ) {\n        throw new Error(\n          `Response is not JSON (${response.headers.get(\"content-type\")})`\n        );\n      }\n      return response.json();\n    },\n    {\n      revalidateOnFocus: false,\n    }\n  );\n\n  // Use this to be able to figure out how long the XHR takes when there's no cache\n  const startTime = React.useRef<Date>();\n  React.useEffect(() => {\n    if (locale) {\n      if (!data) {\n        startTime.current = new Date();\n      } else {\n        if (\n          data.counts.cacheMisses > 0 &&\n          data.counts.cacheMisses === data.counts.total &&\n          startTime.current\n        ) {\n          const lastLoadTime =\n            new Date().getTime() - startTime.current.getTime();\n          saveStorage(locale, { lastLoadTime });\n        }\n      }\n    }\n  }, [locale, data]);\n\n  React.useEffect(() => {\n    if (data) {\n      setLastData(data);\n    }\n  }, [data]);\n\n  const lastStorageData = getStorage(locale);\n  const defaultSort = lastStorageData?.defaultSort || \"popularity\";\n  const defaultSortReverse = lastStorageData?.defaultSortReverse || \"false\";\n  const sort = searchParams.get(\"sort\") || defaultSort;\n  const sortReverse = JSON.parse(\n    searchParams.get(\"sortReverse\") || defaultSortReverse\n  );\n\n  React.useEffect(() => {\n    saveStorage(\n      locale,\n      Object.assign({}, lastStorageData, {\n        defaultSort: sort,\n        defaultSortReverse: sortReverse,\n      })\n    );\n  }, [locale, sort, sortReverse, lastStorageData]);\n\n  if (locale.toLowerCase() === \"en-us\") {\n    return null;\n  }\n\n  return (\n    <Container>\n      {lastData && !error && isValidating && (\n        <p style={{ float: \"right\" }}>Reloading...</p>\n      )}\n      {!data && !error && !lastData && (\n        <Loading\n          estimate={\n            (lastStorageData && lastStorageData.lastLoadTime) || 30 * 1000\n          }\n        />\n      )}\n      {lastData && (\n        <p style={{ textAlign: \"right\" }}>\n          Go to{\" \"}\n          <Link to={`/${locale}/_translations/differences`}>\n            Translation differences for <b>{locale}</b>\n          </Link>\n        </p>\n      )}\n      {error && <ShowSearchError error={error} />}\n      {lastData && (\n        <div className=\"filter-documents\">\n          <FilterControls />\n          <DocumentsTable\n            counts={lastData.counts}\n            documents={lastData.missingDocuments}\n            sort={sort}\n            sortReverse={sortReverse}\n          />\n        </div>\n      )}\n      {data && <BuildTimes times={data.times} />}\n    </Container>\n  );\n}\n\nfunction Container({ children }: { children: React.ReactNode }) {\n  return (\n    <div className=\"missing-translations\">\n      <PageContentContainer>{children}</PageContentContainer>\n    </div>\n  );\n}\n\nfunction ShowSearchError({ error }) {\n  return (\n    <div className=\"error-message search-error\">\n      <h3>Search error</h3>\n      <pre>{error.toString()}</pre>\n    </div>\n  );\n}\n\nfunction BuildTimes({ times }: { times: Times }) {\n  function format(ms: number) {\n    if (ms > 1000) {\n      const s = ms / 1000;\n      return `${s.toFixed(1)} seconds`;\n    } else {\n      return `${Math.trunc(ms)} milliseconds`;\n    }\n  }\n  return (\n    <div className=\"search-times\">\n      <p>Time to find all documents {format(times.took)}</p>\n    </div>\n  );\n}\n\nfunction Loading({ estimate }: { estimate: number }) {\n  const startLoadingTime = new Date();\n  const [estimateEndTime] = React.useState(\n    new Date(startLoadingTime.getTime() + estimate)\n  );\n\n  const [, setIncrements] = React.useState(0);\n  React.useEffect(() => {\n    const interval = setInterval(() => {\n      setIncrements((state) => state + 1);\n    }, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const distance = estimateEndTime.getTime() - startLoadingTime.getTime();\n  const elapsed = new Date().getTime() - startLoadingTime.getTime();\n  const percent = (100 * elapsed) / distance;\n  return (\n    <div className=\"loading\">\n      <progress id=\"progress\" max=\"100\" value={percent} style={{ margin: 20 }}>\n        {percent}%\n      </progress>\n      <br />\n      <small>\n        Estimated time to finish: {((distance - elapsed) / 1000).toFixed(0)}s{\" \"}\n        {elapsed > distance ? (\n          <span aria-label=\"weird\" role=\"img\">\n            \n          </span>\n        ) : null}\n      </small>\n    </div>\n  );\n}\n\nfunction FilterControls() {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [title, setTitle] = React.useState(searchParams.get(\"title\") || \"\");\n  const [url, setURL] = React.useState(searchParams.get(\"url\") || \"\");\n\n  function refreshFilters(reset = false) {\n    const filterParams = createSearchParams(searchParams);\n    for (const [key, value] of [\n      [\"url\", url],\n      [\"title\", title],\n    ]) {\n      if (!reset && value) {\n        filterParams.set(key, value);\n      } else {\n        filterParams.delete(key);\n      }\n    }\n    filterParams.delete(\"page\");\n    setSearchParams(filterParams);\n  }\n\n  function resetFilters() {\n    setURL(\"\");\n    setTitle(\"\");\n    refreshFilters(true);\n  }\n\n  return (\n    <div className=\"filters\">\n      <h3>Filters</h3>\n      <form\n        onSubmit={(event) => {\n          event.preventDefault();\n          refreshFilters();\n        }}\n      >\n        <div>\n          <h4>Document</h4>\n          <input\n            type=\"search\"\n            placeholder=\"Filter by document URI\"\n            value={url}\n            onChange={(event) => {\n              setURL(event.target.value);\n            }}\n            onBlur={() => refreshFilters()}\n          />\n          <input\n            type=\"search\"\n            placeholder=\"Filter by document title\"\n            value={title}\n            onChange={(event) => {\n              setTitle(event.target.value);\n            }}\n            onBlur={() => refreshFilters()}\n          />\n        </div>\n\n        <div>\n          <h4>&nbsp;</h4>\n          <button type=\"submit\">Filter now</button>{\" \"}\n          {(url || title) && (\n            <button type=\"button\" onClick={resetFilters}>\n              Reset filters\n            </button>\n          )}\n        </div>\n      </form>\n    </div>\n  );\n}\ntype NumericOperation = {\n  operation: \"eq\" | \"gt\" | \"gte\" | \"lt\" | \"lte\";\n  value: number;\n};\n\nfunction getNumericOperation(expression: string): NumericOperation | null {\n  function parseIntOrThrow(v: string) {\n    if (!v) {\n      throw new Error(\"Can't be empty\");\n    }\n\n    const parsed = parseInt(v, 10);\n    if (isNaN(parsed)) {\n      throw new Error(`'${v}' not a valid number`);\n    }\n    return parsed;\n  }\n  try {\n    if (expression.startsWith(\">=\")) {\n      return {\n        operation: \"gte\",\n        value: parseIntOrThrow(expression.replace(\">=\", \"\")),\n      };\n    } else if (expression.startsWith(\">\")) {\n      return {\n        operation: \"gt\",\n        value: parseIntOrThrow(expression.replace(\">\", \"\")),\n      };\n    } else if (expression.startsWith(\"<=\")) {\n      return {\n        operation: \"lte\",\n        value: parseIntOrThrow(expression.replace(\"<=\", \"\")),\n      };\n    } else if (expression.startsWith(\"<\")) {\n      return {\n        operation: \"lt\",\n        value: parseIntOrThrow(expression.replace(\"<\", \"\")),\n      };\n    } else if (expression.startsWith(\"==\") || expression.startsWith(\"=\")) {\n      return {\n        operation: \"eq\",\n        value: parseIntOrThrow(expression.replace(/=/g, \"\")),\n      };\n    } else if (expression) {\n      return {\n        operation: \"eq\",\n        value: parseIntOrThrow(expression),\n      };\n    } else {\n      return null;\n    }\n  } catch (error) {\n    console.warn(error);\n    return null;\n  }\n}\n\nfunction matchNumericOperation(value: number, op: NumericOperation): boolean {\n  if (op.operation === \"eq\") {\n    if (value !== op.value) {\n      return false;\n    }\n  } else if (op.operation === \"gt\") {\n    if (!(value > op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"gte\") {\n    if (!(value >= op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"lt\") {\n    if (!(value < op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"lte\") {\n    if (!(value <= op.value)) {\n      return false;\n    }\n  } else {\n    throw new Error(`Not implemented operation '${op.operation}'`);\n  }\n  return true;\n}\n\nfunction DocumentsTable({\n  counts,\n  documents,\n  sort,\n  sortReverse,\n}: {\n  counts: Counts;\n  documents: Document[];\n  sort: string;\n  sortReverse: boolean;\n}) {\n  const [searchParams, setSearchParams] = useSearchParams();\n\n  const page = parseInt(searchParams.get(\"page\") || \"1\", 10);\n  const pageSize = parseInt(searchParams.get(\"pageSize\") || \"20\", 10);\n  const filterTitle = searchParams.get(\"title\") || \"\";\n  const filterURL = searchParams.get(\"url\") || \"\";\n  const filterDifferences = searchParams.get(\"differences\") || \"\";\n  const filterDifferencesOperation = getNumericOperation(filterDifferences);\n\n  function TableHead({ id, title }: { id: string; title: string }) {\n    return (\n      <th\n        onClick={() => {\n          if (sort === id) {\n            setSearchParams(\n              createSearchParams({\n                sort: id,\n                sortReverse: JSON.stringify(!sortReverse),\n              })\n            );\n          } else {\n            setSearchParams(createSearchParams({ sort: id }));\n          }\n        }}\n        className={`sortable ${sort === id ? \"active\" : \"\"} ${\n          sort === id && sortReverse ? \"reverse\" : \"\"\n        }`}\n      >\n        {title}\n      </th>\n    );\n  }\n\n  const filteredDocuments = documents\n    .filter((document) => {\n      if (\n        filterTitle &&\n        !document.title.toLowerCase().includes(filterTitle.toLowerCase())\n      ) {\n        return false;\n      }\n\n      if (\n        filterURL &&\n        !document.mdn_url.toLowerCase().includes(filterURL.toLowerCase())\n      ) {\n        return false;\n      }\n\n      if (\n        filterDifferencesOperation &&\n        !matchNumericOperation(\n          document.differences.total,\n          filterDifferencesOperation\n        )\n      ) {\n        return false;\n      }\n\n      return true;\n    })\n    .sort((A, B) => {\n      let reverse = sortReverse ? -1 : 1;\n      if (sort === \"modified\") {\n        const a = new Date(A.edits.modified);\n        const b = new Date(B.edits.modified);\n        return reverse * (b.getTime() - a.getTime());\n      } else if (sort === \"popularity\") {\n        const a = A.popularity.value;\n        const b = B.popularity.value;\n        return reverse * (b - a);\n      } else if (sort === \"differences\") {\n        const a = A.differences.total;\n        const b = B.differences.total;\n        return reverse * (b - a);\n      } else if (sort === \"title\") {\n        const a = A.title;\n        const b = B.title;\n        return reverse * a.localeCompare(b);\n      } else if (sort === \"mdn_url\") {\n        const a = A.mdn_url;\n        const b = B.mdn_url;\n        return reverse * a.localeCompare(b);\n      } else {\n        throw new Error(`Unrecognized sort '${sort}'`);\n      }\n    });\n  const pageCount = Math.ceil(counts.total / pageSize);\n\n  return (\n    <div className=\"documents\">\n      <h3>\n        {counts.missing.toLocaleString()} missing translations (of{\" \"}\n        {counts.total.toLocaleString()} possible)\n      </h3>\n\n      <table>\n        <thead>\n          <tr>\n            <TableHead id=\"title\" title=\"Document\" />\n            <TableHead id=\"popularity\" title=\"Popularity\" />\n            <TableHead id=\"modified\" title=\"Last modified\" />\n          </tr>\n        </thead>\n        <tbody>\n          {filteredDocuments\n            .slice((page - 1) * pageSize, page * pageSize)\n            .map((doc: Document) => {\n              return (\n                <tr key={doc.mdn_url}>\n                  <td>\n                    <span className=\"document-title-preview\">\n                      {filterTitle ? (\n                        <HighlightedText\n                          text={doc.title}\n                          highlight={filterTitle}\n                        />\n                      ) : (\n                        doc.title\n                      )}\n                    </span>\n                    <br />\n                    <Link\n                      to={`${doc.mdn_url}#_flaws`}\n                      title={doc.title}\n                      target=\"_blank\"\n                    >\n                      <BriefURL uri={doc.mdn_url} filterURL={filterURL} />\n                    </Link>\n                  </td>\n                  <td\n                    title={\n                      doc.popularity.ranking\n                        ? `Meaning there are ${\n                            doc.popularity.ranking - 1\n                          } more popular pages than this`\n                        : \"Meaning it has no ranking. Most likely a very rare (or new) document\"\n                    }\n                  >\n                    {!doc.popularity.ranking\n                      ? \"n/a\"\n                      : `${getGetOrdinal(doc.popularity.ranking)}`}{\" \"}\n                  </td>\n                  <td>\n                    <LastModified edits={doc.edits} />\n                  </td>\n                </tr>\n              );\n            })}\n        </tbody>\n      </table>\n      {pageCount > 1 && (\n        <p className=\"pagination\">\n          <PageLink number={1} disabled={page === 1}>\n            First page\n          </PageLink>{\" \"}\n          {page > 2 && (\n            <PageLink number={page - 1}>Previous page ({page - 1})</PageLink>\n          )}{\" \"}\n          <PageLink number={page + 1} disabled={page + 1 > pageCount}>\n            Next page ({page + 1})\n          </PageLink>\n        </p>\n      )}\n    </div>\n  );\n}\n\nfunction LastModified({ edits }: { edits: DocumentEdits }) {\n  const modified = dayjs(edits.modified);\n  return (\n    <span className=\"last_modified\">\n      <a href={edits.commitURL} target=\"_blank\" rel=\"noreferrer\">\n        <time dateTime={modified.toISOString()} title={modified.toISOString()}>\n          {modified.fromNow()}\n        </time>\n      </a>\n    </span>\n  );\n}\n\nfunction HighlightedText({\n  text,\n  highlight,\n}: {\n  text: string;\n  highlight: string;\n}) {\n  // Split on highlight term and include term into parts, ignore case\n  const parts = text.split(new RegExp(`(${highlight})`, \"gi\"));\n  return (\n    <span>\n      {\" \"}\n      {parts.map((part, i) => (\n        <span\n          key={i}\n          style={\n            part.toLowerCase() === highlight.toLowerCase()\n              ? { fontWeight: \"bold\" }\n              : {}\n          }\n        >\n          {part}\n        </span>\n      ))}{\" \"}\n    </span>\n  );\n}\n\nfunction BriefURL({ uri, filterURL }: { uri: string; filterURL: string }) {\n  const [left, right] = uri.split(/\\/docs\\//, 2);\n  return (\n    <>\n      <span className=\"url-prefix\">{left}/docs/</span>\n      <span className=\"url-slug\">\n        {filterURL ? (\n          <HighlightedText text={right} highlight={filterURL} />\n        ) : (\n          right\n        )}\n      </span>\n    </>\n  );\n}\n\n// https://gist.github.com/jlbruno/1535691/db35b4f3af3dcbb42babc01541410f291a8e8fac\nfunction getGetOrdinal(n: number) {\n  const s = [\"th\", \"st\", \"nd\", \"rd\"];\n  const v = n % 100;\n  return n.toLocaleString() + (s[(v - 20) % 10] || s[v] || s[0]);\n}\n\nfunction PageLink({\n  number,\n  disabled,\n  children,\n}: {\n  number: number;\n  disabled?: boolean;\n  children: React.ReactNode;\n}) {\n  const [searchParams] = useSearchParams();\n  const params = createSearchParams(searchParams);\n  if (number > 1) {\n    params.set(\"page\", `${number}`);\n  } else {\n    params.delete(\"page\");\n  }\n  return (\n    <Link\n      to={\"?\" + params.toString()}\n      className={disabled ? \"disabled\" : \"\"}\n      onClick={(event) => {\n        if (disabled) {\n          event.preventDefault();\n        }\n        const top = document.querySelector(\"div.all-translations\");\n        if (top) {\n          top.scrollIntoView({ behavior: \"smooth\" });\n        }\n      }}\n    >\n      {children}\n    </Link>\n  );\n}\n","import React from \"react\";\nimport {\n  createSearchParams,\n  Link,\n  useParams,\n  useSearchParams,\n  useNavigate,\n} from \"react-router-dom\";\nimport useSWR from \"swr\";\n\nimport { PageContentContainer } from \"../../ui/atoms/page-content\";\n\ninterface Data {\n  l10nKPIs: L10nKPIs;\n  sections: Section[];\n  detailDocuments: DetailDocument[];\n}\n\ninterface Section {\n  l10nKPIs: L10nKPIs;\n  name: string;\n}\n\ninterface L10nKPIs {\n  missing: number;\n  outOfDate: number;\n  upToDate: number;\n  total: number;\n}\n\ninterface DetailDocument {\n  url: string;\n  info: InfoDocument;\n}\n\ninterface InfoDocument {\n  popularity: DocumentPopularity;\n  localePopularity: DocumentPopularity;\n  defaultLocaleInfo: LocaleInfo;\n  localeInfo?: LocaleInfo;\n  dateDiff?: number;\n}\n\ninterface DocumentPopularity {\n  value: number;\n  ranking: number;\n  parentValue: number;\n  parentRanking: number;\n}\n\ninterface LocaleInfo {\n  modified: string;\n  commitURL: string;\n}\n\ninterface LocaleStorageData {\n  defaultSort?: string;\n  defaultSortReverse?: string;\n}\n\ninterface StorageData {\n  [locale: string]: LocaleStorageData;\n}\n\nconst LOCALSTORAGE_KEY = \"translations-dashboard-sections\";\n\nfunction saveStorage(locale: string, data: LocaleStorageData) {\n  try {\n    const stored = JSON.parse(\n      localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\"\n    ) as StorageData;\n    stored[locale] = Object.assign({}, stored[locale] || {}, data);\n    localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(stored));\n  } catch (err) {\n    console.warn(\"Unable to save to localStorage\", err);\n  }\n}\n\nfunction getStorage(locale: string): LocaleStorageData | null {\n  try {\n    const stored = JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\");\n    if (stored) {\n      return stored[locale] as LocaleStorageData;\n    }\n  } catch (err) {\n    console.warn(\"Unable to retrieve from localStorage\", err);\n  }\n  return null;\n}\n\nexport function TranslationDashboard() {\n  const { locale } = useParams();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n\n  const [lastData, setLastData] = React.useState<Data | null>(null);\n\n  const currentSection = searchParams.get(\"section\") || \"\";\n  React.useEffect(() => {\n    if (locale.toLowerCase() === \"en-us\") {\n      navigate(`/${locale}/_translations`);\n    }\n  }, [locale, navigate]);\n\n  React.useEffect(() => {\n    let title = \"Translation dashboard \";\n    if (locale.toLowerCase() !== \"en-us\") {\n      title += ` for ${locale}`;\n    }\n    if (currentSection !== \"\") {\n      title += ` - section ${currentSection}`;\n    }\n    document.title = title;\n  }, [lastData, locale, currentSection]);\n\n  let { data, error, isValidating } = useSWR<Data, Error>(\n    locale.toLowerCase() !== \"en-us\"\n      ? `/_translations/dashboard/?locale=${locale}&section=${currentSection}`\n      : null,\n    async (url) => {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`${response.status} (${await response.text()})`);\n      }\n      if (\n        !(response.headers.get(\"content-type\") || \"\").includes(\n          \"application/json\"\n        )\n      ) {\n        throw new Error(\n          `Response is not JSON (${response.headers.get(\"content-type\")})`\n        );\n      }\n      return response.json();\n    },\n    {\n      revalidateOnFocus: false,\n    }\n  );\n\n  React.useEffect(() => {\n    if (data) {\n      setLastData(data);\n    }\n  }, [data]);\n\n  const lastStorageData = getStorage(locale);\n  const defaultSort = lastStorageData?.defaultSort || \"url\";\n  const defaultSortReverse = lastStorageData?.defaultSortReverse || \"false\";\n  const sort = searchParams.get(\"sort\") || defaultSort;\n  const sortReverse = JSON.parse(\n    searchParams.get(\"sortReverse\") || defaultSortReverse\n  );\n\n  React.useEffect(() => {\n    saveStorage(\n      locale,\n      Object.assign({}, lastStorageData, {\n        defaultSort: sort,\n        defaultSortReverse: sortReverse,\n      })\n    );\n  }, [locale, sort, sortReverse, lastStorageData]);\n\n  if (locale.toLowerCase() === \"en-us\") {\n    return null;\n  }\n\n  let parentSection = \"/\";\n  if (currentSection.split(\"/\").length > 2) {\n    const arrPathSection = currentSection.split(\"/\");\n    arrPathSection.pop();\n    parentSection = arrPathSection.join(\"/\");\n  }\n\n  return (\n    <Container>\n      {lastData && !error && isValidating && (\n        <p style={{ float: \"right\" }}>Reloading...</p>\n      )}\n      {!data && !error && !lastData && <Loading />}\n      {lastData && (\n        <p style={{ textAlign: \"right\" }}>\n          Go to{\" \"}\n          <Link to={`/${locale}/_translations/differences`}>\n            Translation differences for <b>{locale}</b>\n          </Link>\n          {\" / \"}\n          <Link to={`/${locale}/_translations/missing`}>\n            Missing translations for <b>{locale}</b>\n          </Link>\n        </p>\n      )}\n      {error && <ShowError error={error} />}\n      {lastData && (\n        <div className=\"filter-documents\">\n          <SectionHeader\n            l10nKPIs={lastData.l10nKPIs}\n            section={currentSection}\n            parentSection={parentSection}\n          />\n          <SubsectionTable\n            sections={lastData.sections}\n            currentSection={currentSection}\n          />\n          <DocumentsTable\n            documents={lastData.detailDocuments}\n            sort={sort}\n            sortReverse={sortReverse}\n            locale={locale}\n          />\n        </div>\n      )}\n    </Container>\n  );\n  /* \n     );\n    }\n */\n}\n\nfunction Container({ children }: { children: React.ReactNode }) {\n  return (\n    <div className=\"dashboard-section-translations\">\n      <PageContentContainer>{children}</PageContentContainer>\n    </div>\n  );\n}\n\nfunction ShowError({ error }) {\n  return (\n    <div className=\"error-message\">\n      <h3>Error</h3>\n      <pre>{error.toString()}</pre>\n    </div>\n  );\n}\n\nfunction Loading() {\n  return (\n    <div>\n      <label htmlFor=\"progress\">Loading</label>\n      <progress id=\"progress\" max=\"100\" style={{ margin: 20 }}></progress>\n    </div>\n  );\n}\n\nfunction SectionHeader({\n  l10nKPIs,\n  section,\n  parentSection,\n}: {\n  l10nKPIs: L10nKPIs;\n  section: string;\n  parentSection: string;\n}) {\n  const completenessExact =\n    (100 * (l10nKPIs.total - l10nKPIs.missing)) / l10nKPIs.total;\n  const completenessStr = completenessExact.toFixed(1) + \"%\";\n  const freshnessExact = (100 * l10nKPIs.upToDate) / l10nKPIs.total;\n  const freshnessStr = freshnessExact.toFixed(1) + \"%\";\n  return (\n    <div className=\"documents\">\n      <h2>Localization dashboard for: {section || \"/\"}</h2>\n      <p>\n        Parent section:{\" \"}\n        <a href={`dashboard?section=${parentSection}`}>{parentSection}</a>\n      </p>\n      <h3>Summary</h3>\n      <dl>\n        <dt>Total number of pages</dt>\n        <dd>{l10nKPIs.total}</dd>\n        <dt>Number of untranslated pages</dt>\n        <dd>{l10nKPIs.missing}</dd>\n        <dt>Number of outdated pages (older than English in Git) </dt>\n        <dd>{l10nKPIs.outOfDate}</dd>\n        <dt>Number of up-to-date pages</dt>\n        <dd>{l10nKPIs.upToDate}</dd>\n        <dt>\n          <label htmlFor=\"completeness\">Localization completeness</label>\n        </dt>\n        <dd>\n          <progress id=\"completeness\" max=\"100\" value={completenessExact}>\n            {completenessStr}\n          </progress>{\" \"}\n          {completenessStr}\n        </dd>\n        <dt>\n          <label htmlFor=\"freshness\">Localization freshness</label>\n        </dt>\n        <dd>\n          <progress id=\"freshness\" max=\"100\" value={freshnessExact}>\n            {freshnessStr}\n          </progress>{\" \"}\n          {freshnessStr}\n        </dd>\n      </dl>\n    </div>\n  );\n}\n\nfunction SubsectionTable({\n  sections,\n  currentSection,\n}: {\n  sections: Section[];\n  currentSection: string;\n}) {\n  if (sections.length > 0) {\n    return (\n      <section id=\"subsection-table\">\n        <h3>Subsections</h3>\n        <table>\n          <thead>\n            <tr>\n              <th>Section</th>\n              <th>Total / Untranslated / Out of date</th>\n              <th>Completeness</th>\n              <th>Freshness</th>\n            </tr>\n          </thead>\n          <tbody>\n            {sections\n              .sort(\n                (sectionA, sectionB) =>\n                  sectionB.l10nKPIs.total - sectionA.l10nKPIs.total\n              )\n              .map((section) => {\n                const completenessExact =\n                  (100 * (section.l10nKPIs.total - section.l10nKPIs.missing)) /\n                  section.l10nKPIs.total;\n                const completenessStr = completenessExact.toFixed(1) + \"%\";\n                const freshnessExact =\n                  (100 * section.l10nKPIs.upToDate) / section.l10nKPIs.total;\n                const freshnessStr = freshnessExact.toFixed(1) + \"%\";\n                const sectionHref =\n                  \"dashboard?section=%2F\" + encodeURIComponent(section.name);\n                return (\n                  <tr key={section.name}>\n                    <td>\n                      <a href={sectionHref}>\n                        {section.name\n                          .replace(currentSection.slice(1), \"\")\n                          .replace(\"/\", \"\")}\n                      </a>\n                    </td>\n                    <td>\n                      {section.l10nKPIs.total} / {section.l10nKPIs.missing} /{\" \"}\n                      {section.l10nKPIs.outOfDate}\n                    </td>\n                    <td>\n                      <progress max=\"100\" value={completenessExact}>\n                        {completenessStr}\n                      </progress>{\" \"}\n                      {completenessStr}\n                    </td>\n                    <td>\n                      <progress max=\"100\" value={freshnessExact}>\n                        {freshnessStr}\n                      </progress>{\" \"}\n                      {freshnessStr}\n                    </td>\n                  </tr>\n                );\n              })}\n          </tbody>\n        </table>\n      </section>\n    );\n  } else {\n    return null;\n  }\n}\n\nfunction DocumentsTable({\n  documents,\n  sort,\n  sortReverse,\n  locale,\n}: {\n  documents: DetailDocument[];\n  sort: string;\n  sortReverse: boolean;\n  locale: string;\n}) {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const currentSection = searchParams.get(\"section\") || \"\";\n  documents.map((documentDetail) => {\n    if (documentDetail.info.localeInfo) {\n      const dateLocale = new Date(documentDetail.info.localeInfo.modified);\n      const dateDefaultLocale = new Date(\n        documentDetail.info.defaultLocaleInfo.modified\n      );\n      const dateDiff = dateLocale.getTime() - dateDefaultLocale.getTime();\n      documentDetail.info.dateDiff = dateDiff;\n    } else {\n      documentDetail.info.dateDiff = Number.POSITIVE_INFINITY;\n    }\n    return documentDetail;\n  });\n\n  function TableHead({ id, title }: { id: string; title: string }) {\n    return (\n      <th\n        onClick={() => {\n          if (sort === id) {\n            setSearchParams(\n              createSearchParams({\n                sort: id,\n                sortReverse: JSON.stringify(!sortReverse),\n                section: currentSection,\n              })\n            );\n          } else {\n            setSearchParams(\n              createSearchParams({ sort: id, section: currentSection })\n            );\n          }\n        }}\n        className={`sortable ${sort === id ? \"active\" : \"\"} ${\n          sort === id && sortReverse ? \"reverse\" : \"\"\n        }`}\n      >\n        {title}\n      </th>\n    );\n  }\n\n  return (\n    <section id=\"documents-table\">\n      <h3>List of direct subpages</h3>\n      <table>\n        <thead>\n          <tr>\n            <TableHead id=\"url\" title=\"Slug\" />\n            <TableHead id=\"enMDNURL\" title=\"English doc on MDN\" />\n            <TableHead\n              id=\"enCommitGHURL\"\n              title=\"English doc commit on GitHub\"\n            />\n            <TableHead id=\"localURL\" title=\"Local localized doc\" />\n            <TableHead id=\"localMDNURL\" title=\"Localized doc on MDN\" />\n            <TableHead\n              id=\"localCommitGHURL\"\n              title=\"Localized doc commit on GitHub\"\n            />\n            <TableHead id=\"popularityEn\" title=\"Popularity rank (en-US)\" />\n            <TableHead\n              id=\"popularityLocale\"\n              title=\"Popularity rank ({locale})\"\n            />\n            <TableHead id=\"dateDiff\" title=\"Date delta\" />\n          </tr>\n        </thead>\n        <tbody>\n          {documents\n            .sort((A, B) => {\n              let reverse = sortReverse ? -1 : 1;\n              if (sort === \"dateDiff\") {\n                const a = A.info.dateDiff || Number.POSITIVE_INFINITY;\n                const b = B.info.dateDiff || Number.POSITIVE_INFINITY;\n                return reverse * (b - a);\n              } else if (sort === \"popularityLocale\") {\n                const a =\n                  A.info.localePopularity?.ranking || Number.POSITIVE_INFINITY;\n                const b =\n                  B.info.localePopularity?.ranking || Number.POSITIVE_INFINITY;\n                return reverse * (a - b);\n              } else if (sort === \"popularityEn\") {\n                const a = A.info.popularity.ranking || Number.POSITIVE_INFINITY;\n                const b = B.info.popularity.ranking || Number.POSITIVE_INFINITY;\n                return reverse * (a - b);\n              } else if (sort === \"url\") {\n                const a = A.url;\n                const b = B.url;\n                return reverse * a.localeCompare(b);\n              } else {\n                throw new Error(`Unrecognized sort '${sort}'`);\n              }\n            })\n            .map((documentDetail) => {\n              const url = \"https://developer.mozilla.org\" + documentDetail.url;\n              const englishCommitHash =\n                documentDetail.info.defaultLocaleInfo.commitURL\n                  .split(\"commit/\")[1]\n                  .substring(0, 7);\n              const localeCommitHash = documentDetail.info.localeInfo?.commitURL\n                .split(\"commit/\")[1]\n                .substring(0, 7);\n              let status = \"Untranslated\";\n              if (documentDetail.info.localeInfo) {\n                let dateDiff =\n                  documentDetail.info.dateDiff ?? Number.POSITIVE_INFINITY;\n                status = \"Out of date\";\n\n                if (dateDiff > 0) {\n                  status = \"Fresher than English\";\n                } else if (dateDiff > -2678400000) {\n                  const nbDays = Math.round(-dateDiff / (3600 * 24 * 1000));\n                  status = nbDays + \" day\" + (nbDays > 1 ? \"s\" : \"\");\n                } else {\n                  const nbMonths = Math.round(\n                    -dateDiff / (3600 * 24 * 1000 * 30)\n                  );\n                  status = nbMonths + \" month\" + (nbMonths > 1 ? \"s\" : \"\");\n                }\n              }\n              return (\n                <tr key={documentDetail.url}>\n                  <td>\n                    <a href={documentDetail.url}>{documentDetail.url}</a>\n                  </td>\n                  <td>\n                    <a href={url}>English current MDN page</a>\n                  </td>\n                  <td>\n                    <a href={documentDetail.info.defaultLocaleInfo.commitURL}>\n                      GitHub link for <code>{englishCommitHash}</code>\n                    </a>\n                  </td>\n                  <td>\n                    {documentDetail.info.localeInfo && (\n                      <a\n                        href={documentDetail.url.replace(\n                          \"/en-US/\",\n                          \"/\" + locale + \"/\"\n                        )}\n                      >\n                        Local {locale} page\n                      </a>\n                    )}\n                  </td>\n                  <td>\n                    {documentDetail.info.localeInfo && (\n                      <a href={url.replace(\"/en-US/\", \"/\" + locale + \"/\")}>\n                        Locale current MDN page\n                      </a>\n                    )}\n                  </td>\n                  <td>\n                    {documentDetail.info.localeInfo && (\n                      <a href={documentDetail.info.localeInfo.commitURL}>\n                        GitHub link for <code>{localeCommitHash}</code>\n                      </a>\n                    )}\n                  </td>\n                  <td>{documentDetail.info.popularity.ranking}</td>\n                  <td>\n                    {documentDetail.info.localePopularity &&\n                      documentDetail.info.localePopularity.ranking}\n                  </td>\n                  <td>{status}</td>\n                </tr>\n              );\n            })}\n        </tbody>\n      </table>\n    </section>\n  );\n}\n","import React from \"react\";\nimport { Link, useParams, Routes, Route } from \"react-router-dom\";\nimport useSWR from \"swr\";\n\nimport \"./index.scss\";\n\nimport { Loading } from \"../ui/atoms/loading\";\nimport { PageContentContainer } from \"../ui/atoms/page-content\";\n\nimport { TranslationDifferences } from \"./differences\";\nimport { MissingTranslations } from \"./missing\";\nimport { TranslationDashboard } from \"./dashboard\";\n\ninterface Locale {\n  locale: string;\n  language: {\n    English: string;\n    native: string;\n  };\n  isActive: boolean;\n  count: number;\n}\n\ninterface LocalesData {\n  locales: Locale[];\n}\n\nexport default function Translations() {\n  return (\n    <Container>\n      <Routes>\n        <Route path=\"/\" element={<PickLocale />} />\n        <Route path=\"differences\" element={<TranslationDifferences />} />\n        <Route path=\"missing\" element={<MissingTranslations />} />\n        <Route path=\"dashboard\" element={<TranslationDashboard />} />\n      </Routes>\n    </Container>\n  );\n}\n\nfunction PickLocale() {\n  const { locale } = useParams();\n  React.useEffect(() => {\n    let title = \"All translations\";\n    if (locale.toLowerCase() !== \"en-us\") {\n      title += ` for ${locale}`;\n    }\n    document.title = title;\n  }, [locale]);\n\n  const { data: dataLocales, error: errorLocales } = useSWR<LocalesData, Error>(\n    locale.toLowerCase() === \"en-us\" ? \"/_translations/\" : null,\n    async (url) => {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`${response.status} (${await response.text()})`);\n      }\n      return response.json();\n    }\n  );\n\n  if (locale.toLowerCase() === \"en-us\") {\n    return (\n      <>\n        {!dataLocales && !errorLocales && <Loading />}\n        {errorLocales && (\n          <div className=\"error-message\">\n            <h3>Server error</h3>\n            <pre>{errorLocales.toString()}</pre>\n          </div>\n        )}\n        {dataLocales && <ShowLocales locales={dataLocales.locales} />}\n      </>\n    );\n  }\n\n  return (\n    <div className=\"translation-choices\">\n      <Link to={`/${locale}/_translations/differences`} className=\"button\">\n        Translation differences\n      </Link>{\" \"}\n      <Link to={`/${locale}/_translations/missing`} className=\"button\">\n        Missing translations\n      </Link>{\" \"}\n      <Link to={`/${locale}/_translations/dashboard`} className=\"button\">\n        Dashboard\n      </Link>\n    </div>\n  );\n}\n\nfunction Container({ children }: { children: React.ReactNode }) {\n  return (\n    <div className=\"all-translations\">\n      <PageContentContainer>{children}</PageContentContainer>\n    </div>\n  );\n}\n\nfunction ShowLocales({ locales }: { locales: Locale[] }) {\n  return (\n    <div>\n      <h2>Select locale</h2>\n      <table>\n        <tbody>\n          {locales.map((locale) => {\n            return (\n              <tr key={locale.locale}>\n                <td>\n                  <b>\n                    {locale.language.English} ({locale.locale})\n                  </b>{\" \"}\n                  {!locale.isActive && <small>not active</small>}\n                </td>\n                <td>{locale.count.toLocaleString()} documents</td>\n                <td>\n                  <Link to={`/${locale.locale}/_translations/differences`}>\n                    Translation differences\n                  </Link>{\" \"}\n                </td>\n                <td>\n                  <Link to={`/${locale.locale}/_translations/missing`}>\n                    Missing translations\n                  </Link>{\" \"}\n                </td>\n                <td>\n                  <Link to={`/${locale.locale}/_translations/dashboard`}>\n                    Dashboard\n                  </Link>{\" \"}\n                </td>\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n","!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).dayjs=e()}(this,(function(){\"use strict\";var t=1e3,e=6e4,n=36e5,r=\"millisecond\",i=\"second\",s=\"minute\",u=\"hour\",a=\"day\",o=\"week\",f=\"month\",h=\"quarter\",c=\"year\",d=\"date\",$=\"Invalid Date\",l=/^(\\d{4})[-/]?(\\d{1,2})?[-/]?(\\d{0,2})[Tt\\s]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?[.:]?(\\d+)?$/,y=/\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:\"en\",weekdays:\"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\"),months:\"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\")},m=function(t,e,n){var r=String(t);return!r||r.length>=e?t:\"\"+Array(e+1-r.length).join(n)+t},g={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?\"+\":\"-\")+m(r,2,\"0\")+\":\"+m(i,2,\"0\")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,f),s=n-i<0,u=e.clone().add(r+(s?-1:1),f);return+(-(r+(n-i)/(s?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:f,y:c,w:o,d:a,D:d,h:u,m:s,s:i,ms:r,Q:h}[t]||String(t||\"\").toLowerCase().replace(/s$/,\"\")},u:function(t){return void 0===t}},D=\"en\",v={};v[D]=M;var p=function(t){return t instanceof _},S=function(t,e,n){var r;if(!t)return D;if(\"string\"==typeof t)v[t]&&(r=t),e&&(v[t]=e,r=t);else{var i=t.name;v[i]=t,r=i}return!n&&r&&(D=r),r||!n&&D},w=function(t,e){if(p(t))return t.clone();var n=\"object\"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},O=g;O.l=S,O.i=p,O.w=function(t,e){return w(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var _=function(){function M(t){this.$L=S(t.locale,null,!0),this.parse(t)}var m=M.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(O.u(e))return new Date;if(e instanceof Date)return new Date(e);if(\"string\"==typeof e&&!/Z$/i.test(e)){var r=e.match(l);if(r){var i=r[2]-1||0,s=(r[7]||\"0\").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return O},m.isValid=function(){return!(this.$d.toString()===$)},m.isSame=function(t,e){var n=w(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return w(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<w(t)},m.$g=function(t,e,n){return O.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!O.u(e)||e,h=O.p(t),$=function(t,e){var i=O.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},l=function(t,e){return O.w(n.toDate()[t].apply(n.toDate(\"s\"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},y=this.$W,M=this.$M,m=this.$D,g=\"set\"+(this.$u?\"UTC\":\"\");switch(h){case c:return r?$(1,0):$(31,11);case f:return r?$(1,M):$(0,M+1);case o:var D=this.$locale().weekStart||0,v=(y<D?y+7:y)-D;return $(r?m-v:m+(6-v),M);case a:case d:return l(g+\"Hours\",0);case u:return l(g+\"Minutes\",1);case s:return l(g+\"Seconds\",2);case i:return l(g+\"Milliseconds\",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,o=O.p(t),h=\"set\"+(this.$u?\"UTC\":\"\"),$=(n={},n[a]=h+\"Date\",n[d]=h+\"Date\",n[f]=h+\"Month\",n[c]=h+\"FullYear\",n[u]=h+\"Hours\",n[s]=h+\"Minutes\",n[i]=h+\"Seconds\",n[r]=h+\"Milliseconds\",n)[o],l=o===a?this.$D+(e-this.$W):e;if(o===f||o===c){var y=this.clone().set(d,1);y.$d[$](l),y.init(),this.$d=y.set(d,Math.min(this.$D,y.daysInMonth())).$d}else $&&this.$d[$](l);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[O.p(t)]()},m.add=function(r,h){var d,$=this;r=Number(r);var l=O.p(h),y=function(t){var e=w($);return O.w(e.date(e.date()+Math.round(t*r)),$)};if(l===f)return this.set(f,this.$M+r);if(l===c)return this.set(c,this.$y+r);if(l===a)return y(1);if(l===o)return y(7);var M=(d={},d[s]=e,d[u]=n,d[i]=t,d)[l]||1,m=this.$d.getTime()+r*M;return O.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||$;var r=t||\"YYYY-MM-DDTHH:mm:ssZ\",i=O.z(this),s=this.$H,u=this.$m,a=this.$M,o=n.weekdays,f=n.months,h=function(t,n,i,s){return t&&(t[n]||t(e,r))||i[n].substr(0,s)},c=function(t){return O.s(s%12||12,t,\"0\")},d=n.meridiem||function(t,e,n){var r=t<12?\"AM\":\"PM\";return n?r.toLowerCase():r},l={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:O.s(a+1,2,\"0\"),MMM:h(n.monthsShort,a,f,3),MMMM:h(f,a),D:this.$D,DD:O.s(this.$D,2,\"0\"),d:String(this.$W),dd:h(n.weekdaysMin,this.$W,o,2),ddd:h(n.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(s),HH:O.s(s,2,\"0\"),h:c(1),hh:c(2),a:d(s,u,!0),A:d(s,u,!1),m:String(u),mm:O.s(u,2,\"0\"),s:String(this.$s),ss:O.s(this.$s,2,\"0\"),SSS:O.s(this.$ms,3,\"0\"),Z:i};return r.replace(y,(function(t,e){return e||l[t]||i.replace(\":\",\"\")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,$){var l,y=O.p(d),M=w(r),m=(M.utcOffset()-this.utcOffset())*e,g=this-M,D=O.m(this,M);return D=(l={},l[c]=D/12,l[f]=D,l[h]=D/3,l[o]=(g-m)/6048e5,l[a]=(g-m)/864e5,l[u]=g/n,l[s]=g/e,l[i]=g/t,l)[y]||g,$?D:O.a(D)},m.daysInMonth=function(){return this.endOf(f).$D},m.$locale=function(){return v[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=S(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return O.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},M}(),b=_.prototype;return w.prototype=b,[[\"$ms\",r],[\"$s\",i],[\"$m\",s],[\"$H\",u],[\"$W\",a],[\"$M\",f],[\"$y\",c],[\"$D\",d]].forEach((function(t){b[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),w.extend=function(t,e){return t.$i||(t(e,_,w),t.$i=!0),w},w.locale=S,w.isDayjs=p,w.unix=function(t){return w(1e3*t)},w.en=v[D],w.Ls=v,w.p={},w}));","!function(r,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(r=\"undefined\"!=typeof globalThis?globalThis:r||self).dayjs_plugin_relativeTime=e()}(this,(function(){\"use strict\";return function(r,e,t){r=r||{};var n=e.prototype,o={future:\"in %s\",past:\"%s ago\",s:\"a few seconds\",m:\"a minute\",mm:\"%d minutes\",h:\"an hour\",hh:\"%d hours\",d:\"a day\",dd:\"%d days\",M:\"a month\",MM:\"%d months\",y:\"a year\",yy:\"%d years\"};function i(r,e,t,o){return n.fromToBase(r,e,t,o)}t.en.relativeTime=o,n.fromToBase=function(e,n,i,d,u){for(var f,a,s,l=i.$locale().relativeTime||o,h=r.thresholds||[{l:\"s\",r:44,d:\"second\"},{l:\"m\",r:89},{l:\"mm\",r:44,d:\"minute\"},{l:\"h\",r:89},{l:\"hh\",r:21,d:\"hour\"},{l:\"d\",r:35},{l:\"dd\",r:25,d:\"day\"},{l:\"M\",r:45},{l:\"MM\",r:10,d:\"month\"},{l:\"y\",r:17},{l:\"yy\",d:\"year\"}],m=h.length,c=0;c<m;c+=1){var y=h[c];y.d&&(f=d?t(e).diff(i,y.d,!0):i.diff(e,y.d,!0));var p=(r.rounding||Math.round)(Math.abs(f));if(s=f>0,p<=y.r||!y.r){p<=1&&c>0&&(y=h[c-1]);var v=l[y.l];u&&(p=u(\"\"+p)),a=\"string\"==typeof v?v.replace(\"%d\",p):v(p,n,y.l,s);break}}if(n)return a;var M=s?l.future:l.past;return\"function\"==typeof M?M(a):M.replace(\"%s\",a)},n.to=function(r,e){return i(r,e,this,!0)},n.from=function(r,e){return i(r,e,this)};var d=function(r){return r.$u?t.utc():t()};n.toNow=function(r){return this.to(d(this),r)},n.fromNow=function(r){return this.from(d(this),r)}}}));"],"sourceRoot":""}