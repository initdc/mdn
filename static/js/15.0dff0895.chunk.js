(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[15],{108:function(e,t,n){},124:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return f}));var c=n(3),r=n(8),a=n.n(r),s=n(12),i=n(1),o=n.n(i),u=n(4),l=n(2),j=n(14),d=n(7),b=n(6),h=n(19),O=n(9),p=n(70),x=(n(108),n(0));function f(e){var t=Object.assign({},e),n=window.location.pathname;n.endsWith("/")||(n+="/"),n+="index.json";var c=Object(j.a)(n,function(){var e=Object(s.a)(a.a.mark((function e(t){var n,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((n=e.sent).ok){e.next=8;break}return e.next=6,n.text();case 6:throw c=e.sent,new Error("".concat(n.status," on ").concat(t,": ").concat(c));case 8:return e.next=10,n.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{initialData:t.possibleLocales?{possibleLocales:t.possibleLocales}:void 0,revalidateOnFocus:!1}),r=c.data,i=c.error,o=Object(h.c)(),u=Object(j.a)(o&&o.isAuthenticated?"/api/v1/settings":null,function(){var e=Object(s.a)(a.a.mark((function e(t){var n,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("".concat(n.status," on ").concat(n.url));case 5:return e.next=7,n.json();case 7:return c=e.sent,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l=u.data,O=u.error;return b.d?Object(x.jsx)(p.a,{}):o?o.isAuthenticated?O?Object(x.jsxs)("div",{className:"notecard negative",children:[Object(x.jsx)("h3",{children:"Server error"}),Object(x.jsx)("p",{children:"A server error occurred trying to get your user settings."}),Object(x.jsx)("p",{children:Object(x.jsx)("code",{children:O.toString()})}),Object(x.jsx)("a",{href:window.location.pathname,children:"Reload this page and try again."})]}):l?i?Object(x.jsxs)("div",{className:"notecard negative",children:[Object(x.jsx)("h3",{children:"Server error"}),Object(x.jsx)("p",{children:"Unable to get the current user settings from the server."}),Object(x.jsx)("p",{children:Object(x.jsx)("code",{children:i.toString()})}),Object(x.jsx)("a",{href:window.location.pathname,children:"Reload this page and try again."})]}):Object(x.jsxs)("div",{className:"account-settings-panels-container",children:[r&&r.possibleLocales&&r.possibleLocales.length&&Object(x.jsx)(v,{userSettings:l,settingsData:r,refreshUserSettings:function(){Object(j.b)("/api/v1/whoami"),Object(j.b)("/api/v1/settings")}}),Object(x.jsx)(m,{userSettings:l})]}):Object(x.jsx)(d.a,{message:"Loading user settings\u2026"}):Object(x.jsx)(g,{}):Object(x.jsx)(d.a,{message:"Loading user data\u2026"})}function g(){var e=Object(O.a)(),t=new URLSearchParams;return t.set("next",window.location.pathname),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h2",{children:"You have not signed in"}),Object(x.jsx)(u.b,{to:"/".concat(e,"/signin?").concat(t.toString()),children:"Please sign in to continue"})]})}function v(e){var t=e.userSettings,n=e.settingsData,r=e.refreshUserSettings,i=o.a.useState(t.locale||"en-US"),u=Object(c.a)(i,2),l=u[0],j=u[1],d=o.a.useState(!1),b=Object(c.a)(d,2),h=b[0],O=b[1],p=o.a.useState(null),f=Object(c.a)(p,2),g=f[0],v=f[1],m=o.a.useState(null),S=Object(c.a)(m,2),y=S[0],k=S[1];function N(){return C.apply(this,arguments)}function C(){return(C=Object(s.a)(a.a.mark((function e(){var n,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new URLSearchParams).set("locale",l),e.next=4,fetch("/api/v1/settings",{method:"POST",headers:{"X-CSRFToken":t.csrfmiddlewaretoken,"Content-Type":"application/x-www-form-urlencoded"},body:n});case 4:if(400!==(c=e.sent).status){e.next=13;break}return e.t0=k,e.next=9,c.json();case 9:e.t1=e.sent,(0,e.t0)(e.t1),e.next=14;break;case 13:c.ok?(O(!0),r()):v(new Error("".concat(c.status," on ").concat(c.url)));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return o.a.useEffect((function(){var e=!0;return setTimeout((function(){e&&O(!1)}),5e3),function(){e=!1}}),[h]),Object(x.jsxs)("form",{className:"settings-form",onSubmit:function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,N();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[y&&Object(x.jsx)(w,{errors:y.errors}),Object(x.jsxs)("div",{className:"field-group",children:[Object(x.jsx)("h3",{children:"Default language"}),h&&!g&&Object(x.jsx)("div",{className:"notecard success",children:Object(x.jsx)("p",{children:"Yay! Updated settings successfully saved."})}),g&&Object(x.jsxs)("div",{className:"notecard negative",children:[Object(x.jsx)("h4",{children:"Server submission error"}),Object(x.jsx)("p",{children:"Something unexpected happened during server submission."}),Object(x.jsx)("p",{children:Object(x.jsx)("code",{children:g.toString()})}),Object(x.jsx)("a",{href:window.location.pathname,children:"Reload page to try again."})]}),Object(x.jsx)("label",{htmlFor:"id_locale",className:"visually-hidden",children:"Change language"}),Object(x.jsx)("select",{id:"id_locale",name:"locale",value:l,onChange:function(e){j(e.target.value)},children:n.possibleLocales.map((function(e){return Object(x.jsx)("option",{value:e.locale,children:e.English},e.locale)}))})]}),Object(x.jsx)("button",{type:"submit",className:"button",children:"Update language"})]})}function m(e){var t=e.userSettings,n=Object(l.g)(),r=Object(O.a)(),i=o.a.useState(!1),u=Object(c.a)(i,2),d=u[0],b=u[1],h=o.a.useState(!1),p=Object(c.a)(h,2),f=p[0],g=p[1],v=Object(j.a)(f?"/api/v1/settings":null,function(){var e=Object(s.a)(a.a.mark((function e(c){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(c,{method:"DELETE",headers:{"X-CSRFToken":t.csrfmiddlewaretoken}});case 2:if((s=e.sent).ok){e.next=5;break}throw new Error("".concat(s.status," on ").concat(s.url));case 5:return alert("Your account has been closed and you are now signed out."),Object(j.b)("/api/v1/whoami"),n("/".concat(r,"/")),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{revalidateOnFocus:!1}).error;return Object(x.jsxs)("div",{className:"close-account",children:[Object(x.jsx)("h3",{children:"Close account"}),Object(x.jsx)("p",{children:"Delete your account and all account data."}),v&&Object(x.jsxs)("div",{className:"notecard negative",children:[Object(x.jsx)("h3",{children:"Server error"}),Object(x.jsx)("p",{children:"A server error occurred trying to close your account."}),Object(x.jsx)("p",{children:Object(x.jsx)("code",{children:v.toString()})}),Object(x.jsx)("a",{href:window.location.pathname,children:"Reload page to try again."})]}),d?Object(x.jsxs)("div",{className:"confirm-account-closure",children:[Object(x.jsx)("h4",{children:"Please confirm account deletion."}),Object(x.jsxs)("div",{className:"button-container",children:[Object(x.jsx)("button",{type:"button",className:"button outline",onClick:function(){b(!1)},children:"Cancel"})," ",Object(x.jsx)("button",{type:"button",className:"button danger",onClick:function(){g(!0)},children:"Confirm"})]})]}):Object(x.jsx)("button",{type:"button",className:"button",onClick:function(){b(!0)},children:"Close account"})]})}function w(e){var t=e.errors;return Object(x.jsxs)("div",{className:"notecard error",children:[Object(x.jsx)("h4",{children:"Validation errors"}),Object(x.jsx)("ul",{children:Object.entries(t).map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(x.jsxs)("li",{children:[Object(x.jsx)("b",{children:Object(x.jsx)("code",{children:n})}),Object(x.jsx)("ul",{children:r.map((function(e){return Object(x.jsx)("li",{children:e.message},e.code)}))})]},n)}))})]})}},70:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var c=n(0);function r(){return Object(c.jsxs)("div",{className:"notecard warning",children:[Object(c.jsx)("h4",{children:"Authentication disabled"}),Object(c.jsx)("p",{children:"Authentication and the user settings app is currently disabled."})]})}}}]);
//# sourceMappingURL=15.0dff0895.chunk.js.map