(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[11],{115:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return f}));var r=n(8),c=n.n(r),a=n(12),u=n(3),i=n(1),s=n(73),o=n(4),l=n(20),d=n(79),b=(n(86),n(0));function f(){var e=Object(s.a)(),t=Object(i.useState)(null),n=Object(u.a)(t,2),r=n[0],f=n[1],j=Object(l.b)();function h(){return(h=Object(a.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/_document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 3:if((n=e.sent).ok){e.next=15;break}return e.t0=f,e.t1=Error,e.t2="".concat(n.status,": "),e.next=10,n.text();case 10:return e.t3=e.sent,e.t4=e.t2.concat.call(e.t2,e.t3),e.t5=new e.t1(e.t4),(0,e.t0)(e.t5),e.abrupt("return");case 15:window.location.href="/".concat(t.metadata.locale,"/docs/").concat(t.metadata.slug),e.next=21;break;case 18:e.prev=18,e.t6=e.catch(0),f(e.t6);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}return Object(b.jsxs)("main",{className:"page-content-container document-create",role:"main",children:[Object(b.jsxs)("h2",{children:["Create new Document",Object(b.jsx)(o.b,{to:j,className:"close",children:"close"})]}),Object(b.jsx)(d.a,{initialSlug:new URLSearchParams(e.search).get("initial_slug"),onSave:function(e){return h.apply(this,arguments)},savingError:r})]})}},75:function(e,t,n){},79:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(8),c=n.n(r),a=n(12),u=n(3),i=n(1),s=n(73);n(75);var o=n(14),l=n(0);function d(e){var t=e.onSave,n=e.initialSlug,r=e.doc,d=e.isSaving,b=e.savingError,f=Object(s.b)().locale,j=Object(i.useState)(n?n+"/":r?r.metadata.slug:""),h=Object(u.a)(j,2),m=h[0],O=h[1],v=Object(i.useState)(r?r.metadata.title:""),g=Object(u.a)(v,2),p=g[0],x=g[1],w=Object(i.useState)(r?r.rawBody:""),y=Object(u.a)(w,2),S=y[0],k=y[1],E=function(e,t){var n=Object(i.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(r){return console.log(r),t}})),r=Object(u.a)(n,2),c=r[0],a=r[1];return[c,function(t){try{var n=t instanceof Function?t(c):t;a(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(r){console.log(r)}}]}("autosaveEdit",!1),N=Object(u.a)(E,2),R=N[0],C=N[1],T=Object(o.a)("exists:".concat(m),Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/_document?".concat(new URLSearchParams({url:"/".concat(f,"/docs/").concat(m)}).toString()));case 2:return e.abrupt("return",e.sent.ok);case 3:case"end":return e.stop()}}),e)})))).data,D=!r,F=!D&&R,J=Boolean(r&&r.metadata.slug!==m),_=F&&!J,A=!_&&d,B=m.endsWith("/");var P=function(e,t,n){var r=this,c=Object(i.useRef)(null),a=Object(i.useRef)(0),u=Object(i.useRef)(null),s=Object(i.useRef)([]),o=Object(i.useRef)(),l=Object(i.useRef)(),d=Object(i.useRef)(e),b=Object(i.useRef)(!0);d.current=e;var f=!t&&0!==t&&"undefined"!==typeof window;if("function"!==typeof e)throw new TypeError("Expected a function");t=+t||0;var j=!!(n=n||{}).leading,h=!("trailing"in n)||!!n.trailing,m="maxWait"in n,O=m?Math.max(+n.maxWait||0,t):null;return Object(i.useEffect)((function(){return b.current=!0,function(){b.current=!1}}),[]),Object(i.useMemo)((function(){var e=function(e){var t=s.current,n=o.current;return s.current=o.current=null,a.current=e,l.current=d.current.apply(n,t)},n=function(e,t){f&&cancelAnimationFrame(u.current),u.current=f?requestAnimationFrame(e):setTimeout(e,t)},i=function(e){if(!b.current)return!1;var n=e-c.current,r=e-a.current;return!c.current||n>=t||n<0||m&&r>=O},v=function(t){return u.current=null,h&&s.current?e(t):(s.current=o.current=null,l.current)},g=function e(){var r=Date.now();if(i(r))return v(r);if(b.current){var u=r-c.current,s=r-a.current,o=t-u,l=m?Math.min(o,O-s):o;n(e,l)}},p=function(){for(var d=[],f=0;f<arguments.length;f++)d[f]=arguments[f];var h=Date.now(),O=i(h);if(s.current=d,o.current=r,c.current=h,O){if(!u.current&&b.current)return a.current=c.current,n(g,t),j?e(c.current):l.current;if(m)return n(g,t),e(c.current)}return u.current||n(g,t),l.current};return p.cancel=function(){u.current&&(f?cancelAnimationFrame(u.current):clearTimeout(u.current)),a.current=0,s.current=c.current=o.current=u.current=null},p.isPending=function(){return!!u.current},p.flush=function(){return u.current?v(Date.now()):l.current},p}),[j,m,t,O,h,f])}(t,1e3);return Object(i.useEffect)((function(){_&&P({rawBody:S,metadata:{slug:m,title:p,locale:f||""}},J)}),[_,P,m,p,S,J,f]),Object(l.jsxs)("form",{className:"document-form",onSubmit:function(e){e.preventDefault(),t({rawBody:S,metadata:{slug:m,title:p,locale:f||""}},J)},children:[Object(l.jsxs)("div",{children:[Object(l.jsxs)("label",{children:["Slug",Object(l.jsx)("input",{disabled:!D,type:"text",value:m,onChange:function(e){return O(e.target.value)},style:{width:"100%"}})]}),T&&!(r&&r.metadata.slug===m)&&Object(l.jsx)("div",{className:"form-warning",children:"Warning! This slug already exists, creating this document will override the other document using that slug."}),B&&Object(l.jsx)("div",{className:"form-warning",children:"Slugs are not allowed to end in a slash"})]}),J&&F&&Object(l.jsx)("div",{children:"Autosave has been temporarily disabled until the new slug is saved!"}),Object(l.jsx)("p",{children:Object(l.jsxs)("label",{children:["Title",Object(l.jsx)("input",{disabled:A,type:"text",value:p,onChange:function(e){return x(e.target.value)},style:{width:"100%"}})]})}),Object(l.jsx)("textarea",{disabled:A,value:S,onChange:function(e){return k(e.target.value)},rows:20,style:{width:"100%"}}),Object(l.jsxs)("p",{children:[Object(l.jsx)("button",{type:"submit",disabled:A||!p||!m||B||!S,children:D?"Create":"Save"}),!D&&Object(l.jsxs)("span",{className:"action-options",children:[Object(l.jsx)("input",{type:"checkbox",id:"enable_autosave",checked:R,onChange:function(){C(!R)}}),Object(l.jsx)("label",{htmlFor:"enable_autosave",children:"Enable autosave"})]})]}),b&&Object(l.jsxs)("div",{className:"error-message submission-error",children:[Object(l.jsx)("p",{children:"Error saving document"}),Object(l.jsx)("pre",{children:b.toString()})]})]})}},86:function(e,t,n){}}]);
//# sourceMappingURL=11.115f6e85.chunk.js.map