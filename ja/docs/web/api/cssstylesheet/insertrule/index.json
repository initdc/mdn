{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"CSSStyleSheet.insertRule()","mdn_url":"/ja/docs/Web/API/CSSStyleSheet/insertRule","locale":"ja","native":"日本語","sidebarHTML":"<ol><li><strong><a href=\"/ja/docs/Web/API/CSS_Object_Model\">CSS Object Model</a></strong></li><li><strong><a href=\"/ja/docs/Web/API/CSSStyleSheet\"><code>CSSStyleSheet</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>コンストラクター</summary><ol><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/CSSStyleSheet\"><code>CSSStyleSheet()</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>プロパティ</summary><ol><li><a href=\"/ja/docs/Web/API/CSSStyleSheet/cssRules\"><code>cssRules</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/ownerRule\"><code>ownerRule</code> <small>(en-US)</small></a></li><li><svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/rules\"><code>rules</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>メソッド</summary><ol><li><svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/addRule\"><code>addRule()</code> <small>(en-US)</small></a></li><li><a href=\"/ja/docs/Web/API/CSSStyleSheet/deleteRule\"><code>deleteRule()</code></a></li><li><em><code>insertRule()</code></em></li><li><svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/removeRule\"><code>removeRule()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/replace\"><code>replace()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/replaceSync\"><code>replaceSync()</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>継承</summary><ol><li><a href=\"/ja/docs/Web/API/StyleSheet\"><code>StyleSheet</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>CSSOM に関連するページ</summary><ol><li><a href=\"/ja/docs/Web/API/AnimationEvent\"><code>AnimationEvent</code></a></li><li><a href=\"/ja/docs/Web/API/CSS\"><code>CSS</code></a></li><li><a href=\"/ja/docs/Web/API/CSSConditionRule\"><code>CSSConditionRule</code></a></li><li><a href=\"/ja/docs/Web/API/CSSGroupingRule\"><code>CSSGroupingRule</code></a></li><li><a href=\"/ja/docs/Web/API/CSSKeyframeRule\"><code>CSSKeyframeRule</code></a></li><li><a href=\"/ja/docs/Web/API/CSSKeyframesRule\"><code>CSSKeyframesRule</code></a></li><li><a href=\"/ja/docs/Web/API/CSSMediaRule\"><code>CSSMediaRule</code></a></li><li><a href=\"/ja/docs/Web/API/CSSNamespaceRule\"><code>CSSNamespaceRule</code></a></li><li><a href=\"/ja/docs/Web/API/CSSPageRule\"><code>CSSPageRule</code></a></li><li><a href=\"/ja/docs/Web/API/CSSRule\"><code>CSSRule</code></a></li><li><a href=\"/ja/docs/Web/API/CSSRuleList\"><code>CSSRuleList</code></a></li><li><a href=\"/ja/docs/Web/API/CSSStyleDeclaration\"><code>CSSStyleDeclaration</code></a></li><li><a href=\"/ja/docs/Web/API/CSSStyleRule\"><code>CSSStyleRule</code></a></li><li><a href=\"/ja/docs/Web/API/CSSSupportsRule\"><code>CSSSupportsRule</code></a></li><li><a href=\"/ja/docs/Web/API/CaretPosition\"><code>CaretPosition</code></a></li><li><a href=\"/ja/docs/Web/API/MediaQueryList\"><code>MediaQueryList</code></a></li><li><a href=\"/ja/docs/Web/API/Screen\"><code>Screen</code></a></li><li><a href=\"/ja/docs/Web/API/StyleSheet\"><code>StyleSheet</code></a></li><li><a href=\"/ja/docs/Web/API/StyleSheetList\"><code>StyleSheetList</code></a></li><li><a href=\"/ja/docs/Web/API/TransitionEvent\"><code>TransitionEvent</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p><strong>CSSStyleSheet.insertRule()</strong> メソッドは、新しい <a href=\"/ja/docs/Web/API/CSSRule\">CSS 規則</a>を<a href=\"/ja/docs/Web/API/CSSStyleSheet\">現在のスタイルシート</a>に挿入しますが、いくつかの<a href=\"#restrictions\">制限</a>があります。</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> <strong>メモ:</strong> <strong>insertRule()</strong> は <a href=\"/ja/docs/Web/API/CSSStyleSheet\"><code>CSSStyleSheet</code></a> の排他的なメソッドですが、実際には規則を <code><a href=\"/ja/docs/Web/API/CSSStyleSheet\">CSSStyleSheet</a>.cssRules</code>、内部的には <a href=\"/ja/docs/Web/API/CSSRuleList\"><code>CSSRuleList</code></a> に挿入します。</p>\n</div>"}},{"type":"prose","value":{"id":"構文","title":"構文","isH3":false,"content":"<pre class=\"notranslate\">stylesheet.insertRule(rule[, index])\n</pre>"}},{"type":"prose","value":{"id":"引数","title":"引数","isH3":true,"content":"<dl>\n  <dt id=\"rule\">rule</dt>\n  <dd>\n    <p>挿入される規則が入った <a href=\"/ja/docs/Glossary/String\"><code>DOMString</code></a> です。どのような規則を挿入するかは、種類に依存します。</p>\n    <ul>\n      <li><strong><a href=\"/ja/docs/Web/CSS/Syntax#css_statements\">規則セット</a></strong> の場合、<a href=\"/ja/docs/Learn/CSS/Building_blocks/Selectors\">セレクター</a>とスタイル定義です。</li>\n      <li><strong><a href=\"/ja/docs/Web/CSS/At-rule\">アット規則</a></strong> の場合、 @-識別子と規則の内容です。</li>\n    </ul>\n  </dd>\n  <dt id=\"index\">index <span class=\"badge inline optional\">省略可</span></dt>\n  <dd>\n    <p><code>stylesheet.cssRules.length</code> 以下の正の数で、 <code><a href=\"/ja/docs/Web/API/CSSStyleSheet\">CSSStyleSheet</a>.cssRules</code> の中で新しく挿入される規則の位置を示します。既定値は <code>0</code> です。 (古い実装では、これは必須でした。詳しくは<a href=\"#browser_compatibility\">ブラウザーの対応</a>を参照してください。)</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"返値","title":"返値","isH3":true,"content":"<p>スタイルシートの規則リスト内の、新たに挿入された規則のインデックスです。</p>"}},{"type":"prose","value":{"id":"制限事項","title":"制限事項","isH3":true,"content":"<p>CSS スタイルシート規則のリストには、規則がどのようにどこへ挿入されるかに影響する、いくつかの直感的な、またはそれほど直感的でない <a href=\"https://drafts.csswg.org/cssom/#insert-a-css-rule\" class=\"external\" rel=\" noopener\">制限</a> があります。これらに違反すると、 <a href=\"/ja/docs/Web/API/DOMException\"><code>DOMException</code></a> のようなエラーを引き起こす原因になるでしょう。</p>\n<ul>\n  <li><em>index</em> 値が <code><a href=\"/ja/docs/Web/API/CSSRuleList\">CSSRuleList</a>.length</code> を超える場合、 <code>IndexSizeError</code> で処理を中止します。</li>\n  <li>CSS の制約により <em>rule</em> が <em>index</em> <code>0</code> に挿入できない場合、 <code>HierarchyRequestError</code> で処理を中止します。</li>\n  <li><em>rule</em> 引数に 2 個以上の規則を与えた場合、 <code>SyntaxError</code> で処理を中止します。</li>\n  <li><a class=\"page-not-created\" title=\"この項目についての文書はまだ書かれていません。書いてみませんか？\"><code>@import</code></a> アット規則をスタイル規則の後に挿入しようとした場合、 <code>HierarchyRequestError</code> で処理を中止します。</li>\n  <li><em>rule</em> が <a class=\"page-not-created\" title=\"この項目についての文書はまだ書かれていません。書いてみませんか？\"><code>@namespace</code></a> アット規則であり、リストに <code>@import</code> アット規則や <code>@namespace</code> アット規則が含まれている場合、 <code>InvalidStateError</code> で処理を中止します。</li>\n</ul>"}},{"type":"prose","value":{"id":"例","title":"例","isH3":false,"content":""}},{"type":"prose","value":{"id":"例_1","title":"例 1","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// myStyle の先頭に新しい規則を挿入</span>\nmyStyle<span class=\"token punctuation\">.</span><span class=\"token function\">insertRule</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#blanc { color: white }\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"例_2","title":"例 2","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">/**\n * Add a stylesheet rule to the document (it may be better practice\n * to dynamically change classes, so style information can be kept in\n * genuine stylesheets and avoid adding extra elements to the DOM).\n * Note that an array is needed for declarations and rules since ECMAScript does\n * not guarantee a predictable object iteration order, and since CSS is\n * order-dependent.\n * @param {Array} rules Accepts an array of JSON-encoded declarations\n * @example\naddStylesheetRules([\n  ['h2', // Also accepts a second argument as an array of arrays instead\n    ['color', 'red'],\n    ['background-color', 'green', true] // 'true' for !important rules\n  ],\n  ['.myClass',\n    ['background-color', 'yellow']\n  ]\n]);\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">addStylesheetRules</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">rules</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> styleEl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'style'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Append &lt;style&gt; element to &lt;head&gt;</span>\n  document<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>styleEl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Grab style element's sheet</span>\n  <span class=\"token keyword\">var</span> styleSheet <span class=\"token operator\">=</span> styleEl<span class=\"token punctuation\">.</span>sheet<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> rules<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> j <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        rule <span class=\"token operator\">=</span> rules<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        selector <span class=\"token operator\">=</span> rule<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        propStr <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// If the second argument of a rule is an array of arrays, correct our variables.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>rule<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      rule <span class=\"token operator\">=</span> rule<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> pl <span class=\"token operator\">=</span> rule<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> pl<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> prop <span class=\"token operator\">=</span> rule<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      propStr <span class=\"token operator\">+=</span> prop<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">': '</span> <span class=\"token operator\">+</span> prop<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>prop<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> <span class=\"token string\">' !important'</span> <span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">';\\n'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Insert CSS Rule</span>\n    styleSheet<span class=\"token punctuation\">.</span><span class=\"token function\">insertRule</span><span class=\"token punctuation\">(</span>selector <span class=\"token operator\">+</span> <span class=\"token string\">'{'</span> <span class=\"token operator\">+</span> propStr <span class=\"token operator\">+</span> <span class=\"token string\">'}'</span><span class=\"token punctuation\">,</span> styleSheet<span class=\"token punctuation\">.</span>cssRules<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"仕様書","title":"仕様書","isH3":false,"content":"<table>\n  <thead>\n    <tr>\n      <th>仕様書</th>\n      <th>状態</th>\n      <th>備考</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"https://drafts.csswg.org/cssom/#dom-cssstylesheet-insertrule\" hreflang=\"en\" lang=\"en\" class=\"external\" rel=\" noopener\">CSS Object Model (CSSOM)<br><small lang=\"ja\">CSSStyleSheet.insertRule の定義</small></a></td>\n      <td><span class=\"spec-wd\">草案</span></td>\n      <td><a href=\"https://www.w3.org/TR/DOM-Level-2-Style/\" hreflang=\"en\" lang=\"en\" class=\"external\" title=\"Document Object Model (DOM) Level 2 Style Specificationの仕様書\" rel=\" noopener\">Document Object Model (DOM) Level 2 Style Specification</a> からの変更なし。</td>\n    </tr>\n    <tr>\n      <td><a href=\"https://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleSheet-insertRule\" hreflang=\"en\" lang=\"en\" class=\"external\" rel=\" noopener\">Document Object Model (DOM) Level 2 Style Specification<br><small lang=\"ja\">CSSStyleSheet.insertRule の定義</small></a></td>\n      <td><span class=\"spec-obsolete\">廃止</span></td>\n      <td>初回定義</td>\n    </tr>\n  </tbody>\n</table>"}},{"type":"prose","value":{"id":"ポリフィル","title":"ポリフィル","isH3":false,"content":"<p>以下のポリフィルは、 Internet Explorer 5–8 において、 <code>insertRule</code> の引数の入力を標準に準拠させるものです。 <code>insertRule</code> を関数で補完し、引数を既定のネイティブの <code>insertRule</code> に送る前に、セレクターを規則から分離します。</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Sheet_proto</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> originalInsertRule <span class=\"token operator\">=</span> Sheet_proto<span class=\"token punctuation\">.</span>insertRule<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>originalInsertRule<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> <span class=\"token comment\">// 2 mandatory arguments: (selector, rules)</span>\n        Sheet_proto<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">insertRule</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">selectorAndRule</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// First, separate the selector from the rule</span>\n            <span class=\"token literal-property property\">a</span><span class=\"token operator\">:</span> <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> Len<span class=\"token operator\">=</span>selectorAndRule<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span> isEscaped<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> newCharCode<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">!==</span> Len<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                newCharCode <span class=\"token operator\">=</span> selectorAndRule<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isEscaped <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>newCharCode <span class=\"token operator\">===</span> <span class=\"token number\">123</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 123 = \"{\".charCodeAt(0)</span>\n                    <span class=\"token comment\">// Secondly, find the last closing bracket</span>\n                    <span class=\"token keyword\">var</span> openBracketPos <span class=\"token operator\">=</span> i<span class=\"token punctuation\">,</span> closeBracketPos <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">!==</span> Len<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        newCharCode <span class=\"token operator\">=</span> selectorAndRule<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isEscaped <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>newCharCode <span class=\"token operator\">===</span> <span class=\"token number\">125</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 125 = \"}\".charCodeAt(0)</span>\n                            closeBracketPos <span class=\"token operator\">=</span> i<span class=\"token punctuation\">;</span>\n                        <span class=\"token punctuation\">}</span>\n                        isEscaped <span class=\"token operator\">^=</span> newCharCode<span class=\"token operator\">===</span><span class=\"token number\">92</span><span class=\"token operator\">?</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>isEscaped<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 92 = \"\\\\\".charCodeAt(0)</span>\n                    <span class=\"token punctuation\">}</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>closeBracketPos <span class=\"token operator\">===</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">break</span> a<span class=\"token punctuation\">;</span> <span class=\"token comment\">// no closing bracket was found!</span>\n                    <span class=\"token comment\">/*else*/</span> <span class=\"token keyword\">return</span> <span class=\"token function\">originalInsertRule</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// the sheet to be changed</span>\n                        selectorAndRule<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> openBracketPos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// the selector</span>\n                        selectorAndRule<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span>closeBracketPos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// the rule</span>\n                        arguments<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token comment\">// the insert index</span>\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token comment\">// works by if the char code is a backslash, then isEscaped gets flipped (XOR-ed by</span>\n                <span class=\"token comment\">// 1), and if it is not a backslash then isEscaped gets XORed by itself, zeroing it</span>\n                isEscaped <span class=\"token operator\">^=</span> newCharCode<span class=\"token operator\">===</span><span class=\"token number\">92</span><span class=\"token operator\">?</span><span class=\"token number\">1</span><span class=\"token operator\">:</span>isEscaped<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 92 = \"\\\\\".charCodeAt(0)</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token comment\">// Else, there is no unescaped bracket</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">originalInsertRule</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> selectorAndRule<span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CSSStyleSheet</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"browser_compatibility","value":{"title":"ブラウザーの対応","id":"ブラウザーの対応","isH3":false,"query":"api.CSSStyleSheet.insertRule","dataURL":"/ja/docs/Web/API/CSSStyleSheet/insertRule/bcd.json"}},{"type":"prose","value":{"id":"古いブラウザーの対応","title":"古いブラウザーの対応","isH3":true,"content":"<h4 id=\"internet_explorer_8_以前\">Internet Explorer 8 以前</h4>\n<p><strong>addRule</strong>(<em>selector</em>, <em>rule</em> [, <em>index</em>]); — 例: <code>addRule('pre', 'font: 14px verdana'); // 規則を末尾に追加</code></p>\n<p><em>また、標準外の <a href=\"https://www.quirksmode.org/dom/w3c_css.html#change\" class=\"external\" rel=\" noopener\"><code>removeRule()</code></a> および <a href=\"https://www.quirksmode.org/dom/w3c_css.html#access\" class=\"external\" rel=\" noopener\"><code>.rules</code></a> が、それぞれ <a href=\"/ja/docs/Web/API/CSSStyleSheet/deleteRule\" title=\"deleteRule()\"><code>deleteRule()</code></a> および <a href=\"/ja/docs/Web/API/CSSStyleSheet\" title=\".cssRules\"><code>.cssRules</code></a> の代わりに使用されていることにも注意してください。</em></p>"}},{"type":"prose","value":{"id":"関連情報","title":"関連情報","isH3":false,"content":"<ul>\n  <li><a href=\"/ja/docs/Web/API/CSSStyleSheet/deleteRule\"><code>CSSStyleSheet.deleteRule</code></a></li>\n  <li><a href=\"https://www-archive.mozilla.org/docs/web-developer/css1technote/css1tojs.html#priority\" class=\"external\" rel=\" noopener\">Cross-Browser CSS-rules ordering (CSS1)</a></li>\n  <li><a href=\"https://www.quirksmode.org/dom/w3c_css.html\" class=\"external\" rel=\" noopener\">Quirksmode - CSS</a></li>\n</ul>"}}],"toc":[{"text":"構文","id":"構文"},{"text":"例","id":"例"},{"text":"仕様書","id":"仕様書"},{"text":"ポリフィル","id":"ポリフィル"},{"text":"ブラウザーの対応","id":"ブラウザーの対応"},{"text":"関連情報","id":"関連情報"}],"summary":"CSSStyleSheet.insertRule() メソッドは、新しい CSS 規則を現在のスタイルシートに挿入しますが、いくつかの制限があります。","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"CSSStyleSheet.insertRule()","locale":"en-US","native":"English (US)"},{"title":"CSSStyleSheet.insertRule()","locale":"es","native":"Español"},{"title":"CSSStyleSheet.insertRule()","locale":"zh-CN","native":"中文 (简体)"},{"title":"CSSStyleSheet.insertRule()","locale":"zh-TW","native":"正體中文 (繁體)"}],"source":{"folder":"ja/web/api/cssstylesheet/insertrule","github_url":"https://github.com/mdn/translated-content/blob/main/files/ja/web/api/cssstylesheet/insertrule/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/ja/docs/Web","title":"開発者向けのウェブ技術"},{"uri":"/ja/docs/Web/API","title":"Web API"},{"uri":"/ja/docs/Web/API/CSSStyleSheet","title":"CSSStyleSheet"},{"uri":"/ja/docs/Web/API/CSSStyleSheet/insertRule","title":"CSSStyleSheet.insertRule()"}],"pageTitle":"CSSStyleSheet.insertRule() - Web API | MDN","noIndexing":false}}