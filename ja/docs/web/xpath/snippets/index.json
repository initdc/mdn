{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"XPath スニペット","mdn_url":"/ja/docs/Web/XPath/Snippets","locale":"ja","native":"日本語","sidebarHTML":"\n<ol><li><a href=\"/ja/docs/Web/XPath/Comparison_with_CSS_selectors\">CSS セレクターと XPath の比較</a></li><li><a href=\"/ja/docs/Web/XPath/Functions\">Functions</a><ol><li><a href=\"/ja/docs/Web/XPath/Functions\">Functions</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/boolean\">boolean</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/ceiling\">ceiling</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/choose\">choose</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/concat\">concat</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/contains\">contains</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/count\">count</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/current\">current</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/document\">document</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/element-available\">element-available</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/false\">false</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/floor\">floor</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/format-number\">format-number</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/function-available\">function-available</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/generate-id\">generate-id</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/id\">id</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/key\">key</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/lang\">lang</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/last\">last</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/local-name\">local-name</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/name\">name</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/namespace-uri\">namespace-uri</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/normalize-space\">normalize-space</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/not\">not</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/number\">number</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/position\">position</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/round\">round</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/starts-with\">starts-with</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/string-length\">string-length</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/string\">string</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/substring-after\">substring-after</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/substring-before\">substring-before</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/substring\">substring</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/sum\">sum</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/system-property\">system-property</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/translate\">translate</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/true\">true</a></li><li><a href=\"/ja/docs/Web/XPath/Functions/unparsed-entity-url\">unparsed-entity-url</a></li></ol></li><li><a href=\"/ja/docs/Web/XPath/Introduction_to_using_XPath_in_JavaScript\">JavaScript での XPath の利用の手引き</a></li><li><a href=\"/ja/docs/Web/XPath/Snippets\">XPath スニペット</a></li><li><a href=\"/ja/docs/Web/XPath/Axes\">軸</a><ol><li><a href=\"/ja/docs/Web/XPath/Axes\">軸</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/ancestor-or-self\">ancestor-or-self</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/ancestor\">ancestor</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/attribute\">attribute</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/child\">child</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/descendant-or-self\">descendant-or-self</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/descendant\">descendant</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/following-sibling\">following-sibling</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/following\">following</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/namespace\">namespace</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/parent\">parent</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/preceding-sibling\">preceding-sibling</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/preceding\">preceding</a></li><li><a href=\"/ja/docs/Web/XPath/Axes/self\">self</a></li></ol></li></ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>この記事ではいくつか XPath コードスニペットを提供します。それは XPath 機能を JavaScript コードに公開する<a href=\"https://www.w3.org/TR/DOM-Level-3-XPath/\" class=\"external\" rel=\" noopener\">DOM Level 3 XPath 仕様</a>の標準インタフェースに基づく簡単なユーティリティ関数の簡単な例です。スニペットは実際にあなた自身のコードの中で使用できる関数です。</p>"}},{"type":"prose","value":{"id":"ノード指定の評価関数","title":"ノード指定の評価関数","isH3":true,"content":"<p>次のカスタムユーティリティ関数を使用して、指定された XML ノードの XPath 式を評価できます。最初の引数は DOM ノードまたは Document オブジェクトで、2 番目の引数は XPath 式を定義する文字列です。</p>\n<h5 id=\"例ノード指定のカスタム_evaluatexpath_ユーティリティ関数を定義する\">例:ノード指定のカスタム <code>evaluateXPath()</code> ユーティリティ関数を定義する</h5>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Evaluate an XPath expression aExpression against a given DOM node</span>\n<span class=\"token comment\">// or Document object (aNode), returning the results as an array</span>\n<span class=\"token comment\">// thanks wanderingstan at morethanwarm dot mail dot com for the</span>\n<span class=\"token comment\">// initial work.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">evaluateXPath</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">aNode<span class=\"token punctuation\">,</span> aExpr</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> xpe <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XPathEvaluator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> nsResolver <span class=\"token operator\">=</span> xpe<span class=\"token punctuation\">.</span><span class=\"token function\">createNSResolver</span><span class=\"token punctuation\">(</span>aNode<span class=\"token punctuation\">.</span>ownerDocument <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">?</span>\n    aNode<span class=\"token punctuation\">.</span>documentElement <span class=\"token operator\">:</span> aNode<span class=\"token punctuation\">.</span>ownerDocument<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> result <span class=\"token operator\">=</span> xpe<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span>aExpr<span class=\"token punctuation\">,</span> aNode<span class=\"token punctuation\">,</span> nsResolver<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> found <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> res<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>res <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span><span class=\"token function\">iterateNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    found<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> found<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>この関数は <strong><code>new XPathEvaluator()</code></strong> コンストラクタを使用していますが、Firefox、Chrome、Opera、Safari ではサポートされているものの、Edge または Internet Explorer ではサポートされていません。Edge または Internet Explorer のユーザーがアクセスできる Web ドキュメント内のスクリプトは、 <strong><code>new XPathEvaluator()</code></strong> の呼び出しを次のフラグメントに置き換える必要があります。</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>  <span class=\"token comment\">// XPathEvaluator is implemented on objects that implement Document</span>\n  <span class=\"token keyword\">var</span> xpe <span class=\"token operator\">=</span> aNode<span class=\"token punctuation\">.</span>ownerDocument <span class=\"token operator\">||</span> aNode<span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>その場合、<a href=\"/ja/docs/Web/API/Document/createNSResolver\">XPathNSResolver</a>の作成は次のように単純化できます。</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>  <span class=\"token keyword\">var</span> nsResolver <span class=\"token operator\">=</span> xpe<span class=\"token punctuation\">.</span><span class=\"token function\">createNSResolver</span><span class=\"token punctuation\">(</span>xpe<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>ただし、<code>createNSResolver</code>は、XPath 式の名前空間プレフィックスが問い合わせる文書の名前空間プレフィックスと一致する（かつデフォルトの名前空間が使用されていない(回避策については<a href=\"/ja/docs/Web/API/Document/createNSResolver\">document.createNSResolver</a>を参照)）ことが確認されている場合にのみ使用する必要があります。それ以外の場合は、XPathNSResolver の独自の実装を提供する必要があります。</p>\n<p><a href=\"/ja/docs/Web/API/XMLHttpRequest\">XMLHttpRequest</a>を使用してローカルまたはリモートの XML ファイルを DOM ツリー（<a href=\"/ja/docs/Web/Guide/Parsing_and_serializing_XML\">XML のパースとシリアライズ</a>を参照）に読み込む場合、<code>evaluateXPath()</code>の最初の引数は<code>req.responseXML</code>である必要があります。</p>\n<h4 id=\"使用例\">使用例</h4>\n<p>次の XML ドキュメント（<a href=\"/ja/docs/Web/API/Document_Object_Model/How_to_create_a_DOM_tree\">DOM ツリーの作成方法</a>と<a href=\"/ja/docs/Web/Guide/Parsing_and_serializing_XML\">XML のパースとシリアライズ</a>も参照してください）があるとします。</p>\n<h5 id=\"例_カスタム_evaluatexpath_ユーティリティ関数と一緒に使用する_xml_文書\">例: カスタム <code>evaluateXPath()</code> ユーティリティ関数と一緒に使用する XML 文書</h5>\n<div class=\"code-example\"><pre class=\"brush: xml notranslate\"><code><span class=\"token prolog\">&lt;?xml version=\"1.0\"?&gt;</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>people</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>person</span> <span class=\"token attr-name\">first-name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>eric<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">middle-initial</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>H<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">last-name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>jung<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>address</span> <span class=\"token attr-name\">street</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>321 south st<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">city</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>denver<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">state</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>co<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">country</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>usa<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>address</span> <span class=\"token attr-name\">street</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>123 main st<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">city</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>arlington<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">state</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ma<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">country</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>usa<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>person</span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>person</span> <span class=\"token attr-name\">first-name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>jed<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">last-name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>brown<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>address</span> <span class=\"token attr-name\">street</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>321 north st<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">city</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>atlanta<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">state</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ga<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">country</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>usa<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>address</span> <span class=\"token attr-name\">street</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>123 west st<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">city</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>seattle<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">state</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wa<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">country</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>usa<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>address</span> <span class=\"token attr-name\">street</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>321 south avenue<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">city</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>denver<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">state</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>co<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">country</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>usa<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>person</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>people</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>XPath 式を使用してドキュメントを「照会」できるようになりました。 DOM ツリーを眺めることでも同様の結果が得られますが、XPath 式を使用する方がはるかに高速で強力です。id 属性に頼ることができるのであれば、<code>document.getElementById()</code>はまだ強力ですが、XPath ほど強力ではありません。下記は用例です。</p>\n<h5 id=\"例_カスタムの_evaluatexpath_ユーティリティ関数がある_javascript_コード\">例: カスタムの <code>evaluateXPath()</code> ユーティリティ関数がある JavaScript コード</h5>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// display the last names of all people in the doc</span>\n<span class=\"token keyword\">var</span> results <span class=\"token operator\">=</span> <span class=\"token function\">evaluateXPath</span><span class=\"token punctuation\">(</span>people<span class=\"token punctuation\">,</span> <span class=\"token string\">\"//person/@last-name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token keyword\">in</span> results<span class=\"token punctuation\">)</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Person #\"</span> <span class=\"token operator\">+</span> i <span class=\"token operator\">+</span> <span class=\"token string\">\" has the last name \"</span> <span class=\"token operator\">+</span> results<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// get the 2nd person node</span>\nresults <span class=\"token operator\">=</span> <span class=\"token function\">evaluateXPath</span><span class=\"token punctuation\">(</span>people<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/people/person[2]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// get all the person nodes that have addresses in denver</span>\nresults <span class=\"token operator\">=</span> <span class=\"token function\">evaluateXPath</span><span class=\"token punctuation\">(</span>people<span class=\"token punctuation\">,</span> <span class=\"token string\">\"//person[address/@city='denver']\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// get all the addresses that have \"south\" in the street name</span>\nresults <span class=\"token operator\">=</span> <span class=\"token function\">evaluateXPath</span><span class=\"token punctuation\">(</span>people<span class=\"token punctuation\">,</span>  <span class=\"token string\">\"//address[contains(@street, 'south')]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>results<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"docevaluatearray","title":"docEvaluateArray","isH3":true,"content":"<p>以下は、ネームスペースリゾルバなどの特別な必要性に関わらず、XPath の結果を配列に取得（順序づけ）する簡単なユーティリティ関数です。そうでない場合は、<a href=\"/ja/docs/Web/API/Document/evaluate\"><code>document.evaluate()</code></a>のより複雑な構文は避けてください <a href=\"/ja/docs/Web/API/XPathResult\"><code>XPathResult</code></a>の特別なイテレータ（代わりに配列を返す）を使用する必要があります。</p>\n<h5 id=\"例_シンプルな_docevaluatearray​_ユーティリティ関数を定義する\">例: シンプルな <code>docEvaluateArray​()</code> ユーティリティ関数を定義する</h5>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Example usage:</span>\n<span class=\"token comment\">// var els = docEvaluateArray('//a');</span>\n<span class=\"token comment\">// alert(els[0].nodeName); // gives 'A' in HTML document with at least one link</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">docEvaluateArray</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">expr<span class=\"token punctuation\">,</span> doc<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">,</span> resolver</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> i<span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">,</span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    doc <span class=\"token operator\">=</span> doc <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>context <span class=\"token operator\">?</span> context<span class=\"token punctuation\">.</span>ownerDocument <span class=\"token operator\">:</span> document<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    resolver <span class=\"token operator\">=</span> resolver <span class=\"token operator\">||</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    context <span class=\"token operator\">=</span> context <span class=\"token operator\">||</span> doc<span class=\"token punctuation\">;</span>\n\n    result <span class=\"token operator\">=</span> doc<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span>expr<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">,</span> resolver<span class=\"token punctuation\">,</span> XPathResult<span class=\"token punctuation\">.</span><span class=\"token constant\">ORDERED_NODE_SNAPSHOT_TYPE</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> result<span class=\"token punctuation\">.</span>snapshotLength<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        a<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span><span class=\"token function\">snapshotItem</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> a<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"getxpathforelement","title":"getXPathForElement","isH3":true,"content":"<p>次の関数は、要素と XML 文書を渡して、その要素につながる一意の文字列 XPath 式を検索することを可能にします。</p>\n<h5 id=\"例_getxpathforelement​​_ユーティリティ関数を定義する\">例: <code>getXPathForElement​​()</code> ユーティリティ関数を定義する</h5>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">getXPathForElement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">el<span class=\"token punctuation\">,</span> xml</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> xpath <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> pos<span class=\"token punctuation\">,</span> tempitem2<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>el <span class=\"token operator\">!==</span> xml<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    pos <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    tempitem2 <span class=\"token operator\">=</span> el<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>tempitem2<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tempitem2<span class=\"token punctuation\">.</span>nodeType <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> tempitem2<span class=\"token punctuation\">.</span>nodeName <span class=\"token operator\">===</span> el<span class=\"token punctuation\">.</span>nodeName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// If it is ELEMENT_NODE of the same name</span>\n        pos <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      tempitem2 <span class=\"token operator\">=</span> tempitem2<span class=\"token punctuation\">.</span>previousSibling<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    xpath <span class=\"token operator\">=</span> <span class=\"token string\">\"*[name()='\"</span><span class=\"token operator\">+</span>el<span class=\"token punctuation\">.</span>nodeName<span class=\"token operator\">+</span><span class=\"token string\">\"' and namespace-uri()='\"</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">.</span>namespaceURI<span class=\"token operator\">===</span><span class=\"token keyword\">null</span><span class=\"token operator\">?</span><span class=\"token string\">''</span><span class=\"token operator\">:</span>el<span class=\"token punctuation\">.</span>namespaceURI<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"'][\"</span><span class=\"token operator\">+</span>pos<span class=\"token operator\">+</span><span class=\"token string\">']'</span><span class=\"token operator\">+</span><span class=\"token string\">'/'</span><span class=\"token operator\">+</span>xpath<span class=\"token punctuation\">;</span>\n\n    el <span class=\"token operator\">=</span> el<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  xpath <span class=\"token operator\">=</span> <span class=\"token string\">'/*'</span><span class=\"token operator\">+</span><span class=\"token string\">\"[name()='\"</span><span class=\"token operator\">+</span>xml<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">.</span>nodeName<span class=\"token operator\">+</span><span class=\"token string\">\"' and namespace-uri()='\"</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">.</span>namespaceURI<span class=\"token operator\">===</span><span class=\"token keyword\">null</span><span class=\"token operator\">?</span><span class=\"token string\">''</span><span class=\"token operator\">:</span>el<span class=\"token punctuation\">.</span>namespaceURI<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"']\"</span><span class=\"token operator\">+</span><span class=\"token string\">'/'</span><span class=\"token operator\">+</span>xpath<span class=\"token punctuation\">;</span>\n  xpath <span class=\"token operator\">=</span> xpath<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\/$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> xpath<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"関連資料","title":"関連資料","isH3":true,"content":"<ul>\n  <li><a href=\"/ja/docs/Web/XPath\">XPath</a></li>\n  <li><a href=\"http://forums.mozillazine.org/viewtopic.php?t=229106\" class=\"external\" rel=\" noopener\">Forum discussion on this topic</a></li>\n</ul>"}},{"type":"prose","value":{"id":"合わせてお読みください","title":"合わせてお読みください","isH3":false,"content":"<ul>\n  <li><a href=\"/ja/docs/Web/XPath/Introduction_to_using_XPath_in_JavaScript\">JavaScript で XPath を使用する</a></li>\n</ul>"}}],"toc":[{"text":"合わせてお読みください","id":"合わせてお読みください"}],"summary":"この記事ではいくつか XPath コードスニペットを提供します。それは XPath 機能を JavaScript コードに公開するDOM Level 3 XPath 仕様の標準インタフェースに基づく簡単なユーティリティ関数の簡単な例です。スニペットは実際にあなた自身のコードの中で使用できる関数です。","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"XPath snippets","locale":"en-US","native":"English (US)"}],"source":{"folder":"ja/web/xpath/snippets","github_url":"https://github.com/mdn/translated-content/blob/main/files/ja/web/xpath/snippets/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/ja/docs/Web","title":"開発者向けのウェブ技術"},{"uri":"/ja/docs/Web/XPath","title":"XPath"},{"uri":"/ja/docs/Web/XPath/Snippets","title":"XPath スニペット"}],"pageTitle":"XPath スニペット - XPath | MDN","noIndexing":false}}