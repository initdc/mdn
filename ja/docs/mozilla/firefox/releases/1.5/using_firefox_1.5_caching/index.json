{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Using Firefox 1.5 caching","mdn_url":"/ja/docs/Mozilla/Firefox/Releases/1.5/Using_Firefox_1.5_caching","locale":"ja","native":"日本語","sidebarHTML":"\n  <ol>\n    <li class=\"toggle\">\n        <details>\n            <summary>Firefox developer release notes</summary>\n            <ol>\n              <li><a href=\"/ja/docs/Mozilla/Firefox/Releases\">Firefox developer release notes</a></li>\n            </ol>\n        </details>\n    </li>\n    <li class=\"toggle\">\n        <details>\n            <summary>Add-ons</summary>\n            <ol>\n              <li><a href=\"/ja/Add-ons/WebExtensions\">Browser extensions</a></li>\n              <li><a href=\"/ja/Add-ons/Themes\">Themes</a></li>\n            </ol>\n        </details>\n    </li>\n    <li class=\"toggle\">\n        <details>\n            <summary>Firefox internals</summary>\n            <ol>\n              <li><a href=\"/ja/docs/Mozilla/\">Mozilla project</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Gecko\">Gecko</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Firefox/Headless_mode\">Headless mode</a></li>\n              <li><a href=\"/ja/docs/Mozilla/JavaScript_code_modules\">JavaScript code modules</a></li>\n              <li><a href=\"/ja/docs/Mozilla/js-ctypes\">JS-ctypes</a></li>\n              <li><a href=\"/ja/docs/Mozilla/MathML_Project\">MathML project</a></li>\n              <li><a href=\"/ja/docs/Mozilla/MFBT\">MFBT</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Projects\">Mozilla projects</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Preferences\">Preference system</a></li>\n              <li><a href=\"/ja/docs/Mozilla/WebIDL_bindings\">WebIDL bindings</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Tech/XPCOM\">XPCOM</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Tech/XUL\">XUL</a></li>\n            </ol>\n        </details>\n    </li>\n    <li class=\"toggle\">\n        <details>\n            <summary>Building and contributing</summary>\n            <ol>\n              <li><a href=\"/ja/docs/Mozilla/Developer_guide/Build_Instructions\">Build instructions</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Developer_guide/Build_Instructions/Configuring_Build_Options\">Configuring build options</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Developer_guide/Build_Instructions/How_Mozilla_s_build_system_works\">How the build system works</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Developer_guide/Source_Code/Mercurial\">Mozilla source code</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Localization\">Localization</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Mercurial\">Mercurial</a></li>\n              <li><a href=\"/ja/docs/Mozilla/QA\">Quality assurance</a></li>\n              <li><a href=\"/ja/docs/Mozilla/Using_Mozilla_code_in_other_projects\">Using Mozilla code in other projects</a></li>\n            </ol>\n        </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":"はじめに","title":"はじめに","isH3":false,"content":"<p><a href=\"/ja/Firefox_1.5_for_developers\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Firefox 1.5</a> ではウェブページ全体をその JavaScript の状態も含めてメモリ内にキャッシュし、1 つのブラウザセッションとして使用します。訪問したページ間の戻る、進むという動作にページのロードが不要になり、JavaScript の状態も保存されます。この機能によってページナビゲーションが非常に高速化します。この機能は <strong>bfcache</strong>（\"Back-Forward Cache\" のこと）と呼ばれることもあります。このキャッシュ状態はユーザがブラウザを閉じるまで保存されます。</p>\n<p>Firefox がページをキャッシュしない場合があります。ページがキャッシュされないプログラム的な理由でよくあるものをいくつか以下に示します。</p>\n<ul>\n  <li>ページが <code>unload</code> ハンドラを使用している</li>\n  <li>ページが \"cache-control: no-store\" をセットしている</li>\n  <li>ページが \"cache-control: no-cache\" をセットしていて、サイトが HTTPS である</li>\n  <li>ページが完全にはロードされないまま、ユーザがそのページから去るナビゲートをする</li>\n  <li>トップレベルのページにキャッシュ不可能なフレームがある</li>\n  <li>ページがフレーム内にあり、ユーザがそのフレーム内に新しいページをロードする（この場合、ユーザがそのページから去るナビゲートをするとそのフレームに最後にロードされたコンテンツがキャッシュされる）</li>\n</ul>\n<p>この新しいキャッシュ機能により、ページロードの挙動が変わります。ウェブ作者は次のことをしたいと思うことがあるでしょう。</p>\n<ul>\n  <li>ナビゲートされたことがあるページであることを知ること（そのページがユーザのキャッシュからロードされるとき）</li>\n  <li>ユーザがそのページを去るときのページの挙動を定義すること（ページがキャッシュされるようになっている間）</li>\n</ul>\n<p>ブラウザの 2 つの新しいイベントによってウェブ作者はそのどちらもできるようになります。</p>"}},{"type":"prose","value":{"id":"ブラウザの新しいイベント","title":"ブラウザの新しいイベント","isH3":false,"content":"<p>これらの新しいイベントを使用すると、そのページは他のブラウザでは今までどおりにきちんと表示され（過去の Firefox、Internet Explorer、Opera、Safari でテスト済み）、Firefox 1.5 でロードしたときにこの新しいキャッシュ機能が使用されるようになります。</p>\n<p>ウェブページの標準的な挙動は次のとおりです。</p>\n<ol>\n  <li>ユーザがページにナビゲートする。</li>\n  <li>ページロード時にインラインスクリプトが実行される。</li>\n  <li>ページがロードされると <code>onload</code> ハンドラが実行される。</li>\n</ol>\n<p>4 ステップ目があるページもあります。ページが <code>unload</code> ハンドラを使用していると、ユーザがそのページから去るナビゲートをするときにそれが実行されます。<code>unload</code> ハンドラが存在しているとそのページはキャッシュされません。</p>\n<p>ユーザがキャッシュされたページにナビゲートしたとき、インラインスクリプトと <code>onload</code> ハンドラは実行されません（ステップ 2 および 3）。ほとんどの場合、これらのスクリプトの効果が保存されているためです。</p>\n<p>そのページにユーザがナビゲートするたびにロード中に実行されるようにしたいスクリプトや他の動作がそのページに含まれている場合、あるいはいつユーザがキャッシュされたページにナビゲートしたかを知りたい場合は、新しい <code>pageshow</code> イベントを使用します。</p>\n<p>ユーザがそのページから去るナビゲートをするときに実行されるようにしたい動作があるものの、この新しいキャッシュ機能を生かしたく、さらにそれゆえに unload ハンドラを使用したくないという場合は、新しい <code>pagehide</code> イベントを使用します。</p>"}},{"type":"prose","value":{"id":"pageshow_イベント","title":"pageshow イベント","isH3":true,"content":"<p>このイベントは <code>load</code> イベントと同じように動作しますが、ページがロードされるたびに実行される点で異なります（一方、Firefox 1.5 ではページがキャッシュからロードされたときには <code>load</code> イベントは発動しません）。初めてページがロードされるとき、<code>load</code> イベントの発動直後に <code>pageshow</code> イベントが発動します。<code>pageshow</code> イベントは 初回ロード時には <code>false</code> がセットされる <code>persisted</code> という真偽値プロパティを使用します。初回ロードでなければ <code>true</code> がセットされます（つまり、そのページがキャッシュされているときに true がセットされます）。</p>\n<p>ページロードのたびに実行したい JavaScript は <code>pageshow</code> イベントの発動時に実行されるようにセットします。</p>\n<p>この記事で後に示すサンプルのように、JavaScript の関数を <code>pageshow</code> イベントの一部として呼び出す場合、<code>pageshow</code> イベントを <code>load</code> イベントの一部として呼び出すことで、ページが Firefox 1.5 以外のブラウザでロードされたときにもその関数を呼び出せるようになります。</p>"}},{"type":"prose","value":{"id":"pagehide_イベント","title":"pagehide イベント","isH3":true,"content":"<p>ユーザがそのページから去るナビゲートをするときに実行する動作を定義したいものの、<code>unload</code> イベント（そのページがキャッシュされなくなる）を使用したくないという場合は、新しい <code>pagehide</code> イベントを使用することができます。<code>pageshow</code> のように、<code>pagehide</code> イベントは <code>persisted</code> という真偽値プロパティを使用します。このプロパティは、ブラウザがそのページをキャッシュしていなければ <code>false</code> がセットされ、ブラウザがそのページをキャッシュしていれば <code>true</code> がセットされます。このプロパティに <code>false</code> がセットされているとき、<code>unload</code> があれば <code>pagehide</code> イベントの直後にそれが発動します。</p>\n<p>Firefox 1.5 は、そのページの初回ロード時と同じ順番でロードに関するイベントをシミュレートします。フレームはトップレベルの文書と同じように扱われます。そのページにフレームがあると、キャッシュされたページがロードされるときに次のことが起こります。</p>\n<ul>\n  <li>メイン文書で <code>pageshow</code> イベントが発動する前に、各フレームから <code>pageshow</code> イベントが発動する。</li>\n  <li>ユーザがキャッシュされたページから去るナビゲートをすると、メイン文書で <code>pagehide</code> イベントが発動する前に、各フレームから <code>pagehide</code> イベントが発動する。</li>\n  <li>単一のフレーム内でのナビゲーションについては、影響を受けるフレームでのみイベントが発動する。</li>\n</ul>"}},{"type":"prose","value":{"id":"サンプルコード","title":"サンプルコード","isH3":false,"content":"<p>下のサンプルは <code>load</code> イベントと <code>pageshow</code> イベントの両方を使用したページです。このサンプルページは次のような挙動をとります。</p>\n<ul>\n  <li>Firefox 1.5 以外のブラウザでは、次のことがページロードのたびに起こる：<code>load</code> イベントが <code>onLoad</code> 関数をトリガする。<code>onLoad</code> 関数は <code>onPageShow</code> 関数を呼び出す（付随する関数はもちろんのこと）。</li>\n</ul><!---->\n<ul>\n  <li>Firefox 1.5 では、初めてそのページがロードされるときに他のブラウザと同じように <code>load</code> イベントが発動する。さらに <code>pageshow</code> イベントが発動し、<code>persisted</code> に <code>false</code> がセットされるために他のアクションは生じない。</li>\n</ul><!---->\n<ul>\n  <li>Firefox 1.5 では、キャッシュからページがロードされるときは <code>pageshow</code> イベントだけが発動する。<code>persisted</code> には <code>true</code> がセットされるため、<code>onPageShow</code> 関数内の JavaScript アクションだけがトリガされる。</li>\n</ul>\n<p>この例では次のことが起こります。</p>\n<ul>\n  <li>ページはロードされるたびに現在日時を算出し、表示する。この計算には秒とミリ秒が含まれるため、機能のテストが簡単になる。</li>\n  <li>ページの初回ロード時にカーソルがフォームの Name フィールドに移動する。Firefox 1.5 では、ユーザがそのページに戻るナビゲートをすると、カーソルはユーザがそのページから去るナビゲートをしたときにあったフィールドに残る。他のブラウザではカーソルは Name フィールドに戻る。</li>\n</ul>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">HTML</span> <span class=\"token name\">PUBLIC</span> <span class=\"token string\">\"-//W3C//DTD HTML 4.01 Transitional//EN\"</span>\n   <span class=\"token string\">\"http://www.w3.org/TR/html4/loose.dtd\"</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>HTML</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">&gt;</span></span>Order query : Firefox 1.5 Example<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token style\"><span class=\"token language-css\">\n<span class=\"token selector\">body, p</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-family</span><span class=\"token punctuation\">:</span> Verdana<span class=\"token punctuation\">,</span> sans-serif<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 12px<span class=\"token punctuation\">;</span>\n     <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"><span class=\"token language-javascript\">\n<span class=\"token keyword\">function</span> <span class=\"token function\">onLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">loadOnlyFirst</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">onPageShow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">onPageShow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token comment\">// 現在時刻の算出</span>\n\n  <span class=\"token keyword\">var</span> currentTime<span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> year<span class=\"token operator\">=</span>currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getFullYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> month<span class=\"token operator\">=</span>currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getMonth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> day<span class=\"token operator\">=</span>currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> hour<span class=\"token operator\">=</span>currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getHours</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> min<span class=\"token operator\">=</span>currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getMinutes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> sec<span class=\"token operator\">=</span>currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getSeconds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> mil<span class=\"token operator\">=</span>currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getMilliseconds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> displayTime <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>month <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> day <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> year <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span> <span class=\"token operator\">+</span>\n    hour <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> min <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> sec <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> mil<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"timefield\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token operator\">=</span>displayTime<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">loadOnlyFirst</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  document<span class=\"token punctuation\">.</span>zipForm<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onload</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">onLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span> <span class=\"token attr-name\">onpageshow</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>if (event.persisted) onPageShow();<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span>Order query<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>zipForm<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.example.com/formresult.html<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>get<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>timefield<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Date and time:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>timefield<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Name:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>address<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Email address:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>address<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>order<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Order number:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>order<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Submit Query<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>一方、上記のページが <code>pageshow</code> イベントをリスンせず、すべての計算を <code>load</code> イベントの一部として扱う（そして代わりに下のサンプルコード片で置き換える）ものだとすると、ユーザがそのページから去るナビゲーションをするとカーソル位置も日時も Firefox 1.5 にキャッシュされます。ユーザがそのページに戻ると、キャッシュされた日時が表示されます。</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"><span class=\"token language-javascript\">\n<span class=\"token keyword\">function</span> <span class=\"token function\">onLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">loadOnlyFirst</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 現在時刻の算出</span>\n  <span class=\"token keyword\">var</span> currentTime<span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> year <span class=\"token operator\">=</span> currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getFullYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> month <span class=\"token operator\">=</span> currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getMonth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> day <span class=\"token operator\">=</span> currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> hour<span class=\"token operator\">=</span>currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getHours</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> min<span class=\"token operator\">=</span>currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getMinutes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> sec<span class=\"token operator\">=</span>currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getSeconds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> mil<span class=\"token operator\">=</span>currentTime<span class=\"token punctuation\">.</span><span class=\"token function\">getMilliseconds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> displayTime <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>month <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> day <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> year <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span> <span class=\"token operator\">+</span>\n    hour <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> min <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> sec <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> mil<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"timefield\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token operator\">=</span>displayTime<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">loadOnlyFirst</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  document<span class=\"token punctuation\">.</span>zipForm<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onload</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">onLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"firefox_用拡張機能の開発","title":"Firefox 用拡張機能の開発","isH3":false,"content":"<p>Firefox 1.5 の <a href=\"/ja/Building_an_Extension\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">拡張機能</a> はこのキャッシュ機能を許容するものである必要があります。1.5 とそれより前のバージョンの両方と互換性を持つ Firefox の拡張機能を開発したいのであれば、キャッシュされるようにするトリガについては <code>load</code> イベントをリスンし、キャッシュされないようにするトリガについては <code>pageshow</code> イベントをリスンしてください。</p>\n<p>例えば Firefox 用 Google ツールバーは、1.5 とそれより前のバージョンの両方と互換性を持たせるためには、autolink 関数については <code>load</code> イベントをリスンすべきであり、PageRank 関数については <code>pageshow</code> イベントをリスンすべきです。</p>"}}],"toc":[{"text":"はじめに","id":"はじめに"},{"text":"ブラウザの新しいイベント","id":"ブラウザの新しいイベント"},{"text":"サンプルコード","id":"サンプルコード"},{"text":"Firefox 用拡張機能の開発","id":"firefox_用拡張機能の開発"}],"summary":"Firefox 1.5 ではウェブページ全体をその JavaScript の状態も含めてメモリ内にキャッシュし、1 つのブラウザセッションとして使用します。訪問したページ間の戻る、進むという動作にページのロードが不要になり、JavaScript の状態も保存されます。この機能によってページナビゲーションが非常に高速化します。この機能は bfcache（\"Back-Forward Cache\" のこと）と呼ばれることもあります。このキャッシュ状態はユーザがブラウザを閉じるまで保存されます。","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Using Firefox 1.5 caching","locale":"en-US","native":"English (US)"},{"title":"Utilisation du cache de Firefox 1.5","locale":"fr","native":"Français"},{"title":"Использование кеширования в Firefox 1.5","locale":"ru","native":"Русский"},{"title":"Using Firefox 1.5 caching","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"ja/mozilla/firefox/releases/1.5/using_firefox_1.5_caching","github_url":"https://github.com/mdn/translated-content/blob/main/files/ja/mozilla/firefox/releases/1.5/using_firefox_1.5_caching/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/ja/docs/Mozilla","title":"Mozilla"},{"uri":"/ja/docs/Mozilla/Firefox","title":"Firefox"},{"uri":"/ja/docs/Mozilla/Firefox/Releases","title":"Firefox 開発者向けリリースノート"},{"uri":"/ja/docs/Mozilla/Firefox/Releases/1.5","title":"Firefox 1.5 for developers"},{"uri":"/ja/docs/Mozilla/Firefox/Releases/1.5/Using_Firefox_1.5_caching","title":"Using Firefox 1.5 caching"}],"pageTitle":"Using Firefox 1.5 caching - Mozilla | MDN","noIndexing":false}}