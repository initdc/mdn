{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"コンテンツスクリプト","mdn_url":"/ja/docs/Mozilla/Add-ons/WebExtensions/Content_scripts","locale":"ja","native":"日本語","sidebarHTML":"\n  <ol>\n    <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions\"><strong>ブラウザー拡張機能</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>始めましょう</summary>\n        <ol>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\">拡張機能とは何か?</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\">初めての拡張機能</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\">2つめの拡張機能</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\">拡張機能の中身</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Examples\">拡張機能の例</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/What_next_\">次にどうするのか？</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>概念</summary>\n        <ol>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\">JavaScript API 群の利用</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\">コンテンツスクリプト</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">マッチパターン</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\">ファイルの操作</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Internationalization\">多言語対応</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\">Content Security Policy</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\">Native messaging</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\">Differences between API implementations</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\">Chrome との非互換性</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>ユーザーインターフェイス</summary>\n        <ol>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface\">ユーザーインターフェイス</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\">ブラウザーツールバーボタン</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\">アドレスバーボタン</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\">サイドバー</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\">コンテキストメニュー項目</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\">オプションページ</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\">ページ拡張</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\">通知</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\">Address bar suggestions</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\">開発ツールパネル</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>逆引きリファレンス</summary>\n        <ol>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\">HTTP リクエストへの介入</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\">web ページの変更</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\">外部コンテンツの挿入</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">Share objects with page scripts</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\">ツールバーボタンの追加</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\">設定画面の実装</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\">Tabs API 群の使い方</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\">Bookmark API 群の使い方</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\">Cookie API 群の使い方</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\">contextual identities の使い方</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard\">クリップボードとのやりとり</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\">Build a cross-browser extension</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\">Firefox differentiators</a></summary>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>JavaScript API 群</summary>\n        <ol><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\">Browser support for JavaScript APIs</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/alarms\">alarms</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks\">bookmarks</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/browserAction\">browserAction</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/browserSettings\">browserSettings</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/browsingData\">browsingData</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/clipboard\">clipboard</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/commands\">commands</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts\">contentScripts</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities\">contextualIdentities</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/cookies\">cookies</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/downloads\">downloads</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/events\">events</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/extension\">extension</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes\">extensionTypes</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/find\">find</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/history\">history</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/i18n\">i18n</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/identity\">identity</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/idle\">idle</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/management\">management</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/menus\">menus</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/notifications\">notifications</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/omnibox\">omnibox</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/pageAction\">pageAction</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/permissions\">permissions</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11\">pkcs11</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/privacy\">privacy</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/proxy\">proxy</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime\">runtime</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/sessions\">sessions</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/sidebarAction\">sidebarAction</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/storage\">storage</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/tabs\">tabs</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/theme\">theme</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/topSites\">topSites</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/types\">types</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation\">webNavigation</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\">webRequest</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/windows\">windows</a></li></ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n      <summary>Manifest keys</summary>\n        <ol>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json\">序章</a></li>\n        </ol>\n      <ol><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author\">author</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background\">background</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action\">browser_action</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\">browser_specific_settings</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides\">chrome_settings_overrides</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides\">chrome_url_overrides</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands\">commands</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\">content_scripts</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy\">content_security_policy</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale\">default_locale</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description\">description</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer\">developer</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page\">devtools_page</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url\">homepage_url</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons\">icons</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito\">incognito</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version\">manifest_version</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name\">name</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox\">omnibox</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions\">optional_permissions</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\">options_ui</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action\">page_action</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\">permissions</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers\">protocol_handlers</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name\">short_name</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action\">sidebar_action</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme\">theme</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version\">version</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name\">version_name</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources\">web_accessible_resources</a></li></ol>\n      </details>\n    </li>\n     <li class=\"toggle\">\n      <details>\n        <summary>Extension Workshop</summary>\n        <ol>\n          <li><a href=\"https://extensionworkshop.com/documentation/develop/\">Develop</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/publish/\">Publish</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/manage/\">Manage</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/enterprise/\">Enterprise</a></li>\n        </ol>\n      </details>\n    </li>\n    <li><a href=\"/ja/docs/Mozilla/Add-ons/Contact_us\"><strong>コンタクト</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>チャンネル</summary>\n        <ol>\n          <li><a href=\"https://blog.mozilla.org/addons\">ブログ</a></li>\n          <li><a href=\"https://discourse.mozilla.org/c/add-ons\">フォーラム</a></li>\n          <li><a href=\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\">Add-ons chat</a></li>\n        </ol>\n      </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>コンテンツスクリプトは、特定のウェブページのコンテキストで実行される拡張機能の一部です（拡張機能の一部であるバックグラウンドスクリプトや、ウェブサイト自体の一部であるスクリプト、例えば <a href=\"/ja/docs/Web/HTML/Element/script\"><code>&lt;script&gt;</code></a> 要素みたいなものと対をなすような)。</p>\n<p><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#background_scripts\">バックグラウンドスクリプト</a>はすべての <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API\">WebExtension JavaScript API</a> にアクセスできますが、ウェブページのコンテンツに直接アクセスすることはできません。だからあなたの拡張機能がそれを行う必要がある場合は、コンテンツスクリプトが必要です。</p>\n<p>通常のウェブページで読み込まれたスクリプトと同様に、コンテンツスクリプトは、標準の DOM API を使用してページのコンテンツを読み取り、変更することができます。</p>\n<p>コンテンツスクリプトは、<a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Content_scripts#webextension_apis\">WebExtension API</a> の小さなサブセット にしかアクセスできませんが、メッセージングシステムを使用して <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Content_scripts#communicating_with_background_scripts\">バックグラウンドスクリプトと通信</a>し、WebExtension API に間接的にアクセスすることができます。</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> コンテンツスクリプトは次のドメインでブロックされるのに注意してください:</p>\n  <ul>\n    <li>accounts-static.cdn.mozilla.net</li>\n    <li>accounts.firefox.com</li>\n    <li>addons.cdn.mozilla.net</li>\n    <li>addons.mozilla.org</li>\n    <li>api.accounts.firefox.com</li>\n    <li>content.cdn.mozilla.net</li>\n    <li>content.cdn.mozilla.net</li>\n    <li>discovery.addons.mozilla.org</li>\n    <li>input.mozilla.org</li>\n    <li>install.mozilla.org</li>\n    <li>oauth.accounts.firefox.com</li>\n    <li>profile.accounts.firefox.com</li>\n    <li>support.mozilla.org</li>\n    <li>sync.services.mozilla.com</li>\n    <li>testpilot.firefox.com</li>\n  </ul>\n  <p>このドメインのページにコンテンツスクリプトを挿入しようとすると、そのスクリプトは失敗し、ページは <a href=\"/ja/docs/Web/HTTP/CSP\">CSP</a> エラーをログに記録します。</p>\n  <p>addons.mozilla.org を含む制限のために、ユーザーはインストール後すぐに拡張機能を試して、動かないのに気付くだけでしょう! 適切な警告を追加するか、<code>addons.mozilla.org</code> から動かす <a href=\"https://extensionworkshop.com/documentation/develop/onboard-upboard-offboard-users/\" class=\"external\" rel=\" noopener\">onboarding page</a> を追加したくなるでしょう。</p>\n</div>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note:</strong> <code>letfoo</code> や <code>window.foo = \"bar\"</code> にて、コンテンツスクリプトのグローバルスコープで追加された値は、<a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1408996\" class=\"external\" rel=\" noopener\">1408996</a> のバグによって消えることがあります。</p>\n</div>"}},{"type":"prose","value":{"id":"コンテンツスクリプトの読み込み","title":"コンテンツスクリプトの読み込み","isH3":false,"content":"<p>次の 3 つの方法のいずれかを使用して、ウェブページにコンテンツスクリプトを読み込むことができます。</p>\n<ol>\n  <li><strong>インストール時に、URL パターンにマッチするページ内へ</strong>\n    <ul>\n      <li>: <code>manifest.json</code> の <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\"><code>content_scripts</code></a> キーを使用して、URL が<a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">指定されたパターンにマッチする</a>ページをロードするたびにコンテンツスクリプトを読み込むようブラウザーに依頼できます。</li>\n    </ul>\n  </li>\n  <li><strong>実行時に、URL パターンにマッチするページ内へ</strong>\n    <ul>\n      <li>: <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts\"><code>contentScripts</code></a> API を使って、URL が<a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">指定されたパターンにマッチする</a>ページをロードするたびにコンテンツスクリプトを読み込むようブラウザーに依頼できます。これは method (1) のようなもので、違いは実行時にコンテンツスクリプトを追加/削除できることです。</li>\n    </ul>\n  </li>\n  <li><strong>実行時に、特定のタブへ</strong>\n    <ul>\n      <li>: <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/Tabs/executeScript\"><code>tabs.executeScript()</code></a> API を使用すると、ユーザーが<a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\">ブラウザーアクション</a>をクリックした場合など、必要なときにコンテンツスクリプトを特定のタブに読み込むことができます。</li>\n    </ul>\n  </li>\n</ol>\n<p><em>フレームごと、拡張機能ごとの</em>グローバルスコープしかありません。これは 1 つのコンテンツスクリプトの変数は、読み込み方にかかわらず、他のコンテンツスクリプトからアクセスできることになります。</p>\n<p>方法 (1) と (2) では<a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">マッチパターン</a>を使って表現された URL のスクリプトだけを読み込みできます。</p>\n<p>方法 (3) では、拡張機能と一緒にパッケージされたページのスクリプトも読み込みできますが、\"about:debugging\" や \"about:addons\"のような権限つきページにはスクリプトを読み込めません。</p>"}},{"type":"prose","value":{"id":"コンテンツスクリプト環境","title":"コンテンツスクリプト環境","isH3":false,"content":""}},{"type":"prose","value":{"id":"dom_アクセス","title":"DOM アクセス","isH3":true,"content":"<p>コンテンツスクリプトは、普通のページスクリプトと同様に、ページの DOM にアクセスして修正できます。ページスクリプトにてなされた DOM の変更を見ることもできます。</p>\n<p>しかし、コンテンツスクリプトは \"DOM のきれいな見た目\" を取得します。これはつまり:</p>\n<ul>\n  <li>コンテンツスクリプトはページスクリプトにて定義された JavaScript 変数を見ることができない</li>\n  <li>ページスクリプトが組み込み DOM プロパティを再定義した場合、コンテンツスクリプトはそのプロパティの(再定義後でなく)オリジナル値を見ている</li>\n</ul>\n<p>Firefox では、この挙動は <a href=\"https://firefox-source-docs.mozilla.org/dom/scriptSecurity/xray_vision.html\" class=\"only-in-en-us external\" title=\"Currently only available in English (US)\" rel=\" noopener\">Xray vision (en-US)</a> と呼ばれます。</p>\n<p>例えば、次のウェブページを考えます:</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html; charset=utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>page-scripts/page-script.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>\"page-script.js\" スクリプトは次を実行します:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// page-script.js</span>\n\n<span class=\"token comment\">// add a new element to the DOM</span>\n<span class=\"token keyword\">let</span> p <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"p\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\np<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">\"This paragraph was added by a page script.\"</span><span class=\"token punctuation\">;</span>\np<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"page-script-para\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// define a new property on the window</span>\nwindow<span class=\"token punctuation\">.</span>foo <span class=\"token operator\">=</span> <span class=\"token string\">\"This global variable was added by a page script\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// redefine the built-in window.confirm() function</span>\nwindow<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">confirm</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The page script has also redefined 'confirm'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>今度は拡張機能がページにコンテンツスクリプトを挿入します:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\n<span class=\"token comment\">// can access and modify the DOM</span>\n<span class=\"token keyword\">let</span> pageScriptPara <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"page-script-para\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\npageScriptPara<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// can't see page-script-added properties</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>foo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// undefined</span>\n\n<span class=\"token comment\">// sees the original form of redefined properties</span>\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Are you sure?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// calls the original window.confirm()</span>\n</code></pre></div>\n<p>その反対もまた真です; ページスクリプトはコンテンツスクリプトが追加した JavaScript プロパティを見られません。</p>\n<p>このことからすると、コンテンツスクリプトは予言できる振る舞いをする DOM プロパティに依存していて、ページスクリプトにて定義された変数とコンテンツスクリプトで定義する変数の衝突は心配しなくていいです。</p>\n<p>この振る舞いの実用的な結論として、コンテンツスクリプトはページに読み込まれたいかなる JavaScript ライブラリーにもアクセスしません。なので例えば、ページに jQuery が含まれても、コンテンツスクリプトは見ることができません。</p>\n<p>コンテンツスクリプトから JavaScript ライブラリを使いたい場合、ライブラリ自身を、使う方のコンテンツスクリプトと<em>並べて</em>挿入するべきです:</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token property\">\"content_scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"matches\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"*://*.mozilla.org/*\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"js\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"jquery.js\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"content-script.js\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect3\">\n  <p><strong>Note:</strong> <strong>記:</strong> Firefox ではコンテンツスクリプトからページスクリプトによって生成された JavaScript オブジェクトにアクセスしたり、ページスクリプトにコンテンツスクリプトの JavaScript オブジェクトを公開できるようにする API が提供されます。</p>\n  <p>詳しくは<a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">ページスクリプトとオブジェクトを共有する (en-US)</a>のページを見てください。</p>\n</div>"}},{"type":"prose","value":{"id":"webextension_api","title":"WebExtension API","isH3":true,"content":"<p>標準 DOM API に加え、コンテンツスクリプトは次の WebExtension API を使用できます:</p>\n<p><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/extension\"><code>extension</code></a> から:</p>\n<ul>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/extension#geturl()\"><code>getURL()</code></a></li>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/extension#inincognitocontext\"><code>inIncognitoContext</code></a></li>\n</ul>\n<p><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime\"><code>runtime</code></a> から:</p>\n<ul>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime#connect()\"><code>connect()</code></a></li>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime#getmanifest()\"><code>getManifest()</code></a></li>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime#geturl()\"><code>getURL()</code></a></li>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime#onconnect\"><code>onConnect</code></a></li>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime#onmessage\"><code>onMessage</code></a></li>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime#sendmessage()\"><code>sendMessage()</code></a></li>\n</ul>\n<p><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/i18n\"><code>i18n</code></a> から:</p>\n<ul>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getMessage\"><code>getMessage()</code></a></li>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getAcceptLanguages\"><code>getAcceptLanguages()</code></a></li>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getUILanguage\"><code>getUILanguage()</code></a></li>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/i18n/detectLanguage\"><code>detectLanguage()</code></a></li>\n</ul>\n<p>すべてから:</p>\n<ul>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/storage\"><code>storage</code></a></li>\n</ul>"}},{"type":"prose","value":{"id":"xhr_と_fetch","title":"XHR と Fetch","isH3":true,"content":"<p>コンテンツスクリプトは通常の <a href=\"/ja/docs/Web/API/XMLHttpRequest\"><code>window.XMLHttpRequest</code></a> と <a href=\"/ja/docs/Web/API/Fetch_API\"><code>window.fetch()</code></a> API を使ってリクエストを作成できます。</p>\n<div class=\"notecard note\" id=\"sect4\">\n  <p><strong>Note:</strong> Firefox では、コンテンツスクリプトの (例えば、<a href=\"/ja/docs/Web/API/Fetch_API/Using_Fetch\"><code>fetch()</code></a> を使った) リクエストは、拡張機能のコンテキストで起こるので、ページコンテンツを参照する URL を絶対 URL で提供せねばなりません。</p>\n  <p>Chrome では、リクエストはページのコンテキストで起こるので、相対 URL で行われます。例えば、<code>/api</code> は <code>https://[現在のページの URL]/api</code> に送られます。</p>\n</div>\n<p>コンテンツスクリプトは拡張機能の他の部分と同一のクロスドメイン権限を取得します: よって拡張機能が <code>manifest.json</code> の <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\"><code>permissions</code></a> キーを使ってあるドメインのクロスドメインアクセスを要求している場合、コンテンツスクリプトも同様にそのドメインのアクセスを取得します。</p>\n<p>これはより多く権限付けられた XHR に晒して、コンテンツスクリプトでインスタンスを取得することで達成し、その副作用としてページ自体からのリクエストがそうであるように <a href=\"/ja/docs/Web/HTTP/Headers/Origin\"><code>Origin</code></a> と <a href=\"/ja/docs/Web/HTTP/Headers/Referer\"><code>Referer</code></a> ヘッダーがセットされず、リクエストからクロスオリジンな性質を隠すことが好ましいことがよくあります。</p>\n<div class=\"notecard note\" id=\"sect5\">\n  <p><strong>Note:</strong> バージョン 58 以降、コンテンツ自体から送られたかのようなリクエストを必要とする拡張機能は <code>content.XMLHttpRequest</code> と <code>content.fetch()</code> を代わりに使うことができます。</p>\n  <p>クロスブラウザー拡張機能にとってこれらの存在は機能検出となります。</p>\n</div>"}},{"type":"prose","value":{"id":"バックグラウンドスクリプトとの通信","title":"バックグラウンドスクリプトとの通信","isH3":false,"content":"<p>コンテンツスクリプトは WebExtension API の大半を直接には使用できませんが、メッセージ API を用いて拡張機能のバックグラウンドスクリプトと通信できて、それゆえにバックグラウンドスクリプトがアクセスできるすべての API に間接的にアクセスできます。</p>\n<p>バックグラウンドスクリプトとコンテンツスクリプトが通信する 2 つのパターンがあります: (オプションなレスポンスつきの)<strong>ワンオフメッセージ</strong>を送るのと、<strong>お互いに息の長いコネクションを確立して</strong>、そこでメッセージを交換するのとです。</p>"}},{"type":"prose","value":{"id":"ワンオフメッセージ","title":"ワンオフメッセージ","isH3":true,"content":"<p>レスポンスが必須でないワンオフメッセージを送るには、次の API を使います:</p>\n<table>\n  <thead>\n    <tr>\n      <th></th>\n      <th>コンテンツスクリプト内</th>\n      <th>バックグラウンドスクリプト内</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>送信メッセージ</td>\n      <td><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage\"><code>browser.runtime.sendMessage()</code></a></td>\n      <td><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/Tabs/sendMessage\"><code>browser.tabs.sendMessage()</code></a></td>\n    </tr>\n    <tr>\n      <td>受信メッセージ</td>\n      <td><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\"><code>browser.runtime.onMessage</code></a></td>\n      <td><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\"><code>browser.runtime.onMessage</code></a></td>\n    </tr>\n  </tbody>\n</table>\n<p>例えば、ウェブページでのクリックイベントをリッスンするコンテンツスクリプトがここにあります。クリックがリンク上である場合、ターゲット URL をバックグラウンドページにメッセージします。</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> notifyExtension<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">notifyExtension</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>tagName <span class=\"token operator\">!=</span> <span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  browser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span><span class=\"token function\">sendMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string-property property\">\"url\"</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>バックグラウンドスクリプトはこのメッセージをリッスンして、<a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/notifications\"><code>notifications</code></a> API を使って通知を表示します:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// background-script.js</span>\n\nbrowser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span>onMessage<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>notify<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">notify</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  browser<span class=\"token punctuation\">.</span>notifications<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"basic\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"iconUrl\"</span><span class=\"token operator\">:</span> browser<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span><span class=\"token function\">getURL</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"link.png\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"You clicked a link!\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"message\"</span><span class=\"token operator\">:</span> message<span class=\"token punctuation\">.</span>url\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>この例のコードは Github の <a href=\"https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n\" class=\"external\" rel=\" noopener\">notify-link-clicks-i18n</a> のサンプルから簡単に適用できます。</p>"}},{"type":"prose","value":{"id":"コネクションベースのメッセージ","title":"コネクションベースのメッセージ","isH3":true,"content":"<p>ワンオフメッセージの送信は、バックグラウンドスクリプトとコンテンツスクリプトとで多くのメッセージを交換する場合はめんどくさいです。なので代替パターンは、この 2 つのコンテキスト間で寿命の長いコネクションを確立して、メッセージ交換にこのコネクションを使うことです。</p>\n<p>いずれの側にも <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">runtime.Port (en-US)</a> オブジェクトがあり、メッセージ交換に使えます。</p>\n<p>コネクションを作成するには:</p>\n<ul>\n  <li>片方で <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnect\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">runtime.onConnect (en-US)</a> にてコネクションをリッスンする。</li>\n  <li>もう片方で次を呼び出す:\n    <ul>\n      <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/connect\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">tabs.connect() (en-US)</a> (コンテンツスクリプトに接続する場合)</li>\n      <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/connect\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">runtime.connect() (en-US)</a> (バックグラウンドスクリプトに接続する場合)</li>\n    </ul>\n  </li>\n</ul>\n<p>これは <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">runtime.Port (en-US)</a> オブジェクトを返します。</p>\n<ul>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnect\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">runtime.onConnect (en-US)</a> リスナーには自身の <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">runtime.Port (en-US)</a> オブジェクトが渡される。</li>\n</ul>\n<p>それぞれがポートを持ったら、両方が:</p>\n<ul>\n  <li><code>runtime.Port.postMessage()</code> でメッセージを送って</li>\n  <li><code>runtime.Port.onMessage</code> でメッセージを受信できるようになる。</li>\n</ul>\n<p>例えば、ロードしたらすぐに、このコンテンツスクリプトは:</p>\n<ul>\n  <li>バックグラウンドに接続し</li>\n  <li><code>myPort</code> 変数に <code>Port</code> を格納する</li>\n  <li><code>myPort</code> のメッセージをリッスンする(ログに出す)</li>\n  <li>ユーザーがドキュメントをクリックしたとき、バックグラウンドスクリプトに <code>myPort</code> を使ってメッセージを送る</li>\n</ul>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\n<span class=\"token keyword\">var</span> myPort <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span><span class=\"token string\">\"port-from-cs\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmyPort<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">greeting</span><span class=\"token operator\">:</span> <span class=\"token string\">\"hello from content script\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmyPort<span class=\"token punctuation\">.</span>onMessage<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">m</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"In content script, received message from background script: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">.</span>greeting<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ndocument<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  myPort<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">greeting</span><span class=\"token operator\">:</span> <span class=\"token string\">\"they clicked the page!\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>対応するバックグラウンドスクリプトは:</p>\n<ul>\n  <li>コンテンツスクリプトからの通信試行をリッスンする</li>\n  <li>通信試行を受け取ったとき:\n    <ul>\n      <li><code>portFromCS</code> という名前の変数にポートを格納する</li>\n      <li>そのポートを使ってコンテンツスクリプトにメッセージを送る</li>\n      <li>ポートに届いたメッセージをリッスンしてログに出す</li>\n    </ul>\n  </li>\n  <li>ユーザーが拡張機能のブラウザーアクションをクリックしたとき、<code>portFromCS</code> を使ってコンテンツスクリプトにメッセージを送る</li>\n</ul>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// background-script.js</span>\n\n<span class=\"token keyword\">var</span> portFromCS<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">connected</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  portFromCS <span class=\"token operator\">=</span> p<span class=\"token punctuation\">;</span>\n  portFromCS<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">greeting</span><span class=\"token operator\">:</span> <span class=\"token string\">\"hi there content script!\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  portFromCS<span class=\"token punctuation\">.</span>onMessage<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">m</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"In background script, received message from content script\"</span><span class=\"token punctuation\">)</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">.</span>greeting<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nbrowser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span>onConnect<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>connected<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nbrowser<span class=\"token punctuation\">.</span>browserAction<span class=\"token punctuation\">.</span>onClicked<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  portFromCS<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">greeting</span><span class=\"token operator\">:</span> <span class=\"token string\">\"they clicked the button!\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h4 id=\"複数のコンテンツスクリプト\">複数のコンテンツスクリプト</h4>\n<p>同時に複数のコンテンツスクリプトが通信する場合、各接続を配列に格納するのが良いかもしれません。</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// background-script.js</span>\n\n<span class=\"token keyword\">var</span> ports <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">connected</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  ports<span class=\"token punctuation\">[</span>p<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">.</span>tab<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span>    <span class=\"token operator\">=</span> p\n  <span class=\"token comment\">//...</span>\n<span class=\"token punctuation\">}</span>\n\nbrowser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span>onConnect<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>connected<span class=\"token punctuation\">)</span>\n\nbrowser<span class=\"token punctuation\">.</span>browserAction<span class=\"token punctuation\">.</span>onClicked<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  ports<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        p<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">greeting</span><span class=\"token operator\">:</span> <span class=\"token string\">\"they clicked the button!\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"ワンオフメッセージとコネクションベースのメッセージとの選択","title":"ワンオフメッセージとコネクションベースのメッセージとの選択","isH3":true,"content":"<p>ワンオフとコネクションベースのメッセージの選択は、拡張機能がどうメッセージを利用すると期待されるかに依存します。</p>\n<p>推奨のベストプラクティスは次の通りです:</p>\n<p><strong>次のときにワンオフメッセージを使用…</strong></p>\n<ul>\n  <li>メッセージに 1 つだけの応答がある場合</li>\n  <li>メッセージの受信を少しのスクリプトがリッスンする場合(<a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\"><code>runtime.onMessage</code></a> 呼び出し)</li>\n</ul>\n<p><strong>次のときにコネクションベースメッセージを使用…</strong></p>\n<ul>\n  <li>スクリプトが、複数のメッセージを交換するセッションに関わる場合</li>\n  <li>拡張機能がタスクの進捗や、タスクが中断されたのを知る必要がある場合、または初期化されたタスクをメッセージング経由で中断したい場合</li>\n</ul>"}},{"type":"prose","value":{"id":"ウェブページとの通信","title":"ウェブページとの通信","isH3":false,"content":"<p>既定では、コンテンツスクリプトはページスクリプトが作成したオブジェクトにアクセスできませんが、DOM <a href=\"/ja/docs/Web/API/Window/postMessage\"><code>window.postMessage</code></a> と <a href=\"/ja/docs/Web/API/EventTarget/addEventListener\"><code>window.addEventListener</code></a> API を使ってページスクリプトと通信できます。</p>\n<p>例えば:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// page-script.js</span>\n\n<span class=\"token keyword\">var</span> messenger <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"from-page-script\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmessenger<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> messageContentScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">messageContentScript</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">direction</span><span class=\"token operator\">:</span> <span class=\"token string\">\"from-page-script\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Message from the page\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>source <span class=\"token operator\">==</span> window <span class=\"token operator\">&amp;&amp;</span>\n      event<span class=\"token punctuation\">.</span>data <span class=\"token operator\">&amp;&amp;</span>\n      event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>direction <span class=\"token operator\">==</span> <span class=\"token string\">\"from-page-script\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content script received message: \\\"\"</span> <span class=\"token operator\">+</span> event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>message <span class=\"token operator\">+</span> <span class=\"token string\">\"\\\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>これの完全な動作サンプルは、<a href=\"https://mdn.github.io/webextensions-examples/content-script-page-script-messaging.html\" class=\"external\" rel=\" noopener\">GitHub のデモページを訪れて</a>指示に従ってください。</p>\n<div class=\"notecard warning\" id=\"sect6\">\n  <p>\n    <strong>Warning:</strong> <strong>この方法で信頼できないウェブコンテンツと相互作用するには細心の注意が必要です</strong>！\n    拡張機能は強力な力を持つコードの権限があり、敵意のあるウェブページは簡単にこの力にアクセスします。\n  </p>\n  <p>細かい例を作るには、メッセージを受け取ったコンテンツスクリプトがこのようなことを行うと仮定してください:</p>\n  <div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>source <span class=\"token operator\">==</span> window <span class=\"token operator\">&amp;&amp;</span>\n      event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>direction <span class=\"token operator\">&amp;&amp;</span>\n      event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>direction <span class=\"token operator\">==</span> <span class=\"token string\">\"from-page-script\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n  <p>今やページスクリプトはコンテンツスクリプトのすべての権限でコードを実行できます。</p>\n</div>"}},{"type":"prose","value":{"id":"コンテンツスクリプト内で_eval_を使う","title":"コンテンツスクリプト内で eval() を使う","isH3":false,"content":"<dl>\n  <dt id=\"chrome_では\">Chrome では</dt>\n  <dd>\n    <p><a href=\"/ja/docs/Web/JavaScript/Reference/Global_Objects/eval\"><code>eval</code></a> は常にページコンテキストではなくてコンテンツスクリプトのコンテキストで動作します。</p>\n  </dd>\n  <dt id=\"firefox_では\">Firefox では</dt>\n  <dd>\n    <p><code>eval()</code> を呼ぶ場合、<strong>コンテンツスクリプト</strong>のコンテキストで動作します。 <code>window.eval()</code> を呼ぶ場合、<strong>ページ</strong>のコンテキストで動作します。, it runs code in the context of the <strong>content script</strong>.</p>\n  </dd>\n</dl>\n<p>例えば、こんなコンテンツスクリプトを考えてみます:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string\">'window.x = 1;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string\">'window.y = 2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">In content script, window.x: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>window<span class=\"token punctuation\">.</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">In content script, window.y: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>window<span class=\"token punctuation\">.</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">\"check\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>このコードは単に変数 x と y を、<code>window.eval()</code> と <code>eval()</code> を用いて作成し、値をログに出し、ページにメッセージします。</p>\n<p>メッセージの受信に際し、ページスクリプトは同じ変数をログに出します:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>source <span class=\"token operator\">===</span> window <span class=\"token operator\">&amp;&amp;</span> event<span class=\"token punctuation\">.</span>data <span class=\"token operator\">&amp;&amp;</span> event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>message <span class=\"token operator\">===</span> <span class=\"token string\">\"check\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">In page script, window.x: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>window<span class=\"token punctuation\">.</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">In page script, window.y: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>window<span class=\"token punctuation\">.</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p><strong>Chrome では、こんな出力が生成されます:</strong></p>\n<pre class=\"notranslate\">In content script, window.x: 1\nIn content script, window.y: 2\nIn page script, window.x: undefined\nIn page script, window.y: undefined\n</pre>\n<p><strong>Firefox では、こんな出力が生成されます:</strong></p>\n<pre class=\"notranslate\">In content script, window.x: undefined\nIn content script, window.y: 2\nIn page script, window.x: 1\nIn page script, window.y: undefined\n</pre>\n<p>同じことは <a href=\"/ja/docs/Web/API/setTimeout\"><code>setTimeout()</code></a>、<a href=\"/ja/docs/Web/API/setInterval\"><code>setInterval()</code></a>、<a href=\"/ja/docs/Web/JavaScript/Reference/Global_Objects/Function\"><code>Function()</code></a> にも言えます。</p>\n<div class=\"notecard warning\" id=\"sect7\">\n  <p><strong>Warning:</strong> <strong>ページのコンテキストでコードを実行するときは特に注意してください！</strong></p>\n  <p>ページの環境が悪意をはらんだウェブページにコントロールされ、期待しない方法であなたが操作するオブジェクトを再定義するかもしれません。</p>\n  <div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// page.js redefines console.log</span>\n\n<span class=\"token keyword\">var</span> original <span class=\"token operator\">=</span> console<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">log</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">original</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n  <div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js calls the redefined version</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string\">'console.log(false)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n</div>"}}],"toc":[{"text":"コンテンツスクリプトの読み込み","id":"コンテンツスクリプトの読み込み"},{"text":"コンテンツスクリプト環境","id":"コンテンツスクリプト環境"},{"text":"バックグラウンドスクリプトとの通信","id":"バックグラウンドスクリプトとの通信"},{"text":"ウェブページとの通信","id":"ウェブページとの通信"},{"text":"コンテンツスクリプト内で eval() を使う","id":"コンテンツスクリプト内で_eval_を使う"}],"summary":"コンテンツスクリプトは、特定のウェブページのコンテキストで実行される拡張機能の一部です（拡張機能の一部であるバックグラウンドスクリプトや、ウェブサイト自体の一部であるスクリプト、例えば <script> 要素みたいなものと対をなすような)。","popularity":0.0002,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Content scripts","locale":"en-US","native":"English (US)"},{"title":"Scripts de contenu","locale":"fr","native":"Français"},{"title":"Content scripts","locale":"ko","native":"한국어"},{"title":"Встраиваемый скрипт","locale":"ru","native":"Русский"},{"title":"Content scripts","locale":"zh-CN","native":"中文 (简体)"},{"title":"內容腳本","locale":"zh-TW","native":"正體中文 (繁體)"}],"source":{"folder":"ja/mozilla/add-ons/webextensions/content_scripts","github_url":"https://github.com/mdn/translated-content/blob/main/files/ja/mozilla/add-ons/webextensions/content_scripts/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/ja/docs/Mozilla","title":"Mozilla"},{"uri":"/ja/docs/Mozilla/Add-ons","title":"アドオン"},{"uri":"/ja/docs/Mozilla/Add-ons/WebExtensions","title":"ブラウザー拡張機能"},{"uri":"/ja/docs/Mozilla/Add-ons/WebExtensions/Content_scripts","title":"コンテンツスクリプト"}],"pageTitle":"コンテンツスクリプト - Mozilla | MDN","noIndexing":false}}