{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"設定ページを実装する","mdn_url":"/ja/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page","locale":"ja","native":"日本語","sidebarHTML":"\n  <ol>\n    <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions\"><strong>ブラウザー拡張機能</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>始めましょう</summary>\n        <ol>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\">拡張機能とは何か?</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\">初めての拡張機能</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\">2つめの拡張機能</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\">拡張機能の中身</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Examples\">拡張機能の例</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/What_next_\">次にどうするのか？</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>概念</summary>\n        <ol>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\">JavaScript API 群の利用</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\">コンテンツスクリプト</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">マッチパターン</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\">ファイルの操作</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Internationalization\">多言語対応</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\">Content Security Policy</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\">Native messaging</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\">Differences between API implementations</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\">Chrome との非互換性</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>ユーザーインターフェイス</summary>\n        <ol>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface\">ユーザーインターフェイス</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\">ブラウザーツールバーボタン</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\">アドレスバーボタン</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\">サイドバー</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\">コンテキストメニュー項目</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\">オプションページ</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\">ページ拡張</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\">通知</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\">Address bar suggestions</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\">開発ツールパネル</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>逆引きリファレンス</summary>\n        <ol>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\">HTTP リクエストへの介入</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\">web ページの変更</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\">外部コンテンツの挿入</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">Share objects with page scripts</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\">ツールバーボタンの追加</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\">設定画面の実装</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\">Tabs API 群の使い方</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\">Bookmark API 群の使い方</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\">Cookie API 群の使い方</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\">contextual identities の使い方</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard\">クリップボードとのやりとり</a></li>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\">Build a cross-browser extension</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\">Firefox differentiators</a></summary>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>JavaScript API 群</summary>\n        <ol><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\">Browser support for JavaScript APIs</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/alarms\">alarms</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks\">bookmarks</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/browserAction\">browserAction</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/browserSettings\">browserSettings</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/browsingData\">browsingData</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/clipboard\">clipboard</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/commands\">commands</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts\">contentScripts</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities\">contextualIdentities</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/cookies\">cookies</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/downloads\">downloads</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/events\">events</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/extension\">extension</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes\">extensionTypes</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/find\">find</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/history\">history</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/i18n\">i18n</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/identity\">identity</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/idle\">idle</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/management\">management</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/menus\">menus</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/notifications\">notifications</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/omnibox\">omnibox</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/pageAction\">pageAction</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/permissions\">permissions</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11\">pkcs11</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/privacy\">privacy</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/proxy\">proxy</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime\">runtime</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/sessions\">sessions</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/sidebarAction\">sidebarAction</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/storage\">storage</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/tabs\">tabs</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/theme\">theme</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/topSites\">topSites</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/types\">types</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation\">webNavigation</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\">webRequest</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/windows\">windows</a></li></ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n      <summary>Manifest keys</summary>\n        <ol>\n          <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json\">序章</a></li>\n        </ol>\n      <ol><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author\">author</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background\">background</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action\">browser_action</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\">browser_specific_settings</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides\">chrome_settings_overrides</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides\">chrome_url_overrides</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands\">commands</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\">content_scripts</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy\">content_security_policy</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale\">default_locale</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description\">description</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer\">developer</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page\">devtools_page</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url\">homepage_url</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons\">icons</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito\">incognito</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version\">manifest_version</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name\">name</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox\">omnibox</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions\">optional_permissions</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\">options_ui</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action\">page_action</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\">permissions</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers\">protocol_handlers</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name\">short_name</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action\">sidebar_action</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme\">theme</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version\">version</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name\">version_name</a></li><li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources\">web_accessible_resources</a></li></ol>\n      </details>\n    </li>\n     <li class=\"toggle\">\n      <details>\n        <summary>Extension Workshop</summary>\n        <ol>\n          <li><a href=\"https://extensionworkshop.com/documentation/develop/\">Develop</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/publish/\">Publish</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/manage/\">Manage</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/enterprise/\">Enterprise</a></li>\n        </ol>\n      </details>\n    </li>\n    <li><a href=\"/ja/docs/Mozilla/Add-ons/Contact_us\"><strong>コンタクト</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>チャンネル</summary>\n        <ol>\n          <li><a href=\"https://blog.mozilla.org/addons\">ブログ</a></li>\n          <li><a href=\"https://discourse.mozilla.org/c/add-ons\">フォーラム</a></li>\n          <li><a href=\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\">Add-ons chat</a></li>\n        </ol>\n      </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>設定ページは、ユーザーに拡張機能の設定を確認して変える方法を与えます(「プリファレンス」や「オプション」とも呼ばれます)。</p>\n<p>WebExtension API では一般に、設定は <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/storage\"><code>storage</code></a> API で保存されます。設定ページの実装は次の 3 ステップの手順です:</p>\n<ul>\n  <li>設定を表示して、ユーザーがそれを変更できる HTML を書く。</li>\n  <li>HTML からインクルードされる、ストレージから設定ページに投入し、ユーザーが変更した時に保存された設定を更新するスクリプトを書く。</li>\n  <li>HTML ファイルのパスを manifest.json の <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\"><code>options_ui</code></a> キーに設定する。これにより、HTML 文書が、拡張機能の名前や説明と共に、文書ブラウザーのアドオンマネージャーに表示される。</li>\n</ul>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime/openOptionsPage\"><code>runtime.openOptionsPage()</code></a> 関数を使ってプログラム的に開くこともできます。</p>\n</div>"}},{"type":"prose","value":{"id":"簡単な拡張機能","title":"簡単な拡張機能","isH3":false,"content":"<p>まずは、ユーザーが訪問するページに青い枠をつける拡張機能を書きます。</p>\n<p>\"settings\" というディレクトリーを作り、そこに \"manifest.json\" という名前のファイルを作って下記の中身を入れます:</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n\n  <span class=\"token property\">\"manifest_version\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Settings example\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0\"</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"content_scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"matches\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"&lt;all_urls&gt;\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"js\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"borderify.js\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>この拡張機能はブラウザーに対し、\"borderify.js\" というコンテンツスクリプトを、ユーザーが訪問するすべてのウェブページで読み込むよう指示します。</p>\n<p>次に、\"settings\" ディレクトリー内に \"borderify.js\" というファイルを作り、次の中身を入れます:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>border <span class=\"token operator\">=</span> <span class=\"token string\">\"10px solid blue\"</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>これは単にページに青い枠をつけます。</p>\n<p><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Temporary_Installation_in_Firefox\">この拡張機能をインストール</a>してテストします — お好みのあらゆるウェブページを開きます:</p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/E-WUhihF8fw\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\" loading=\"lazy\"></iframe>"}},{"type":"prose","value":{"id":"設定を追加する","title":"設定を追加する","isH3":false,"content":"<p>今度は枠の色をユーザーが設定できるような設定ページを作りましょう。</p>\n<p>まずは \"manifest.json\" を次の中身に更新します:</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n\n  <span class=\"token property\">\"manifest_version\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Settings example\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0\"</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"content_scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"matches\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"&lt;all_urls&gt;\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"js\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"borderify.js\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"options_ui\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"page\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"options.html\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"permissions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"storage\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"applications\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"gecko\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"addon@example.com\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>新しく次の 3 つのキーを追加しました:</p>\n<ul>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\"><code>options_ui</code></a>: これは HTML 文書に、この拡張機能の設定ページ(オプションページともいう)であることを設定します</li>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\"><code>permissions</code></a>: <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/storage\"><code>storage</code></a> API を使って設定を保存し、この API を使うパーミッションが必要です</li>\n  <li><code>applications</code>: 同期ストレージに設定を読み書きするには、拡張機能の ID を入れておく必要があります</li>\n</ul>\n<p>次に \"options.html\" を提供する約束をしたので、作成します。\"settings\" ディレクトリー内にその名前でファイルを作成して、次の中身を与えます:</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span>Border color<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>color<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Save<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>options.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>これは <a href=\"/ja/docs/Web/HTML/Element/form\"><code>&lt;form&gt;</code></a> と、そこにラベル付きのテキスト <a href=\"/ja/docs/Web/HTML/Element/input\"><code>&lt;input&gt;</code></a> と送信 <a href=\"/ja/docs/Web/HTML/Element/button\"><code>&lt;button&gt;</code></a> を定義します。また \"options.js\" というスクリプトも入っています。</p>\n<p>もう一度 \"options.js\"を \"settings\" ディレクトリーに作り、次の中身を与えます:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">saveOptions</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  e<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  browser<span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span>sync<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#color\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">restoreOptions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">setCurrentChoice</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#color\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>color <span class=\"token operator\">||</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">onError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Error: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>error<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">var</span> getting <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span>sync<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"color\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  getting<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>setCurrentChoice<span class=\"token punctuation\">,</span> onError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"DOMContentLoaded\"</span><span class=\"token punctuation\">,</span> restoreOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"form\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"submit\"</span><span class=\"token punctuation\">,</span> saveOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>これは 2 つのことをします:</p>\n<ul>\n  <li>文書が読み込まれた時、\"color\" の値を <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/storage/StorageArea/get\"><code>storage.sync.get()</code></a> を使ってストレージから取り出します。値が未設定なら、既定の \"blue\" を用います。これで値を <code>sync</code> ストレージ領域から取得できます。</li>\n  <li>ユーザーが \"Save\" を押して送信した時、テキストボックスの値を <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/storage/StorageArea/set\"><code>storage.sync.set()</code></a> を用いて保存します。これで値を <code>sync</code> ストレージ領域に保存できます。</li>\n</ul>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note:</strong> 記: 別々の .js ファイルの指定が必要です。インライン JavaScript は使用できません。</p>\n</div>\n<p>ローカルストレージがふさわしいと感じる場合、代わりにローカルストレージに設定値を保存できます。</p>\n<div class=\"notecard note\" id=\"sect3\">\n  <p><strong>Note:</strong> Firefox の <code>storage.sync</code> の実装はアドオン ID に依存しているのに注意します。<code>storage.sync</code> を使う場合、上記 manifest にあるように、manifest.json の <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\"><code>applications</code></a> キーに拡張機能の ID をセットしておく必要があります。</p>\n</div>\n<p>最後に、ストレージから枠の色を読むのに \"borderify.js\" を更新します:</p>\n<div class=\"notecard warning\" id=\"sect4\">\n  <p><strong>Warning:</strong> バージョン 52 より前の Firefox の <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/storage/StorageArea/get\">browser.storage.local.get()</a> のバグにより、下記のコードは機能しません。バージョン 52 より前の Firefox で動作させるには、<code>onGot()</code> の中で 2 回出てくる <code>item.color</code> を <code>item[0].color</code> に変えないといけません。</p>\n</div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code> <span class=\"token keyword\">function</span> <span class=\"token function\">onError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Error: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>error<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">onGot</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> color <span class=\"token operator\">=</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    color <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>border <span class=\"token operator\">=</span> <span class=\"token string\">\"10px solid \"</span> <span class=\"token operator\">+</span> color<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> getting <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span>sync<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"color\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngetting<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>onGot<span class=\"token punctuation\">,</span> onError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>この時点で、拡張機能はこのようになります:</p>\n<pre class=\"notranslate\">settings/\n    borderify.js\n    manifest.json\n    options.html\n    options.js\n</pre>\n<p>いま、次を行ってみます:</p>\n<ul>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/Temporary_Installation_in_Firefox#reloading_a_temporary_add-on\">拡張機能を再読み込み</a></li>\n  <li>ウェブページを読み込む</li>\n  <li>設定ページを開いて枠の色を変える</li>\n  <li>ウェブページを再読み込みして違いを見る</li>\n</ul>\n<p>Firefox で設定ページにアクセスするには about:addons に移動して拡張機能のエントリーの隣の \"Preferences\" ボタンをクリックします。</p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/ECt9cbWh1qs\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\" loading=\"lazy\"></iframe>"}},{"type":"prose","value":{"id":"詳しく学ぶ","title":"詳しく学ぶ","isH3":false,"content":"<ul>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\"><code>options_ui</code></a> マニフェストキーのリファレンス文書</li>\n  <li><a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/storage\"><code>storage</code></a> API のリファレンス文書</li>\n  <li>拡張機能から直接設定ページを開くには <a href=\"/ja/docs/Mozilla/Add-ons/WebExtensions/API/runtime/openOptionsPage\"><code>runtime.openOptionsPage()</code></a> API を使う</li>\n  <li>設定ページの例:\n    <ul>\n      <li><a href=\"https://github.com/mdn/webextensions-examples/tree/master/favourite-colour\" class=\"external\" rel=\" noopener\">favourite-colour</a></li>\n    </ul>\n  </li>\n</ul>"}}],"toc":[{"text":"簡単な拡張機能","id":"簡単な拡張機能"},{"text":"設定を追加する","id":"設定を追加する"},{"text":"詳しく学ぶ","id":"詳しく学ぶ"}],"summary":"設定ページは、ユーザーに拡張機能の設定を確認して変える方法を与えます(「プリファレンス」や「オプション」とも呼ばれます)。","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Implement a settings page","locale":"en-US","native":"English (US)"},{"title":"Implementar una página de configuración","locale":"es","native":"Español"},{"title":"Ajouter une page de paramètres","locale":"fr","native":"Français"},{"title":"实现一个设置页面","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"ja/mozilla/add-ons/webextensions/implement_a_settings_page","github_url":"https://github.com/mdn/translated-content/blob/main/files/ja/mozilla/add-ons/webextensions/implement_a_settings_page/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/ja/docs/Mozilla","title":"Mozilla"},{"uri":"/ja/docs/Mozilla/Add-ons","title":"アドオン"},{"uri":"/ja/docs/Mozilla/Add-ons/WebExtensions","title":"ブラウザー拡張機能"},{"uri":"/ja/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page","title":"設定ページを実装する"}],"pageTitle":"設定ページを実装する - Mozilla | MDN","noIndexing":false}}