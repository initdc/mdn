{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Audio and Video Delivery","mdn_url":"/zh-CN/docs/Web/Guide/Audio_and_video_delivery","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>我们可以通过多种方式在网络上交付音频和视频，从“静态”媒体文件到自适应实时流。本文旨在作为探讨基于 Web 的媒体的各种传递机制以及与流行浏览器的兼容性的起点。</p>"}},{"type":"prose","value":{"id":"音频和视频元素","title":"音频和视频元素","isH3":false,"content":"<p>Whether we are dealing with pre-recorded audio files or live streams, the mechanism for making them available through the browser's <a href=\"/zh-CN/docs/Web/HTML/Element/audio\"><code>&lt;audio&gt;</code></a> and <a href=\"/zh-CN/docs/Web/HTML/Element/video\"><code>&lt;video&gt;</code></a> elements remains pretty much the same. Currently, to support all browsers we need to specify two formats, although with the adoption of MP3 and MP4 formats in Firefox and Opera, this is changing fast. You can find compatibility information in the following places:</p>\n<ul>\n  <li><a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Cross-browser_audio_basics#audio_codec_support\">Audio Codec Compatibility Table</a></li>\n  <li><a href=\"/en-US/docs/Web/Media/Formats#browser_compatibility\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Audio/Video Codec Compatibility Table (en-US)</a></li>\n</ul>\n<p>To deliver video and audio, the general workflow is usually something like this:</p>\n<ol>\n  <li>Check what format the browser supports via feature detection (usually a choice of two, as stated above.)</li>\n  <li>If the browser doesn't support playback of any of the provided formats natively, provide a fallback (such as a Flash movie.)</li>\n  <li>Identify how you want to play/instantiate the media (e.g. a <a href=\"/zh-CN/docs/Web/HTML/Element/video\"><code>&lt;video&gt;</code></a> element, or <code>document.createElement('video')</code> perhaps?)</li>\n  <li>Deliver the media file to the player.</li>\n</ol>"}},{"type":"prose","value":{"id":"html_音频","title":"HTML 音频","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>audio</span> <span class=\"token attr-name\">controls</span> <span class=\"token attr-name\">preload</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>auto<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audiofile.mp3<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audio/mpeg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token comment\">&lt;!-- fallback for browsers that don't suppport mp3 --&gt;</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audiofile.ogg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audio/ogg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token comment\">&lt;!-- fallback for browsers that don't support audio tag --&gt;</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audiofile.mp3<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>download audio<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>audio</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>上面的代码将创建一个音频播放器，该播放器尝试预加载尽可能多的音频以流畅播放。</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>备注：</strong> preload 属性可能会被某些移动浏览器忽略。</p>\n</div>\n<p>有关更多信息，请参见 <a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Cross-browser_audio_basics#html5_audio_in_detail\">Cross Browser Audio Basics (HTML5 Audio In Detail)</a></p>"}},{"type":"prose","value":{"id":"html_视频","title":"HTML 视频","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>video</span> <span class=\"token attr-name\">controls</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>640<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>480<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">poster</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>initialimage.png<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">autoplay</span> <span class=\"token attr-name\">muted</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>videofile.mp4<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>video/mp4<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token comment\">&lt;!-- fallback for browsers that don't suppport mp4 --&gt;</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>videofile.webm<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>video/webm<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token comment\">&lt;!-- specifying subtitle files --&gt;</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>track</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>subtitles_en.vtt<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">kind</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>subtitles<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">srclang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">label</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>English<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>track</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>subtitles_no.vtt<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">kind</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>subtitles<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">srclang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>no<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">label</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Norwegian<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token comment\">&lt;!-- fallback for browsers that don't support video tag --&gt;</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>videofile.mp4<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>download video<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>video</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>上面的代码创建了一个尺寸为 640x480 像素的视频播放器，显示海报图像，直到播放视频为止。我们指示视频自动播放，但默认情况下将其静音。</p>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>备注：</strong> 某些移动浏览器可能会忽略自动播放属性。同样，自动播放功能在滥用时也会引起争议。强烈建议您阅读<a href=\"/zh-CN/docs/Web/Media/Autoplay_guide\">媒体和 Web 音频 API 的自动播放指南</a>，以了解如何明智地使用自动播放。</p>\n</div>\n<p>For further info see <a href=\"/zh-CN/docs/Web/HTML/Element/video\">&lt;video&gt; element</a> and <a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/cross_browser_video_player\">Creating a cross-browser video player</a>.</p>"}},{"type":"prose","value":{"id":"audio_and_video_fallback","title":"Audio and Video Fallback","isH3":true,"content":"<p>You can create a more comprehensive Fallback using Flash. <a href=\"https://github.com/johndyer/mediaelement/blob/master/build/flashmediaelement.swf\" class=\"external\" rel=\" noopener\">Using flashmediaelement.swf</a> is one way.</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>audio</span> <span class=\"token attr-name\">controls</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audiofile.mp3<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audio/mpeg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audiofile.ogg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audio/ogg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token comment\">&lt;!-- fallback for non supporting browsers goes here --&gt;</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>audiofile.mp3<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>download audio<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>object</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>320<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>30<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>application/x-shockwave-flash<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">data</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flashmediaelement.swf<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>param</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>movie<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flashmediaelement.swf<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>param</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flashvars<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>controls=true&amp;isvideo=false&amp;file=audiofile.mp3<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>object</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>audio</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>该过程与视频非常相似，只需记住在<code>flashvars value</code>参数中设置<code>isvideo = true</code>。</p>\n<p><a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Cross-browser_audio_basics#fallbacks\">More options for Fallbacks</a>.</p>"}},{"type":"prose","value":{"id":"javascript_音频","title":"JavaScript 音频","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> myAudio <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>myAudio<span class=\"token punctuation\">.</span><span class=\"token function\">canPlayType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio/mpeg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  myAudio<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'audiofile.mp3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>myAudio<span class=\"token punctuation\">.</span><span class=\"token function\">canPlayType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio/ogg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  myAudio<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'audiofile.ogg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nmyAudio<span class=\"token punctuation\">.</span>currentTime <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\nmyAudio<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>我们根据浏览器支持的音频文件的类型来设置音频的来源，然后将播放头设置为 5 秒钟以尝试播放它。</p>\n<div class=\"notecard note\" id=\"sect3\">\n  <p><strong>备注：</strong> 除非由用户启动的事件发布，否则某些移动浏览器将忽略播放。</p>\n</div>\n<p>It's also possible to feed an <a href=\"/zh-CN/docs/Web/HTML/Element/audio\"><code>&lt;audio&gt;</code></a> element a base64 encoded WAV file, allowing to generate audio on the fly:</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>audio</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>player<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>data:audio/x-wav;base64,UklGRvC...<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>audio</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p><a href=\"https://github.com/kripken/speak.js/\" class=\"external\" rel=\" noopener\">Speak.js</a> employs this technique. <a href=\"https://speak-demo.herokuapp.com\" class=\"external\" rel=\" noopener\">Try the demo</a>.</p>"}},{"type":"prose","value":{"id":"javascript_video","title":"JavaScript Video","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> myVideo <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'video'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>myVideo<span class=\"token punctuation\">.</span><span class=\"token function\">canPlayType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'video/mp4'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  myVideo<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'videofile.mp4'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>myVideo<span class=\"token punctuation\">.</span><span class=\"token function\">canPlayType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'video/webm'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  myVideo<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'videofile.webm'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nmyVideo<span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> <span class=\"token number\">480</span><span class=\"token punctuation\">;</span>\nmyVideo<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> <span class=\"token number\">320</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>We set the source of the video depending on the type of video file the browser supports we then set the width and height of the video.</p>"}},{"type":"prose","value":{"id":"web_audio_api","title":"Web Audio API","isH3":false,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>  <span class=\"token keyword\">var</span> context<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> request<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> source<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    context <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>AudioContext <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>webkitAudioContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XMLHttpRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    request<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"http://jplayer.org/audio/mp3/RioMez-01-Sleep_together.mp3\"</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    request<span class=\"token punctuation\">.</span>responseType <span class=\"token operator\">=</span> <span class=\"token string\">\"arraybuffer\"</span><span class=\"token punctuation\">;</span>\n\n    request<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      context<span class=\"token punctuation\">.</span><span class=\"token function\">decodeAudioData</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">buffer</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        source <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">createBufferSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        source<span class=\"token punctuation\">.</span>buffer <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">;</span>\n        source<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// auto play</span>\n        source<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// start was previously noteOn</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    request<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'web audio api not supported'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>In this example we retrieve an MP3 file via XHR, load it into a source and play it (<a href=\"http://jsbin.com/facutone/1/edit?js\" class=\"external\" rel=\" noopener\">Try it for yourself</a>). Find more about Web Audio API basics in <a href=\"/zh-CN/docs/Web/API/Web_Audio_API/Using_Web_Audio_API\">Using the Web Audio API</a>.</p>"}},{"type":"prose","value":{"id":"getusermedia_stream_api","title":"getUserMedia / Stream API","isH3":false,"content":"<p>It's also possible to retrieve a live stream from a webcam and/or microphone using <code>getUserMedia</code> and the Stream API. This makes up part of a wider technology known as WebRTC (Web Real-Time Communications) and is compatible with the latest versions of Chrome, Firefox and Opera.</p>\n<p>To grab the stream from your webcam, first set up a <a href=\"/zh-CN/docs/Web/HTML/Element/video\"><code>&lt;video&gt;</code></a> element:</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>video</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>webcam<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>480<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>360<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>video</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>Next, if supported connect the webcam source to the video element:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>navigator<span class=\"token punctuation\">.</span>getUserMedia <span class=\"token operator\">||</span>\n  <span class=\"token punctuation\">(</span>navigator<span class=\"token punctuation\">.</span>getUserMedia <span class=\"token operator\">=</span> navigator<span class=\"token punctuation\">.</span>mozGetUserMedia <span class=\"token operator\">||</span>\n  navigator<span class=\"token punctuation\">.</span>webkitGetUserMedia <span class=\"token operator\">||</span> navigator<span class=\"token punctuation\">.</span>msGetUserMedia<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span> <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span> <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>webkitURL <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>mozURL <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>msURL<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>navigator<span class=\"token punctuation\">.</span>getUserMedia<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    navigator<span class=\"token punctuation\">.</span><span class=\"token function\">getUserMedia</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">video</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">audio</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> onSuccess<span class=\"token punctuation\">,</span> onError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'getUserMedia is not supported in this browser.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">onSuccess</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stream</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> video <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webcam'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    video<span class=\"token punctuation\">.</span>autoplay <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    video<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">.</span><span class=\"token function\">createObjectURL</span><span class=\"token punctuation\">(</span>stream<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">onError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'There has been a problem retreiving the streams - are you running on file:/// or did you disallow access?'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>To find out more, read our <a href=\"/en-US/docs/Web/API/Navigator/getUserMedia\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Navigator.getUserMedia (en-US)</a> page.</p>"}},{"type":"prose","value":{"id":"mediastream_recording","title":"Mediastream Recording","isH3":false,"content":"<p>New standards are being rolled out to allow your browser to grab media from your mic or camera using <code>getUserMedia</code> and record it instantly using the new MediaRecorder API. You take the stream you receive from <code>getUserMedia</code>, pass it to a <code>MediaRecorder</code> object, take the resulting output and feed it to your audio or video source.</p>\n<p>The main mechanism is outlined below:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">onSuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stream</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">var</span> mediaRecorder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MediaRecorder</span><span class=\"token punctuation\">(</span>stream<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  mediaRecorder<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">ondataavailable</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> audio <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    audio<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">.</span><span class=\"token function\">createObjectURL</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nnavigator<span class=\"token punctuation\">.</span><span class=\"token function\">getUserMedia</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">audio</span><span class=\"token operator\">:</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> onSuccess<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>See <a href=\"/en-US/docs/Web/API/MediaStream_Recording_API\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">MediaRecorder API (en-US)</a> for more details.</p>\n<div class=\"notecard note\" id=\"sect4\">\n  <p><strong>备注：</strong> MediaRecorder is currently only supported in Firefox and only for audio, however there are some interesting workarounds including a library called <a href=\"https://github.com/muaz-khan/WebRTC-Experiment/tree/master/RecordRTC\" class=\"external\" rel=\" noopener\">RecordRTC</a>.</p>\n</div>"}},{"type":"prose","value":{"id":"media_source_extensions_mse","title":"Media Source Extensions (MSE)","isH3":false,"content":"<p><a href=\"https://dvcs.w3.org/hg/html-media/raw-file/tip/media-source/media-source.html\" class=\"external\" rel=\" noopener\">Media Source Extensions</a> is a W3C working draft that plans to extend <a href=\"/zh-CN/docs/Web/API/HTMLMediaElement\"><code>HTMLMediaElement</code></a> to allow JavaScript to generate media streams for playback. Allowing JavaScript to generate streams facilitates a variety of use cases like adaptive streaming and time shifting live streams.</p>"}},{"type":"prose","value":{"id":"encrypted_media_extensions_eme","title":"Encrypted Media Extensions (EME)","isH3":true,"content":"<p><a href=\"https://dvcs.w3.org/hg/html-media/raw-file/tip/encrypted-media/encrypted-media.html\" class=\"external\" rel=\" noopener\">Encrypted Media Extensions</a> is a W3C proposal to extend <code>HTMLMediaElement</code>, providing APIs to control playback of protected content.</p>\n<p>The API supports use cases ranging from simple clear key decryption to high value video (given an appropriate user agent implementation). License/key exchange is controlled by the application, facilitating the development of robust playback applications supporting a range of content decryption and protection technologies.</p>\n<p>One of the principle uses of EME is to allow browsers to implement DRM (<a href=\"http://en.wikipedia.org/wiki/Digital_rights_management\" class=\"external\" rel=\" noopener\">Digital Rights Management</a>), which helps to prevent web-based content (especially video) from being copied.</p>"}},{"type":"prose","value":{"id":"adaptive_streaming","title":"Adaptive Streaming","isH3":true,"content":"<p>New formats and protocols are being rolled out to facilitate adaptive streaming. Adaptive streaming media means that the bandwidth and typically quality of the stream can change in real-time in reaction to the user's available bandwidth. Adaptive streaming is often used in conjunction with live streaming where smooth delivery of audio or video is paramount.</p>\n<p>The main formats used for adaptive streaming are <a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Live_streaming_web_audio_and_video#hls\">HLS</a> and <a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Live_streaming_web_audio_and_video#mpeg-dash\">MPEG-DASH</a>. MSE has been designed with DASH in mind. MSE defines byte streams according to <a href=\"https://dvcs.w3.org/hg/html-media/raw-file/tip/media-source/isobmff-byte-stream-format.html\" class=\"external\" rel=\" noopener\">ISOBMFF</a> and <a href=\"http://en.wikipedia.org/wiki/M2ts\" class=\"external\" rel=\" noopener\">M2TS</a> (both supported in DASH, the latter supported in HLS). Generally speaking, if you are interested in standards, are looking for flexibility, or wish to support most modern browsers, you are probably better off with DASH.</p>\n<div class=\"notecard note\" id=\"sect5\">\n  <p><strong>备注：</strong> Currently Safari does not support DASH although dash.js will work on newer versions of Safari scheduled for release with OSX Yosemite.</p>\n</div>\n<p>DASH also provides a number of profiles including simple onDemand profiles that no preprocessing and splitting up of media files. There are also a number of cloud based services that will convert your media to both HLS and DASH.</p>\n<p>For further information see <a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Live_streaming_web_audio_and_video\">Live streaming web audio and video</a>.</p>"}},{"type":"prose","value":{"id":"debugging_audio_video_issues","title":"Debugging Audio / Video Issues","isH3":false,"content":"<p>Having issues playing back audio or video? Try the following check-list.</p>"}},{"type":"prose","value":{"id":"does_the_browser_support_the_supplied_formats","title":"Does the browser support the supplied formats?","isH3":true,"content":"<p>Use the following verified sources within your audio and video elements to check support.</p>\n<ul>\n  <li>Audio MP3 (<code>type=\"audio/mpeg\"</code>): <a href=\"https://jPlayer.org/audio/mp3/Miaow-01-Tempered-song.mp3\" class=\"external\" rel=\" noopener\">http://jPlayer.org/audio/mp3/Miaow-01-Tempered-song.mp3</a> (<a href=\"http://jsbin.com/gekatoge/1/edit\" class=\"external\" rel=\" noopener\">play the MP3 audio live</a>.)</li>\n  <li>Audio MP4 (<code>type=\"audio/mp4\"</code>): <a href=\"https://jPlayer.org/audio/m4a/Miaow-01-Tempered-song.m4a\" class=\"external\" rel=\" noopener\">http://jPlayer.org/audio/m4a/Miaow-01-Tempered-song.m4a</a> (<a href=\"http://jsbin.com/gekatoge/2/edit\" class=\"external\" rel=\" noopener\">play the MP4 audio live</a>.)</li>\n  <li>Audio Ogg (<code>type=\"audio/ogg\"</code>): <a href=\"https://jPlayer.org/audio/ogg/Miaow-01-Tempered-song.ogg\" class=\"external\" rel=\" noopener\">http://jPlayer.org/audio/ogg/Miaow-01-Tempered-song.ogg</a> (<a href=\"http://jsbin.com/gekatoge/4/edit\" class=\"external\" rel=\" noopener\">play the OGG audio live</a>.)</li>\n  <li>Video MP4 (<code>type=\"video/mp4\"</code>): <a href=\"https://jPlayer.org/video/m4v/Big_Buck_Bunny_Trailer.m4v\" class=\"external\" rel=\" noopener\">http://jPlayer.org/video/m4v/Big_Buck_Bunny_Trailer.m4v</a> (<a href=\"http://jsbin.com/gekatoge/5/edit\" class=\"external\" rel=\" noopener\">play the MP4 video live</a>.)</li>\n  <li>Video WebM (<code>type=\"video/webm\"</code>): <a href=\"https://jPlayer.org/video/webm/Big_Buck_Bunny_Trailer.webm\" class=\"external\" rel=\" noopener\">http://jPlayer.org/video/webm/Big_Buck_Bunny_Trailer.webm</a> (<a href=\"http://jsbin.com/gekatoge/6/edit\" class=\"external\" rel=\" noopener\">play the WebM video live</a>.)</li>\n  <li>Video Ogg (<code>type=\"video/ogg\"</code>): <a href=\"https://jPlayer.org/video/ogv/Big_Buck_Bunny_Trailer.ogv\" class=\"external\" rel=\" noopener\">http://jPlayer.org/video/ogv/Big_Buck_Bunny_Trailer.ogv</a> (<a href=\"http://jsbin.com/gekatoge/7/edit\" class=\"external\" rel=\" noopener\">play the OGG video live</a>.)</li>\n</ul>\n<p>If these don't play then the browser you are testing doesn't support the given format. Consider using a different format or using a fallback.</p>\n<p>If these work but the files you are supplying don't, there are two possible issues:</p>\n<h4 id=\"1._the_media_server_is_not_delivering_the_correct_mime_types_with_the_file\">1. The media server is not delivering the correct mime types with the file</h4>\n<p>Although this is usually supported, you may need to add the following to your media server's <code>.htaccess</code> file.</p>\n<div class=\"code-example\"><pre class=\"brush: plain notranslate\"># AddType TYPE/SUBTYPE EXTENSION\n\nAddType audio/mpeg mp3\nAddType audio/mp4 m4a\nAddType audio/ogg ogg\nAddType audio/ogg oga\n\nAddType video/mp4 mp4\nAddType video/mp4 m4v\nAddType video/ogg ogv\nAddType video/webm webm\nAddType video/webm webmv\n</pre></div>\n<h4 id=\"2._your_files_have_been_encoded_incorrectly\">2. Your files have been encoded incorrectly</h4>\n<p>Your files may have been encoded incorrectly — try encoding using one of the following tools, which are proven to be pretty reliable:</p>\n<ul>\n  <li><a href=\"http://audacity.sourceforge.net/\" class=\"external\" rel=\" noopener\">Audacity</a> - Free Audio Editor and Recorder</li>\n  <li><a href=\"https://www.getmiro.com/\" class=\"external\" rel=\" noopener\">Miro</a> - Free, open-source music and video player</li>\n  <li><a href=\"https://handbrake.fr/\" class=\"external\" rel=\" noopener\">Handbrake</a> - Open Source Video Transcoder</li>\n  <li><a href=\"http://firefogg.org/\" class=\"external\" rel=\" noopener\">Firefogg</a> - Video and Audio encoding for Firefox</li>\n  <li><a href=\"https://www.ffmpeg.org/\" class=\"external\" rel=\" noopener\">FFmpeg2</a> - Comprehensive command line encoder</li>\n  <li><a href=\"https://libav.org/\" class=\"external\" rel=\" noopener\">Libav</a> - Comprehensive command line encoder</li>\n  <li><a href=\"https://m.vid.ly/\" class=\"external\" rel=\" noopener\">Vid.ly</a> - Video player,transcoding and delivery</li>\n  <li><a href=\"https://archive.org/\" class=\"external\" rel=\" noopener\">Internet Archive</a> - Free transcoding and storage</li>\n</ul>"}},{"type":"prose","value":{"id":"customising_your_media_player","title":"Customising Your Media Player","isH3":false,"content":"<p>You may decide that you want your audio or video player to have a consistent look across browsers, or just wish to tweak it to match your site. The general technique for achieving this is to omit the <code>controls</code> attribute so that the default browser controls are not displayed, create custom controls using HTML and CSS, then use JavaScript to link your controls to the audio/video API.</p>\n<p>If you need something extra, it's possible to add features that are not currently present in default players, such as playback rate, quality stream switches or even audio spectrums. You can also choose how to make your player responsive — for example you might remove the progress bar under certain conditions.</p>\n<p>You may detect click, touch and/or keyboard events to trigger actions such as play, pause and scrubbing. It's often important to remember keyboard controls for user convenience and accessibility.</p>\n<p>A quick example — first set up your audio and custom controls in HTML:</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>audio</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>my-audio<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://jPlayer.org/audio/mp3/Miaow-01-Tempered-song.mp3<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>audio</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>my-control<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>play<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>add a bit of JavaScript to detect events to play and pause the audio:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">var</span> myAudio <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my-audio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> myControl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my-control'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">switchState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>myAudio<span class=\"token punctuation\">.</span>paused <span class=\"token operator\">==</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      myAudio<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      myControl<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">\"pause\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      myAudio<span class=\"token punctuation\">.</span><span class=\"token function\">pause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      myControl<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">\"play\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">checkKey</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>keycode <span class=\"token operator\">==</span> <span class=\"token number\">32</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">//spacebar</span>\n      <span class=\"token function\">switchState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  myControl<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">switchState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"keypress\"</span><span class=\"token punctuation\">,</span> checkKey<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>You can <a href=\"http://jsbin.com/jujeladu/2/edit\" class=\"external\" rel=\" noopener\">try this example out here</a>. For more information, see <a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Cross-browser_audio_basics#creating_your_own_custom_audio_player\">Creating your own custom audio player</a>.</p>"}},{"type":"prose","value":{"id":"audiovideo_javascript_libraries","title":"Audio/Video JavaScript Libraries","isH3":false,"content":"<p>A number of audio and video JavaScript libaries exist. The most popular libraries allow you to choose a consistent player design over all browsers and provide a fallback for browsers that don't support audio and video natively. Fallbacks often use Adobe Flash or Microsoft Silverlight plugins. Other functionality such as the track element for subtitles can also be provided through media libraries.</p>"}},{"type":"prose","value":{"id":"audio_only","title":"Audio only","isH3":true,"content":"<ul>\n  <li><a href=\"http://www.schillmania.com/projects/soundmanager2/\" class=\"external\" rel=\" noopener\">SoundManager</a></li>\n</ul>"}},{"type":"prose","value":{"id":"video_only","title":"Video only","isH3":true,"content":"<ul>\n  <li><a href=\"https://flowplayer.org/\" class=\"external\" rel=\" noopener\">flowplayer</a>: Gratis with a flowplayer logo watermark. Open source (GPL licensed.)</li>\n  <li><a href=\"https://www.jwplayer.com\" class=\"external\" rel=\" noopener\">JWPlayer</a>: Requires registration to download. Open Source Edition (Creative Commons License.)</li>\n  <li><a href=\"https://www.sublimevideo.net/\" class=\"external\" rel=\" noopener\">SublimeVideo</a>: Requires registration. Form based set up with domain specific link to CDN hosted library.</li>\n  <li><a href=\"https://www.videojs.com/\" class=\"external\" rel=\" noopener\">Video.js</a>: Gratis and Open Source (Apache 2 Licensed.)</li>\n</ul>"}},{"type":"prose","value":{"id":"audio_and_video","title":"Audio and Video","isH3":true,"content":"<ul>\n  <li><a href=\"https://jPlayer.org\" class=\"external\" rel=\" noopener\">jPlayer</a>: Gratis and Open Source (MIT Licensed.)</li>\n  <li><a href=\"http://mediaelementjs.com/\" class=\"external\" rel=\" noopener\">mediaelement.js</a>: Gratis and Open Source (MIT Licensed.)</li>\n</ul>"}},{"type":"prose","value":{"id":"web_audio_api_2","title":"Web Audio API","isH3":true,"content":"<ul>\n  <li><a href=\"https://github.com/cwilso/AudioContext-MonkeyPatch\" class=\"external\" rel=\" noopener\">AudioContext monkeypatch</a>: A polyfill for older versions of the Web Audio API; Open Source (Apache 2 Licensed.)</li>\n</ul>"}},{"type":"prose","value":{"id":"basic_tutorials","title":"Basic tutorials","isH3":false,"content":"<dl>\n  <dt id=\"creating_a_cross-browser_video_player\"><a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/cross_browser_video_player\">Creating a cross-browser video player</a></dt>\n  <dd>\n    <p>A guide to creating a basic cross browser video player using the <a href=\"/zh-CN/docs/Web/HTML/Element/video\"><code>&lt;video&gt;</code></a> element.</p>\n  </dd>\n  <dt id=\"video_player_styling_basics\"><a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Video_player_styling_basics\">Video player styling basics</a></dt>\n  <dd>\n    <p>With the cross-browser video player put in place in the previous article, this article now looks at providing some basic, reponsive styling for the player.</p>\n  </dd>\n  <dt id=\"cross-browser_audio_basics\"><a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Cross-browser_audio_basics\">Cross-browser audio basics</a></dt>\n  <dd>\n    <p>This article provides a basic guide to creating an HTML5 audio player that works cross browser, with all the associated attributes, properties and events explained, and a quick guide to custom controls created using the Media API.</p>\n  </dd>\n  <dt id=\"media_buffering_seeking_and_time_ranges\"><a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/buffering_seeking_time_ranges\">Media buffering, seeking, and time ranges</a></dt>\n  <dd>\n    <p>Sometimes it's useful to know how much <a href=\"/zh-CN/docs/Web/HTML/Element/audio\"><code>&lt;audio&gt;</code></a> or <a href=\"/zh-CN/docs/Web/HTML/Element/video\"><code>&lt;video&gt;</code></a> has downloaded or is playable without delay — a good example of this is the buffered progress bar of an audio or video player. This article discusses how to build a buffer/seek bar using <a href=\"/zh-CN/docs/Web/API/TimeRanges\">TimeRanges</a>, and other features of the media API.</p>\n  </dd>\n  <dt id=\"html5_playbackrate_explained\"><a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/HTML5_playbackRate_explained\">HTML5 playbackRate explained</a></dt>\n  <dd>\n    <p>The <code>playbackRate</code> property allows us to change the speed or rate at which a piece of web audio or video is playing. This article explains it in detail.</p>\n  </dd>\n  <dt id=\"using_the_web_audio_api\"><a href=\"/zh-CN/docs/Web/API/Web_Audio_API/Using_Web_Audio_API\">Using the Web Audio API</a></dt>\n  <dd>\n    <p>Explains the basics of using the Web Audio API to grab, manipulate and play back an audio source.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"streaming_media_tutorials","title":"Streaming media tutorials","isH3":false,"content":"<dl>\n  <dt id=\"live_streaming_web_audio_and_video\"><a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Live_streaming_web_audio_and_video\">Live streaming web audio and video</a></dt>\n  <dd>\n    <p>Live streaming technology is often employed to relay live events such as sports, concerts and more generally TV and Radio programmes that are output live. Often shortened to just streaming, live streaming is the process of transmitting media 'live' to computers and devices. This is a fairly complex and nascent subject with a lot of variables, so in this article we'll introduce you to the subject and let you know how you can get started.</p>\n  </dd>\n  <dt id=\"setting_up_adaptive_streaming_media_sources\"><a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Setting_up_adaptive_streaming_media_sources\">Setting up adaptive streaming media sources</a></dt>\n  <dd>\n    <p>Let's say you want to set up an adaptive streaming media source on a server, to be consumed inside an HTML5 media element. How would you do that? This article explains how, looking at two of the most common formats: MPEG-DASH and HLS (HTTP Live Streaming.)</p>\n  </dd>\n  <dt id=\"dash_adaptive_streaming_for_html_5_video\"><a href=\"/zh-CN/docs/Web/Media/DASH_Adaptive_Streaming_for_HTML_5_Video\">DASH Adaptive Streaming for HTML 5 Video</a></dt>\n  <dd>\n    <p>Details how to set up adaptive streaming using DASH and WebM.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"advanced_tutorials","title":"Advanced tutorials","isH3":false,"content":"<dl>\n  <dt id=\"adding_captions_and_subtitles_to_html5_video\"><a href=\"/zh-CN/docs/Web/Apps/Build/Manipulating_media/Adding_captions_and_subtitles_to_HTML5_video\">Adding captions and subtitles to HTML5 video</a></dt>\n  <dd>\n    <p>This article explains how to add captions and subtitles to HTML5 <a href=\"/zh-CN/docs/Web/HTML/Element/video\"><code>&lt;video&gt;</code></a>, using <a href=\"/en-US/docs/Web/API/WebVTT_API\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Web_Video_Text_Tracks_Format (en-US)</a> and the <a href=\"/zh-CN/docs/Web/HTML/Element/track\"><code>&lt;track&gt;</code></a> element.</p>\n  </dd>\n  <dt id=\"writing_web_audio_api_code_that_works_in_every_browser\"><a href=\"/en-US/docs/Web/Guide/Audio_and_video_delivery/Web_Audio_API_cross_browser\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Writing Web Audio API code that works in every browser (en-US)</a></dt>\n  <dd>\n    <p>A guide to writing cross browser Web Audio API code.</p>\n  </dd>\n  <dt id=\"h.264_support_in_firefox\"><a href=\"/zh-CN/docs/Web/Apps/Developing/Manipulating_media/H.264_support_in_Firefox\">H.264 support in Firefox</a></dt>\n  <dd>\n    <p>This article explains the state of support for the H.264 video format in Firefox/Firefox OS, including code examples, tips and tricks.</p>\n  </dd>\n  <dt id=\"easy_audio_capture_with_the_mediarecorder_api\"><a href=\"https://hacks.mozilla.org/2014/06/easy-audio-capture-with-the-mediarecorder-api/\" class=\"external\" rel=\" noopener\">Easy audio capture with the MediaRecorder API</a></dt>\n  <dd>\n    <p>Explains the basics of using the MediaRecorder API to directly record a media stream.</p>\n  </dd>\n</dl>\n<div class=\"notecard note\" id=\"sect6\">\n  <p><strong>备注：</strong> Firefox OS versions 1.3 and above support the <a href=\"http://en.wikipedia.org/wiki/Real_Time_Streaming_Protocol\" class=\"external\" rel=\" noopener\">RTSP</a> protocol for streaming video delivery. A fallback solution for older versions would be to use <code>&lt;video&gt;</code> along with a suitable format for Gecko (such as WebM) to serve fallback content. More information will be published on this in good time.</p>\n</div>"}},{"type":"prose","value":{"id":"references","title":"References","isH3":false,"content":"<ul>\n  <li><a href=\"/zh-CN/docs/Web/HTML/Element/video\">The video element</a></li>\n  <li><a href=\"/en-US/docs/Web/Events#media\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Media events API (en-US)</a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/HTMLVideoElement\">HTMLVideoElement API</a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/MediaSource\">MediaSource API</a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/Web_Audio_API\">Web Audio API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/MediaStream_Recording_API\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">MediaRecorder API (en-US)</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Navigator/getUserMedia\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">getUserMedia (en-US)</a></li>\n</ul>"}}],"toc":[{"text":"音频和视频元素","id":"音频和视频元素"},{"text":"Web Audio API","id":"web_audio_api"},{"text":"getUserMedia / Stream API","id":"getusermedia_stream_api"},{"text":"Mediastream Recording","id":"mediastream_recording"},{"text":"Media Source Extensions (MSE)","id":"media_source_extensions_mse"},{"text":"Debugging Audio / Video Issues","id":"debugging_audio_video_issues"},{"text":"Customising Your Media Player","id":"customising_your_media_player"},{"text":"Audio/Video JavaScript Libraries","id":"audiovideo_javascript_libraries"},{"text":"Basic tutorials","id":"basic_tutorials"},{"text":"Streaming media tutorials","id":"streaming_media_tutorials"},{"text":"Advanced tutorials","id":"advanced_tutorials"},{"text":"References","id":"references"}],"summary":"我们可以通过多种方式在网络上交付音频和视频，从“静态”媒体文件到自适应实时流。本文旨在作为探讨基于 Web 的媒体的各种传递机制以及与流行浏览器的兼容性的起点。","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Audio and Video Delivery","locale":"en-US","native":"English (US)"},{"title":"Intégration audio et vidéo","locale":"fr","native":"Français"},{"title":"音声と動画の配信","locale":"ja","native":"日本語"},{"title":"Audio and Video Delivery","locale":"ko","native":"한국어"},{"title":"Доставка аудио и видео контента","locale":"ru","native":"Русский"}],"source":{"folder":"zh-cn/web/guide/audio_and_video_delivery","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/web/guide/audio_and_video_delivery/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Web","title":"Web 开发技术"},{"uri":"/zh-CN/docs/Web/Guide","title":"Web 开发者指南"},{"uri":"/zh-CN/docs/Web/Guide/Audio_and_video_delivery","title":"Audio and Video Delivery"}],"pageTitle":"Audio and Video Delivery - Web 开发者指南 | MDN","noIndexing":false}}