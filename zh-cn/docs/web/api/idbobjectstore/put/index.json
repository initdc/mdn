{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"IDBObjectStore.put()","mdn_url":"/zh-CN/docs/Web/API/IDBObjectStore/put","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"<ol><li><strong><a href=\"/zh-CN/docs/Web/API/IndexedDB_API\">IndexedDB API</a></strong></li><li><strong><a href=\"/zh-CN/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>属性</summary><ol><li><a href=\"/zh-CN/docs/Web/API/IDBObjectStore/autoIncrement\"><code>autoIncrement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBObjectStore/indexNames\"><code>indexNames</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBObjectStore/keyPath\"><code>keyPath</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/name\"><code>name</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/transaction\"><code>transaction</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>方法</summary><ol><li><a href=\"/zh-CN/docs/Web/API/IDBObjectStore/add\"><code>add()</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/clear\"><code>clear()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/count\"><code>count()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/createIndex\"><code>createIndex()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/delete\"><code>delete()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/deleteIndex\"><code>deleteIndex()</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBObjectStore/get\"><code>get()</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/getAll\"><code>getAll()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/getAllKeys\"><code>getAllKeys()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/getKey\"><code>getKey()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/index\"><code>index()</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBObjectStore/openCursor\"><code>openCursor()</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBObjectStore/openKeyCursor\"><code>openKeyCursor()</code> <small>(en-US)</small></a></li><li><em><code>put()</code></em></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>IndexedDB 的相关页面</summary><ol><li><a href=\"/zh-CN/docs/Web/API/IDBCursor\"><code>IDBCursor</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBCursorWithValue\"><code>IDBCursorWithValue</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBDatabase\"><code>IDBDatabase</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBFactory\"><code>IDBFactory</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBIndex\"><code>IDBIndex</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBKeyRange\"><code>IDBKeyRange</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBOpenDBRequest\"><code>IDBOpenDBRequest</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBRequest\"><code>IDBRequest</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBTransaction\"><code>IDBTransaction</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBVersionChangeEvent\"><code>IDBVersionChangeEvent</code> <small>(en-US)</small></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p><a href=\"/zh-CN/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a> 接口的 <strong><code>put()</code></strong> 方法更新一条给定的数据库记录，如果给出的值不存在，则插入一个新的记录</p>\n<p>它返回一个 <a href=\"/zh-CN/docs/Web/API/IDBRequest\"><code>IDBRequest</code></a> 对象，并且在一个单独的线程 ,创建一个值的 <a href=\"https://www.whatwg.org/specs/web-apps/current-work/multipage/common-dom-interfaces.html#structured-clone\" class=\"external\" rel=\" noopener\">structured clone</a> ,并且把它的值储存在对象仓库 (object store) 中. 当事务的模式是<code>readwrite 时，</code>这个方法用来添加新的记录，或者更新一条对象仓库 (object store) 中已存在的记录 . 如果记录被成功储存，then a success event is fired on the returned request object with the <code>result</code> set to the key for the stored record, and the <code>transaction</code> set to the transaction in which this object store is opened.</p>\n<p>put 方法是一个插入或更新对象仓库的方法。参考仅用于插入的方法 <a href=\"/zh-CN/docs/Web/API/IDBObjectStore/add\"><code>IDBObjectStore.add</code></a> 方法。</p>\n<p>谨记，如果你有一条 <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBCursor\"><code>IDBCursor</code> <small>(en-US)</small></a> 记录想要更新，使用<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBCursor/update\"><code>IDBCursor.update()</code> <small>(en-US)</small></a> 方法更新，比 <a href=\"/zh-CN/docs/Web/API/IDBObjectStore/put\" aria-current=\"page\"><code>IDBObjectStore.put()</code></a> 方法更合适。这样做可以清楚地表明将更新现有记录，而不是插入新记录。</p><div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> 此特性在 <a href=\"/zh-CN/docs/Web/API/Web_Workers_API\">Web Worker</a> 中可用</p>\n</div>"}},{"type":"prose","value":{"id":"语法","title":"语法","isH3":false,"content":"<pre class=\"notranslate\">var request = objectStore.put(item);\nvar request = objectStore.put(item, key);\n</pre>"}},{"type":"prose","value":{"id":"参数","title":"参数","isH3":true,"content":"<dl>\n  <dt id=\"item\">item</dt>\n  <dd>\n    <p>你想要更新 (或插入) 的记录。</p>\n  </dd>\n  <dt id=\"key\">key <span class=\"badge inline optional\">可选</span></dt>\n  <dd>\n    <p>你想要更新记录的主键 (e.g. from <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBCursor/primaryKey\"><code>IDBCursor.primaryKey</code> <small>(en-US)</small></a>). This is only needed for object stores that have an <code>autoIncrement</code> primary key, therefore the key is not in a field on the record object. In such cases, calling <code>put(item)</code> will always insert a new record, because it doesn't know what existing record you might want to modify.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"返回值","title":"返回值","isH3":true,"content":"<p>一个 <a href=\"/zh-CN/docs/Web/API/IDBRequest\"><code>IDBRequest</code></a> 对象 ,在该对象上触发与此操作相关的后续事件。</p>"}},{"type":"prose","value":{"id":"异常","title":"异常","isH3":true,"content":"<p>This method may raise a <a href=\"/zh-CN/docs/Web/API/DOMException\"><code>DOMException</code></a> of one of the following types:</p>\n<table class=\"standard-table\">\n  <thead>\n    <tr>\n      <th scope=\"col\">Exception</th>\n      <th scope=\"col\">Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>ReadOnlyError</code></td>\n      <td>\n        The transaction associated with this operation is in read-only\n        <a href=\"/en-US/docs/Web/API/IDBTransaction#mode_constants\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">mode (en-US)</a>.\n      </td>\n    </tr>\n    <tr>\n      <td><code>TransactionInactiveError</code></td>\n      <td>This <a href=\"/zh-CN/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a>'s transaction is inactive.</td>\n    </tr>\n    <tr>\n      <td><code>DataError</code></td>\n      <td>\n        <p>Any of the following conditions apply:</p>\n        <ul>\n          <li>\n            The object store uses in-line keys or has a key generator, and a key\n            parameter was provided.\n          </li>\n          <li>\n            The object store uses out-of-line keys and has no key generator, and\n            no key parameter was provided.\n          </li>\n          <li>\n            The object store uses in-line keys but no key generator, and the\n            object store's key path does not yield a valid key.\n          </li>\n          <li>The key parameter was provided but does not contain a valid key.</li>\n        </ul>\n      </td>\n    </tr>\n    <tr>\n      <td><code>InvalidStateError</code></td>\n      <td>\n        The <a href=\"/zh-CN/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a> has been deleted or\n        removed.\n      </td>\n    </tr>\n    <tr>\n      <td><code>DataCloneError</code></td>\n      <td>\n        The data being stored could not be cloned by the internal structured\n        cloning algorithm.<br>\n      </td>\n    </tr>\n  </tbody>\n</table>"}},{"type":"prose","value":{"id":"参数_2","title":"参数","isH3":false,"content":"<dl>\n  <dt id=\"value\">value</dt>\n  <dd>\n    <p>被储存的值。</p>\n  </dd>\n  <dt id=\"key_2\">key</dt>\n  <dd>\n    <p>识别记录的键。如果没有声明，那么记录键值将为空。如果对象仓库有一个键生成器 (e.g. autoincrement) ,必须传入 key 来更新对象。</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"example","title":"Example","isH3":false,"content":"<p>The following example requests a given record title; when that request is successful the <code>onsuccess</code> function gets the associated record from the <a href=\"/zh-CN/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a> (made available as <code>objectStoreTitleRequest.result</code>), updates one property of the record, and then puts the updated record back into the object store in another request with <code>put()</code>. For a full working example, see our <a href=\"https://github.com/mdn/to-do-notifications/\" class=\"external\" rel=\" noopener\">To-do Notifications</a> app (<a href=\"https://mdn.github.io/to-do-notifications/\" class=\"external\" rel=\" noopener\">view example live</a>.)</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> title <span class=\"token operator\">=</span> <span class=\"token string\">\"Walk dog\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Open up a transaction as usual</span>\n<span class=\"token keyword\">var</span> objectStore <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'toDoList'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"readwrite\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">objectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">'toDoList'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Get the to-do list object that has this title as it's title</span>\n<span class=\"token keyword\">var</span> objectStoreTitleRequest <span class=\"token operator\">=</span> objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nobjectStoreTitleRequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Grab the data object returned as the result</span>\n  <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> objectStoreTitleRequest<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Update the notified value in the object to \"yes\"</span>\n  data<span class=\"token punctuation\">.</span>notified <span class=\"token operator\">=</span> <span class=\"token string\">\"yes\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Create another request that inserts the item back into the database</span>\n  <span class=\"token keyword\">var</span> updateTitleRequest <span class=\"token operator\">=</span> objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Log the transaction that originated this request</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The transaction that originated this request is \"</span> <span class=\"token operator\">+</span> updateTitleRequest<span class=\"token punctuation\">.</span>transaction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// When this new request succeeds, run the displayData() function again to update the display</span>\n  updateTitleRequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">displayData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Specification","id":"specification","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/IndexedDB/#ref-for-dom-idbobjectstore-put①","title":"Indexed Database API 3.0"}],"query":"api.IDBObjectStore.put"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.IDBObjectStore.put","dataURL":"/zh-CN/docs/Web/API/IDBObjectStore/put/bcd.json"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/zh-CN/docs/Web/API/IndexedDB_API/Using_IndexedDB\">Using IndexedDB</a></li>\n  <li>Starting transactions: <a href=\"/zh-CN/docs/Web/API/IDBDatabase\"><code>IDBDatabase</code></a></li>\n  <li>Using transactions: <a href=\"/zh-CN/docs/Web/API/IDBTransaction\"><code>IDBTransaction</code></a></li>\n  <li>Setting a range of keys: <a href=\"/zh-CN/docs/Web/API/IDBKeyRange\"><code>IDBKeyRange</code></a></li>\n  <li>Retrieving and making changes to your data: <a href=\"/zh-CN/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a></li>\n  <li>Using cursors: <a href=\"/zh-CN/docs/Web/API/IDBCursor\"><code>IDBCursor</code></a></li>\n  <li>Reference example: <a href=\"https://github.com/mdn/to-do-notifications/tree/gh-pages\" class=\"external\" rel=\" noopener\">To-do Notifications</a> (<a href=\"https://mdn.github.io/to-do-notifications/\" class=\"external\" rel=\" noopener\">view example live</a>.)</li>\n</ul>"}}],"toc":[{"text":"语法","id":"语法"},{"text":"参数","id":"参数_2"},{"text":"Example","id":"example"},{"text":"Specification","id":"specification"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"IDBObjectStore 接口的 put() 方法更新一条给定的数据库记录，如果给出的值不存在，则插入一个新的记录","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"IDBObjectStore.put()","locale":"en-US","native":"English (US)"},{"title":"IDBObjectStore.put()","locale":"fr","native":"Français"}],"source":{"folder":"zh-cn/web/api/idbobjectstore/put","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/web/api/idbobjectstore/put/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Web","title":"Web 开发技术"},{"uri":"/zh-CN/docs/Web/API","title":"Web API 接口参考"},{"uri":"/zh-CN/docs/Web/API/IDBObjectStore","title":"IDBObjectStore"},{"uri":"/zh-CN/docs/Web/API/IDBObjectStore/put","title":"IDBObjectStore.put()"}],"pageTitle":"IDBObjectStore.put() - Web API 接口参考 | MDN","noIndexing":false}}