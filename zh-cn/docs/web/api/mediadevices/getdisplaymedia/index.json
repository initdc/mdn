{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"MediaDevices.getDisplayMedia()","mdn_url":"/zh-CN/docs/Web/API/MediaDevices/getDisplayMedia","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"<ol><li><strong><a href=\"/zh-CN/docs/Web/API/Screen_Capture_API\">Screen Capture API</a></strong></li><li class=\"toggle\"><details open=\"\"><summary>指南</summary><ol><li><a href=\"/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture\">Using the Screen Capture API</a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>属性</summary><ol><li><a href=\"/zh-CN/docs/Web/API/MediaTrackConstraints/cursor\"><code>MediaTrackConstraints.cursor</code></a></li><li><a href=\"/zh-CN/docs/Web/API/MediaTrackConstraints/displaySurface\"><code>MediaTrackConstraints.displaySurface</code></a></li><li><a href=\"/zh-CN/docs/Web/API/MediaTrackConstraints/logicalSurface\"><code>MediaTrackConstraints.logicalSurface</code></a></li><li><a href=\"/zh-CN/docs/Web/API/MediaTrackSettings/cursor\"><code>MediaTrackSettings.cursor</code></a></li><li><a href=\"/zh-CN/docs/Web/API/MediaTrackSettings/displaySurface\"><code>MediaTrackSettings.displaySurface</code></a></li><li><a href=\"/zh-CN/docs/Web/API/MediaTrackSettings/logicalSurface\"><code>MediaTrackSettings.logicalSurface</code></a></li><li><a href=\"/zh-CN/docs/Web/API/MediaTrackSupportedConstraints/cursor\"><code>MediaTrackSupportedConstraints.cursor</code></a></li><li><a href=\"/zh-CN/docs/Web/API/MediaTrackSupportedConstraints/displaySurface\"><code>MediaTrackSupportedConstraints.displaySurface</code></a></li><li><a href=\"/zh-CN/docs/Web/API/MediaTrackSupportedConstraints/logicalSurface\"><code>MediaTrackSupportedConstraints.logicalSurface</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>方法</summary><ol><li><a href=\"/zh-CN/docs/Web/API/MediaDevices/getDisplayMedia\"><code>MediaDevices.getDisplayMedia()</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>这个 <a href=\"/zh-CN/docs/Web/API/MediaDevices\"><code>MediaDevices</code></a> 接口的 <strong><code>getDisplayMedia()</code></strong> 方法提示用户去选择和授权捕获展示的内容或部分内容（如一个窗口）在一个<a href=\"/zh-CN/docs/Web/API/MediaStream\"><code>MediaStream</code></a> 里。然后，这个媒体流可以通过使用 <a href=\"/zh-CN/docs/Web/API/MediaStream_Recording_API\">MediaStream Recording API</a> 被记录或者作为<a href=\"/zh-CN/docs/Web/API/WebRTC_API\">WebRTC</a> 会话的一部分被传输。</p>\n<p>去 <a href=\"/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture\">Using the Screen Capture API</a> 查找更多详情和例子。</p>"}},{"type":"prose","value":{"id":"语法","title":"语法","isH3":false,"content":"<div class=\"code-example\"><pre class=\"brush: plain notranslate\">var promise = navigator.mediaDevices.getDisplayMedia(constraints);\n</pre></div>"}},{"type":"prose","value":{"id":"参数","title":"参数","isH3":true,"content":"<dl>\n  <dt id=\"constraints\"><code>constraints</code> <span class=\"badge inline optional\">可选</span></dt>\n  <dd>\n    <p>一个可选的<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MediaDevices/getUserMedia\"><code>MediaStreamConstraints</code> <small>(en-US)</small></a>对象，它指定了返回的<a href=\"/zh-CN/docs/Web/API/MediaStream\"><code>MediaStream</code></a>的要求。因为<code>getDisplayMedia()</code>需要视频轨道，所以即使<code>constraints</code> 对象没有明确请求视频轨道，返回的流也会有一个。</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"返回值","title":"返回值","isH3":true,"content":"<p>一个被解析为 <a href=\"/zh-CN/docs/Web/API/MediaStream\"><code>MediaStream</code></a> 的 <a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a>，其中包含一个视频轨道。视频轨道的内容来自用户选择的屏幕区域以及一个可选的音频轨道。</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>备注：</strong> 浏览器对音频的支持程度各不相同，既取决于是否支持，也取决于音频源。点击 <a href=\"#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9%E6%80%A7\">浏览器兼容性</a> 来查看各个浏览器的支持性。</p>\n</div>"}},{"type":"prose","value":{"id":"异常","title":"异常","isH3":true,"content":"<p>来自返回的 promise 的拒绝是通过将<a href=\"/zh-CN/docs/Web/API/DOMException\"><code>DOMException</code></a>错误对象传递给 promise 的失败处理程序来进行的。可能的错误是：</p>\n<dl>\n  <dt id=\"aborterror\"><code>AbortError</code> ［中止错误］</dt>\n  <dd>\n    <p>发生了与以下任何其他异常不匹配的错误或故障。</p>\n  </dd>\n  <dt id=\"invalidstateerror\"><code>InvalidStateError</code> ［拒绝错误］</dt>\n  <dd>\n    <p>调用 <code>getDisplayMedia()</code> 的 context 中的 <a href=\"/zh-CN/docs/Web/API/Document\"><code>document</code></a> 不是完全激活的; 例如，也许它不是最前面的标签。</p>\n  </dd>\n  <dt id=\"notallowederror\"><code>NotAllowedError</code> ［拒绝错误］</dt>\n  <dd>\n    <p>用户拒绝授予访问屏幕区域的权限，或者不允许当前浏览实例访问屏幕共享。</p>\n  </dd>\n  <dt id=\"notfounderror\"><code>NotFoundError</code> ［找不到错误］</dt>\n  <dd>\n    <p>没有可用于捕获的屏幕视频源。</p>\n  </dd>\n  <dt id=\"notreadableerror\"><code>NotReadableError</code> ［无法读取错误］</dt>\n  <dd>\n    <p>用户选择了屏幕，窗口，标签或其他屏幕数据源，但发生了硬件或操作系统级别错误或锁定，从而预先占用了共享所选源。</p>\n  </dd>\n  <dt id=\"overconstrainederror\"><code>OverconstrainedError</code> ［转换错误］</dt>\n  <dd>\n    <p>创建流后，由于无法生成兼容的流导致应用指定的 <code>constraints</code> 失效。</p>\n  </dd>\n  <dt id=\"typeerror\"><code>TypeError</code> ［类型错误］</dt>\n  <dd>\n    <p>指定的 <code>constraints</code> 包括调用 <code>getDisplayMedia()</code> 时不允许的<code>constraints</code>。这些不受支持的<code>constraints</code>是 <code>advanced</code> 的，任何约束又有一个名为 <code>min</code> 或 <code>exact</code> 的成员。</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"示例","title":"示例","isH3":false,"content":"<p>在下面的示例中，我们创建了一个 <code>startCapture()</code> 方法，该方法在给定由 <code>displayMediaOptions</code> 参数指定的一组选项的情况下启动屏幕捕获。选项以 <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MediaDevices/getUserMedia\"><code>MediaStreamConstraints</code> <small>(en-US)</small></a>对象的形式指定，该对象指定首选流配置和从中捕获视频的显示表面</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">startCapture</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">displayMediaOptions</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> captureStream <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    captureStream <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> navigator<span class=\"token punctuation\">.</span>mediaDevices<span class=\"token punctuation\">.</span><span class=\"token function\">getDisplayMedia</span><span class=\"token punctuation\">(</span>displayMediaOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error: \"</span> <span class=\"token operator\">+</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> captureStream<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>这里使用 <a class=\"page-not-created\" title=\"此文档尚未被撰写，期待你的贡献!\"><code>await</code></a> 来进行异步等待 <code>getDisplayMedia()</code>来进行 <a href=\"/zh-CN/docs/Web/API/MediaStream\"><code>MediaStream</code></a>解析，其中包含指定选项所请求的显示内容。之后，流被返回给调用者以供其使用，可能是使用 <a href=\"/zh-CN/docs/Web/API/RTCPeerConnection/addTrack\"><code>RTCPeerConnection.addTrack()</code></a>添加到 WebRTC 调用来从流中添加视频轨道。</p>"}},{"type":"specifications","value":{"title":"规范","id":"规范","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/mediacapture-screen-share/#dom-mediadevices-getdisplaymedia","title":"Screen Capture"}],"query":"api.MediaDevices.getDisplayMedia"}},{"type":"browser_compatibility","value":{"title":"浏览器兼容性","id":"浏览器兼容性","isH3":false,"query":"api.MediaDevices.getDisplayMedia","dataURL":"/zh-CN/docs/Web/API/MediaDevices/getDisplayMedia/bcd.json"}},{"type":"prose","value":{"id":"参考","title":"参考","isH3":false,"content":"<ul>\n  <li><a href=\"/zh-CN/docs/Web/API/Screen_Capture_API\">Screen Capture API</a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/Screen_Capture_API/Using_Screen_Capture\">Using the Screen Capture API</a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/Media_Capture_and_Streams_API\">Media Capture and Streams API</a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/WebRTC_API\">WebRTC API</a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/MediaDevices/getUserMedia\" title=\"getUserMedia()\"><code>getUserMedia()</code></a>: Capturing media from a camera and/or microphone</li>\n</ul>"}}],"toc":[{"text":"语法","id":"语法"},{"text":"示例","id":"示例"},{"text":"规范","id":"规范"},{"text":"浏览器兼容性","id":"浏览器兼容性"},{"text":"参考","id":"参考"}],"summary":"这个 MediaDevices 接口的 getDisplayMedia() 方法提示用户去选择和授权捕获展示的内容或部分内容（如一个窗口）在一个MediaStream 里。然后，这个媒体流可以通过使用 MediaStream Recording API 被记录或者作为WebRTC 会话的一部分被传输。","popularity":0.0008,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"MediaDevices.getDisplayMedia()","locale":"en-US","native":"English (US)"},{"title":"MediaDevices.getDisplayMedia()","locale":"ja","native":"日本語"}],"source":{"folder":"zh-cn/web/api/mediadevices/getdisplaymedia","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/web/api/mediadevices/getdisplaymedia/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Web","title":"Web 开发技术"},{"uri":"/zh-CN/docs/Web/API","title":"Web API 接口参考"},{"uri":"/zh-CN/docs/Web/API/MediaDevices","title":"MediaDevices"},{"uri":"/zh-CN/docs/Web/API/MediaDevices/getDisplayMedia","title":"MediaDevices.getDisplayMedia()"}],"pageTitle":"MediaDevices.getDisplayMedia() - Web API 接口参考 | MDN","noIndexing":false}}