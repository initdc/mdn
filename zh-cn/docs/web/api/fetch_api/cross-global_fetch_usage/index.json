{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Cross-global fetch usage","mdn_url":"/zh-CN/docs/Web/API/Fetch_API/Cross-global_fetch_usage","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>本文解释了在 fetch 时发生的边缘情况（以及潜在的其他 APIs 展示相同类型的资源检索行为）。当从“iframe”发起包含相对 url 的跨源 fetch 时，相对 url 用于针对当前全局位置而不是 iframe 的位置进行解析。</p>"}},{"type":"prose","value":{"id":"边缘情况","title":"边缘情况","isH3":false,"content":"<p>大多数网站几乎不会遇到这种边缘情况。如下：</p>\n<ul>\n  <li>需要一个同源的 iframe</li>\n  <li>该同源 iframe 需要具有不同基址位置</li>\n  <li>必须使用跨全局的 fetch 函数，例如。<code>frame.contentWindow.fetch()</code></li>\n  <li>传递给 fetch 函数的是相对 URL</li>\n</ul>"}},{"type":"prose","value":{"id":"遇到的问题","title":"遇到的问题","isH3":false,"content":"<p>以前，我们从当前全局 URL 中解析相对 URL，例如：</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> absolute <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">URL</span><span class=\"token punctuation\">(</span>relative<span class=\"token punctuation\">,</span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>这样做不是什么大问题，只是表现出这种行为的不同 API 与规范中定义的行为的不一致可能导致问题的进一步发展。</p>"}},{"type":"prose","value":{"id":"解决方案","title":"解决方案","isH3":false,"content":"<p>在 Firefox 60 及以后版本中，Mozilla 对相对 URL 的解析是相对于拥有<code>fetch()</code>函数的全局的。（见 <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1432272\" class=\"external\" rel=\" noopener\">bug&nbsp;1432272</a>）。因此在上述情形中，URL 是相对于 iframe 的地址进行解析的：</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> absolute <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">URL</span><span class=\"token punctuation\">(</span>relative<span class=\"token punctuation\">,</span> frame<span class=\"token punctuation\">.</span>contentWindow<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>关于使新规范与此行为变化保持一致，以缓解未来可能出现的问题，大量讨论正在进行中。</p>"}}],"toc":[{"text":"边缘情况","id":"边缘情况"},{"text":"遇到的问题","id":"遇到的问题"},{"text":"解决方案","id":"解决方案"}],"summary":"本文解释了在 fetch 时发生的边缘情况（以及潜在的其他 APIs 展示相同类型的资源检索行为）。当从“iframe”发起包含相对 url 的跨源 fetch 时，相对 url 用于针对当前全局位置而不是 iframe 的位置进行解析。","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Cross-global fetch usage","locale":"en-US","native":"English (US)"},{"title":"グローバル間フェッチの使用","locale":"ja","native":"日本語"},{"title":"Uso de busca Cross-global","locale":"pt-BR","native":"Português (do Brasil)"},{"title":"Cross-global fetch usage","locale":"ru","native":"Русский"}],"source":{"folder":"zh-cn/web/api/fetch_api/cross-global_fetch_usage","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/web/api/fetch_api/cross-global_fetch_usage/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Web","title":"Web 开发技术"},{"uri":"/zh-CN/docs/Web/API","title":"Web API 接口参考"},{"uri":"/zh-CN/docs/Web/API/Fetch_API","title":"Fetch API"},{"uri":"/zh-CN/docs/Web/API/Fetch_API/Cross-global_fetch_usage","title":"Cross-global fetch usage"}],"pageTitle":"Cross-global fetch usage - Web API 接口参考 | MDN","noIndexing":false}}