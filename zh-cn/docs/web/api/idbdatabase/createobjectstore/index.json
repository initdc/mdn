{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"IDBDatabase.createObjectStore()","mdn_url":"/zh-CN/docs/Web/API/IDBDatabase/createObjectStore","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"<ol><li><strong><a href=\"/zh-CN/docs/Web/API/IndexedDB_API\">IndexedDB API</a></strong></li><li><strong><a href=\"/zh-CN/docs/Web/API/IDBDatabase\"><code>IDBDatabase</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>属性</summary><ol><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBDatabase/name\"><code>name</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBDatabase/objectStoreNames\"><code>objectStoreNames</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBDatabase/version\"><code>version</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>方法</summary><ol><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBDatabase/close\"><code>close()</code> <small>(en-US)</small></a></li><li><em><code>createObjectStore()</code></em></li><li><a href=\"/zh-CN/docs/Web/API/IDBDatabase/deleteObjectStore\"><code>deleteObjectStore()</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBDatabase/transaction\"><code>transaction()</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>事件</summary><ol><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBDatabase/close_event\"><code>close</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBDatabase/versionchange_event\"><code>versionchange</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>继承</summary><ol><li><a href=\"/zh-CN/docs/Web/API/EventTarget\"><code>EventTarget</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>IndexedDB 的相关页面</summary><ol><li><a href=\"/zh-CN/docs/Web/API/IDBCursor\"><code>IDBCursor</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBCursorWithValue\"><code>IDBCursorWithValue</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBFactory\"><code>IDBFactory</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBIndex\"><code>IDBIndex</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBKeyRange\"><code>IDBKeyRange</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBOpenDBRequest\"><code>IDBOpenDBRequest</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBRequest\"><code>IDBRequest</code></a></li><li><a href=\"/zh-CN/docs/Web/API/IDBTransaction\"><code>IDBTransaction</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBVersionChangeEvent\"><code>IDBVersionChangeEvent</code> <small>(en-US)</small></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p><a href=\"/zh-CN/docs/Web/API/IDBDatabase\"><code>IDBDatabase</code></a> 接口的 <strong><code>createObjectStore()</code></strong> 方法创建并返回一个新的 object store 或 index。</p>\n<p>此方法接受一个参数作为 store 的名称，也接受一个可选的参数对象让你可以定义重要的可选属性。你可以用这个属性唯一的标识此 store 中的每个对象。因为参数是一个标识符，所以 store 中的每一个对象都应有此属性并保证此属性唯一。</p>\n<p>此方法只能在 <a href=\"/en-US/docs/Web/API/IDBTransaction#version_change\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">versionchange (en-US)</a> 事务中被调用。</p><div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> 此特性在 <a href=\"/zh-CN/docs/Web/API/Web_Workers_API\">Web Worker</a> 中可用</p>\n</div>"}},{"type":"prose","value":{"id":"语法","title":"语法","isH3":false,"content":"<pre class=\"notranslate\">var objectStore = IDBDatabase.createObjectStore(name);\nvar objectStore = IDBDatabase.createObjectStore(name, options);\n</pre>"}},{"type":"prose","value":{"id":"参数","title":"参数","isH3":true,"content":"<dl>\n  <dt id=\"name\">name</dt>\n  <dd>\n    <p>被创建的 object store 的名称。请注意创建空名称的 object store 是被允许的。</p>\n  </dd>\n  <dt id=\"optionalparameters\">optionalParameters <span class=\"badge inline optional\">可选</span></dt>\n  <dd>\n    <p>可选的对象，它的属性是此方法的可选参数，其中包括以下的属性：</p>\n    <table>\n      <thead>\n        <tr>\n          <th>Attribute</th>\n          <th>Description</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td><code>keyPath</code></td>\n          <td><a href=\"/en-US/docs/Web/API/IndexedDB_API/Basic_Terminology#gloss_keypath\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">key path (en-US)</a> 被用在新的 object store 上。如果为空或未指定，object store 创建时将没有 key path，而是使用 <a href=\"/en-US/docs/Web/API/IndexedDB_API/Basic_Terminology#gloss_outofline_key\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">out-of-line keys (en-US)</a> 。你也能传一个数组作为 <code>keyPath</code> 。</td>\n        </tr>\n        <tr>\n          <td><code>autoIncrement</code></td>\n          <td>如果为 <code>true</code>, object store 有一个 <a href=\"/en-US/docs/Web/API/IndexedDB_API/Basic_Terminology#gloss_keygenerator\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">key generator (en-US)</a>. 默认为 <code>false</code>。</td>\n        </tr>\n      </tbody>\n    </table>\n    <p>未知参数将被忽略。</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"返回值","title":"返回值","isH3":true,"content":"<dl>\n  <dt id=\"idbobjectstore\"><a href=\"/zh-CN/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a></dt>\n  <dd>\n    <p>新创建的 object store 对象。</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"异常","title":"异常","isH3":true,"content":"<p>This method may raise a 此方法可能会抛出一个 <a href=\"/zh-CN/docs/Web/API/DOMException\"><code>DOMException</code></a> 带有以下所列其中一种类型的 <a href=\"/zh-CN/docs/Web/API/DOMError\"><code>DOMError</code></a> ：</p>\n<table>\n  <thead>\n    <tr>\n      <th>Exception</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>InvalidStateError</code></td>\n      <td>在非<code>versionchange</code>事务中调用时发生。在一些旧版本的 Webkit 浏览器，你必须先调用方法。</td>\n    </tr>\n    <tr>\n      <td><code>TransactionInactiveError</code></td>\n      <td>如果对不存在的源数据库发出请求（例如，已被删除的）。此外，在 Firefox 版本小于 41 中，会抛出误导性的 <code>InvalidStateError</code> 错误，这一问题现已修复（请参阅 <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1176165\" class=\"external\" rel=\" noopener\">bug&nbsp;1176165</a>）。</td>\n    </tr>\n    <tr>\n      <td><code>ConstraintError</code></td>\n      <td>数据库中已存同名的对象存储（名字区分大小写）</td>\n    </tr>\n    <tr>\n      <td><code>InvalidAccessError</code></td>\n      <td>如果 <code>autoIncrement</code> 设置为 true，并且 keyPath 是空字符串或包含空字符串的数组。</td>\n    </tr>\n  </tbody>\n</table>"}},{"type":"prose","value":{"id":"example","title":"Example","isH3":false,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code> <span class=\"token comment\">// 打开一个数据库</span>\n  <span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>indexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"toDoList\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// This handler is called when a new version of the database</span>\n  <span class=\"token comment\">// is created, either when one has not been created before</span>\n  <span class=\"token comment\">// or when a new version number is submitted by calling</span>\n  <span class=\"token comment\">// window.indexedDB.open().</span>\n  <span class=\"token comment\">// This handler is only supported in recent browsers.</span>\n  request<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onupgradeneeded</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> db <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n\n    db<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      note<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">+=</span> <span class=\"token string\">'&lt;li&gt;Error loading database.&lt;/li&gt;'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Create an objectStore for this database</span>\n\n    <span class=\"token keyword\">var</span> objectStore <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">createObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"toDoList\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">keyPath</span><span class=\"token operator\">:</span> <span class=\"token string\">\"taskTitle\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// define what data items the objectStore will contain</span>\n\n    objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hours\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hours\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">unique</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"minutes\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"minutes\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">unique</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"day\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"day\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">unique</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"month\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"month\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">unique</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"year\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"year\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">unique</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"notified\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"notified\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">unique</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    note<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">+=</span> <span class=\"token string\">'&lt;li&gt;Object store created.&lt;/li&gt;'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Specification","id":"specification","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/IndexedDB/#ref-for-dom-idbdatabase-createobjectstore①","title":"Indexed Database API 3.0"}],"query":"api.IDBDatabase.createObjectStore"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.IDBDatabase.createObjectStore","dataURL":"/zh-CN/docs/Web/API/IDBDatabase/createObjectStore/bcd.json"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/zh-CN/docs/Web/API/IndexedDB_API/Using_IndexedDB\">Using IndexedDB</a></li>\n  <li>Starting transactions: <a href=\"/zh-CN/docs/Web/API/IDBDatabase\"><code>IDBDatabase</code></a></li>\n  <li>Using transactions: <a href=\"/zh-CN/docs/Web/API/IDBTransaction\"><code>IDBTransaction</code></a></li>\n  <li>Setting a range of keys: <a href=\"/zh-CN/docs/Web/API/IDBKeyRange\"><code>IDBKeyRange</code></a></li>\n  <li>Retrieving and making changes to your data: <a href=\"/zh-CN/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a></li>\n  <li>Using cursors: <a href=\"/zh-CN/docs/Web/API/IDBCursor\"><code>IDBCursor</code></a></li>\n  <li>Reference example: <a href=\"https://github.com/mdn/to-do-notifications/tree/gh-pages\" class=\"external\" rel=\" noopener\">To-do Notifications</a> (<a href=\"https://mdn.github.io/to-do-notifications/\" class=\"external\" rel=\" noopener\">view example live</a>.)</li>\n</ul>"}}],"toc":[{"text":"语法","id":"语法"},{"text":"Example","id":"example"},{"text":"Specification","id":"specification"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"IDBDatabase 接口的 createObjectStore() 方法创建并返回一个新的 object store 或 index。","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"IDBDatabase.createObjectStore()","locale":"en-US","native":"English (US)"},{"title":"IDBDatabase.createObjectStore()","locale":"fr","native":"Français"},{"title":"IDBDatabase.createObjectStore","locale":"ja","native":"日本語"}],"source":{"folder":"zh-cn/web/api/idbdatabase/createobjectstore","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/web/api/idbdatabase/createobjectstore/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Web","title":"Web 开发技术"},{"uri":"/zh-CN/docs/Web/API","title":"Web API 接口参考"},{"uri":"/zh-CN/docs/Web/API/IDBDatabase","title":"IDBDatabase"},{"uri":"/zh-CN/docs/Web/API/IDBDatabase/createObjectStore","title":"IDBDatabase.createObjectStore()"}],"pageTitle":"IDBDatabase.createObjectStore() - Web API 接口参考 | MDN","noIndexing":false}}