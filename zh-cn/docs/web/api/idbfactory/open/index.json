{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"IDBFactory.open","mdn_url":"/zh-CN/docs/Web/API/IDBFactory/open","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"<ol><li><strong><a href=\"/zh-CN/docs/Web/API/IDBFactory\"><code>IDBFactory</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>方法</summary><ol><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBFactory/cmp\"><code>cmp()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBFactory/databases\"><code>databases()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBFactory/deleteDatabase\"><code>deleteDatabase()</code> <small>(en-US)</small></a></li><li><em><code>open()</code></em></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p><strong><code>IDBFactory.open</code></strong> 方法用于<a href=\"/zh-CN/docs/Web/API/IndexedDB_API#gloss_database_connection\">打开一个数据库连接</a>。本方法立即返回一个 <a href=\"/zh-CN/docs/Web/API/IDBOpenDBRequest\"><code>IDBOpenDBRequest</code></a> 对象，但打开数据库的操作是异步执行的。</p>\n<p>连接数据库在一个单独的线程中进行，包括以下几个步骤：</p>\n<ol>\n  <li>指定数据库已经存在时：\n    <ul>\n      <li>等待 <a class=\"page-not-created\" title=\"此文档尚未被撰写，期待你的贡献!\"><code>versionchange</code></a> 操作完成。</li>\n      <li>如果数据库已计划删除，那等着删除完成。</li>\n    </ul>\n  </li>\n  <li>如果已有数据库版本高于给定的 <code>version</code>，中止操作并返回类型为 <code>VersionError</code> 的 <code>DOMError</code>。</li>\n  <li>如果已有数据库版本低于给定的 <code>version</code>，触发一个 <code>versionchange</code> 操作。</li>\n  <li>如果数据库不存在，创建指定名称的数据库，将版本号设置为给定版本，如果给定版本号，则设置为 1，and no object stores.</li>\n  <li>创建数据库连接。</li>\n</ol>\n<p>如果操作成功执行，将触发 <code>success</code> 事件 on the request object that is returned from this method, with its <code>result</code> attribute set to the new <a href=\"/zh-CN/docs/Web/API/IDBDatabase\"><code>IDBDatabase</code></a> object for the connection.</p>\n<p>If an error occurs while the database connection is being opened, then an <a href=\"/zh-CN/docs/IndexedDB/IDBErrorEvent\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">error event</a> is fired on the request object returned from this method.</p>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<p>For the current standard:</p>\n<pre class=\"notranslate\"> IDBOpenDBRequest open (DOMString name, [EnforceRange] optional unsigned long long version);\n</pre>\n<p>For the experimental version with <code>options</code> (see below):</p>\n<pre class=\"notranslate\">IDBOpenDBRequest open (DOMString name, optional IDBOpenDBOptions options);\n</pre>"}},{"type":"prose","value":{"id":"示例","title":"示例","isH3":false,"content":"<p>For the current standard:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>indexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"toDoList\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>For the experimental version with <code>options</code> (see below):</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>indexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"toDoList\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">version</span><span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">storage</span><span class=\"token operator\">:</span> <span class=\"token string\">\"temporary\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"参数","title":"参数","isH3":false,"content":"<dl>\n  <dt id=\"name\">name</dt>\n  <dd>\n    <p>数据库名称</p>\n  </dd>\n  <dt id=\"version\">version</dt>\n  <dd>\n    <p>指定数据库版本，当你想要更改数据库格式（比如增加对象存储，非增加记录），必须指定更高版本，通过 versionchange 来更改</p>\n  </dd>\n  <dt id=\"options_version_and_storage\">options (version and storage) <svg class=\"icon icon-nonstandard\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-nonstandard\"></use>\n</svg></dt>\n  <dd>\n    <p>In Gecko, since <a href=\"/zh-CN/docs/Mozilla/Firefox/Releases/26\">version 26</a>, you can include an <code>options</code> object as a parameter of <a href=\"/zh-CN/docs/Web/API/IDBFactory/open\" aria-current=\"page\"><code>IDBFactory.open</code></a> that contains the <code>version</code> number of the database, plus a storage value that specifies whether you want to use <code>permanent</code> (the default value) storage for the IndexedDB, or <code>temporary</code> storage (aka shared pool.) See <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=785884\" class=\"external\" rel=\" noopener\">bug&nbsp;785884</a> for more details. This is a non-standard feature that we are looking to standardise sometime in the future.</p>\n  </dd>\n</dl>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>备注：</strong> Data in temporary storage persists until the global limit for the pool is reached. The global limit calculation is relatively complex, but we are considering changing it (see <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=968272\" class=\"external\" rel=\" noopener\">bug&nbsp;968272</a>). When the global limit is reached, then data for the least recently used origin is deleted. There's also a group limit (eTLD+1 group/domain) which is currently 20% of the global limit. All requets that would exceed the group limit are just rejected.</p>\n</div>"}},{"type":"prose","value":{"id":"返回","title":"返回","isH3":false,"content":"<dl>\n  <dt id=\"idbopendbrequest\"><a href=\"/zh-CN/docs/Web/API/IDBOpenDBRequest\"><code>IDBOpenDBRequest</code></a></dt>\n  <dd>\n    <p>The request object on which subsequent events related to this request are fired.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"exceptions","title":"Exceptions","isH3":false,"content":"<p>This method may raise a <a href=\"/zh-CN/docs/Web/API/DOMException\"><code>DOMException</code></a> with a <a href=\"/en-US/docs/Web/API/DOMError\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">DOMError (en-US)</a> of the following types:</p>\n<table>\n  <thead>\n    <tr>\n      <th>Exception</th>\n      <th>描述</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>TypeError</code></td>\n      <td>The value of version is zero or a negative number or not a number.</td>\n    </tr>\n  </tbody>\n</table>"}},{"type":"specifications","value":{"title":"规范","id":"规范","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/IndexedDB/#ref-for-dom-idbfactory-open②","title":"Indexed Database API 3.0"}],"query":"api.IDBFactory.open"}},{"type":"browser_compatibility","value":{"title":"浏览器兼容性","id":"浏览器兼容性","isH3":false,"query":"api.IDBFactory.open","dataURL":"/zh-CN/docs/Web/API/IDBFactory/open/bcd.json"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"示例","id":"示例"},{"text":"参数","id":"参数"},{"text":"返回","id":"返回"},{"text":"Exceptions","id":"exceptions"},{"text":"规范","id":"规范"},{"text":"浏览器兼容性","id":"浏览器兼容性"}],"summary":"IDBFactory.open 方法用于打开一个数据库连接。本方法立即返回一个 IDBOpenDBRequest 对象，但打开数据库的操作是异步执行的。","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"IDBFactory.open()","locale":"en-US","native":"English (US)"},{"title":"IDBFactory.open()","locale":"fr","native":"Français"},{"title":"IDBFactory.open","locale":"ja","native":"日本語"}],"source":{"folder":"zh-cn/web/api/idbfactory/open","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/web/api/idbfactory/open/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Web","title":"Web 开发技术"},{"uri":"/zh-CN/docs/Web/API","title":"Web API 接口参考"},{"uri":"/zh-CN/docs/Web/API/IDBFactory","title":"IDBFactory"},{"uri":"/zh-CN/docs/Web/API/IDBFactory/open","title":"IDBFactory.open"}],"pageTitle":"IDBFactory.open - Web API 接口参考 | MDN","noIndexing":false}}