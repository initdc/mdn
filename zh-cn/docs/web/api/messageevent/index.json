{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"MessageEvent","mdn_url":"/zh-CN/docs/Web/API/MessageEvent","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"<ol><li><strong><a href=\"/zh-CN/docs/Web/API/HTML_DOM_API\">HTML DOM API</a></strong></li><li><strong><a href=\"/zh-CN/docs/Web/API/MessageEvent\"><code>MessageEvent</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>构造函数</summary><ol><li><a href=\"/zh-CN/docs/Web/API/MessageEvent/MessageEvent\"><code>MessageEvent()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>属性</summary><ol><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MessageEvent/data\"><code>data</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MessageEvent/lastEventId\"><code>lastEventId</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MessageEvent/origin\"><code>origin</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MessageEvent/ports\"><code>ports</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MessageEvent/source\"><code>source</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>继承</summary><ol><li><a href=\"/zh-CN/docs/Web/API/Event\"><code>Event</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>HTML DOM 的相关页面</summary><ol><li><a href=\"/zh-CN/docs/Web/API/BeforeUnloadEvent\"><code>BeforeUnloadEvent</code></a></li><li><a href=\"/zh-CN/docs/Web/API/DOMStringMap\"><code>DOMStringMap</code></a></li><li><a href=\"/zh-CN/docs/Web/API/ErrorEvent\"><code>ErrorEvent</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLAnchorElement\"><code>HTMLAnchorElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLAreaElement\"><code>HTMLAreaElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLAudioElement\"><code>HTMLAudioElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLBRElement\"><code>HTMLBRElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLBaseElement\"><code>HTMLBaseElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLBodyElement\"><code>HTMLBodyElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLButtonElement\"><code>HTMLButtonElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLCanvasElement\"><code>HTMLCanvasElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLContentElement\"><code>HTMLContentElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLDListElement\"><code>HTMLDListElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLDataElement\"><code>HTMLDataElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLDataListElement\"><code>HTMLDataListElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLDialogElement\"><code>HTMLDialogElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLDivElement\"><code>HTMLDivElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLDocument\"><code>HTMLDocument</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLElement\"><code>HTMLElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLEmbedElement\"><code>HTMLEmbedElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLFieldSetElement\"><code>HTMLFieldSetElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLFormControlsCollection\"><code>HTMLFormControlsCollection</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLFormElement\"><code>HTMLFormElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLFrameSetElement\"><code>HTMLFrameSetElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLHRElement\"><code>HTMLHRElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLHeadElement\"><code>HTMLHeadElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLHeadingElement\"><code>HTMLHeadingElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLHtmlElement\"><code>HTMLHtmlElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLIFrameElement\"><code>HTMLIFrameElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLImageElement\"><code>HTMLImageElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLInputElement\"><code>HTMLInputElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLKeygenElement\"><code>HTMLKeygenElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLLIElement\"><code>HTMLLIElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLLabelElement\"><code>HTMLLabelElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLLegendElement\"><code>HTMLLegendElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLLinkElement\"><code>HTMLLinkElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLMapElement\"><code>HTMLMapElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLMediaElement\"><code>HTMLMediaElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLMetaElement\"><code>HTMLMetaElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLMeterElement\"><code>HTMLMeterElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLModElement\"><code>HTMLModElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLOListElement\"><code>HTMLOListElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLObjectElement\"><code>HTMLObjectElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLOptGroupElement\"><code>HTMLOptGroupElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLOptionElement\"><code>HTMLOptionElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLOptionsCollection\"><code>HTMLOptionsCollection</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLOutputElement\"><code>HTMLOutputElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLParagraphElement\"><code>HTMLParagraphElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLPictureElement\"><code>HTMLPictureElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLPreElement\"><code>HTMLPreElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLProgressElement\"><code>HTMLProgressElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLQuoteElement\"><code>HTMLQuoteElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLScriptElement\"><code>HTMLScriptElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLSelectElement\"><code>HTMLSelectElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLShadowElement\"><code>HTMLShadowElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLSourceElement\"><code>HTMLSourceElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLSpanElement\"><code>HTMLSpanElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLStyleElement\"><code>HTMLStyleElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLTableCaptionElement\"><code>HTMLTableCaptionElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLTableCellElement\"><code>HTMLTableCellElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLTableColElement\"><code>HTMLTableColElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLTableElement\"><code>HTMLTableElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLTableRowElement\"><code>HTMLTableRowElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLTableSectionElement\"><code>HTMLTableSectionElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLTemplateElement\"><code>HTMLTemplateElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLTextAreaElement\"><code>HTMLTextAreaElement</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLTimeElement\"><code>HTMLTimeElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLTitleElement\"><code>HTMLTitleElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLTrackElement\"><code>HTMLTrackElement</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/HTMLUListElement\"><code>HTMLUListElement</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLUnknownElement\"><code>HTMLUnknownElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HTMLVideoElement\"><code>HTMLVideoElement</code></a></li><li><a href=\"/zh-CN/docs/Web/API/HashChangeEvent\"><code>HashChangeEvent</code></a></li><li><a href=\"/zh-CN/docs/Web/API/History\"><code>History</code></a></li><li><a href=\"/zh-CN/docs/Web/API/ImageData\"><code>ImageData</code></a></li><li><a href=\"/zh-CN/docs/Web/API/Location\"><code>Location</code></a></li><li><a href=\"/zh-CN/docs/Web/API/MessageChannel\"><code>MessageChannel</code></a></li><li><a href=\"/zh-CN/docs/Web/API/MessagePort\"><code>MessagePort</code></a></li><li><a href=\"/zh-CN/docs/Web/API/Navigator\"><code>Navigator</code></a></li><li><a href=\"/zh-CN/docs/Web/API/PageTransitionEvent\"><code>PageTransitionEvent</code></a></li><li><a href=\"/zh-CN/docs/Web/API/Plugin\"><code>Plugin</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PluginArray\"><code>PluginArray</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/PopStateEvent\"><code>PopStateEvent</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/PromiseRejectionEvent\"><code>PromiseRejectionEvent</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/RadioNodeList\"><code>RadioNodeList</code> <small>(en-US)</small></a></li><li><a href=\"/zh-CN/docs/Web/API/ValidityState\"><code>ValidityState</code></a></li><li><a href=\"/zh-CN/docs/Web/API/Window\"><code>Window</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p><strong><code>MessageEvent</code></strong> 是接口代表一段被目标对象接收的消息。</p>\n<p>用来代表下列情况的消息</p>\n<ul>\n  <li><a href=\"/zh-CN/docs/Web/API/Server-sent_events\">Server-sent events</a> (参见<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/EventSource/message_event\"><code>EventSource.onmessage</code> <small>(en-US)</small></a>).</li>\n  <li><a href=\"/zh-CN/docs/Web/API/WebSockets_API\">Web sockets</a> (参见 <a href=\"/zh-CN/docs/Web/API/WebSocket\">WebSocket</a> 接口的 <code>onmessage</code> 属性).</li>\n  <li>Cross-document messaging (参见 <a href=\"/zh-CN/docs/Web/API/Window/postMessage\"><code>Window.postMessage()</code></a> 和 <a class=\"page-not-created\" title=\"此文档尚未被撰写，期待你的贡献!\"><code>Window.onmessage</code></a>).</li>\n  <li><a href=\"/zh-CN/docs/Web/API/Channel_Messaging_API\">Channel messaging</a> (参见 <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MessagePort/postMessage\"><code>MessagePort.postMessage()</code> <small>(en-US)</small></a> 和<a href=\"/zh-CN/docs/Web/API/MessagePort/message_event\"><code>MessagePort.onmessage</code></a>).</li>\n  <li>Cross-worker/document messaging (参见上面两个入口，还有 <a href=\"/zh-CN/docs/Web/API/Worker/postMessage\"><code>Worker.postMessage()</code></a>, <a href=\"/zh-CN/docs/Web/API/Worker/message_event\"><code>Worker.onmessage</code></a>, <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/message_event\"><code>ServiceWorkerGlobalScope.onmessage</code> <small>(en-US)</small></a>, 等等.)</li>\n  <li><a href=\"/zh-CN/docs/Web/API/Broadcast_Channel_API\">Broadcast channels</a> (参见 <a href=\"/zh-CN/docs/Web/API/BroadcastChannel/postMessage\"><code>Broadcastchannel.postMessage()</code></a>) 和 <a href=\"/zh-CN/docs/Web/API/BroadcastChannel/message_event\"><code>BroadcastChannel.onmessage</code></a>).</li>\n  <li>WebRTC data channels (参见 <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/RTCDataChannel/message_event\"><code>RTCDataChannel.onmessage</code> <small>(en-US)</small></a>).</li>\n</ul>\n<p>通过这个事件触发的动作被定义为一个函数，该函数作为相关<code><a href=\"/zh-CN/docs/Web/Reference/Events/message\" title=\"This is a link to an unwritten page\" class=\"page-not-created\">message</a></code>事件 (例如使用前文所列的<code>onmessage</code> 处理器) 的事件处理器。</p><div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> 此特性在 <a href=\"/zh-CN/docs/Web/API/Web_Workers_API\">Web Worker</a> 中可用</p>\n</div>"}},{"type":"prose","value":{"id":"构造函数","title":"构造函数","isH3":false,"content":"<dl>\n  <dt id=\"messageevent\"><a href=\"/zh-CN/docs/Web/API/MessageEvent/MessageEvent\" title=\"MessageEvent()\"><code>MessageEvent()</code></a></dt>\n  <dd>\n    <p>创建一个新的 <strong>消息事件</strong> 。</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"属性","title":"属性","isH3":false,"content":"<p><em>继承其父类 <a href=\"/zh-CN/docs/Web/API/Event\"><code>Event</code></a> 的属性。</em></p>\n<dl>\n  <dt id=\"messageevent.data_en-us\"><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MessageEvent/data\"><code>MessageEvent.data</code> <small>(en-US)</small></a> <span title=\"该属性的值无法更改\" class=\"badge inline readonly\">只读 </span></dt>\n  <dd>\n    <p>返回 <a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String\"><code>DOMString</code></a>, <a href=\"/zh-CN/docs/Web/API/Blob\"><code>Blob</code></a> 或者 <a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\"><code>ArrayBuffer</code></a>，包含来自发送者的数据。</p>\n  </dd>\n  <dt id=\"messageevent.origin_en-us\"><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MessageEvent/origin\"><code>MessageEvent.origin</code> <small>(en-US)</small></a></dt>\n  <dd>\n    <p>返回一个表示消息发送者来源的<a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String\"><code>USVString</code></a></p>\n  </dd>\n  <dt id=\"messageevent.lasteventid_en-us\"><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MessageEvent/lastEventId\"><code>MessageEvent.lastEventId</code> <small>(en-US)</small></a> <span title=\"该属性的值无法更改\" class=\"badge inline readonly\">只读 </span></dt>\n  <dd>\n    <p><a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String\"><code>DOMString</code></a> representing a unique ID for the event.</p>\n  </dd>\n  <dt id=\"messageevent.source_en-us\"><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MessageEvent/source\"><code>MessageEvent.source</code> <small>(en-US)</small></a></dt>\n  <dd>\n    <p><code>MessageEventSource</code> (可以是 <a class=\"page-not-created\" title=\"此文档尚未被撰写，期待你的贡献!\"><code>WindowProxy</code></a>, <a href=\"/zh-CN/docs/Web/API/MessagePort\"><code>MessagePort</code></a>, 或 <a href=\"/zh-CN/docs/Web/API/ServiceWorker\"><code>ServiceWorker</code></a> 对象) 代表消息发送者。</p>\n  </dd>\n  <dt id=\"messageevent.ports_en-us\"><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MessageEvent/ports\"><code>MessageEvent.ports</code> <small>(en-US)</small></a></dt>\n  <dd>\n    <p><a href=\"/zh-CN/docs/Web/API/MessagePort\"><code>MessagePort</code></a>对象数组，表示消息正通过特定通道（数据通道）发送的相关端口（适用于通道消息传输或者向一个共享线程（shared work）发送消息时）。</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"方法","title":"方法","isH3":false,"content":"<p><em>继承父类 <a href=\"/zh-CN/docs/Web/API/Event\"><code>Event</code></a> 的方法。</em></p>\n<dl>\n  <dt id=\"messageevent.initmessageevent\"><a class=\"page-not-created\" title=\"此文档尚未被撰写，期待你的贡献!\"><code>MessageEvent.initMessageEvent()</code></a> <svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg></dt>\n  <dd>\n    <p><strong>不要再使用</strong>: 使用 <a href=\"/zh-CN/docs/Web/API/MessageEvent/MessageEvent\" title=\"MessageEvent()\"><code>MessageEvent()</code></a>。</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"示例","title":"示例","isH3":false,"content":"<p>在我们的基础共享线程示例 <a href=\"https://github.com/mdn/simple-shared-worker\" class=\"external\" rel=\" noopener\">Basic shared worker example</a> (<a href=\"https://mdn.github.io/simple-shared-worker/\" class=\"external\" rel=\" noopener\">run shared worker</a>) 中，我们有两个 HTML 页，每一页都用简单的 js 代码去执行简单的计算。不同的脚本使用同一个 worker 文件去执行计算 — 它们都可以访问那个 worker 文件，即使它们（scripts）运行在不同的窗口。</p>\n<p>下面的代码片段展示了使用<a href=\"/zh-CN/docs/Web/API/SharedWorker/SharedWorker\" title=\"SharedWorker()\"><code>SharedWorker()</code></a>构造器创建一个 <code>SharedWorker</code>对象。</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> myWorker <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SharedWorker</span><span class=\"token punctuation\">(</span><span class=\"token string\">'worker.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>接下来两份脚本通过一个<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/SharedWorker/port\"><code>SharedWorker.port</code> <small>(en-US)</small></a>方法创建的<a href=\"/zh-CN/docs/Web/API/MessagePort\"><code>MessagePort</code></a>对象访问 worker。如果 onmessage 事件通过 addEventListener 被绑定，端口可以用<code>start()</code>方法手动开启：</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>myWorker<span class=\"token punctuation\">.</span>port<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>当端口被打开，两份脚本各自都可用 <code>port.postMessage()</code> 向 worker 传消息并用 <code>port.onmessage</code>处理它（worker）传来的消息：</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>first<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onchange</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  myWorker<span class=\"token punctuation\">.</span>port<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>first<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span>second<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Message posted to worker'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nsecond<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onchange</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  myWorker<span class=\"token punctuation\">.</span>port<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>first<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span>second<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Message posted to worker'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nmyWorker<span class=\"token punctuation\">.</span>port<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmessage</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  result1<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Message received from worker'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>在 worker 内部我们使用 <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/SharedWorkerGlobalScope/connect_event\"><code>SharedWorkerGlobalScope.onconnect</code> <small>(en-US)</small></a> 处理器来连接前文说到相同端口。与 worker 相关联的端口可以在 <code><a href=\"/zh-CN/docs/Web/Reference/Events/connect\" title=\"This is a link to an unwritten page\" class=\"page-not-created\">connect</a></code> 事件的 <code>ports</code> 属性中访问到 — 接着我们使用 <a href=\"/zh-CN/docs/Web/API/MessagePort\"><code>MessagePort</code></a> <code>start()</code> 方法打开端口，<code>onmessage</code> 处理器来处理主线程传来的消息。</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token function-variable function\">onconnect</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> port <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>ports<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  port<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> workerResult <span class=\"token operator\">=</span> <span class=\"token string\">'Result: '</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> e<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    port<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span>workerResult<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  port<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Required when using addEventListener. Otherwise called implicitly by onmessage setter.</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"规范","id":"规范","isH3":false,"specifications":[{"bcdSpecificationURL":"https://html.spec.whatwg.org/multipage/comms.html#the-messageevent-interface","title":"HTML Standard"}],"query":"api.MessageEvent"}},{"type":"browser_compatibility","value":{"title":"浏览器兼容性","id":"浏览器兼容性","isH3":false,"query":"api.MessageEvent","dataURL":"/zh-CN/docs/Web/API/MessageEvent/bcd.json"}}],"toc":[{"text":"构造函数","id":"构造函数"},{"text":"属性","id":"属性"},{"text":"方法","id":"方法"},{"text":"示例","id":"示例"},{"text":"规范","id":"规范"},{"text":"浏览器兼容性","id":"浏览器兼容性"}],"summary":"MessageEvent 是接口代表一段被目标对象接收的消息。","popularity":0.0003,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"MessageEvent","locale":"en-US","native":"English (US)"},{"title":"MessageEvent","locale":"es","native":"Español"},{"title":"MessageEvent","locale":"fr","native":"Français"},{"title":"MessageEvent","locale":"ja","native":"日本語"},{"title":"MessageEvent","locale":"ko","native":"한국어"},{"title":"MessageEvent","locale":"zh-TW","native":"正體中文 (繁體)"}],"source":{"folder":"zh-cn/web/api/messageevent","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/web/api/messageevent/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Web","title":"Web 开发技术"},{"uri":"/zh-CN/docs/Web/API","title":"Web API 接口参考"},{"uri":"/zh-CN/docs/Web/API/MessageEvent","title":"MessageEvent"}],"pageTitle":"MessageEvent - Web API 接口参考 | MDN","noIndexing":false}}