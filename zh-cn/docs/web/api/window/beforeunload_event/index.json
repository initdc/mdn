{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Window: beforeunload event","mdn_url":"/zh-CN/docs/Web/API/Window/beforeunload_event","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>当浏览器窗口关闭或者刷新时，会触发 beforeunload 事件。当前页面不会直接关闭，可以点击确定按钮关闭或刷新，也可以取消关闭或刷新。</p>\n<table class=\"properties\">\n  <tbody>\n    <tr>\n      <th scope=\"row\">Bubbles</th>\n      <td>No</td>\n    </tr>\n    <tr>\n      <th scope=\"row\">Cancelable</th>\n      <td>Yes</td>\n    </tr>\n    <tr>\n      <th scope=\"row\">Interface</th>\n      <td><a href=\"/zh-CN/docs/Web/API/Event\"><code>Event</code></a></td>\n    </tr>\n    <tr>\n      <th scope=\"row\">Event handler property</th>\n      <td><a href=\"/zh-CN/docs/Web/API/Window/beforeunload_event\" title=\"onbeforeunload\" aria-current=\"page\"><code>onbeforeunload</code></a></td>\n    </tr>\n  </tbody>\n</table>\n<p>事件使网页能够触发一个确认对话框，询问用户是否真的要离开该页面。如果用户确认，浏览器将导航到新页面，否则导航将会取消。</p>\n<p>根据规范，要显示确认对话框，事件处理程序需要在事件上调用<a href=\"/zh-CN/docs/Web/API/Event/preventDefault\" title=\"preventDefault()\"><code>preventDefault()</code></a>。</p>\n<p>但是请注意，并非所有浏览器都支持此方法，而有些浏览器需要事件处理程序实现两个遗留方法中的一个作为代替：</p>\n<ul>\n  <li>将字符串分配给事件的<code>returnValue</code>属性</li>\n  <li>从事件处理程序返回一个字符串。</li>\n</ul>\n<p>某些浏览器过去在确认对话框中显示返回的字符串，从而使事件处理程序能够向用户显示自定义消息。但是，此方法已被弃用，并且在大多数浏览器中不再支持。</p>\n<p>为避免意外弹出窗口，除非页面已与之交互，否则浏览器可能不会显示在<code>beforeunload</code>事件中创建的提示，甚至根本不会显示它们。</p>\n<p>将事件处理程序/监听器加到<code>window</code>或 <code>document</code>的<code>beforeunload</code>事件后，将阻止浏览器使用内存中的页面导航缓存，例如<a href=\"/zh-CN/docs/Mozilla/Firefox/Releases/1.5/Using_Firefox_1.5_caching\">Firefox 的 Back-Forward 缓存</a>或<a href=\"https://webkit.org/blog/516/webkit-page-cache-ii-the-unload-event/\" class=\"external\" rel=\" noopener\">WebKit 的 Page Cache</a>。</p>\n<p>HTML 规范指出在此事件中调用<a href=\"/zh-CN/docs/Web/API/Window/alert\"><code>window.alert()</code></a>，<a href=\"/zh-CN/docs/Web/API/Window/confirm\"><code>window.confirm()</code></a>以及<a href=\"/zh-CN/docs/Web/API/Window/prompt\"><code>window.prompt()</code></a>方法，可能会失效。更多详细信息，请参见<a href=\"https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#user-prompts\" class=\"external\" rel=\" noopener\">HTML 规范</a>。</p>"}},{"type":"prose","value":{"id":"示例","title":"示例","isH3":false,"content":"<p>HTML 规范指出作者应该使用 <a href=\"/zh-CN/docs/Web/API/Event/preventDefault\"><code>Event.preventDefault()</code></a> 而非 <a href=\"/zh-CN/docs/Web/API/Event/returnValue\"><code>Event.returnValue</code></a>，然而，不是所有浏览器都支持这么做。</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'beforeunload'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Cancel the event as stated by the standard.</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Chrome requires returnValue to be set.</span>\n  event<span class=\"token punctuation\">.</span>returnValue <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"规范","id":"规范","isH3":false,"specifications":[{"bcdSpecificationURL":"https://html.spec.whatwg.org/multipage/indices.html#event-beforeunload","title":"HTML Standard"}],"query":"api.Window.beforeunload_event"}},{"type":"browser_compatibility","value":{"title":"浏览器兼容性","id":"浏览器兼容性","isH3":false,"query":"api.Window.beforeunload_event","dataURL":"/zh-CN/docs/Web/API/Window/beforeunload_event/bcd.json"}},{"type":"prose","value":{"id":"参阅","title":"参阅","isH3":false,"content":"<ul>\n  <li>相关事件：<a href=\"/zh-CN/docs/Web/API/Window/DOMContentLoaded_event\" title=\"DOMContentLoaded\"><code>DOMContentLoaded</code></a>, <a href=\"/zh-CN/docs/Web/API/Document/readystatechange_event\" title=\"readystatechange\"><code>readystatechange</code></a>, <a href=\"/zh-CN/docs/Web/API/Window/load_event\" title=\"load\"><code>load</code></a>, <a href=\"/zh-CN/docs/Web/API/Window/unload_event\" title=\"unload\"><code>unload</code></a></li>\n  <li><a href=\"https://html.spec.whatwg.org/#prompt-to-unload-a-document\" class=\"external\" rel=\" noopener\">Unloading Documents — Prompt to unload a document</a></li>\n  <li><a href=\"https://developers.google.com/web/updates/2016/04/chrome-51-deprecations?hl=en#remove_custom_messages_in_onbeforeunload_dialogs\" class=\"external\" rel=\" noopener\">Remove Custom Messages in onbeforeload Dialogs after Chrome 51</a></li>\n</ul>"}}],"toc":[{"text":"示例","id":"示例"},{"text":"规范","id":"规范"},{"text":"浏览器兼容性","id":"浏览器兼容性"},{"text":"参阅","id":"参阅"}],"summary":"当浏览器窗口关闭或者刷新时，会触发 beforeunload 事件。当前页面不会直接关闭，可以点击确定按钮关闭或刷新，也可以取消关闭或刷新。","popularity":0.0018,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Window: beforeunload event","locale":"en-US","native":"English (US)"},{"title":"beforeunload","locale":"es","native":"Español"},{"title":"beforeunload","locale":"fr","native":"Français"},{"title":"Window: beforeunload イベント","locale":"ja","native":"日本語"},{"title":"Window: beforeunload 이벤트","locale":"ko","native":"한국어"},{"title":"beforeunload","locale":"pt-BR","native":"Português (do Brasil)"},{"title":"Window: beforeunload event","locale":"ru","native":"Русский"},{"title":"Window: beforeunload event","locale":"zh-TW","native":"正體中文 (繁體)"}],"source":{"folder":"zh-cn/web/api/window/beforeunload_event","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/web/api/window/beforeunload_event/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Web","title":"Web 开发技术"},{"uri":"/zh-CN/docs/Web/API","title":"Web API 接口参考"},{"uri":"/zh-CN/docs/Web/API/Window","title":"Window"},{"uri":"/zh-CN/docs/Web/API/Window/beforeunload_event","title":"Window: beforeunload event"}],"pageTitle":"Window: beforeunload event - Web API 接口参考 | MDN","noIndexing":false}}