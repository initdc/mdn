{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Navigation Timing API","mdn_url":"/zh-CN/docs/Web/API/Navigation_timing_API","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"<ol><li><strong><a href=\"/zh-CN/docs/Web/API/Navigation_timing_API\">Navigation timing API</a></strong></li><li class=\"toggle\"><details open=\"\"><summary>指南</summary><ol><li><a href=\"/zh-CN/docs/Web/API/Navigation_timing_API/Using_Navigation_Timing\">Using Navigation Timing</a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>接口</summary><ol><li><a href=\"/zh-CN/docs/Web/API/Performance\"><code>Performance</code></a></li><li><a href=\"/zh-CN/docs/Web/API/PerformanceNavigation\"><code>PerformanceNavigation</code></a></li><li><a href=\"/zh-CN/docs/Web/API/PerformanceTiming\"><code>PerformanceTiming</code></a></li><li><a href=\"/zh-CN/docs/Web/API/PerformanceNavigationTiming\"><code>PerformanceNavigationTiming</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>属性</summary><ol><li><a href=\"/zh-CN/docs/Web/API/performance_property\"><code>performance_property</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p><strong>Navigation Timing API</strong> 提供了可用于衡量一个网站性能的数据。与用于相同目的的其他基于 JavaScript 的机制不同，该 API 可以提供可以更有用和更准确的端到端延迟数据。</p>"}},{"type":"prose","value":{"id":"concepts_and_usage","title":"Concepts and usage","isH3":false,"content":"<p>你可以使用 Navigation Timing API 在客户端收集性能数据，并用 <a href=\"/zh-CN/docs/Web/API/XMLHttpRequest\"><code>XMLHttpRequest</code></a> 或其它技术传送到服务端。同时，该 API 使你可以衡量之前难以获取的数据，如卸载前一个页面的时间，在域名解析上的时间，在执行 <code><a href=\"/en-US/docs/Web/API/Window/load_event\" title=\"Currently only available in English (US)\" class=\"only-in-en-us\">load (en-US)</a></code> 事件处理器上花费的总时间等。</p>"}},{"type":"prose","value":{"id":"interfaces","title":"Interfaces","isH3":false,"content":"<a href=\"/zh-CN/docs/Web/API/Performance\"><code>Performance</code></a>\n<p>返回一个 Performance 对象。该对象由 High Resolution Time API 定义，Navigation Timing API 在此基础上增加了两个属性：<a href=\"/zh-CN/docs/Web/API/Performance/timing\" title=\"timing\"><code>timing</code></a> 和 <a href=\"/zh-CN/docs/Web/API/Performance/navigation\" title=\"navigation\"><code>navigation</code></a></p><a href=\"/zh-CN/docs/Web/API/PerformanceNavigationTiming\"><code>PerformanceNavigationTiming</code></a>\n<p>提供了方法和属性来存取关于游览器文档 navigation 事件的相关数据。如文档实际加载/卸载的时间。</p><svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg> <a href=\"/zh-CN/docs/Web/API/PerformanceTiming\"><code>PerformanceTiming</code></a>\n<p>曾被用来获取 <a href=\"/zh-CN/docs/Web/API/Performance/timing\" title=\"timing\"><code>timing</code></a> 的值，用来衡量页面性能。</p><svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg> <a href=\"/zh-CN/docs/Web/API/PerformanceNavigation\"><code>PerformanceNavigation</code></a>\n<p>曾被用来获取 <a href=\"/zh-CN/docs/Web/API/Performance/navigation\" title=\"navigation\"><code>navigation</code></a> 的值，用来描述加载相关的操作。</p>\n<p>以下示例显示了如何测量感知加载时间：</p>\n<pre class=\"notranslate\">function onLoad() {\n  var now = new Date().getTime();\n  var page_load_time = now - performance.timing.navigationStart;\n  console.log(\"User-perceived page loading time: \" + page_load_time);\n}\n</pre>\n<p>还有很多以毫秒为单位呈现的测量事件，你可以通过 <a href=\"/zh-CN/docs/Web/API/PerformanceTiming\"><code>PerformanceTiming</code></a> 接口得到它们。按照事件发生的先后顺序，这些事件的列表如下：</p>\n<ul>\n  <li>navigationStart</li>\n  <li>unloadEventStart</li>\n  <li>unloadEventEnd</li>\n  <li>redirectStart</li>\n  <li>redirectEnd</li>\n  <li>fetchStart</li>\n  <li>domainLookupStart</li>\n  <li>domainLookupEnd</li>\n  <li>connectStart</li>\n  <li>connectEnd</li>\n  <li>secureConnectionStart</li>\n  <li>requestStart</li>\n  <li>responseStart</li>\n  <li>responseEnd</li>\n  <li>domLoading</li>\n  <li>domInteractive</li>\n  <li>domContentLoadedEventStart</li>\n  <li>domContentLoadedEventEnd</li>\n  <li>domComplete</li>\n  <li>loadEventStart</li>\n  <li>loadEventEnd</li>\n</ul>\n<p><code>window.performance.navigation</code> 对象存储了两个属性，它们表示触发页面加载的原因。这些原因可能是页面重定向、前进后退按钮或者普通的 <code>URL</code> 加载。</p>\n<p>window.performance.navigation.type：</p>\n<table>\n  <thead>\n    <tr>\n      <th>Constant</th>\n      <th>Value</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>TYPE_NAVIGATE</code></td>\n      <td>0</td>\n      <td>导航开始于点击链接、或者在用户代理中输入 URL、或者表单提交、或者通过除下表中 TYPE_RELOAD 和 TYPE_BACK_FORWARD 的脚本初始化操作。</td>\n    </tr>\n    <tr>\n      <td><code>TYPE_RELOAD</code></td>\n      <td>1</td>\n      <td>通过刷新操作或者 location.reload() 方法导航。</td>\n    </tr>\n    <tr>\n      <td><code>TYPE_BACK_FORWARD</code></td>\n      <td>2</td>\n      <td>通过历史遍历操作导航。</td>\n    </tr>\n    <tr>\n      <td><code>TYPE_UNDEFINED</code></td>\n      <td>255</td>\n      <td>其他非以上类型的导航。</td>\n    </tr>\n  </tbody>\n</table>\n<p><code>window.performance.navigation.redirectCount</code> 表示到达最终页面前，重定向的次数（如果有的话）。</p>\n<p>Navigation Timing API 可以用于收集客户端性能数据，然后通过 XHR 发送给服务端。还可以计算那些其他方法难以计算的数据，如卸载 (unload) 上一个页面的时间、域名查找时间、window.onload 的总时间等等。</p>"}},{"type":"prose","value":{"id":"示例","title":"示例","isH3":false,"content":"<p>计算页面加载所需的总时长：</p>\n<pre class=\"notranslate\">var perfData = window.performance.timing;\nvar pageLoadTime = perfData.loadEventEnd - perfData.navigationStart;\n</pre>\n<p>计算请求返回时长：</p>\n<pre class=\"notranslate\">var connectTime = perfData.responseEnd - perfData.requestStart;\n</pre>"}},{"type":"prose","value":{"id":"规范","title":"规范","isH3":false,"content":"<ul>\n  <li><a href=\"https://www.w3.org/TR/navigation-timing/\" class=\"external\" rel=\" noopener\">https://w3c.github.io/navigation-timing/</a></li>\n</ul>"}},{"type":"browser_compatibility","value":{"title":"浏览器兼容性","id":"浏览器兼容性","isH3":false,"query":"api.PerformanceTiming","dataURL":"/zh-CN/docs/Web/API/Navigation_timing_API/bcd.json"}}],"toc":[{"text":"Concepts and usage","id":"concepts_and_usage"},{"text":"Interfaces","id":"interfaces"},{"text":"示例","id":"示例"},{"text":"规范","id":"规范"},{"text":"浏览器兼容性","id":"浏览器兼容性"}],"summary":"Navigation Timing API 提供了可用于衡量一个网站性能的数据。与用于相同目的的其他基于 JavaScript 的机制不同，该 API 可以提供可以更有用和更准确的端到端延迟数据。","popularity":0.0003,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Navigation Timing API","locale":"en-US","native":"English (US)"},{"title":"Navigation Timing API","locale":"ja","native":"日本語"},{"title":"내비게이션 타이밍(Navigation Timing)","locale":"ko","native":"한국어"},{"title":"Navigation Timing","locale":"pt-BR","native":"Português (do Brasil)"},{"title":"Navigation Timing API","locale":"ru","native":"Русский"}],"source":{"folder":"zh-cn/web/api/navigation_timing_api","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/web/api/navigation_timing_api/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Web","title":"Web 开发技术"},{"uri":"/zh-CN/docs/Web/API","title":"Web API 接口参考"},{"uri":"/zh-CN/docs/Web/API/Navigation_timing_API","title":"Navigation Timing API"}],"pageTitle":"Navigation Timing API - Web API 接口参考 | MDN","noIndexing":false}}