{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"交易过程的基本概念","mdn_url":"/zh-CN/docs/Web/API/Payment_Request_API/Concepts","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"<ol><li><strong><a href=\"/zh-CN/docs/Web/API/Payment_Request_API\">Payment Request API</a></strong></li><li class=\"toggle\"><details open=\"\"><summary>指南</summary><ol><li><a href=\"/zh-CN/docs/Web/API/Payment_Request_API/Using_the_Payment_Request_API\">Using the Payment Request API</a></li><li><a href=\"/zh-CN/docs/Web/API/Payment_Request_API/Concepts\">Payment processing concepts</a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>接口</summary><ol><li><a href=\"/zh-CN/docs/Web/API/MerchantValidationEvent\"><code>MerchantValidationEvent</code></a></li><li><a href=\"/zh-CN/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a></li><li><a href=\"/zh-CN/docs/Web/API/PaymentMethodChangeEvent\"><code>PaymentMethodChangeEvent</code></a></li><li><a href=\"/zh-CN/docs/Web/API/PaymentRequest\"><code>PaymentRequest</code></a></li><li><a href=\"/zh-CN/docs/Web/API/PaymentRequestUpdateEvent\"><code>PaymentRequestUpdateEvent</code></a></li><li><a href=\"/zh-CN/docs/Web/API/PaymentResponse\"><code>PaymentResponse</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>属性</summary><ol><li><a href=\"/zh-CN/docs/Web/API/HTMLIFrameElement/allowPaymentRequest\"><code>HTMLIFrameElement.allowPaymentRequest</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div class=\"notecard secure\" id=\"sect1\"><p><strong>安全上下文:</strong> 此项功能仅在<a href=\"/zh-CN/docs/Web/Security/Secure_Contexts\">安全上下文</a>(HTTPS), 一些 <a href=\"#browser_compatibility\">支持的浏览器</a>.</p></div>\n<p><a href=\"/zh-CN/docs/Web/API/Payment_Request_API\">交易请求 API</a>使在网站或应用上进行的交易变得更便捷。在这篇文档中，我们将了解此接口如何运作，以及各个组件的功能。</p>"}},{"type":"prose","value":{"id":"术语","title":"术语","isH3":false,"content":"<p>在深入了解此 API 的工作方式前，你应该了解以下术语。</p>\n<dl>\n  <dt id=\"收款方（或商家）\">收款方（或商家）</dt>\n  <dd>\n    <p>商家可以是个人，也可以是一个组织。商家扮演的角色是在自己的网站或应用上通过支付请求 API 收款。</p>\n  </dd>\n  <dt id=\"付款方\">付款方</dt>\n  <dd>\n    <p>付款方可以是个人，也可以是一个组织。付款方扮演的角色是，在网站或应用上购买物品。支付流程要求付款方先自证身份，然后授权付款。</p>\n  </dd>\n  <dt id=\"支付方式\">支付方式</dt>\n  <dd>\n    <p>付款的方式，例如信用卡或线上支付服务。</p>\n  </dd>\n  <dt id=\"支付方式提供方\">支付方式提供方</dt>\n  <dd>\n    <p>对某种特定支付方式提供技术支持的组织。例如，使用信用卡付钱时，信用卡交易处理就是一种支付方式提供方。</p>\n  </dd>\n  <dt id=\"交易处理机\">交易处理机</dt>\n  <dd>\n    <p>一段代码，作用是与付款方式提供方交互，进行交易处理。</p>\n  </dd>\n</dl>\n<p>某些交易处理机会用到<strong>商家认证</strong>。商家认证是指以某种方式认证商家的身份，可能的方式包括密码学机制（例如公钥）。认证成功后的商家得以和交易处理机进行交互。</p>"}},{"type":"prose","value":{"id":"支付方式识别码","title":"支付方式识别码","isH3":false,"content":"<p>交易处理机是通过<strong>支付方式识别码</strong>识别的。交易方式识别码是一个指向唯一交易处理机的字符串，它可以是一套已成标准的识别码，也可以是一个 URL。后者被交易处理服务同时用于两种用途：自证身份和处理交易。</p>"}},{"type":"prose","value":{"id":"标准化的交易方式识别码","title":"标准化的交易方式识别码","isH3":true,"content":"<p>目前注册在案的只有一套<a href=\"https://www.w3.org/TR/payment-method-id/#registry\" class=\"external\" rel=\" noopener\">标准化交易方式识别码</a>。（未来可能会添加更多。）</p>\n<dl>\n  <dt id=\"基本卡（basic-card，输入一次银行卡信息后即可多次消费的支付方式）\"><code>基本卡（basic-card，输入一次银行卡信息后即可多次消费的支付方式）</code></dt>\n  <dd>\n    <p>?根据基本卡规范进行交易处理。?详细说明请参见<a class=\"page-not-created\" title=\"此文档尚未被撰写，期待你的贡献!\"><code>BasicCardRequest</code></a>。<strong><em>此处应该有对基本卡规范和使用方法进行说明的文档。</em></strong></p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"基于_url_的交易方式识别码","title":"基于 URL 的交易方式识别码","isH3":true,"content":"<p>这种识别方式的具体使用将会极大程度地依赖不同服务各自的规范。比如，某种服务可能使用多个 URL 链接，不同 URL 的使用依赖于 API 的版本和通信方式等。</p>\n<dl>\n  <dt id=\"httpsapple.comapple-pay\"><code>https://apple.com/apple-pay</code></dt>\n  <dd>\n    <p>交易使用<a href=\"https://www.apple.com/apple-pay/\" class=\"external\" rel=\" noopener\">Apple Pay</a>服务。目前，只有 Safari 浏览器支持这种交易方式。</p>\n  </dd>\n  <dt id=\"httpsgoogle.compay\"><code>https://google.com/pay</code></dt>\n  <dd>\n    <p>交易使用<a href=\"https://pay.google.com/\" class=\"external\" rel=\" noopener\">Google Pay</a>. 目前，只有 Chrome 及 Chrome 内核的浏览器支持这种交易方式。</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"交易处理机的功能","title":"交易处理机的功能","isH3":false,"content":"<p><a href=\"/zh-CN/docs/Glossary/User_agent\">user agent</a>内部机制支持不同类型的交易。另外，你还可以调用<a href=\"https://w3c.github.io/payment-handler/\" class=\"external\" rel=\" noopener\">交易处理 API</a>来支持更多相应的支付方式提供方（前提是你使用的浏览器支持这些 API 的使用）。不论使用哪种方式，交易处理机的功能都是如下几条：</p>\n<ol>\n  <li><strong>确保交易正确进行。</strong> 交易正确进行的条件取决于不同的支付类型和用户的支付请求；例如，如果用户选择了信用卡支付，而收款方并不支持这种方式，交易就无法正确进行。</li>\n  <li><strong>响应用户代理发起的对商家进行认证的请求（在处理机支持商家认证的前提下）。</strong> 详细说明请参考<a href=\"#%E5%95%86%E5%AE%B6%E8%AE%A4%E8%AF%81\">商家认证</a>。</li>\n  <li>**验证用户提交的信息有资格发起一次有效交易。**这一步骤会创建并返回一个基于具体支付方式的对象，此对象包含处理交易所需要的信息。</li>\n</ol>"}},{"type":"prose","value":{"id":"商家认证","title":"商家认证","isH3":false,"content":"<p>一些交易处理机包含<strong>商家认证</strong>步骤**。**商家认证是指，通过某种方式识别商家的身份，使用的方式通常是“密码学挑战”。没有成功通过认证的商家不被允许使用交易处理机。</p>\n<p>具体的认证方式由交易处理机决定，也完全可以省去这种认证。最终，网站或应用唯一要做的就是就是获取商家的认证密钥并传输给<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MerchantValidationEvent/complete\"><code>complete()</code> <small>(en-US)</small></a>事件的方法。</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>paymentRequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmerchantvalidation</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">complete</span><span class=\"token punctuation\">(</span><span class=\"token function\">fetchValidationData</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>validationURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>在这个例子中，由<code>fetchValidationData()</code>方法加载由<code>validationURL</code>提供的认证信息。要注意到的是，这个方法必须由商家服务器转发，因为通常情况下，客户端不会主动访问用于认证的 URL。</p>\n<p>然后，该数据（或用来解析该数据的<a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a>）被传送给交易处理机的<code>complete()</code>方法。交易处理机可以用该数据获取更多信息或是进行更多重的算法解析，以认证商家对处理机的使用权。</p>\n<p>因此，注意到如下事实很重要：<a href=\"/zh-CN/docs/Glossary/User_agent\">user agent</a>永远不会发送<code><a href=\"/zh-CN/docs/Web/Reference/Events/merchantvalidation\" title=\"This is a link to an unwritten page\" class=\"page-not-created\">merchantvalidation</a></code>事件，除非用户代理自身装载了交易处理机。例如，Safari 浏览器本身即支持 Apple Pay，而 Apple Pay 的交易处理机可据此向客户端发送<code>merchantvalidation</code>、指示客户端获取服务器上的认证信息，并将其传送给交易处理机的<code>complete()</code>，来为商品进行支付。</p>"}},{"type":"specifications","value":{"title":"规范","id":"规范","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/payment-request/","title":"Payment Request API"},{"bcdSpecificationURL":"https://w3c.github.io/payment-method-id/","title":"Payment Method Identifiers"}],"query":"undefined"}},{"type":"prose","value":{"id":"相关文档","title":"相关文档","isH3":false,"content":"<ul>\n  <li><a href=\"/zh-CN/docs/Web/API/Payment_Request_API\">支付请求 API</a></li>\n  <li><a href=\"/en-US/docs/Web/API/Payment_Request_API/Using_the_Payment_Request_API\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Using the Payment Request API (en-US)</a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/Payment_Request_API/Concepts\" aria-current=\"page\">Payment processing concepts</a></li>\n  <li><a href=\"https://webkit.org/blog/8182/introducing-the-payment-request-api-for-apple-pay/\" class=\"external\" rel=\" noopener\">Introducing the Payment Request API for Apple Pay</a></li>\n  <li><a href=\"https://developers.google.com/pay/api/web/guides/paymentrequest/tutorial\" class=\"external\" rel=\" noopener\">Google Pay API PaymentRequest Tutorial</a></li>\n</ul>"}}],"toc":[{"text":"术语","id":"术语"},{"text":"支付方式识别码","id":"支付方式识别码"},{"text":"交易处理机的功能","id":"交易处理机的功能"},{"text":"商家认证","id":"商家认证"},{"text":"规范","id":"规范"},{"text":"相关文档","id":"相关文档"}],"summary":"交易请求 API使在网站或应用上进行的交易变得更便捷。在这篇文档中，我们将了解此接口如何运作，以及各个组件的功能。","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Payment processing concepts","locale":"en-US","native":"English (US)"}],"source":{"folder":"zh-cn/web/api/payment_request_api/concepts","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/web/api/payment_request_api/concepts/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Web","title":"Web 开发技术"},{"uri":"/zh-CN/docs/Web/API","title":"Web API 接口参考"},{"uri":"/zh-CN/docs/Web/API/Payment_Request_API","title":"支付请求接口"},{"uri":"/zh-CN/docs/Web/API/Payment_Request_API/Concepts","title":"交易过程的基本概念"}],"pageTitle":"交易过程的基本概念 - Web API 接口参考 | MDN","noIndexing":false}}