{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"结构化克隆算法","mdn_url":"/zh-CN/docs/Web/API/Web_Workers_API/Structured_clone_algorithm","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>结构化克隆算法是<a href=\"https://www.w3.org/html/wg/drafts/html/master/infrastructure.html#safe-passing-of-structured-data\" class=\"external\" rel=\" noopener\">由 HTML5 规范定义</a>的用于复制复杂 JavaScript 对象的算法。通过来自 <a href=\"/zh-CN/docs/Web/API/Worker\">Workers</a>的 <code>postMessage()</code> 或使用 <a href=\"/zh-CN/docs/Glossary/IndexedDB\">IndexedDB</a> 存储对象时在内部使用。它通过递归输入对象来构建克隆，同时保持先前访问过的引用的映射，以避免无限遍历循环。</p>"}},{"type":"prose","value":{"id":"结构化克隆所不能做到的","title":"结构化克隆所不能做到的","isH3":false,"content":"<ul>\n  <li><a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Error\"><code>Error</code></a> 以及 <a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function\"><code>Function</code></a> 对象是不能被结构化克隆算法复制的；如果你尝试这样子去做，这会导致抛出 <code>DATA_CLONE_ERR</code> 的异常。</li>\n  <li>企图去克隆 DOM 节点同样会抛出 <code>DATA_CLONE_ERR</code> 异常。</li>\n  <li>对象的某些特定参数也不会被保留\n    <ul>\n      <li><code>RegExp</code> 对象的 <code>lastIndex</code> 字段不会被保留</li>\n      <li>属性描述符，setters 以及 getters（以及其他类似元数据的功能）同样不会被复制。例如，如果一个对象用属性描述符标记为 read-only，它将会被复制为 read-write，因为这是默认的情况下。</li>\n      <li>原形链上的属性也不会被追踪以及复制。</li>\n    </ul>\n  </li>\n</ul>"}},{"type":"prose","value":{"id":"支持的类型","title":"支持的类型","isH3":false,"content":"<table>\n  <thead>\n    <tr>\n      <th>对象类型</th>\n      <th>注意</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/JavaScript/Data_structures#%E5%8E%9F%E5%A7%8B%E5%80%BC\">所有的原始类型</a></td>\n      <td>symbols 除外</td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Boolean\">Boolean</a> 对象</td>\n      <td></td>\n    </tr>\n    <tr>\n      <td>String 对象</td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date\">Date</a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp\">RegExp</a></td>\n      <td><code>lastIndex</code> 字段不会被保留。</td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/API/Blob\"><code>Blob</code></a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/API/File\"><code>File</code></a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/API/FileList\"><code>FileList</code></a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\">ArrayBuffer</a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/TypedArray\">ArrayBufferView</a></td>\n      <td>这基本上意味着所有的 <a href=\"/zh-CN/docs/Web/JavaScript/Typed_arrays\">类型化数组</a> ，如 Int32Array 等。</td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/API/ImageData\"><code>ImageData</code></a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array\">Array</a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object\">Object</a></td>\n      <td>仅包括普通对象（如对象字面量）</td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Map\">Map</a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Set\">Set</a></td>\n      <td></td>\n    </tr>\n  </tbody>\n</table>"}},{"type":"prose","value":{"id":"相关链接","title":"相关链接","isH3":false,"content":"<ul>\n  <li><a href=\"https://www.w3.org/TR/html5/infrastructure.html#safe-passing-of-structured-data\" class=\"external\" rel=\" noopener\">HTML5 Specification: Safe passing of structured data</a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/Window/history\"><code>window.history</code></a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/Window/postMessage\"><code>window.postMessage()</code></a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/Web_Workers_API\">Web Workers</a></li>\n  <li><a href=\"/zh-CN/docs/Web/API/IndexedDB_API\">IndexedDB</a></li>\n  <li><a href=\"/zh-CN/docs/Components.utils.cloneInto\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Components.utils.cloneInto</a></li>\n</ul>"}}],"toc":[{"text":"结构化克隆所不能做到的","id":"结构化克隆所不能做到的"},{"text":"支持的类型","id":"支持的类型"},{"text":"相关链接","id":"相关链接"}],"summary":"结构化克隆算法是由 HTML5 规范定义的用于复制复杂 JavaScript 对象的算法。通过来自 Workers的 postMessage() 或使用 IndexedDB 存储对象时在内部使用。它通过递归输入对象来构建克隆，同时保持先前访问过的引用的映射，以避免无限遍历循环。","popularity":0.0003,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"The structured clone algorithm","locale":"en-US","native":"English (US)"},{"title":"L’algorithme de clonage structuré","locale":"fr","native":"Français"},{"title":"構造化複製アルゴリズム","locale":"ja","native":"日本語"},{"title":"The structured clone algorithm","locale":"ko","native":"한국어"},{"title":"Алгоритм структурированного клонирования","locale":"ru","native":"Русский"}],"source":{"folder":"zh-cn/web/api/web_workers_api/structured_clone_algorithm","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/web/api/web_workers_api/structured_clone_algorithm/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Web","title":"Web 开发技术"},{"uri":"/zh-CN/docs/Web/API","title":"Web API 接口参考"},{"uri":"/zh-CN/docs/Web/API/Web_Workers_API","title":"Web Workers API"},{"uri":"/zh-CN/docs/Web/API/Web_Workers_API/Structured_clone_algorithm","title":"结构化克隆算法"}],"pageTitle":"结构化克隆算法 - Web API 接口参考 | MDN","noIndexing":false}}