{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"实现一个设置页面","mdn_url":"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"\n  <ol>\n    <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions\"><strong>浏览器扩展程序</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>开始</summary>\n        <ol>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\">什么是扩展程序?</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\">你的第一个扩展程序</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\">你的第二个扩展程序</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\">详解扩展程序</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Examples\">扩展程序示例</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/What_next_\">接下来呢?</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>概念</summary>\n        <ol>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\">使用 JavaScript APIs</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\">Content scripts</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">匹配样式</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\">处理文件</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Internationalization\">国际化</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\">内容安全举措</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\">本地消息</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\">API实现之间的差异</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\">Chrome不兼容</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>用户界面</summary>\n        <ol>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface\">用户界面</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\">工具栏按钮</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\">地址栏按钮</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\">侧边栏</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\">上下文菜单项</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\">选项页面</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\">扩展页面</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\">通知</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\">地址栏建议</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\">开发人员工具面板</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>怎么做</summary>\n        <ol>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\">拦截HTTP 请求</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\">修改网页</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\">插入外部内容</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">Share objects with page scripts</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\">向工具栏添加按钮</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\">应用设置页面</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\">使用Tabs API</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\">使用Bookmarks API</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\">使用Cookies API</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\">使用上下文身份</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard\">Interact with the clipboard</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\">构建跨浏览器扩展</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\">Firefox的优势</a></summary>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>JavaScript APIs</summary>\n        <ol><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\">Browser support for JavaScript APIs</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/alarms\">alarms</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks\">bookmarks</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/browserAction\">browserAction</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/captivePortal\">captivePortal</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/clipboard\">clipboard</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts\">contentScripts</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/cookies\">cookies</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/downloads\">downloads</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/find\">find</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/history\">history</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/i18n\">i18n</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/idle\">idle</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/menus\">menus</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/permissions\">permissions</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/proxy\">proxy</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime\">runtime</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/search\">search</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/sessions\">sessions</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/storage\">storage</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/tabs\">tabs</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/types\">types</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation\">webNavigation</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\">webRequest</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/windows\">windows</a></li></ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n      <summary>Manifest keys</summary>\n        <ol>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json\">介绍</a></li>\n        </ol>\n      <ol><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\">applications</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action\">browser_action</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\">content_scripts</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale\">default_locale</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer\">developer</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url\">homepage_url</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version\">manifest_version</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version\">version</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources\">web_accessible_resources</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author\">作者 - author</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name\">名称 - name</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background\">后台 - background</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description\">描述 - description</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\">权限 - permissions</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name\">短名称 - short_name</a></li></ol>\n      </details>\n    </li>\n     <li class=\"toggle\">\n      <details>\n        <summary>Extension Workshop</summary>\n        <ol>\n          <li><a href=\"https://extensionworkshop.com/documentation/develop/\">Develop</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/publish/\">Publish</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/manage/\">Manage</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/enterprise/\">Enterprise</a></li>\n        </ol>\n      </details>\n    </li>\n    <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/Contact_us\"><strong>联系我们</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>渠道</summary>\n        <ol>\n          <li><a href=\"https://blog.mozilla.org/addons\">Add-ons博客</a></li>\n          <li><a href=\"https://discourse.mozilla.org/c/add-ons\">Add-ons论坛</a></li>\n          <li><a href=\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\">Add-ons chat</a></li>\n        </ol>\n      </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>设置页面可以让用户查看，修改扩展的一些设置。</p>\n<p>对于 WebExtensions，设置通常使用 <a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/storage\"><code>storage</code></a> API 保存。实现一个设置页面通常包含以下三步：</p>\n<ul>\n  <li>制作一个 HTML 文件用以显示并修改设置</li>\n  <li>写一个包含于该 HTML 文件的脚本，其可以使设置页面存储与存储设备中并在用户修改后更新他。</li>\n  <li>在 manifest.json 文件 <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">options_ui (en-US)</a> 关键字中 设置 HTML 文件的路径。通过这种方式，该 HTML 将会被显示浏览器管理器里该插件名字和描述的旁边。</li>\n</ul>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>备注：</strong> 你也可以使用 <a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime/openOptionsPage\"><code>runtime.openOptionsPage()</code></a> 打开该页面。</p>\n</div>"}},{"type":"prose","value":{"id":"简单的_webextension","title":"简单的 WebExtension","isH3":false,"content":"<p>首先，我们写一个向用户访问的所有页面添加一个蓝色边框的扩展。</p>\n<p>创建一个新的文件夹命名为“setting”，然后创建文件“manifest.json”它包含以下内容：</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n\n  <span class=\"token property\">\"manifest_version\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Settings example\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0\"</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"content_scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"matches\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"&lt;all_urls&gt;\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"js\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"borderify.js\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>该扩展指示浏览器在用户访问的网站上加载一个名为\"borderify.js“的 Content Script。</p>\n<p>接下来，在\"setting\"目录下创建\"borderify.js\"，然后给予他以下内容：</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>border <span class=\"token operator\">=</span> <span class=\"token string\">\"10px solid blue\"</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>这只是向网页加入了一一个蓝色边框</p>\n<p>现在 <a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Temporary_Installation_in_Firefox\">安装该扩展</a> 并测试它——打开任意一个网页：</p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/E-WUhihF8fw\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\" loading=\"lazy\"></iframe>"}},{"type":"prose","value":{"id":"添加设置页面","title":"添加设置页面","isH3":false,"content":"<p>现在让我们创建一个设置页面来允许用户设置边框的颜色。</p>\n<p>首先更新 \"manifest.json\" 使他拥有如下内容：</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n\n  <span class=\"token property\">\"manifest_version\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Settings example\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0\"</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"content_scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"matches\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"&lt;all_urls&gt;\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"js\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"borderify.js\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"options_ui\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"page\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"options.html\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"permissions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"storage\"</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>我们加入了两个 manifest 关键字：</p>\n<ul>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">options_ui (en-US)</a>: 设置了一个 HTML 来作为设置页面。</li>\n  <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\"><code>permissions</code></a>: 我们使用 <a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/storage\"><code>storage</code></a> API 来保存设置，所以我们需要请求权限来使用该 API。</li>\n</ul>\n<p>接下来，因为我们承诺提供\"options.html\"，让我们来创建他，在\"setting\"目录创建一个该文件并具有以下内容：</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span><span class=\"token punctuation\">&gt;</span></span>Border color<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>color<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Save<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>options.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>这里定义了一个带有标记文字<a href=\"/zh-CN/docs/Web/HTML/Element/Input\"><code>&lt;input&gt;</code></a>的 <a href=\"/zh-CN/docs/Web/HTML/Element/form\"><code>&lt;form&gt;</code></a> 和一个 提交 <a href=\"/zh-CN/docs/Web/HTML/Element/button\"><code>&lt;button&gt;</code></a>. 也包含了一个名为\"options.js\"的脚本。</p>\n<p>仍然在\"settting\"目录下创建 \"options.js\"，并给予他以下内容：</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">saveOptions</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  e<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  browser<span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span>local<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#color\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">restoreOptions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">setCurrentChoice</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#color\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>color <span class=\"token operator\">||</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">onError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Error: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>error<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">var</span> getting <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span>local<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"color\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  getting<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>setCurrentChoice<span class=\"token punctuation\">,</span> onError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"DOMContentLoaded\"</span><span class=\"token punctuation\">,</span> restoreOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"form\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"submit\"</span><span class=\"token punctuation\">,</span> saveOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>它做了两件事：</p>\n<ul>\n  <li>当网页被加载它使用<a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage/StorageArea/get\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">storage.local.get() (en-US)</a> 从存贮设备中获取了名为\"color”的值。如果该值未被设置其为默认值 blue。</li>\n  <li>当用户点击提交按钮，使用<a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage/StorageArea/set\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">storage.local.set() (en-US)</a> 存贮颜色值。</li>\n</ul>\n<p>最后，更新\"borderify.js\" 来读取边框颜色：</p>\n<div class=\"notecard warning\" id=\"sect2\">\n  <p><strong>警告：</strong> 因为 <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage/StorageArea/get\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">browser.storage.local.get() (en-US)</a> 在火狐 52 版本之前的一个漏洞 ,以下代码没法起作用。为了使它生效，<code>onGot()</code> 中的 <code>item.color</code> 必须改为 <code>item[0].color</code>。</p>\n</div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code> <span class=\"token keyword\">function</span> <span class=\"token function\">onError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Error: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>error<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">onGot</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> color <span class=\"token operator\">=</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    color <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>border <span class=\"token operator\">=</span> <span class=\"token string\">\"10px solid \"</span> <span class=\"token operator\">+</span> color<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> getting <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span>local<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"color\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngetting<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>onGot<span class=\"token punctuation\">,</span> onError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>最后，完整的扩展看起来是这样：</p>\n<pre class=\"notranslate\">settings/\n    borderify.js\n    manifest.json\n    options.html\n    options.js\n</pre>\n<p>现在：</p>\n<ul>\n  <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Temporary_Installation_in_Firefox#reloading_a_temporary_add-on\">重新载入扩展</a></li>\n  <li>加载一个网页</li>\n  <li>打开设置页面并修改边框颜色</li>\n  <li>重载网页查看变化。</li>\n</ul>\n<p>在火狐中你可以通过访问\"about:addons\"点击扩展旁边的\"Preferences\"按钮访问设置页面。</p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/ECt9cbWh1qs\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\" loading=\"lazy\"></iframe>"}},{"type":"prose","value":{"id":"进一步了解","title":"进一步了解","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">options_ui (en-US)</a> 关键字文档</li>\n  <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/storage\"><code>storage</code></a> API 文档</li>\n  <li>使用<a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime/openOptionsPage\"><code>runtime.openOptionsPage()</code></a> 直接打开你的设置页面</li>\n  <li>另一个设置页面例子：\n    <ul>\n      <li><a href=\"https://github.com/mdn/webextensions-examples/tree/master/favourite-colour\" class=\"external\" rel=\" noopener\">favourite-colour</a></li>\n    </ul>\n  </li>\n</ul>"}}],"toc":[{"text":"简单的 WebExtension","id":"简单的_webextension"},{"text":"添加设置页面","id":"添加设置页面"},{"text":"进一步了解","id":"进一步了解"}],"summary":"设置页面可以让用户查看，修改扩展的一些设置。","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Implement a settings page","locale":"en-US","native":"English (US)"},{"title":"Implementar una página de configuración","locale":"es","native":"Español"},{"title":"Ajouter une page de paramètres","locale":"fr","native":"Français"},{"title":"設定ページを実装する","locale":"ja","native":"日本語"}],"source":{"folder":"zh-cn/mozilla/add-ons/webextensions/implement_a_settings_page","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/mozilla/add-ons/webextensions/implement_a_settings_page/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Mozilla","title":"Mozilla"},{"uri":"/zh-CN/docs/Mozilla/Add-ons","title":"附加组件"},{"uri":"/zh-CN/docs/Mozilla/Add-ons/WebExtensions","title":"浏览器扩展"},{"uri":"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page","title":"实现一个设置页面"}],"pageTitle":"实现一个设置页面 - Mozilla | MDN","noIndexing":false}}