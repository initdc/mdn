{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"原生应用清单","mdn_url":"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Native_manifests","locale":"zh-CN","native":"中文 (简体)","sidebarHTML":"\n  <ol>\n    <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions\"><strong>浏览器扩展程序</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>开始</summary>\n        <ol>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\">什么是扩展程序?</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\">你的第一个扩展程序</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\">你的第二个扩展程序</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\">详解扩展程序</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Examples\">扩展程序示例</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/What_next_\">接下来呢?</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>概念</summary>\n        <ol>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\">使用 JavaScript APIs</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\">Content scripts</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">匹配样式</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\">处理文件</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Internationalization\">国际化</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\">内容安全举措</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\">本地消息</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\">API实现之间的差异</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\">Chrome不兼容</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>用户界面</summary>\n        <ol>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface\">用户界面</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\">工具栏按钮</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\">地址栏按钮</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\">侧边栏</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\">上下文菜单项</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\">选项页面</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\">扩展页面</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\">通知</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\">地址栏建议</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\">开发人员工具面板</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>怎么做</summary>\n        <ol>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\">拦截HTTP 请求</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\">修改网页</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\">插入外部内容</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">Share objects with page scripts</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\">向工具栏添加按钮</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\">应用设置页面</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\">使用Tabs API</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\">使用Bookmarks API</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\">使用Cookies API</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\">使用上下文身份</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard\">Interact with the clipboard</a></li>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\">构建跨浏览器扩展</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\">Firefox的优势</a></summary>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>JavaScript APIs</summary>\n        <ol><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\">Browser support for JavaScript APIs</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/alarms\">alarms</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks\">bookmarks</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/browserAction\">browserAction</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/captivePortal\">captivePortal</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/clipboard\">clipboard</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts\">contentScripts</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/cookies\">cookies</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/downloads\">downloads</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/find\">find</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/history\">history</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/i18n\">i18n</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/idle\">idle</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/menus\">menus</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/permissions\">permissions</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/proxy\">proxy</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime\">runtime</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/search\">search</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/sessions\">sessions</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/storage\">storage</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/tabs\">tabs</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/types\">types</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation\">webNavigation</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\">webRequest</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/windows\">windows</a></li></ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n      <summary>Manifest keys</summary>\n        <ol>\n          <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json\">介绍</a></li>\n        </ol>\n      <ol><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\">applications</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action\">browser_action</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\">content_scripts</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale\">default_locale</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer\">developer</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url\">homepage_url</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version\">manifest_version</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version\">version</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources\">web_accessible_resources</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author\">作者 - author</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name\">名称 - name</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background\">后台 - background</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description\">描述 - description</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\">权限 - permissions</a></li><li><a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name\">短名称 - short_name</a></li></ol>\n      </details>\n    </li>\n     <li class=\"toggle\">\n      <details>\n        <summary>Extension Workshop</summary>\n        <ol>\n          <li><a href=\"https://extensionworkshop.com/documentation/develop/\">Develop</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/publish/\">Publish</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/manage/\">Manage</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/enterprise/\">Enterprise</a></li>\n        </ol>\n      </details>\n    </li>\n    <li><a href=\"/zh-CN/docs/Mozilla/Add-ons/Contact_us\"><strong>联系我们</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>渠道</summary>\n        <ol>\n          <li><a href=\"https://blog.mozilla.org/addons\">Add-ons博客</a></li>\n          <li><a href=\"https://discourse.mozilla.org/c/add-ons\">Add-ons论坛</a></li>\n          <li><a href=\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\">Add-ons chat</a></li>\n        </ol>\n      </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>原生应用清单是一个符合特定规则的 JSON 文件，它应该使用与 extension 不同的安装方式存放在用户的计算机上。举个例子，原生应用清单是由设备管理员或者通过原生应用安装器提供的。</p>\n<p>有三种不同的原生应用清单：</p>\n<table class=\"standard-table\">\n  <tbody>\n    <tr>\n      <td><a href=\"#原生应用通信清单\">原生应用通信清单</a></td>\n      <td>\n        <p>定义关于<a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\">与本地应用通信</a>的功能：哪一个 extension 可以与本机的原生应用交换信息。</p>\n      </td>\n    </tr>\n    <tr>\n      <td><a href=\"#存储管理清单\">存储管理清单</a></td>\n      <td>\n        <p>\n          定义一些 extension 可以用\n          <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage/managed\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">storage.managed (en-US)</a> 读取的只读数据。\n        </p>\n      </td>\n    </tr>\n    <tr>\n      <td><a href=\"#pkcs #11 清单\">PKCS #11 清单</a></td>\n      <td>\n        <p>\n          定义了 extension 使用 <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">pkcs11 (en-US)</a> API 去枚举\n          PKCS #11 安全模型 并在 Firefox 安装它们。\n        </p>\n      </td>\n    </tr>\n  </tbody>\n</table>\n<p>对于所有的原生应用清单，你需要做一些工作以便于浏览器可以找到它们。这些规则在 <a href=\"#%E6%B8%85%E5%8D%95%E8%B7%AF%E5%BE%84\">清单路径</a> 章节。</p>"}},{"type":"prose","value":{"id":"原生应用通信清单","title":"原生应用通信清单","isH3":false,"content":"<p>原生应用通信清单中包含单个 JSON 对象，对象具有如下属性：</p>\n<table class=\"fullwidth-table standard-table\">\n  <thead>\n    <tr>\n      <th scope=\"col\">Name</th>\n      <th scope=\"col\">Type</th>\n      <th scope=\"col\">Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>name</code></td>\n      <td>String</td>\n      <td>\n        <p>原生应用的名字</p>\n        <p>\n          它必须与 extension 调用\n          <a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime/connectNative\"><code>runtime.connectNative()</code></a> 和\n          <a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendNativeMessage\"><code>runtime.sendNativeMessage()</code></a>\n          时传入的名称保持一致。\n        </p>\n        <p>\n          在 OS X 和 Linux 中，它必须和清单文件的文件名保持一致（除.json\n          文件扩展名外）。\n        </p>\n        <p>在 Windows 中，它必须和你创建的包含原生应用清单路径的注册表一致。</p>\n        <p>\n          它必须符合正则表达式\n          \"^\\w+(\\.\\w+)*$\"。这意味着它只能包含小写字母、数字、下划线和\n          <code>.</code> ，并且不允许开头或结束是 <code>.</code> ，并且\n          <code>.</code> 后面不能是 <code>.</code> 。\n        </p>\n      </td>\n    </tr>\n    <tr>\n      <td><code>description</code></td>\n      <td>String</td>\n      <td>\n        <p>关于这个原生应用的描述。</p>\n      </td>\n    </tr>\n    <tr>\n      <td><code>path</code></td>\n      <td>String</td>\n      <td>\n        <p>到原生应用的路径。</p>\n        <p>\n          在 Windows 中，这可以是一个相对路径。在 OS X 和 Linux\n          中，必须是绝对路径。\n        </p>\n      </td>\n    </tr>\n    <tr>\n      <td><code>type</code></td>\n      <td>String</td>\n      <td>\n        <p>定义 extension 和原生应用的连接方法。</p>\n        <p>\n          目前只支持一种值，那就是\n          stdio。该值表示应用使用标准输入（stdin）来接受消息，用标准输出（stdout）来发送消息。\n        </p>\n      </td>\n    </tr>\n    <tr>\n      <td><code>allowed_extensions</code></td>\n      <td>Array of String</td>\n      <td>\n        <p>\n          由\n          <a href=\"https://extensionworkshop.com/documentation/develop/extensions-and-the-add-on-id/\" class=\"external\" rel=\" noopener\">Add-on ID</a>\n          组成的数组。每个值代表允许 ID 为该值的 extension 与这个原生应用通信。\n        </p>\n        <div class=\"note notecard\" id=\"sect1\">\n          <p>\n            这意味着你可能需要在你 extension 的 manifest.json 中包含\n            <a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\">applications</a>\n            字段，并为 extension 设置一个显示的 ID，哪怕是在开发时\n          </p>\n        </div>\n      </td>\n    </tr>\n  </tbody>\n</table>\n<p>举个例子，这是 ping_pong 原生应用的原生应用通信清单：</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ping_pong\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Example host for native messaging\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"path\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/path/to/native-messaging/app/ping_pong.py\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"stdio\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"allowed_extensions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"ping_pong@example.org\"</span> <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>清单表示：它允许 ID 为 ping_pong@example.org 的 extension 通过传入 ping_pong 给 <a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime\"><code>runtime</code></a> 与自己连接。原生应用自身在 /path/to/native-messaging/app/ping_pong.py 中。</p>"}},{"type":"prose","value":{"id":"存储管理清单","title":"存储管理清单","isH3":false,"content":"<p>存储管理清单中包含单个 JSON 对象，对象具有如下属性：</p>\n<table class=\"fullwidth-table standard-table\">\n  <thead>\n    <tr>\n      <th scope=\"col\">Name</th>\n      <th scope=\"col\">Type</th>\n      <th scope=\"col\">Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>name</code></td>\n      <td>String</td>\n      <td>\n        <p>\n          <strong>一个</strong> extension 的 ID，表示这个 extension\n          可以读取这个仓库。\n        </p>\n        <p>\n          给出这个 ID 需要你的 extension 的 manifest.json 文件包含\n          <a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\">applications</a>\n          字段。\n        </p>\n      </td>\n    </tr>\n    <tr>\n      <td><code>description</code></td>\n      <td>String</td>\n      <td>\n        <p>人类可读的描述，Firefox 会忽略它。</p>\n      </td>\n    </tr>\n    <tr>\n      <td><code>type</code></td>\n      <td>String</td>\n      <td>\n        <p>该值只能是<code>storage</code>。</p>\n      </td>\n    </tr>\n    <tr>\n      <td><code>data</code></td>\n      <td>Object</td>\n      <td>\n        <p>\n          一个 JSON 对象，其中可以包含任何合法的 JSON\n          值（string、number、boolean、array、object），他们将成为<code>browser.storage.managed</code>可访问的数据。\n        </p>\n      </td>\n    </tr>\n  </tbody>\n</table>\n<p>举个例子：</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"favourite-colour-examples@mozilla.org\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ignored\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"storage\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"data\"</span><span class=\"token operator\">:</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"colour\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"management thinks it should be blue!\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>在给出的清单文件中，ID 为 favourite-colour-examples@mozilla.org 的 extension 有权限使用清单中的 data 字段中的数据，代码如下：</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> storageItem <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>storage<span class=\"token punctuation\">.</span>managed<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'colour'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nstorageItem<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Managed colour is: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>res<span class=\"token punctuation\">.</span>colour<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"pkcs_11_清单","title":"PKCS #11 清单","isH3":false,"content":"<p>PKCS #11 清单中包含单个 JSON 对象，对象具有如下属性：</p>\n<table class=\"fullwidth-table standard-table\">\n  <thead>\n    <tr>\n      <th scope=\"col\">Name</th>\n      <th scope=\"col\">Type</th>\n      <th scope=\"col\">Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>name</code></td>\n      <td>String</td>\n      <td>\n        <p>PKCS #11 模块的名字。</p>\n        <p>它必须和你使用 <code>pkcs11</code> API 时的名字一致。</p>\n        <p>\n          在 OS X 和 Linux\n          中，它必须和清单文件的文件名保持一致（除文件扩展名外）\n        </p>\n        <p>在 Windows 中，它必须和你创建的包含原生应用清单路径的注册表一致。</p>\n        <p>\n          它必须符合正则表达式\n          \"^\\w+(\\.\\w+)*$\"。这意味着它只能包含小写字母、数字、下划线和\n          <code>.</code> ，并且不允许开头或结束是 <code>.</code> ，并且\n          <code>.</code> 后面不能是 <code>.</code> 。\n        </p>\n      </td>\n    </tr>\n    <tr>\n      <td><code>description</code></td>\n      <td>String</td>\n      <td>\n        <p>关于该模块的描述。</p>\n        <p>\n          它将被用在浏览器界面中为模块设置一个友好的名字（比如，在 Firefox\n          的“安全设备”对话框中）\n        </p>\n      </td>\n    </tr>\n    <tr>\n      <td><code>path</code></td>\n      <td>String</td>\n      <td>\n        <p>到模块的路径。</p>\n        <p>\n          在 Windows 中，这可以是一个相对路径。在 OS X 和 Linux\n          中，必须是绝对路径。\n        </p>\n      </td>\n    </tr>\n    <tr>\n      <td><code>type</code></td>\n      <td>String</td>\n      <td>该值只能是<code>pkcs11</code>。This must be \"pkcs11\".</td>\n    </tr>\n    <tr>\n      <td><code>allowed_extensions</code></td>\n      <td>Array of String</td>\n      <td>\n        <p>\n          由\n          <a href=\"https://extensionworkshop.com/documentation/develop/extensions-and-the-add-on-id/\" class=\"external\" rel=\" noopener\">Add-on ID</a>\n          组成的数组。每个值代表允许 ID 为该值的 extension 与这个模块通信。\n        </p>\n        <div class=\"note notecard\" id=\"sect2\">\n          <p>\n            这意味着你可能需要在你 extension 的 manifest.json 中包含\n            <a href=\"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\">applications</a>\n            字段，并为 extension 设置一个显示的 ID，哪怕是在开发时\n          </p>\n        </div>\n      </td>\n    </tr>\n  </tbody>\n</table>\n<p>举个例子：</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my_module\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"My test module\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pkcs11\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"path\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/path/to/libpkcs11testmodule.dylib\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"allowed_extensions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"my-extension@mozilla.org\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>给出的这个 JSON 清单，保存为 my_module.json，ID 为 my-extension@mozilla.org 的 extension 就能够使用类似于如下代码安装 /path/to/libpkcs11testmodule.dylib 安全模块：</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>browser<span class=\"token punctuation\">.</span>pkcs11<span class=\"token punctuation\">.</span><span class=\"token function\">installModule</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"my_module\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"清单路径","title":"清单路径","isH3":false,"content":"<p>在 Linux 和 Mac OS X 中，你需要将清单文件存在特定的位置。在 Windows 中，你需要创建一个注册表来指向清单文件。</p>\n<p>所有类型的清单的详细规则都是相同的，除了倒数第二个的 type 字段表示了清单的类型。下面的例子展示了三种不同类型的清单。在例子中，&lt;name&gt; 代表清单中的 name 字段值。</p>"}},{"type":"prose","value":{"id":"windows","title":"Windows","isH3":true,"content":"<p>如果想要全局可见，使用下面的路径创建注册表：</p>\n<div class=\"code-example\"><pre class=\"brush: plain notranslate\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Mozilla\\NativeMessagingHosts\\&lt;name&gt;\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Mozilla\\ManagedStorage\\&lt;name&gt;\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Mozilla\\PKCS11Modules\\&lt;name&gt;\n</pre></div>\n<p>注册表应该有单个默认值，值里存放“到清单文件的路径”。比如为原生应用通信清单建立的注册表差不多是这样：</p>\n<p>\n  <img src=\"https://mdn.mozillademos.org/files/15643/native-message-regkey-exaple.png\" alt=\"为原生应用通信清单建立的注册表\" loading=\"lazy\">\n</p>\n<div class=\"notecard note\" id=\"sect3\">\n  <p><strong>备注：</strong> 对于原生应用清单，即使原生应用是 32 位的，也不能在 <a href=\"https://en.wikipedia.org/wiki/WoW64#Registry_and_file_system\" class=\"external\" rel=\" noopener\">Wow6432Node</a> 下创建注册表。浏览器将总会在 native 视图下寻找注册表的，而不是 32 位放在环境。确保注册表的创建在原生视图中，你可以键入 KEY_WOW64_64KEY 或 KEY_WOW64_32KEY 到 RegCreateKeyEx。请参考：<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384129(v=vs.85).aspx\" class=\"external\" rel=\" noopener\">Accessing an Alternate Registry View</a></p>\n</div>\n<p>如果想要用户级别的可见，使用下面的路径创建注册表：</p>\n<div class=\"code-example\"><pre class=\"brush: plain notranslate\">HKEY_CURRENT_USER\\SOFTWARE\\Mozilla\\NativeMessagingHosts\\&lt;name&gt;\n\nHKEY_CURRENT_USER\\SOFTWARE\\Mozilla\\ManagedStorage\\&lt;name&gt;\n\nHKEY_CURRENT_USER\\SOFTWARE\\Mozilla\\PKCS11Modules\\&lt;name&gt;\n</pre></div>\n<p>注册表应该有单个默认值，值里存放“到清单文件的路径”。</p>"}},{"type":"prose","value":{"id":"mac_os_x","title":"Mac OS X","isH3":true,"content":"<p>如果想要全局可见，将清单文件存放在：</p>\n<div class=\"code-example\"><pre class=\"brush: plain notranslate\">/Library/Application Support/Mozilla/NativeMessagingHosts/&lt;name&gt;.json\n\n/Library/Application Support/Mozilla/ManagedStorage/&lt;name&gt;.json\n\n/Library/Application Support/Mozilla/PKCS11Modules/&lt;name&gt;.json\n</pre></div>\n<p>如果想要用户级别的可见，将清单文件存放在：</p>\n<div class=\"code-example\"><pre class=\"brush: plain notranslate\">~/Library/Application Support/Mozilla/NativeMessagingHosts/&lt;name&gt;.json\n\n~/Library/Application Support/Mozilla/ManagedStorage/&lt;name&gt;.json\n\n~/Library/Application Support/Mozilla/PKCS11Modules/&lt;name&gt;.json\n</pre></div>"}},{"type":"prose","value":{"id":"linux","title":"Linux","isH3":true,"content":"<p>如果想要全局可见，将清单文件存放在：</p>\n<div class=\"code-example\"><pre class=\"brush: plain notranslate\">/usr/lib/mozilla/native-messaging-hosts/&lt;name&gt;.json\n\n/usr/lib/mozilla/managed-storage/&lt;name&gt;.json\n\n/usr/lib/mozilla/pkcs11-modules/&lt;name&gt;.json\n</pre></div>\n<p>或者：</p>\n<div class=\"code-example\"><pre class=\"brush: plain notranslate\">/usr/lib64/mozilla/native-messaging-hosts/&lt;name&gt;.json\n\n/usr/lib64/mozilla/managed-storage/&lt;name&gt;.json\n\n/usr/lib64/mozilla/pkcs11-modules/&lt;name&gt;.json\n</pre></div>\n<p>如果想要用户级别的可见，将清单文件存放在：</p>\n<div class=\"code-example\"><pre class=\"brush: plain notranslate\">~/.mozilla/native-messaging-hosts/&lt;name&gt;.json\n\n~/.mozilla/managed-storage/&lt;name&gt;.json\n\n~/.mozilla/pkcs11-modules/&lt;name&gt;.json\n</pre></div>"}}],"toc":[{"text":"原生应用通信清单","id":"原生应用通信清单"},{"text":"存储管理清单","id":"存储管理清单"},{"text":"PKCS #11 清单","id":"pkcs_11_清单"},{"text":"清单路径","id":"清单路径"}],"summary":"原生应用清单是一个符合特定规则的 JSON 文件，它应该使用与 extension 不同的安装方式存放在用户的计算机上。举个例子，原生应用清单是由设备管理员或者通过原生应用安装器提供的。","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Native manifests","locale":"en-US","native":"English (US)"},{"title":"manifests Natif","locale":"fr","native":"Français"},{"title":"ネイティブマニフェスト","locale":"ja","native":"日本語"}],"source":{"folder":"zh-cn/mozilla/add-ons/webextensions/native_manifests","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-cn/mozilla/add-ons/webextensions/native_manifests/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-CN/docs/Mozilla","title":"Mozilla"},{"uri":"/zh-CN/docs/Mozilla/Add-ons","title":"附加组件"},{"uri":"/zh-CN/docs/Mozilla/Add-ons/WebExtensions","title":"浏览器扩展"},{"uri":"/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Native_manifests","title":"原生应用清单"}],"pageTitle":"原生应用清单 - Mozilla | MDN","noIndexing":false}}