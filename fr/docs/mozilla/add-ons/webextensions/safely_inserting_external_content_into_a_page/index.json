{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Insérer en toute sécurité du contenu externe dans une page","mdn_url":"/fr/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page","locale":"fr","native":"Français","sidebarHTML":"\n  <ol>\n    <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions\"><strong>WebExtensions</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Démarrage</summary>\n        <ol>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\">Que sont les WebExtensions ?</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\">Votre première WebExtension</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\">Votre deuxième WebExtension</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\">Anatomie d'une WebExtension</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Examples\">Exemples de WebExtensions</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/What_next_\">Que faire ensuite ?</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Concepts</summary>\n        <ol>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\">Utilisation des API JavaScript</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\">Scripts de contenu</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">Motifs de correspondance (Match patterns)</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\">Travailler avec les fichiers</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Internationalization\">Internationalisation</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\">Politique de sécurité du contenu</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\">Message natifs</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\">Differences between API implementations</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\">Incompatibilités avec Chrome</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Interface Utilisateur</summary>\n        <ol>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface\">Introduction</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\">Bouton de la barre d'outils</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\">Bouton de la barre d'adresse</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\">Barres latérales</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\">Éléments du menu contextuel</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\">Page d'options</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\">Pages pour l'extension</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\">Notifications</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\">Suggestions de la barre d'adresse</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\">Panneaux d'outils de développement</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Mode d'emploi</summary>\n        <ol>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\">Intercepter les requêtes HTTP</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\">Modifier une page web</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\">Insérer un contenu externe</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">Share objects with page scripts</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\">Ajouter un bouton à la barre d'outils</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\">Mettre en place une page de paramètres</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\">Travailler avec l'API Tabs</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\">Travailler avec l'API Bookmarks</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\">Travailler avec l'API Cookies</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\">Travailler avec des identités contextuelles</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard\">Interagir avec le presse-papier</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\">Build a cross-browser extension</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\">Firefox differentiators</a></summary>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Les API JavaScript</summary>\n        <ol><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\">Browser support for JavaScript APIs</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/alarms\">alarms</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks\">bookmarks</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/browserAction\">browserAction</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/browserSettings\">browserSettings</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/browsingData\">browsingData</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/captivePortal\">captivePortal</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/clipboard\">clipboard</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/commands\">commands</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts\">contentScripts</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities\">contextualIdentities</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/cookies\">cookies</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/devtools\">devtools</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/dns\">dns</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/downloads\">downloads</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/events\">events</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/extension\">extension</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes\">extensionTypes</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/find\">find</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/history\">history</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n\">i18n</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/identity\">identity</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/idle\">idle</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/management\">management</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/menus\">menus</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/notifications\">notifications</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/omnibox\">omnibox</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/pageAction\">pageAction</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/permissions\">permissions</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11\">pkcs11</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/privacy\">privacy</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/proxy\">proxy</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime\">runtime</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/search\">search</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/sessions\">sessions</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/sidebarAction\">sidebarAction</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/storage\">storage</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/tabs\">tabs</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/theme\">theme</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/topSites\">topSites</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/types\">types</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/userScripts\">userScripts</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation\">webNavigation</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\">webRequest</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/windows\">windows</a></li></ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n      <summary>Clés de manifeste</summary>\n        <ol>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json\">Introduction</a></li>\n        </ol>\n      <ol><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author\">author</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background\">background</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action\">browser_action</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\">browser_specific_settings</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides\">chrome_settings_overrides</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides\">chrome_url_overrides</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands\">commands</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\">content_scripts</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy\">content_security_policy</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale\">default_locale</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description\">description</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer\">developer</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page\">devtools_page</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/dictionaries\">dictionaries</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/externally_connectable\">externally_connectable</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url\">homepage_url</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons\">icons</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito\">incognito</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version\">manifest_version</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name\">name</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/offline_enabled\">offline_enabled</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox\">omnibox</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions\">optional_permissions</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_page\">options_page</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\">options_ui</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action\">page_action</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\">permissions</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers\">protocol_handlers</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name\">short_name</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action\">sidebar_action</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/storage\">storage</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme\">theme</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme_experiment\">theme expérimentation</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/user_scripts\">user_scripts</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version\">version</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name\">version_name</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources\">web_accessible_resources</a></li></ol>\n      </details>\n    </li>\n     <li class=\"toggle\">\n      <details>\n        <summary>Extension Workshop</summary>\n        <ol>\n          <li><a href=\"https://extensionworkshop.com/documentation/develop/\">Develop</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/publish/\">Publish</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/manage/\">Manage</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/enterprise/\">Enterprise</a></li>\n        </ol>\n      </details>\n    </li>\n    <li><a href=\"/fr/docs/Mozilla/Add-ons/Contact_us\"><strong>Nous contacter</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Canaux de discussions</summary>\n        <ol>\n          <li><a href=\"https://blog.mozilla.org/addons\">Blog extensions</a></li>\n          <li><a href=\"https://discourse.mozilla.org/c/add-ons\">Forum extensions</a></li>\n          <li><a href=\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\">Add-ons chat</a></li>\n        </ol>\n      </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>Il y a des moments où vous pourriez vouloir ou devez inclure du contenu d'une source externe dans votre extension. Cependant, il existe un risque que des scripts malveillants soient intégrés à la source, soit par le développeur de la source, soit par une tierce partie malveillante.</p>\n<p>Prenez un lecteur RSS à titre d'exemple. Vous ne savez pas quels flux RSS votre extension va ouvrir et n'ont aucun contrôle sur le contenu de ces flux RSS. Ainsi, il est possible que l'utilisateur puisse s'abonner à un flux où, par exemple, le titre d'un élément de fil inclut un script. Cela pourrait être quelque chose d'aussi simple que d'inclure du code JavaScript dans les balises <code>&lt;script&gt;&lt;/script&gt;</code>. Si vous deviez extraire le titre, supposer qu'il s'agissait d'un texte brut et l'ajouter au DOM d'une page créée par votre extension, votre script a maintenant un script inconnu dans son navigateur. Par conséquent, il faut prendre soin d'éviter d'évaluer du texte arbitraire au format HTML.</p>\n<p>Vous devez également vous souvenir que les extensions ont des contextes privilégiés, par exemple dans les scripts d'arrière-plan et les scripts de contenu. Dans le pire des cas, un script incorporé peut s'exécuter dans l'un de ces contextes, une situation connue sous le nom d'escalade de privilèges. Cette situation peut laisser le navigateur d'un utilisateur ouvert à une attaque à distance en permettant au site Web qui a injecté le code d'accéder à des données utilisateur critiques, telles que des mots de passe, l'historique du navigateur ou le comportement de navigation.</p>\n<p>Cet article examine comment travailler en toute sécurité avec des données distantes et l'ajouter à un DOM.</p>"}},{"type":"prose","value":{"id":"travailler_avec_des_chaînes_arbitraires","title":"Travailler avec des chaînes arbitraires","isH3":false,"content":"<p>Lorsque vous travaillez avec des chaînes, il existe quelques options recommandées pour les ajouter en toute sécurité à une page : les méthodes de création de nœuds DOM standard ou jQuery.</p>"}},{"type":"prose","value":{"id":"méthodes_de_création_de_noeud_dom","title":"Méthodes de création de noeud DOM","isH3":true,"content":"<p>Une approche légère pour insérer des chaînes dans une page consiste à utiliser les méthodes de manipulation DOM natives : <a href=\"/fr/docs/Web/API/Document/createElement\"><code>document.createElement</code></a>, <a href=\"/fr/docs/Web/API/Element/setAttribute\"><code>Element.setAttribute</code></a>, et <a href=\"/fr/docs/Web/API/Node/textContent\"><code>Node.textContent</code></a>. L'approche sécurisée consiste à créer les nœuds séparément et à affecter leur contenu à l'aide de textContent :</p>\n<div class=\"code-example\"><pre class=\"brush: js example-good notranslate\"><code><span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>responseText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> div <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndiv<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>className<span class=\"token punctuation\">;</span>\ndiv<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">\"Your favorite color is now \"</span> <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">;</span>\naddonElement<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>div<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Cette approche est sûre car l'utilisation de <code>.textContent</code> échappe automatiquement à tout code HTML distant dans <code>data.color</code>.</p>\n<p>Cependant, attention, vous pouvez utiliser des méthodes natives qui ne sont pas sécurisées. Prenez le code suivant :</p>\n<div class=\"code-example\"><pre class=\"brush: js example-bad notranslate\"><code><span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>responseText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\naddonElement<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">\"&lt;div class='\"</span> <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span>className <span class=\"token operator\">+</span> <span class=\"token string\">\"'&gt;\"</span> <span class=\"token operator\">+</span>\n                         <span class=\"token string\">\"Your favorite color is now \"</span> <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span>color <span class=\"token operator\">+</span>\n                         <span class=\"token string\">\"&lt;/div&gt;\"</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Ici, le contenu de <code>data.className</code> ou de <code>data.color</code> peut contenir du HTML qui peut fermer le tag plus tôt, insérer du contenu HTML arbitraire, puis ouvrir une autre balise.</p>"}},{"type":"prose","value":{"id":"jquery","title":"jQuery","isH3":true,"content":"<p>Lors de l'utilisation de jQuery, des fonctions telles que <code>attr()</code> et <code>text()</code> échappent au contenu lorsqu'il est ajouté à un DOM. Ainsi, l'exemple de \"couleur préférée\" ci-dessus, implémenté dans jQuery, ressemblerait à ceci:</p>\n<div class=\"code-example\"><pre class=\"brush: js example-good notranslate\"><code><span class=\"token keyword\">var</span> node <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;/div&gt;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nnode<span class=\"token punctuation\">.</span><span class=\"token function\">addClass</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>className<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nnode<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Your favorite color is now \"</span> <span class=\"token operator\">+</span> data<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"travailler_avec_du_contenu_html","title":"Travailler avec du contenu HTML","isH3":false,"content":"<p>Lorsque vous travaillez avec du contenu de source externe dont vous savez qu'il s'agit du code HTML, il est essentiel de nettoyer le code HTML avant de l'ajouter à une page. La meilleure pratique pour désinfecter le code HTML consiste à utiliser une bibliothèque de nettoyage HTML ou un moteur de modèle avec des fonctionnalités de nettoyage HTML. Dans cette section, nous examinons certains outils appropriés et comment les utiliser.</p>"}},{"type":"prose","value":{"id":"désinfection_html","title":"Désinfection HTML","isH3":true,"content":"<p>Une bibliothèque de nettoyage HTML désactive tout ce qui pourrait conduire à l'exécution de scripts à partir du HTML, de sorte que vous pouvez injecter en toute sécurité des ensembles complets de nœuds HTML à partir d'une source distante dans votre DOM. <a href=\"https://github.com/cure53/DOMPurify\" class=\"external\" rel=\" noopener\">DOMPurify</a>, qui a été examiné par divers experts en sécurité, est une bibliothèque appropriée pour cette tâche dans les extensions.</p>\n<p>Pour l'utilisation en production, <a href=\"https://github.com/cure53/DOMPurify\" class=\"external\" rel=\" noopener\">DOMPurify</a> cest disponible en version minifiée : purify.min.js. Vous pouvez utiliser ce script de la manière qui convient le mieux à votre extension. Par exemple, vous pouvez l'ajouter en tant que script de contenu :</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token property\">\"content_scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"matches\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"&lt;all_urls&gt;\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"js\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"purify.min.js\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"myinjectionscript.js\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span>\n</code></pre></div>\n<p>Ensuite, dans myinjectionscript.js, vous pouvez lire le code HTML externe, le désinfecter et l'ajouter au DOM d'une page :</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> elem <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> cleanHTML <span class=\"token operator\">=</span> DOMPurify<span class=\"token punctuation\">.</span><span class=\"token function\">sanitize</span><span class=\"token punctuation\">(</span>externalHTML<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nelem<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> cleanHTML<span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Vous pouvez utiliser n'importe quelle méthode pour ajouter le HTML aseptisé à votre DOM, par exemple la fonction <code>.html()</code> de jQuery’s. Souvenez-vous cependant que le drapeau <code>SAFE_FOR_JQUERY</code> doit être utilisé dans ce cas :</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> elem <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;div/&gt;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> cleanHTML <span class=\"token operator\">=</span> DOMPurify<span class=\"token punctuation\">.</span><span class=\"token function\">sanitize</span><span class=\"token punctuation\">(</span>externalHTML<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">SAFE_FOR_JQUERY</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nelem<span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span>cleanHTML<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"moteur_de_modèle","title":"Moteur de modèle","isH3":true,"content":"<p>Un autre modèle courant consiste à créer un modèle HTML local pour une page et à utiliser des valeurs distantes pour remplir les blancs. Bien que cette approche soit généralement acceptable, il faut éviter d'utiliser des constructions qui permettraient l'insertion de code exécutable. Cela peut se produire lorsque le moteur de création de modèles utilise des constructions qui insèrent du code HTML brut dans le document. Si la variable utilisée pour insérer le code HTML brut est une source distante, elle est soumise au même risque de sécurité mentionné dans l'introduction.</p>\n<p>Par exemple, lorsque vous utilisez des <a href=\"https://mustache.github.io/\" class=\"external\" rel=\" noopener\">modèles moustache</a>, vous devez utiliser la double moustache, <code>{{variable}}</code>, qui échappe à tout code HTML. L'utilisation de la triple moustache, <code>{{{variable}}}</code>, doit être évitée car cela injecte une chaîne HTML brute et pourrait ajouter du code exécutable à votre modèle. <a href=\"http://handlebarsjs.com/\" class=\"external\" rel=\" noopener\">Handlebars</a> fonctionne d'une manière similaire, avec des variables dans le double guidon, <code>{{variable}}</code>, étant échappé. Considérant que, les variables dans le guidon triple sont laissées crues et doivent être évitées. De même, si vous créez une aide Handlebars à l'aide de <code>Handlebars.SafeString</code> utilisez <code>Handlebars.escapeExpression()</code> pour échapper tous les paramètres dynamiques transmis à l'assistant. C'est une exigence car la variable résultante de <code>Handlebars.SafeString</code> est considérée comme sûre et elle n'est pas échappée lorsqu'elle est insérée avec des guidons doubles.</p>\n<p>Il existe des concepts similaires dans d'autres systèmes de modélisation qui doivent être abordés avec le même niveau de soin.</p>"}},{"type":"prose","value":{"id":"lecture_supplémentaire","title":"Lecture supplémentaire","isH3":false,"content":"<p>Pour plus d'informations sur ce sujet, consultez les articles suivants :</p>\n<ul>\n  <li><a href=\"https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet\" class=\"external\" rel=\" noopener\">XSS (Cross Site Scripting) Prévention Cheat Sheet</a></li>\n</ul>"}}],"toc":[{"text":"Travailler avec des chaînes arbitraires","id":"travailler_avec_des_chaînes_arbitraires"},{"text":"Travailler avec du contenu HTML","id":"travailler_avec_du_contenu_html"},{"text":"Lecture supplémentaire","id":"lecture_supplémentaire"}],"summary":"Il y a des moments où vous pourriez vouloir ou devez inclure du contenu d'une source externe dans votre extension. Cependant, il existe un risque que des scripts malveillants soient intégrés à la source, soit par le développeur de la source, soit par une tierce partie malveillante.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Safely inserting external content into a page","locale":"en-US","native":"English (US)"},{"title":"Safely inserting external content into a page","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"fr/mozilla/add-ons/webextensions/safely_inserting_external_content_into_a_page","github_url":"https://github.com/mdn/translated-content/blob/main/files/fr/mozilla/add-ons/webextensions/safely_inserting_external_content_into_a_page/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/fr/docs/Mozilla","title":"Mozilla"},{"uri":"/fr/docs/Mozilla/Add-ons","title":"Modules"},{"uri":"/fr/docs/Mozilla/Add-ons/WebExtensions","title":"WebExtensions"},{"uri":"/fr/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page","title":"Insérer en toute sécurité du contenu externe dans une page"}],"pageTitle":"Insérer en toute sécurité du contenu externe dans une page - Mozilla | MDN","noIndexing":false}}