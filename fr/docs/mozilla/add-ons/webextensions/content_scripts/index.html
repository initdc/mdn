<!DOCTYPE html><html lang="en-US" prefix="og: https://ogp.me/ns#"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon-48x48.97046865.png"><link rel="apple-touch-icon" href="/apple-touch-icon.0ea0fa02.png"><meta name="theme-color" content="#ffffff"><link rel="manifest" href="/manifest.56b1cedc.json"><link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="MDN Web Docs"><script>Array.prototype.flat&&Array.prototype.includes||document.write('<script src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.flat%2Ces6"><\/script>')</script><title>Scripts de contenu - Mozilla | MDN</title><link rel="preload" as="font" type="font/woff2" crossorigin="" href="/static/media/ZillaSlab-Bold.subset.0beac26b.woff2"><link rel="alternate" title="Scripts de contenu" href="https://developer.mozilla.org/fr/docs/Mozilla/Add-ons/WebExtensions/Content_scripts" hreflang="fr"><link rel="alternate" title="內容腳本" href="https://developer.mozilla.org/zh-TW/docs/Mozilla/Add-ons/WebExtensions/Content_scripts" hreflang="zh-TW"><link rel="alternate" title="Content scripts" href="https://developer.mozilla.org/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Content_scripts" hreflang="zh"><link rel="alternate" title="Встраиваемый скрипт" href="https://developer.mozilla.org/ru/docs/Mozilla/Add-ons/WebExtensions/Content_scripts" hreflang="ru"><link rel="alternate" title="Content scripts" href="https://developer.mozilla.org/ko/docs/Mozilla/Add-ons/WebExtensions/Content_scripts" hreflang="ko"><link rel="alternate" title="コンテンツスクリプト" href="https://developer.mozilla.org/ja/docs/Mozilla/Add-ons/WebExtensions/Content_scripts" hreflang="ja"><link rel="alternate" title="Content scripts" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts" hreflang="en"><meta name="description" content="Un script de contenu (content script en anglais) est une partie de votre extension qui s’exécute dans le contexte d’une page web donnée (par opposition aux scripts d’arrière-plan qui font partie de l'extension, ou aux scripts qui font partie du site Web lui-même, tels que ceux chargés en utilisant l'élément <script>)."><meta property="og:url" content="https://developer.mozilla.org/fr/docs/Mozilla/Add-ons/WebExtensions/Content_scripts"><meta property="og:title" content="Scripts de contenu - Mozilla | MDN"><meta property="og:description" content="Un script de contenu (content script en anglais) est une partie de votre extension qui s’exécute dans le contexte d’une page web donnée (par opposition aux scripts d’arrière-plan qui font partie de l'extension, ou aux scripts qui font partie du site Web lui-même, tels que ceux chargés en utilisant l'élément <script>)."><meta property="og:locale" content="fr"><meta property="og:image" content="https://developer.mozilla.org/mdn-social-share.0ca9dbda.png"><meta property="twitter:card" content="summary_large_image"><meta name="robots" content="index, follow"><link rel="canonical" href="https://developer.mozilla.org/fr/docs/Mozilla/Add-ons/WebExtensions/Content_scripts"><style media="print">.breadcrumbs-container,.document-toc-container,.language-menu,.language-toggle,.on-github,.page-footer,.page-header-main,nav.sidebar,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style><link href="/static/css/main.55b68e13.chunk.css" rel="stylesheet"><script src="/static/js/runtime-main.4bb4c356.js" defer=""></script><script src="/static/js/4.a756dea3.chunk.js" defer=""></script><script src="/static/js/main.d4d565e0.chunk.js" defer=""></script></head><body><div id="root"><ul id="nav-access" class="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-search" href="#main-q">Skip to search</a></li><li><a id="skip-select-language" href="#select-language">Skip to select language</a></li></ul><div class="page-wrapper document-page"><header class="page-header"><a href="/fr/" class="logo" aria-label="MDN Web Docs"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451.74 135"><path d="M7.14 8.35v111.06h111.05V8.35zm103.71 56c-.48.92-1 1.79-1.46 2.71a3.44 3.44 0 01-3.54 2 2.4 2.4 0 00-1.55.5c-1.37.9-2.76 1.79-4.18 2.63a7.33 7.33 0 01-6.35.34 29.71 29.71 0 00-10.63-2 11.7 11.7 0 00-9.46 4.31 14.84 14.84 0 00-2.13 4.29c-1.24 3.07-2.3 21.38-2.3 26.05 0 0-17.62-3.42-34.15-20.34l4.31-11.32h-13.5l9.76-10.35h-16.8l9.77-10.34H12.69L30.45 34a40.9 40.9 0 0119.77-10.83c7.1-1.22 8.93-.53 13.31.77l2.43.73.85.25 3.1.95a12.56 12.56 0 006.21.09 11.37 11.37 0 018.25 1 8.24 8.24 0 014.1 6.22 7.29 7.29 0 003.61 5.49 59.45 59.45 0 009.32 4.11c2.27.86 4.54 1.84 6.79 2.72a6.81 6.81 0 012.86 2.06 4.81 4.81 0 011.1 2.73c.14 2 .37 4 .47 6a15.24 15.24 0 01-1.77 8.03zM320.12 39.62a5.42 5.42 0 00-4.53 2.13 7.36 7.36 0 00-1.7 4.43v2.36a6.28 6.28 0 001.7 4.46 5.63 5.63 0 004.3 1.82 5.12 5.12 0 004.57-2.27A9.7 9.7 0 00326 47a8.11 8.11 0 00-1.67-5.52 5.36 5.36 0 00-4.21-1.86zM387.38 39.53a5.52 5.52 0 00-4.7 2.15 8.8 8.8 0 00-1.63 5.49 9.23 9.23 0 001.58 5.45 5.38 5.38 0 004.7 2.25 5.61 5.61 0 004.74-2.2 8.91 8.91 0 001.68-5.59 8.24 8.24 0 00-1.75-5.52 5.76 5.76 0 00-4.62-2.03zM299.47 41.35a4.34 4.34 0 00-4-1.92 4.55 4.55 0 00-3.89 1.73 8.37 8.37 0 00-1.58 4.17h10.48a6.3 6.3 0 00-1.01-3.98zM357.74 30.75H352v23.31h5.72q5.47 0 8.35-3t2.93-8.65q0-5.43-2.88-8.55t-8.38-3.11z"></path><path d="M121.55 8.35v70.8h323V8.35zm42.21 22.45h-4V54h3.68v3.73h-11.25V54h3.31V36.79h-.19l-9.63 19.12h-2.12l-10-19.4h-.19V54h3.45v3.73h-11.15V54h3.68V30.8h-4v-3.73H133l11.66 22.56h.19l11.18-22.56h7.7zm29.12 22.67q-4.11 4.28-11.38 4.28h-14.06v-3.69h3.73V30.75h-3.73v-3.68h13.83q7.59 0 11.66 4.29a15.4 15.4 0 014 11 15.33 15.33 0 01-4.05 11.11zm38.89-22.67h-3.68v27h-2.6L208.08 35h-.19v19h4.67v3.73h-12.22V54h3.49V30.8h-4v-3.73h7.08l16.9 22.09h.19V30.8h-4.58v-3.73h12.32zm43.8 27h-3.31l-7.83-23.18h-.19l-7.55 23.18h-3.35l-8.78-27h-2.65v-3.73H253v3.73h-3.87L255 50.71h.23l6.61-19.91H259v-3.73h11v3.73h-2.78l6.61 20.1h.23l5.43-20.1h-4.15v-3.73h11v3.73h-2.54zm26.71-1.51a9.66 9.66 0 01-6.42 2 10.2 10.2 0 01-7.41-2.74c-1.89-1.82-2.83-4.47-2.83-7.93a12.37 12.37 0 012.64-8.12 9 9 0 017.32-3.21 8.62 8.62 0 016.75 2.69 9.65 9.65 0 012.45 6.52 13.67 13.67 0 01-.28 2.69H290q.29 6.71 6.18 6.7a5.2 5.2 0 003.71-1.18 5.82 5.82 0 001.67-2.83l3.45.71a7.21 7.21 0 01-2.73 4.65zm25.77-1.63c-1.51 2.4-3.92 3.61-7.22 3.61s-5.84-1.29-7.22-3.87c0 .25-.1.82-.21 1.7s-.19 1.44-.22 1.7H309c.16-1 .31-2 .47-3.07a21.42 21.42 0 00.24-3.16v-23h-3.4v-3.3h7.55V40.9a9.76 9.76 0 012.67-3.28 7.33 7.33 0 014.74-1.4 8.48 8.48 0 016.5 2.78q2.55 2.74 2.55 7.74a14.6 14.6 0 01-2.27 7.87zm41.39-1.14q-4.11 4.28-11.37 4.28H344v-3.74h3.73V30.75H344v-3.68h13.83q7.59 0 11.66 4.29a15.41 15.41 0 014.06 11 15.34 15.34 0 01-4.11 11.11zm25.65 1.68a10.53 10.53 0 01-7.9 3.07 10 10 0 01-7.63-3 10.93 10.93 0 01-2.8-7.83 12.13 12.13 0 012.69-7.93q2.69-3.3 8-3.3t8 3.28a12 12 0 012.64 7.76 10.86 10.86 0 01-3 7.9zm22.61.57c-1.4 1.66-3.63 2.5-6.68 2.5a9.58 9.58 0 01-7.15-2.76q-2.72-2.76-2.71-7.91a12.25 12.25 0 012.69-8 9.17 9.17 0 017.5-3.28 15 15 0 013.82.48 10.37 10.37 0 013.5 1.65l.85 5.47-3.35.38-.76-3.54a8.07 8.07 0 00-4.11-1 4.9 4.9 0 00-4.39 2.15 9.93 9.93 0 00-1.41 5.55 8.9 8.9 0 001.5 5.38 5.23 5.23 0 004.44 2c2.92 0 4.67-1.7 5.23-5.1l3.5.71a10.34 10.34 0 01-2.47 5.27zm20.48.75a11.68 11.68 0 01-6.63 1.75 15.52 15.52 0 01-8.26-2.08L424 51l3.26.33-.1 2.74a7 7 0 002.06.66 12.63 12.63 0 002.19.19 8.68 8.68 0 003.66-.75 2.5 2.5 0 001.63-2.36 2.25 2.25 0 00-1.32-2.2 12.65 12.65 0 00-3.28-1 47.39 47.39 0 01-3.9-.82 7.5 7.5 0 01-3.25-1.7 4.67 4.67 0 01-1.33-3.66c0-2.36.88-4 2.62-4.91a12 12 0 015.6-1.37 15 15 0 014.08.55 16.65 16.65 0 013.47 1.39l.47 5.1-3.3.37-.48-3.3a9.5 9.5 0 00-4.06-.9 5.62 5.62 0 00-2.87.66 2.33 2.33 0 00-1.15 2.25 2.13 2.13 0 001.3 2.07 11.91 11.91 0 003.21.92 36.69 36.69 0 013.82.83 7.46 7.46 0 013.21 1.74 4.9 4.9 0 011.3 3.73 5.56 5.56 0 01-2.66 4.91z"></path><path d="M181.17 30.75h-5.71v23.31h5.71q5.47 0 8.36-3t2.88-8.61q0-5.43-2.88-8.55t-8.36-3.15zM121.63 119.32V81.74h114.91v37.58zM153.22 109h-2v-6.85a4.8 4.8 0 00-1.58-4 5.57 5.57 0 00-3.55-1.26 5 5 0 00-4.92 3.26 4.19 4.19 0 00-1.88-2.46 5.82 5.82 0 00-3-.8 4.89 4.89 0 00-4.56 2.56v-2.21h-6.28v3.26h2v8.5h-2v3.23h9.11V109h-2.86v-5.25a4.4 4.4 0 01.69-2.56 2.47 2.47 0 012.21-1q2.57 0 2.56 3.63v8.41h6.29V109h-2v-5.25a4.47 4.47 0 01.67-2.56 2.42 2.42 0 012.19-1q2.63 0 2.63 3.63v8.41h6.28zm9.88-12.07q-4 0-6 2.36a8.41 8.41 0 00-2 5.66 7.25 7.25 0 002.17 5.62 8 8 0 005.65 2 8.54 8.54 0 005.94-2.11 7.27 7.27 0 002.34-5.67 8.21 8.21 0 00-2-5.51q-2.07-2.34-6.1-2.34zm-.1 12.35a3 3 0 01-2.63-1.33 5.68 5.68 0 01-.9-3.26 5 5 0 011-3.28 3.23 3.23 0 012.61-1.18 3.5 3.5 0 012.59 1.08 4.56 4.56 0 011.07 3.31 5.21 5.21 0 01-1 3.41 3.33 3.33 0 01-2.74 1.25zm25-2.3l-3.39-.29-.7 2.32H179l8.32-9.54-.32-2.23h-13.19l-.53 5.25 3.16.34.67-2.36h4.65l-8.25 9.53.44 2.26h13.13zm7.62-9.74h-4.46v5.39h4.46zm0 9.61h-4.46v5.39h4.46zm13.54-17.49h-4.23l-6.48 22.88h4.22zm8.68 0h-4.23l-6.45 22.88h4.19zm15 22.51l-.07-2.26a1.22 1.22 0 01-.56.1c-.69 0-1-.39-1-1.16v-6.49a4.39 4.39 0 00-1.8-3.84 7 7 0 00-4.16-1.28 14.55 14.55 0 00-3.16.3 24.14 24.14 0 00-3.29 1.06l-.56 3.46 3.39.4.5-1.69a2.78 2.78 0 011.08-.37 11.3 11.3 0 011.25-.07c1.19 0 1.89.37 2.09 1.1a8.55 8.55 0 01.3 2.26v.5a8.91 8.91 0 00-1.18-.11h-1.21a12.64 12.64 0 00-4.81.88 3.53 3.53 0 00-2.18 3.64 3.66 3.66 0 001.48 3.33 5.63 5.63 0 003.11 1 4.67 4.67 0 003-.91 6.78 6.78 0 001.8-2 3 3 0 003.33 3 5.54 5.54 0 002.66-.85zm-9.25-2.32a1.69 1.69 0 01-1.36-.52 1.81 1.81 0 01-.43-1.21 1.67 1.67 0 01.86-1.68 4.63 4.63 0 012-.42 7.69 7.69 0 011.07.07l1.06.13a3.58 3.58 0 01-1.08 2.74 3.24 3.24 0 01-2.11.89z"></path></svg></a><button type="button" class="ghost main-menu-toggle" aria-haspopup="true" aria-label="Show Menu"></button><div class="page-header-main "><nav class="main-nav" aria-label="Main menu"><ul class="main-menu nojs"><li class="top-level-entry-container"><button id="technologies-button" type="button" class="top-level-entry" aria-haspopup="menu" aria-expanded="false">Technologies</button><ul class="technologies " role="menu" aria-labelledby="technologies-button"><li role="none"><a tabindex="-1" href="/fr/docs/Web" role="menuitem">Technologies Overview</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web/HTML" role="menuitem">HTML</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web/CSS" role="menuitem">CSS</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web/JavaScript" role="menuitem">JavaScript</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web/Guide/Graphics" role="menuitem">Graphics</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web/HTTP" role="menuitem">HTTP</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web/API" role="menuitem">APIs</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Mozilla/Add-ons/WebExtensions" role="menuitem">Browser Extensions</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web/MathML" role="menuitem">MathML</a></li></ul></li><li class="top-level-entry-container"><button id="references-guides-button" type="button" class="top-level-entry" aria-haspopup="menu" aria-expanded="false">References &amp; Guides</button><ul class="references-guides " role="menu" aria-labelledby="references-guides-button"><li role="none"><a tabindex="-1" href="/fr/docs/Learn" role="menuitem">Learn web development</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web/Tutorials" role="menuitem">Tutorials</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web/Reference" role="menuitem">References</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web/Guide" role="menuitem">Developer Guides</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web/Accessibility" role="menuitem">Accessibility</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Games" role="menuitem">Game development</a></li><li role="none"><a tabindex="-1" href="/fr/docs/Web" role="menuitem">...more docs</a></li></ul></li><li class="top-level-entry-container"><button id="feedback-button" type="button" class="top-level-entry" aria-haspopup="menu" aria-expanded="false">Feedback</button><ul class="feedback " role="menu" aria-labelledby="feedback-button"><li role="none"><a tabindex="-1" href="/fr/docs/MDN/Contribute/Feedback" role="menuitem">Send Feedback</a></li><li role="none"><a tabindex="-1" href="/fr/docs/MDN/Contribute" role="menuitem">Contribute to MDN</a></li><li role="none"><a tabindex="-1" target="_blank" rel="noopener noreferrer" href="https://github.com/mdn/content/issues/new" role="menuitem">Report a content issue<!-- --> 🌐</a></li><li role="none"><a tabindex="-1" target="_blank" rel="noopener noreferrer" href="https://github.com/mdn/yari/issues/new" role="menuitem">Report a platform issue<!-- --> 🌐</a></li></ul></li></ul></nav><div class="header-search"><form action="/fr/search" class="search-form search-widget" role="search"><label for="main-q" class="visually-hidden">Search MDN</label><input type="search" name="q" id="main-q" class="search-input-field" placeholder="Site search... (Press &quot;/&quot; to focus)" pattern="(.|\s)*\S(.|\s)*" required="" value=""><input type="submit" class="ghost search-button" value="" aria-label="Search"></form></div><div class="auth-container"></div></div></header><div class="breadcrumb-locale-container"><nav class="breadcrumbs-container" aria-label="Breadcrumb navigation"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/fr/docs/Mozilla"><span property="name">Mozilla</span></a><meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/fr/docs/Mozilla/Add-ons"><span property="name">Modules</span></a><meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-penultimate" property="item" typeof="WebPage" href="/fr/docs/Mozilla/Add-ons/WebExtensions"><span property="name">WebExtensions</span></a><meta property="position" content="3"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-current-page" property="item" typeof="WebPage" href="/fr/docs/Mozilla/Add-ons/WebExtensions/Content_scripts"><span property="name">Scripts de contenu</span></a><meta property="position" content="4"></li></ol></nav><ul class="language-toggle"><li><a href="#select-language" class="language-icon"><span class="show-desktop">Change language</span></a></li><li><a class="view-in-english" href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts"><span class="show-desktop">View in</span> English</a></li></ul></div><div class="localized-content-note notecard inline neutral"><a href="/en-US/docs/MDN/Contribute/Localize#active_locales">Cette page a été traduite à partir de l'anglais par la communauté. Vous pouvez également contribuer en rejoignant la communauté francophone sur MDN Web Docs.</a></div><aside class="document-toc-container"><section class="document-toc"><header><h2>Table of contents</h2><button type="button" class="ghost toc-trigger-mobile" aria-controls="toc-entries" aria-expanded="false">Table of contents</button></header><ul id="toc-entries"><li><a href="#charger_des_scripts_de_contenu">Charger des scripts de contenu</a></li><li><a href="#environnement_des_scripts_de_contenu">Environnement des scripts de contenu</a></li><li><a href="#communication_avec_les_scripts_darrière-plan">Communication avec les scripts d'arrière-plan</a></li><li><a href="#communiquer_avec_la_page_web">Communiquer avec la page web</a></li><li><a href="#utilisation_de_eval_dans_les_scripts_de_contenu">Utilisation de <code>eval()</code> dans les scripts de contenu</a></li></ul></section></aside><main id="content" class="main-content" role="main"><article class="main-page-content" lang="fr"><h1>Scripts de contenu</h1><div><p>Un script de contenu (<em>content script</em> en anglais) est une partie de votre extension qui s’exécute dans le contexte d’une page web donnée (par opposition aux scripts d’arrière-plan qui font partie de l'extension, ou aux scripts qui font partie du site Web lui-même, tels que ceux chargés en utilisant l'élément <a href="/fr/docs/Web/HTML/Element/script"><code>&lt;script&gt;</code></a>).</p>
<p>Les <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#background_scripts">scripts d'arrière-plan</a> peuvent accéder à l'ensemble des <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API">API WebExtension</a> mais ils ne peuvent pas accéder directement au contenu des pages web. Aussi, si votre extension doit manipuler le contenu des pages web, vous devrez utiliser les scripts de contenu.</p>
<p>Tout comme les scripts habituellement chargés par les pages web classiques, les scripts de contenu peuvent lire et modifier le contenu de leurs pages en utilisant les API DOM standard.</p>
<p>Les scripts de contenu ne peuvent accéder qu'à <a href="#api webextensions">un sous-ensemble des API WebExtension</a>, mais ils peuvent <a href="#communication_background">communiquer avec les scripts d'arrière-plan</a> grâce à un système de messages et ainsi accéder indirectement aux API WebExtension.</p>
<div class="notecard note" id="sect1">
  <p><strong>Note :</strong> que les scripts de contenu sont bloqués sur les domaines suivants :</p>
  <ul>
    <li>accounts-static.cdn.mozilla.net</li>
    <li>accounts.firefox.com</li>
    <li>addons.cdn.mozilla.net</li>
    <li>addons.mozilla.org</li>
    <li>api.accounts.firefox.com</li>
    <li>content.cdn.mozilla.net</li>
    <li>content.cdn.mozilla.net</li>
    <li>discovery.addons.mozilla.org</li>
    <li>input.mozilla.org</li>
    <li>install.mozilla.org</li>
    <li>oauth.accounts.firefox.com</li>
    <li>profile.accounts.firefox.com</li>
    <li>support.mozilla.org</li>
    <li>sync.services.mozilla.com</li>
    <li>testpilot.firefox.com</li>
  </ul>
  <p>If you try to inject a content script into a page in these domains, it will fail and the page will log a <a href="/fr/docs/Web/HTTP/CSP">CSP</a> error.</p>
  <p>Because these restrictions include addons.mozilla.org, users may attempt to use your extension immediately after installation—only to find that it doesn't work! You may want to add an appropriate warning, or an <a href="https://extensionworkshop.com/documentation/develop/onboard-upboard-offboard-users/" class="external" rel=" noopener">onboarding page</a> to move users away from addons.mozilla.org.</p>
</div>
<div class="notecard note" id="sect2">
  <p><strong>Note :</strong> Les valeurs ajoutées à la portée globale d'un script de contenu avec <code>var foo</code> ou <code>window.foo = "bar"</code> peuvent disparaître à cause du bogue <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1408996" class="external" rel=" noopener">1408996</a>.</p>
</div></div><h2 id="charger_des_scripts_de_contenu"><a href="#charger_des_scripts_de_contenu" title="Permalink to Charger des scripts de contenu">Charger des scripts de contenu</a></h2><div><p>Il est possible de charger un script de contenu dans une page web de trois manières différentes :</p>
<ol>
  <li><strong>Lors de la phase d'installation, pour les pages qui correspondent à certains motifs d'URL :</strong> en utilisant la clé <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts"><code>content_scripts</code></a> dans le fichier <code>manifest.json</code>, vous pouvez demander au navigateur de charger un script de contenu chaque fois que le navigateur charge une page dont l'URL <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Match_patterns">correspond à un motif donné</a>.</li>
  <li><strong>Lors de l'exécution, pour les pages qui correspondent à certains motifs d'URL :</strong> en utilisant l'API <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts"><code>contentScripts</code></a>, vous pouvez demander au navigateur de charger un script de contenu chaque fois que le navigateur charge une page dont l'URL <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Match_patterns">correspond à un motif donné</a>. Cette méthode est la version dynamique de la première méthode.</li>
  <li><strong>Lors de l'exécution, pour certains onglets spécifiques :</strong> en utilisant la méthode <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/Tabs/executeScript"><code>tabs.executeScript()</code></a>, vous pouvez charger un script de contenu dans un onglet spécifique quand vous le souhaitez (par exemple lorsqu'un utilisateur clique sur un <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Browser_action">bouton d'action du navigateur</a>).</li>
</ol>
<p>Il n'y a qu'une seule portée globale pour chaque <em>frame</em> et pour chaque extension. Cela signifie que les variables d'un script de contenu peuvent être accédées directement par un autre script de contenu, indépendamment de la manière dont le script de contenu a été chargé.</p>
<p>À l'aide des méthodes (1) et (2), vous ne pouvez charger des scripts que dans des pages dont les URL peuvent être représentées par un <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Match_patterns">motif de correspondance</a>.</p>
<p>En utilisant la méthode (3), vous pouvez également charger des scripts dans des pages packagées avec votre extension, mais vous ne pouvez pas charger des scripts dans des pages privilégiées du navigateur (comme <a href=""><code>about:debugging</code></a> ou <a href=""><code>about:addons</code></a>).</p></div><h2 id="environnement_des_scripts_de_contenu"><a href="#environnement_des_scripts_de_contenu" title="Permalink to Environnement des scripts de contenu">Environnement des scripts de contenu</a></h2><div></div><h3 id="accès_au_dom"><a href="#accès_au_dom" title="Permalink to Accès au DOM">Accès au DOM</a></h3><div><p>Les scripts de contenu peuvent accéder et modifier le DOM de la page à la manière des scripts classique. Ils peuvent également observer tout changement du DOM effectué par les scripts de la page.</p>
<p>Cependant, les scripts de contenu reçoivent une «&nbsp;vue propre du DOM&nbsp;». Cela signifie que :</p>
<ul>
  <li>Les scripts de contenu ne peuvent pas accéder aux variables JavaScript définies par les scripts de la page.</li>
  <li>Si un script de page redéfinit une propriété intrinsèque du DOM, le script de contenu verra la version originale de cette propriété et non la version redéfinie.</li>
</ul>
<p>Dans Firefox, ce comportement s'appelle <a href="https://firefox-source-docs.mozilla.org/dom/scriptSecurity/xray_vision.html" class="only-in-en-us external" title="Currently only available in English (US)" rel=" noopener">Vision Xray (en-US)</a>.</p>
<p>Prenons par exemple la page web suivante&nbsp;:</p>
<div class="code-example"><pre class="brush: html notranslate"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html; charset=utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>page-scripts/page-script.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div>
<p>Le script «&nbsp;page-script.js&nbsp;» est écrit ci-dessous&nbsp;:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// page-script.js</span>

<span class="token comment">// ajouter un élément au DOM</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">"Ce paragraphe a été ajouté par un script de la page."</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"page-script-para"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// définition d’une nouvelle propriété pour la fenêtre</span>
window<span class="token punctuation">.</span>toto <span class="token operator">=</span> <span class="token string">"Cette variable globale a été ajoutée par un script de la page."</span><span class="token punctuation">;</span>

<span class="token comment">// redéfinition de la fonction intégrée window.confirm()</span>
window<span class="token punctuation">.</span><span class="token function-variable function">confirm</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Ce script de page peut aussi redéfinir ’confirm’."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Et maintenant une extension injecte ce script de contenu dans la page&nbsp;:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// content-script.js</span>

<span class="token comment">// peut accéder au DOM et le modifier</span>
<span class="token keyword">var</span> pageScriptPara <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"page-script-para"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pageScriptPara<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">;</span>

<span class="token comment">// ne peut pas voir les propriétés ajoutées par un script de la page</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>toto<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// non défini</span>

<span class="token comment">// voit la forme originale des propriétés redéfinies</span>
window<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"Êtes-vous sûr ?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// appelle la méthode window.confirm() originale</span>
</code></pre></div>
<p>L'inverse est également vrai&nbsp;: les scripts de la page ne peuvent pas voir les propriétés JavaScript ajoutées par les scripts de contenu.</p>
<p>Ceci signifie que le script de contenu peut compter sur un comportement prévisible des propriétés du DOM et n'a pas à se soucier d'un éventuel conflit entre les variables qu'il définit et celles des scripts de page.</p>
<p>Une des conséquences pratiques de ce comportement est que les scripts de contenu n’ont accès à aucune des bibliothèques JavaScript chargées par la page. Par exemple, si la page inclut jQuery, le script de contenu ne pourra pas le voir.</p>
<p>Si un script de contenu veut utiliser une bibliothèque JavaScript, alors la bibliothèque doit être injectée en tant que script de contenu aux côtés du script de contenu qui veut l’utiliser.</p>
<div class="code-example"><pre class="brush: json notranslate"><code><span class="token property">"content_scripts"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"matches"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"*://*.mozilla.org/*"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"js"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"jquery.js"</span><span class="token punctuation">,</span> <span class="token string">"content-script.js"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div>
<div class="notecard note" id="sect3">
  <p><strong>Note :</strong> Firefox <em>fournis</em> certaines API qui permettent aux scripts de contenu d'accéder aux objets JavaScript créés par les scripts de page et d'exposer leurs propres objets JavaScript aux scripts de page.</p>
  <p>Voir <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts">Partage d'objets avec des scripts de page</a> pour plus de détails.</p>
</div></div><h3 id="les_api_webextension_accessibles"><a href="#les_api_webextension_accessibles" title="Permalink to Les API WebExtension accessibles">Les API WebExtension accessibles</a></h3><div><p>En plus des API standard du DOM, les scripts de contenu peuvent utiliser les API WebExtension suivantes&nbsp;:</p>
<p>Depuis l'API <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/extension"><code>extension</code></a>&nbsp;:</p>
<ul>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/extension#geturl()"><code>getURL()</code></a></li>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/extension#inincognitocontext"><code>inIncognitoContext</code></a></li>
</ul>
<p>Depuis l'API <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime"><code>runtime</code></a>&nbsp;:</p>
<ul>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#connect()"><code>connect()</code></a></li>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#getmanifest()"><code>getManifest()</code></a></li>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#geturl()"><code>getURL()</code></a></li>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#onconnect"><code>onConnect</code></a></li>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#onmessage"><code>onMessage</code></a></li>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#sendmessage()"><code>sendMessage()</code></a></li>
</ul>
<p>Depuis l'API <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n"><code>i18n</code></a>&nbsp;:</p>
<ul>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getMessagee"><code>getMessage()</code></a></li>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getAcceptLanguages"><code>getAcceptLanguages()</code></a></li>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getUILanguage"><code>getUILanguage()</code></a></li>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n/detectLanguage"><code>detectLanguage()</code></a></li>
</ul>
<p>A partir des <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/menus"><code>menus</code></a>:</p>
<ul>
  <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/menus/getTargetElement"><code>getTargetElement</code></a></li>
</ul>
<p>L'ensemble des propriétés et méthodes de l'API <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/storage"><code>storage</code></a>.</p></div><h3 id="xhr_et_fetch"><a href="#xhr_et_fetch" title="Permalink to XHR et Fetch">XHR et Fetch</a></h3><div><p>Les scripts de contenu peuvent effectuer des requêtes en utilisant les API classiques <a href="/fr/docs/Web/API/XMLHttpRequest"><code>window.XMLHttpRequest</code></a> et <a href="/fr/docs/Web/API/Fetch_API"><code>window.fetch()</code></a>.</p>
<p>Les scripts de contenu obtiennent les mêmes privilèges interdomaines que le reste de l'extension : si l'extension a demandé un accès interdomaine pour un domaine à l'aide de la clé <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions"><code>permissions</code></a> dans le fichier <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json"><code>manifest.json</code></a>, ses scripts de contenu auront également accès à ce domaine.</p>
<p>Ceci est accompli en exposant des instances XHR et <em>fetch</em> privilégiées dans le script de contenu. Cela a pour effet secondaire de ne pas définir les en-têtes <a href="/fr/docs/Web/HTTP/Headers/Origin"><code>Origin</code></a> et <a href="/fr/docs/Web/HTTP/Headers/Referer"><code>Referer</code></a> tels que la page elle-même l'aurait fait. Cela est souvent préférable afin d'éviter que la requête révèle la différence d'origine. À partir de Firefox 58, les extensions qui doivent exécuter des requêtes se comportant comme si elles étaient envoyées par le contenu lui-même peuvent utiliser <code>content.XMLHttpRequest</code> et <code>content.fetch()</code>. Pour les extensions visant une compatibilité entre les navigateurs, il est nécessaire de vérifier la présence de ces API avant de les utiliser.</p></div><h2 id="communication_avec_les_scripts_darrière-plan"><a href="#communication_avec_les_scripts_darrière-plan" title="Permalink to Communication avec les scripts d'arrière-plan">Communication avec les scripts d'arrière-plan</a></h2><div><p>Bien que les scripts de contenu ne puissent pas utiliser la totalité des API WebExtension, ils peuvent communiquer avec les scripts d'arrière-plan de l'extension via l'API de messagerie et ont donc indirectement accès aux mêmes API que ces derniers.</p>
<p>Par défault, il existe deux moyens de communication entre les scripts d'arrière-plan et les scripts de contenu&nbsp;: vous pouvez envoyer des messages un par un, avec des réponses optionelles, ou vous pouvez établir une connexion continue entre les scripts, et utiliser cette connexion pour échanger des messages.</p></div><h3 id="un_message_à_la_fois"><a href="#un_message_à_la_fois" title="Permalink to Un message à la fois">Un message à la fois</a></h3><div><p>Pour envoyer un message à la fois, vous pouvez utiliser les API suivantes :</p>
<table class="standard-table">
  <thead>
    <tr>
      <th scope="row"></th>
      <th scope="col">Dans le script de contenu</th>
      <th scope="col">Dans les scripts d'arrière-plan</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th scope="row">Envoyer un message</th>
      <td><code><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#sendmessage()">browser.runtime.sendMessage()</a></code></td>
      <td><code><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/Tabs/sendMessage">browser.tabs.sendMessage()</a></code></td>
    </tr>
    <tr>
      <th scope="row">Recevoir un message</th>
      <td><code><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage">browser.runtime.onMessage</a></code></td>
      <td><code><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#onmessage">browser.runtime.onMessage</a></code></td>
    </tr>
  </tbody>
</table>
<p>Par exemple, voici un script de contenu qui écoute les évènements de clic sur une page web. Si le clic était sur un lien, il envoie un message à la page d'arrière-plan avec l'URL cible&nbsp;:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// content-script.js</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> notifyExtension<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">notifyExtension</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>tagName <span class="token operator">!=</span> <span class="token string">"A"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">"url"</span><span class="token operator">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>href<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Le script d'arrière-plan écoute les messages et affiche une notification en utilisant l'API <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/notifications"><code>notification</code></a> :</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// background-script.js</span>

browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>notify<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">notify</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  browser<span class="token punctuation">.</span>notifications<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"basic"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"iconUrl"</span><span class="token operator">:</span> browser<span class="token punctuation">.</span>extension<span class="token punctuation">.</span><span class="token function">getURL</span><span class="token punctuation">(</span><span class="token string">"link.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string-property property">"title"</span><span class="token operator">:</span> <span class="token string">"Vous avez cliqué sur un lien&amp;nbsp;!"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"message"</span><span class="token operator">:</span> message<span class="token punctuation">.</span>url
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Ce code d'exemple est légèrement dérivé de l'exemple <a href="https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n" class="external" rel=" noopener">notify-link-clicks-i18n</a> sur GitHub.</p></div><h3 id="les_messages_en_flux_continu"><a href="#les_messages_en_flux_continu" title="Permalink to Les messages en flux continu">Les messages en flux continu</a></h3><div><p>L'envoi de messages distincts peut vite devenir lourd si de nombreux messages sont envoyés entre les scripts d'arrière plan et les scripts de contenu.</p>
<p>L'une des alternatives possibles est d'établir une connexion longue durée entre les deux scripts et d'utiliser cette connexion afin d'échanger des messages.</p>
<p>De chaque côté (contenu d'une part, arrière-plan d'autre part), les scripts possèdent un objet <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port"><code>runtime.Port</code></a> dont ils peuvent se servir pour échanger des messages.</p>
<p>Pour créer la connexion&nbsp;:</p>
<ul>
  <li>L'un des côtés se tient à l'écoute des connexions avec <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnect"><code>runtime.onConnect</code></a>.</li>
  <li>L'autre côté appelle <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/tabs/connect"><code>tabs.connect()</code></a> (pour se connecter à un script de contenu) ou <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/connect"><code>runtime.connect()</code></a> (pour se connecter à un script d'arrière plan). Ces deux méthodes renvoient un objet <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port"><code>runtime.Port</code></a>.</li>
  <li>Le gestionnaire d'évènement <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnect"><code>runtime.onConnect</code></a> reçoit alors en argument un objet <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port"><code>runtime.Port</code></a> qui lui est propre.</li>
</ul>
<p>Une fois que chaque côté possède son propre port, ils peuvent échanger en utilisant <code>runtime.Port.postMessage()</code> pour envoyer des message et <code>runtime.Port.onMessage</code> pour en recevoir.</p>
<p>Par exemple, dès le chargement, ce script de contenu&nbsp;:</p>
<ul>
  <li>se connecte au script d'arrière plan et stocke l'objet <code>Port</code> dans une variable <code>myPort</code></li>
  <li>écoute des messages sur <code>myPort</code>, et les enregistre.</li>
  <li>envoie des messages au script d'arrière plan via <code>myPort</code>, quand l'utlisateur clique sur le document.</li>
</ul>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// content-script.js</span>

<span class="token keyword">var</span> myPort <span class="token operator">=</span> browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">"port-from-cs"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myPort<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">greeting</span><span class="token operator">:</span> <span class="token string">"ici le script de contenu"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

myPort<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Dans le script de contenu, réception d'un message du script d'arrière-plan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>greeting<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  myPort<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">greeting</span><span class="token operator">:</span> <span class="token string">"clic sur la page&amp;nbsp;!"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Le script d'arrière plan qui correspond ·</p>
<ul>
  <li>Écoute les tentatives de connexion depuis le script de contenu.</li>
  <li>Quand il reçoit une tentative de connexion&nbsp;:
    <ul>
      <li>Enregistre le port dans une variable nommée <code>portFromCS</code></li>
      <li>Envoie un message au script de contenu en utilisant le port</li>
      <li>Commence à écouter les messages reçus sur le port et les enregistre.</li>
    </ul>
  </li>
  <li>Envoie des messages au script de contenu en utilisant <code>portFromCS</code>, quand l'utilisateur clique sur l'action navigateur de l'add-on</li>
</ul>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// background-script.js</span>

<span class="token keyword">var</span> portFromCS<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">connected</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  portFromCS <span class="token operator">=</span> p<span class="token punctuation">;</span>
  portFromCS<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">greeting</span><span class="token operator">:</span> <span class="token string">"salut, script de contenu&amp;nbsp;!"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  portFromCS<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Dans le script d'arrière-plan, réception d'un message du script de contenu."</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>greeting<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onConnect<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>connected<span class="token punctuation">)</span><span class="token punctuation">;</span>

browser<span class="token punctuation">.</span>browserAction<span class="token punctuation">.</span>onClicked<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  portFromCS<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">greeting</span><span class="token operator">:</span> <span class="token string">"clic sur le bouton&amp;nbsp;!"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h4 id="scripts_de_contenu_multiples">Scripts de contenu multiples</h4>
<p>Si plusieurs scripts de contenu communiquent en même temps, vous pouvez stocker chaque connexion dans un tableau.</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// background-script.js</span>

<span class="token keyword">var</span> ports <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">connected</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ports<span class="token punctuation">[</span>p<span class="token punctuation">.</span>sender<span class="token punctuation">.</span>tab<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">;</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onConnect<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>connected<span class="token punctuation">)</span>

browser<span class="token punctuation">.</span>browserAction<span class="token punctuation">.</span>onClicked<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ports<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      p<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">greeting</span><span class="token operator">:</span> <span class="token string">"clic sur le bouton !"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div><h2 id="communiquer_avec_la_page_web"><a href="#communiquer_avec_la_page_web" title="Permalink to Communiquer avec la page web">Communiquer avec la page web</a></h2><div><p>Bien que les scripts de contenu ne puissent (par défaut) accéder aux objets créés par les scripts de page, ils peuvent cependant communiquer avec les scripts de page en utilisant les API <a href="/fr/docs/Web/API/Window/postMessage"><code>window.postMessage</code></a> et <a href="/fr/docs/Web/API/EventTarget/addEventListener"><code>window.addEventListener</code></a> du DOM.</p>
<p>Par exemple&nbsp;:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// page-script.js</span>

<span class="token keyword">var</span> messenger <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"from-page-script"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

messenger<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> messageContentScript<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">messageContentScript</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  window<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">direction</span><span class="token operator">:</span> <span class="token string">"from-page-script"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">"Message de la page"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// content-script.js</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>source <span class="token operator">==</span> window <span class="token operator">&amp;&amp;</span>
      event<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span>
      event<span class="token punctuation">.</span>data<span class="token punctuation">.</span>direction <span class="token operator">==</span> <span class="token string">"from-page-script"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Le script de contenu a reçu ce message&amp;nbsp;: \""</span> <span class="token operator">+</span> event<span class="token punctuation">.</span>data<span class="token punctuation">.</span>message <span class="token operator">+</span> <span class="token string">"\""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Pour un exemple complet et fonctionnel, <a href="https://mdn.github.io/webextensions-examples/content-script-page-script-messaging.html" class="external" rel=" noopener">visitez la page de démo sur Github</a> et suivez les instructions.</p>
<div class="notecard warning" id="sect4">
  <p><strong>Attention :</strong> Notez que vous devez être très prudent lorsque vous interagissez avec du contenu Web non fiable de cette manière. Les extensions sont du code privilégié qui peut avoir de puissantes capacités et les pages Web hostiles peuvent facilement les amener à accéder à ces capacités.</p>
  <p>Pour donner un exemple trivial, supposons que le code du script de contenu qui reçoit le message ressemble à ceci&nbsp;:</p>
  <div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// content-script.js</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>source <span class="token operator">==</span> window <span class="token operator">&amp;&amp;</span>
      event<span class="token punctuation">.</span>data<span class="token punctuation">.</span>direction <span class="token operator">&amp;&amp;</span>
      event<span class="token punctuation">.</span>data<span class="token punctuation">.</span>direction <span class="token operator">==</span> <span class="token string">"from-page-script"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">eval</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
  <p>Maintenant, le script de page peut exécuter n'importe quel code avec tous les privilèges du script de contenu.</p>
</div></div><h2 id="utilisation_de_eval_dans_les_scripts_de_contenu"><a href="#utilisation_de_eval_dans_les_scripts_de_contenu" title="Permalink to Utilisation de eval() dans les scripts de contenu">Utilisation de <code>eval()</code> dans les scripts de contenu</a></h2><div><p>Dans Chrome, <a href="/fr/docs/Web/JavaScript/Reference/Global_Objects/eval"><code>eval()</code></a> exécute toujours le code dans le contexte du script de contenu et pas dans le contexte de la page.</p>
<p>Dans Firefox&nbsp;:</p>
<ul>
  <li>Si vous appelez <code>eval()</code>, le code est exécuté dans le contexte du <strong>script de contenu</strong></li>
  <li>Si vous appelez <code>window.eval()</code>, le code est exécute dans le contexte de la <strong>page</strong>.</li>
</ul>
<p>Par exemple, considérons un script de contenu comme ceci &nbsp;:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// content-script.js</span>

window<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'window.x = 1;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'window.y = 2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Dans le script de contenu, window.x: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>window<span class="token punctuation">.</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Dans le script de contenu, window.y: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>window<span class="token punctuation">.</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">"check"</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Ce code crée simplement des variables x et y en utilisant <code>window.eval()</code> et <code>eval()</code> puis enregistre leurs valeurs et envoie un message à la page.</p>
<p>À la réception du message, le script de page enregistre les mêmes variables :</p>
<div class="code-example"><pre class="brush: js notranslate"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>source <span class="token operator">===</span> window <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>data<span class="token punctuation">.</span>message <span class="token operator">===</span> <span class="token string">"check"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Dans le script de la page, window.x: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>window<span class="token punctuation">.</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Dans le script de la page, window.y: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>window<span class="token punctuation">.</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Dans Chrome, cela produira le résultat suivant :</p>
<pre class="notranslate">Dans le script de contenu, window.x: 1
Dans le script de contenu, window.y: 2
Dans le script de la page, window.x: undefined
Dans le script de la page, window.y: undefined
</pre>
<p>Dans Firefox, on aura le résultat suivant :</p>
<pre class="notranslate">Dans le script de contenu, window.x: undefined
Dans le script de contenu, window.y: 2
Dans le script de la page, window.x: 1
Dans le script de la page, window.y: undefined
</pre>
<p>La même chose s'applique pour <a href="/fr/docs/Web/API/setTimeout"><code>setTimeout()</code></a>, <a href="/en-US/docs/Web/API/setInterval" class="only-in-en-us" title="Currently only available in English (US)">setInterval() (en-US)</a>, et <a href="/fr/docs/Web/JavaScript/Reference/Global_Objects/Function"><code>Function()</code></a>.</p>
<div class="notecard warning" id="sect5">
  <p><strong>Attention :</strong> Lorsque vous exécutez du code dans le contexte de la page, l'avertissement précédent reste nécessaire : l'environnement de la page est contrôlé par des pages web potentiellement malveillantes qui peuvent redéfinir les objets avec lesquels vous interagissez&nbsp;:</p>
  <div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// page.js redéfinit console.log</span>

<span class="token keyword">var</span> original <span class="token operator">=</span> console<span class="token punctuation">.</span>log<span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function-variable function">log</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">original</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
  <div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// content-script.js appelle la version redéfinie</span>

window<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'console.log(false)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</div></div></article><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h3>Found a problem with this page?</h3><ul><li><a href="https://github.com/mdn/translated-content/edit/main/files/fr/mozilla/add-ons/webextensions/content_scripts/index.md" title="You're going to need to sign in to GitHub first (Opens in a new tab)" target="_blank" rel="noopener noreferrer">Edit on <b>GitHub</b></a></li><li><a href="https://github.com/mdn/translated-content/blob/main/files/fr/mozilla/add-ons/webextensions/content_scripts/index.md" title="Folder: fr/mozilla/add-ons/webextensions/content_scripts (Opens in a new tab)" target="_blank" rel="noopener noreferrer">Source on <b>GitHub</b></a></li><li><a href="https://github.com/mdn/translated-content/issues/new?body=MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Ffr%2Fdocs%2FMozilla%2FAdd-ons%2FWebExtensions%2FContent_scripts%0A%0A%23%23%23%23+What+information+was+incorrect%2C+unhelpful%2C+or+incomplete%3F%0A%0A%0A%23%23%23%23+Specific+section+or+headline%3F%0A%0A%0A%23%23%23%23+What+did+you+expect+to+see%3F%0A%0A%0A%23%23%23%23+Did+you+test+this%3F+If+so%2C+how%3F%0A%0A%0A%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EMDN+Content+page+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60fr%2Fmozilla%2Fadd-ons%2Fwebextensions%2Fcontent_scripts%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Ffr%2Fdocs%2FMozilla%2FAdd-ons%2FWebExtensions%2FContent_scripts%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Ftranslated-content%2Fblob%2Fmain%2Ffiles%2Ffr%2Fmozilla%2Fadd-ons%2Fwebextensions%2Fcontent_scripts%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Ftranslated-content%2Fcommit%2F921c46a374ab0a9f4cc809af0370f8c412e54701%0A*+Document+last+modified%3A+2022-10-01T03%3A41%3A16.000Z%0A%0A%3C%2Fdetails%3E&amp;title=Issue+with+%22Scripts+de+contenu%22%3A+%28short+summary+here+please%29&amp;labels=needs-triage%2Cl10n-fr" title="This will take you to https://github.com/mdn/content to file a new issue" target="_blank" rel="noopener noreferrer">Report a problem with this content on <b>GitHub</b></a></li><li>Want to fix the problem yourself? See<!-- --> <a href="https://github.com/mdn/content/blob/main/README.md" target="_blank" rel="noopener noreferrer">our Contribution guide</a>.</li></ul></div><p class="last-modified-date"><b>Last modified:</b> <time datetime="2022-10-01T03:41:16.000Z">Oct 1, 2022</time>,<!-- --> <a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Content_scripts/contributors.txt">by MDN contributors</a></p><form class="language-menu"><fieldset id="select-language"><legend>Change your language</legend><label for="language-selector" class="visually-hidden">Select your preferred language</label> <select id="language-selector" name="language"><option selected="" value="fr">Français</option><option value="en-US">English (US)</option><option value="ja">日本語</option><option value="ko">한국어</option><option value="ru">Русский</option><option value="zh-CN">中文 (简体)</option><option value="zh-TW">正體中文 (繁體)</option></select> <button type="submit" class="button minimal">Change language</button></fieldset></form></div></aside></main><nav id="sidebar-quicklinks" class="sidebar"><h4>Related Topics</h4><div>
  <ol>
    <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions"><strong>WebExtensions</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Démarrage</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions">Que sont les WebExtensions ?</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension">Votre première WebExtension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension">Votre deuxième WebExtension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension">Anatomie d'une WebExtension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Examples">Exemples de WebExtensions</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/What_next_">Que faire ensuite ?</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Concepts</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs">Utilisation des API JavaScript</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Content_scripts">Scripts de contenu</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Match_patterns">Motifs de correspondance (Match patterns)</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Working_with_files">Travailler avec les fichiers</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Internationalization">Internationalisation</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy">Politique de sécurité du contenu</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Native_messaging">Message natifs</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations">Differences between API implementations</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities">Incompatibilités avec Chrome</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Interface Utilisateur</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface">Introduction</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action">Bouton de la barre d'outils</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions">Bouton de la barre d'adresse</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars">Barres latérales</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items">Éléments du menu contextuel</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages">Page d'options</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages">Pages pour l'extension</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications">Notifications</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox">Suggestions de la barre d'adresse</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels">Panneaux d'outils de développement</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Mode d'emploi</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests">Intercepter les requêtes HTTP</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page">Modifier une page web</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page">Insérer un contenu externe</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts">Share objects with page scripts</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar">Ajouter un bouton à la barre d'outils</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page">Mettre en place une page de paramètres</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API">Travailler avec l'API Tabs</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API">Travailler avec l'API Bookmarks</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API">Travailler avec l'API Cookies</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities">Travailler avec des identités contextuelles</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard">Interagir avec le presse-papier</a></li>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension">Build a cross-browser extension</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators">Firefox differentiators</a></summary>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Les API JavaScript</summary>
        <ol><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs">Browser support for JavaScript APIs</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/alarms">alarms</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks">bookmarks</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/browserAction">browserAction</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/browserSettings">browserSettings</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/browsingData">browsingData</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/captivePortal">captivePortal</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/clipboard">clipboard</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/commands">commands</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts">contentScripts</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities">contextualIdentities</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/cookies">cookies</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/devtools">devtools</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/dns">dns</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/downloads">downloads</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/events">events</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/extension">extension</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes">extensionTypes</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/find">find</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/history">history</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n">i18n</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/identity">identity</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/idle">idle</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/management">management</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/menus">menus</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/notifications">notifications</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/omnibox">omnibox</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/pageAction">pageAction</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/permissions">permissions</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11">pkcs11</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/privacy">privacy</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/proxy">proxy</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime">runtime</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/search">search</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/sessions">sessions</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/sidebarAction">sidebarAction</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/storage">storage</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/tabs">tabs</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/theme">theme</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/topSites">topSites</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/types">types</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/userScripts">userScripts</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation">webNavigation</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/webRequest">webRequest</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/API/windows">windows</a></li></ol>
      </details>
    </li>
    <li class="toggle">
      <details>
      <summary>Clés de manifeste</summary>
        <ol>
          <li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json">Introduction</a></li>
        </ol>
      <ol><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author">author</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background">background</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action">browser_action</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings">browser_specific_settings</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides">chrome_settings_overrides</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides">chrome_url_overrides</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands">commands</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts">content_scripts</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy">content_security_policy</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale">default_locale</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description">description</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer">developer</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page">devtools_page</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/dictionaries">dictionaries</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/externally_connectable">externally_connectable</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url">homepage_url</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons">icons</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito">incognito</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version">manifest_version</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name">name</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/offline_enabled">offline_enabled</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox">omnibox</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions">optional_permissions</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_page">options_page</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui">options_ui</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action">page_action</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions">permissions</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers">protocol_handlers</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name">short_name</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action">sidebar_action</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/storage">storage</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme">theme</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme_experiment">theme expérimentation</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/user_scripts">user_scripts</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version">version</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name">version_name</a></li><li><a href="/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources">web_accessible_resources</a></li></ol>
      </details>
    </li>
     <li class="toggle">
      <details>
        <summary>Extension Workshop</summary>
        <ol>
          <li><a href="https://extensionworkshop.com/documentation/develop/">Develop</a></li>
          <li><a href="https://extensionworkshop.com/documentation/publish/">Publish</a></li>
          <li><a href="https://extensionworkshop.com/documentation/manage/">Manage</a></li>
          <li><a href="https://extensionworkshop.com/documentation/enterprise/">Enterprise</a></li>
        </ol>
      </details>
    </li>
    <li><a href="/fr/docs/Mozilla/Add-ons/Contact_us"><strong>Nous contacter</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Canaux de discussions</summary>
        <ol>
          <li><a href="https://blog.mozilla.org/addons">Blog extensions</a></li>
          <li><a href="https://discourse.mozilla.org/c/add-ons">Forum extensions</a></li>
          <li><a href="https://chat.mozilla.org/#/room/%23addons:mozilla.org">Add-ons chat</a></li>
        </ol>
      </details>
    </li>
  </ol>
</div></nav></div><footer id="nav-footer" class="page-footer"><div class="content-container"><div class="page-footer-logo"><a href="/fr/" class="logo" aria-label="MDN Web Docs"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451.74 135" fill="#fff"><path d="M7.14 8.35v111.06h111.05V8.35zm103.71 56c-.48.92-1 1.79-1.46 2.71a3.44 3.44 0 01-3.54 2 2.4 2.4 0 00-1.55.5c-1.37.9-2.76 1.79-4.18 2.63a7.33 7.33 0 01-6.35.34 29.71 29.71 0 00-10.63-2 11.7 11.7 0 00-9.46 4.31 14.84 14.84 0 00-2.13 4.29c-1.24 3.07-2.3 21.38-2.3 26.05 0 0-17.62-3.42-34.15-20.34l4.31-11.32h-13.5l9.76-10.35h-16.8l9.77-10.34H12.69L30.45 34a40.9 40.9 0 0119.77-10.83c7.1-1.22 8.93-.53 13.31.77l2.43.73.85.25 3.1.95a12.56 12.56 0 006.21.09 11.37 11.37 0 018.25 1 8.24 8.24 0 014.1 6.22 7.29 7.29 0 003.61 5.49 59.45 59.45 0 009.32 4.11c2.27.86 4.54 1.84 6.79 2.72a6.81 6.81 0 012.86 2.06 4.81 4.81 0 011.1 2.73c.14 2 .37 4 .47 6a15.24 15.24 0 01-1.77 8.03zM320.12 39.62a5.42 5.42 0 00-4.53 2.13 7.36 7.36 0 00-1.7 4.43v2.36a6.28 6.28 0 001.7 4.46 5.63 5.63 0 004.3 1.82 5.12 5.12 0 004.57-2.27A9.7 9.7 0 00326 47a8.11 8.11 0 00-1.67-5.52 5.36 5.36 0 00-4.21-1.86zM387.38 39.53a5.52 5.52 0 00-4.7 2.15 8.8 8.8 0 00-1.63 5.49 9.23 9.23 0 001.58 5.45 5.38 5.38 0 004.7 2.25 5.61 5.61 0 004.74-2.2 8.91 8.91 0 001.68-5.59 8.24 8.24 0 00-1.75-5.52 5.76 5.76 0 00-4.62-2.03zM299.47 41.35a4.34 4.34 0 00-4-1.92 4.55 4.55 0 00-3.89 1.73 8.37 8.37 0 00-1.58 4.17h10.48a6.3 6.3 0 00-1.01-3.98zM357.74 30.75H352v23.31h5.72q5.47 0 8.35-3t2.93-8.65q0-5.43-2.88-8.55t-8.38-3.11z"></path><path d="M121.55 8.35v70.8h323V8.35zm42.21 22.45h-4V54h3.68v3.73h-11.25V54h3.31V36.79h-.19l-9.63 19.12h-2.12l-10-19.4h-.19V54h3.45v3.73h-11.15V54h3.68V30.8h-4v-3.73H133l11.66 22.56h.19l11.18-22.56h7.7zm29.12 22.67q-4.11 4.28-11.38 4.28h-14.06v-3.69h3.73V30.75h-3.73v-3.68h13.83q7.59 0 11.66 4.29a15.4 15.4 0 014 11 15.33 15.33 0 01-4.05 11.11zm38.89-22.67h-3.68v27h-2.6L208.08 35h-.19v19h4.67v3.73h-12.22V54h3.49V30.8h-4v-3.73h7.08l16.9 22.09h.19V30.8h-4.58v-3.73h12.32zm43.8 27h-3.31l-7.83-23.18h-.19l-7.55 23.18h-3.35l-8.78-27h-2.65v-3.73H253v3.73h-3.87L255 50.71h.23l6.61-19.91H259v-3.73h11v3.73h-2.78l6.61 20.1h.23l5.43-20.1h-4.15v-3.73h11v3.73h-2.54zm26.71-1.51a9.66 9.66 0 01-6.42 2 10.2 10.2 0 01-7.41-2.74c-1.89-1.82-2.83-4.47-2.83-7.93a12.37 12.37 0 012.64-8.12 9 9 0 017.32-3.21 8.62 8.62 0 016.75 2.69 9.65 9.65 0 012.45 6.52 13.67 13.67 0 01-.28 2.69H290q.29 6.71 6.18 6.7a5.2 5.2 0 003.71-1.18 5.82 5.82 0 001.67-2.83l3.45.71a7.21 7.21 0 01-2.73 4.65zm25.77-1.63c-1.51 2.4-3.92 3.61-7.22 3.61s-5.84-1.29-7.22-3.87c0 .25-.1.82-.21 1.7s-.19 1.44-.22 1.7H309c.16-1 .31-2 .47-3.07a21.42 21.42 0 00.24-3.16v-23h-3.4v-3.3h7.55V40.9a9.76 9.76 0 012.67-3.28 7.33 7.33 0 014.74-1.4 8.48 8.48 0 016.5 2.78q2.55 2.74 2.55 7.74a14.6 14.6 0 01-2.27 7.87zm41.39-1.14q-4.11 4.28-11.37 4.28H344v-3.74h3.73V30.75H344v-3.68h13.83q7.59 0 11.66 4.29a15.41 15.41 0 014.06 11 15.34 15.34 0 01-4.11 11.11zm25.65 1.68a10.53 10.53 0 01-7.9 3.07 10 10 0 01-7.63-3 10.93 10.93 0 01-2.8-7.83 12.13 12.13 0 012.69-7.93q2.69-3.3 8-3.3t8 3.28a12 12 0 012.64 7.76 10.86 10.86 0 01-3 7.9zm22.61.57c-1.4 1.66-3.63 2.5-6.68 2.5a9.58 9.58 0 01-7.15-2.76q-2.72-2.76-2.71-7.91a12.25 12.25 0 012.69-8 9.17 9.17 0 017.5-3.28 15 15 0 013.82.48 10.37 10.37 0 013.5 1.65l.85 5.47-3.35.38-.76-3.54a8.07 8.07 0 00-4.11-1 4.9 4.9 0 00-4.39 2.15 9.93 9.93 0 00-1.41 5.55 8.9 8.9 0 001.5 5.38 5.23 5.23 0 004.44 2c2.92 0 4.67-1.7 5.23-5.1l3.5.71a10.34 10.34 0 01-2.47 5.27zm20.48.75a11.68 11.68 0 01-6.63 1.75 15.52 15.52 0 01-8.26-2.08L424 51l3.26.33-.1 2.74a7 7 0 002.06.66 12.63 12.63 0 002.19.19 8.68 8.68 0 003.66-.75 2.5 2.5 0 001.63-2.36 2.25 2.25 0 00-1.32-2.2 12.65 12.65 0 00-3.28-1 47.39 47.39 0 01-3.9-.82 7.5 7.5 0 01-3.25-1.7 4.67 4.67 0 01-1.33-3.66c0-2.36.88-4 2.62-4.91a12 12 0 015.6-1.37 15 15 0 014.08.55 16.65 16.65 0 013.47 1.39l.47 5.1-3.3.37-.48-3.3a9.5 9.5 0 00-4.06-.9 5.62 5.62 0 00-2.87.66 2.33 2.33 0 00-1.15 2.25 2.13 2.13 0 001.3 2.07 11.91 11.91 0 003.21.92 36.69 36.69 0 013.82.83 7.46 7.46 0 013.21 1.74 4.9 4.9 0 011.3 3.73 5.56 5.56 0 01-2.66 4.91z"></path><path d="M181.17 30.75h-5.71v23.31h5.71q5.47 0 8.36-3t2.88-8.61q0-5.43-2.88-8.55t-8.36-3.15zM121.63 119.32V81.74h114.91v37.58zM153.22 109h-2v-6.85a4.8 4.8 0 00-1.58-4 5.57 5.57 0 00-3.55-1.26 5 5 0 00-4.92 3.26 4.19 4.19 0 00-1.88-2.46 5.82 5.82 0 00-3-.8 4.89 4.89 0 00-4.56 2.56v-2.21h-6.28v3.26h2v8.5h-2v3.23h9.11V109h-2.86v-5.25a4.4 4.4 0 01.69-2.56 2.47 2.47 0 012.21-1q2.57 0 2.56 3.63v8.41h6.29V109h-2v-5.25a4.47 4.47 0 01.67-2.56 2.42 2.42 0 012.19-1q2.63 0 2.63 3.63v8.41h6.28zm9.88-12.07q-4 0-6 2.36a8.41 8.41 0 00-2 5.66 7.25 7.25 0 002.17 5.62 8 8 0 005.65 2 8.54 8.54 0 005.94-2.11 7.27 7.27 0 002.34-5.67 8.21 8.21 0 00-2-5.51q-2.07-2.34-6.1-2.34zm-.1 12.35a3 3 0 01-2.63-1.33 5.68 5.68 0 01-.9-3.26 5 5 0 011-3.28 3.23 3.23 0 012.61-1.18 3.5 3.5 0 012.59 1.08 4.56 4.56 0 011.07 3.31 5.21 5.21 0 01-1 3.41 3.33 3.33 0 01-2.74 1.25zm25-2.3l-3.39-.29-.7 2.32H179l8.32-9.54-.32-2.23h-13.19l-.53 5.25 3.16.34.67-2.36h4.65l-8.25 9.53.44 2.26h13.13zm7.62-9.74h-4.46v5.39h4.46zm0 9.61h-4.46v5.39h4.46zm13.54-17.49h-4.23l-6.48 22.88h4.22zm8.68 0h-4.23l-6.45 22.88h4.19zm15 22.51l-.07-2.26a1.22 1.22 0 01-.56.1c-.69 0-1-.39-1-1.16v-6.49a4.39 4.39 0 00-1.8-3.84 7 7 0 00-4.16-1.28 14.55 14.55 0 00-3.16.3 24.14 24.14 0 00-3.29 1.06l-.56 3.46 3.39.4.5-1.69a2.78 2.78 0 011.08-.37 11.3 11.3 0 011.25-.07c1.19 0 1.89.37 2.09 1.1a8.55 8.55 0 01.3 2.26v.5a8.91 8.91 0 00-1.18-.11h-1.21a12.64 12.64 0 00-4.81.88 3.53 3.53 0 00-2.18 3.64 3.66 3.66 0 001.48 3.33 5.63 5.63 0 003.11 1 4.67 4.67 0 003-.91 6.78 6.78 0 001.8-2 3 3 0 003.33 3 5.54 5.54 0 002.66-.85zm-9.25-2.32a1.69 1.69 0 01-1.36-.52 1.81 1.81 0 01-.43-1.21 1.67 1.67 0 01.86-1.68 4.63 4.63 0 012-.42 7.69 7.69 0 011.07.07l1.06.13a3.58 3.58 0 01-1.08 2.74 3.24 3.24 0 01-2.11.89z"></path></svg></a></div><ul class="link-list-mdn"><li><a href="/fr/docs/Web">Web Technologies</a></li><li><a href="/fr/docs/Learn">Learn Web Development</a></li><li><a href="/fr/docs/MDN/About">About MDN</a></li><li><a href="/fr/docs/MDN/Feedback">Feedback</a></li></ul><ul class="link-list-moz"><li><a href="https://www.mozilla.org/about/" target="_blank" rel="noopener noreferrer">About</a></li><li><a href="https://shop.spreadshirt.com/mdn-store/" target="_blank" rel="noopener noreferrer">MDN Web Docs Store</a></li><li><a href="https://www.mozilla.org/contact/" target="_blank" rel="noopener noreferrer">Contact Us</a></li><li><a href="https://www.mozilla.org/firefox/?utm_source=developer.mozilla.org&amp;utm_campaign=footer&amp;utm_medium=referral" target="_blank" rel="noopener noreferrer">Firefox</a></li></ul><div class="social social-mdn"><h4>MDN</h4><ul><li><a class="social-icon twitter" href="https://twitter.com/mozdevnet" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on Twitter</span></a></li><li><a class="social-icon github" href="https://github.com/mdn/" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on Github</span></a></li></ul></div><div class="social social-moz"><h4>Mozilla</h4><ul><li><a class="social-icon twitter" href="https://twitter.com/mozilla" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">Mozilla on Twitter</span></a></li><li><a class="social-icon instagram" href="https://www.instagram.com/mozillagram/" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">Mozilla on Instagram</span></a></li></ul></div><p id="license" class="footer-license">© 2005-<!-- -->2022<!-- --> Mozilla and individual contributors. Content is available under<!-- --> <a href="/docs/MDN/About#Copyrights_and_licenses">these licenses</a>.</p><ul class="footer-legal"><li><a href="https://www.mozilla.org/about/legal/terms/mozilla" target="_blank" rel="noopener noreferrer">Terms</a></li><li><a href="https://www.mozilla.org/privacy/websites/" target="_blank" rel="noopener noreferrer">Privacy</a></li><li><a href="https://www.mozilla.org/privacy/websites/#cookies" target="_blank" rel="noopener noreferrer">Cookies</a></li></ul></div></footer><div class="page-overlay hidden"></div></div><script type="application/json" id="hydration">{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Scripts de contenu","mdn_url":"/fr/docs/Mozilla/Add-ons/WebExtensions/Content_scripts","locale":"fr","native":"Français","sidebarHTML":"\n  <ol>\n    <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions\"><strong>WebExtensions</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Démarrage</summary>\n        <ol>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\">Que sont les WebExtensions ?</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\">Votre première WebExtension</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\">Votre deuxième WebExtension</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\">Anatomie d'une WebExtension</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Examples\">Exemples de WebExtensions</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/What_next_\">Que faire ensuite ?</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Concepts</summary>\n        <ol>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\">Utilisation des API JavaScript</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\">Scripts de contenu</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">Motifs de correspondance (Match patterns)</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\">Travailler avec les fichiers</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Internationalization\">Internationalisation</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\">Politique de sécurité du contenu</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\">Message natifs</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\">Differences between API implementations</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\">Incompatibilités avec Chrome</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Interface Utilisateur</summary>\n        <ol>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface\">Introduction</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\">Bouton de la barre d'outils</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\">Bouton de la barre d'adresse</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\">Barres latérales</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\">Éléments du menu contextuel</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\">Page d'options</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\">Pages pour l'extension</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\">Notifications</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\">Suggestions de la barre d'adresse</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\">Panneaux d'outils de développement</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Mode d'emploi</summary>\n        <ol>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\">Intercepter les requêtes HTTP</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\">Modifier une page web</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\">Insérer un contenu externe</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">Share objects with page scripts</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\">Ajouter un bouton à la barre d'outils</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\">Mettre en place une page de paramètres</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\">Travailler avec l'API Tabs</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\">Travailler avec l'API Bookmarks</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\">Travailler avec l'API Cookies</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\">Travailler avec des identités contextuelles</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard\">Interagir avec le presse-papier</a></li>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\">Build a cross-browser extension</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\">Firefox differentiators</a></summary>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Les API JavaScript</summary>\n        <ol><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\">Browser support for JavaScript APIs</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/alarms\">alarms</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks\">bookmarks</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/browserAction\">browserAction</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/browserSettings\">browserSettings</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/browsingData\">browsingData</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/captivePortal\">captivePortal</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/clipboard\">clipboard</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/commands\">commands</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts\">contentScripts</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities\">contextualIdentities</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/cookies\">cookies</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/devtools\">devtools</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/dns\">dns</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/downloads\">downloads</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/events\">events</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/extension\">extension</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes\">extensionTypes</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/find\">find</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/history\">history</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n\">i18n</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/identity\">identity</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/idle\">idle</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/management\">management</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/menus\">menus</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/notifications\">notifications</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/omnibox\">omnibox</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/pageAction\">pageAction</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/permissions\">permissions</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11\">pkcs11</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/privacy\">privacy</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/proxy\">proxy</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime\">runtime</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/search\">search</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/sessions\">sessions</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/sidebarAction\">sidebarAction</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/storage\">storage</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/tabs\">tabs</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/theme\">theme</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/topSites\">topSites</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/types\">types</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/userScripts\">userScripts</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation\">webNavigation</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\">webRequest</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/windows\">windows</a></li></ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n      <summary>Clés de manifeste</summary>\n        <ol>\n          <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json\">Introduction</a></li>\n        </ol>\n      <ol><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author\">author</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background\">background</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action\">browser_action</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\">browser_specific_settings</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides\">chrome_settings_overrides</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides\">chrome_url_overrides</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands\">commands</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\">content_scripts</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy\">content_security_policy</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale\">default_locale</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description\">description</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer\">developer</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page\">devtools_page</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/dictionaries\">dictionaries</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/externally_connectable\">externally_connectable</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url\">homepage_url</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons\">icons</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito\">incognito</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version\">manifest_version</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name\">name</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/offline_enabled\">offline_enabled</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox\">omnibox</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions\">optional_permissions</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_page\">options_page</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\">options_ui</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action\">page_action</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\">permissions</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers\">protocol_handlers</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name\">short_name</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action\">sidebar_action</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/storage\">storage</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme\">theme</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme_experiment\">theme expérimentation</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/user_scripts\">user_scripts</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version\">version</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name\">version_name</a></li><li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources\">web_accessible_resources</a></li></ol>\n      </details>\n    </li>\n     <li class=\"toggle\">\n      <details>\n        <summary>Extension Workshop</summary>\n        <ol>\n          <li><a href=\"https://extensionworkshop.com/documentation/develop/\">Develop</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/publish/\">Publish</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/manage/\">Manage</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/enterprise/\">Enterprise</a></li>\n        </ol>\n      </details>\n    </li>\n    <li><a href=\"/fr/docs/Mozilla/Add-ons/Contact_us\"><strong>Nous contacter</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Canaux de discussions</summary>\n        <ol>\n          <li><a href=\"https://blog.mozilla.org/addons\">Blog extensions</a></li>\n          <li><a href=\"https://discourse.mozilla.org/c/add-ons\">Forum extensions</a></li>\n          <li><a href=\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\">Add-ons chat</a></li>\n        </ol>\n      </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>Un script de contenu (<em>content script</em> en anglais) est une partie de votre extension qui s’exécute dans le contexte d’une page web donnée (par opposition aux scripts d’arrière-plan qui font partie de l'extension, ou aux scripts qui font partie du site Web lui-même, tels que ceux chargés en utilisant l'élément <a href=\"/fr/docs/Web/HTML/Element/script\"><code>&lt;script&gt;</code></a>).</p>\n<p>Les <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#background_scripts\">scripts d'arrière-plan</a> peuvent accéder à l'ensemble des <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API\">API WebExtension</a> mais ils ne peuvent pas accéder directement au contenu des pages web. Aussi, si votre extension doit manipuler le contenu des pages web, vous devrez utiliser les scripts de contenu.</p>\n<p>Tout comme les scripts habituellement chargés par les pages web classiques, les scripts de contenu peuvent lire et modifier le contenu de leurs pages en utilisant les API DOM standard.</p>\n<p>Les scripts de contenu ne peuvent accéder qu'à <a href=\"#api webextensions\">un sous-ensemble des API WebExtension</a>, mais ils peuvent <a href=\"#communication_background\">communiquer avec les scripts d'arrière-plan</a> grâce à un système de messages et ainsi accéder indirectement aux API WebExtension.</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note :</strong> que les scripts de contenu sont bloqués sur les domaines suivants :</p>\n  <ul>\n    <li>accounts-static.cdn.mozilla.net</li>\n    <li>accounts.firefox.com</li>\n    <li>addons.cdn.mozilla.net</li>\n    <li>addons.mozilla.org</li>\n    <li>api.accounts.firefox.com</li>\n    <li>content.cdn.mozilla.net</li>\n    <li>content.cdn.mozilla.net</li>\n    <li>discovery.addons.mozilla.org</li>\n    <li>input.mozilla.org</li>\n    <li>install.mozilla.org</li>\n    <li>oauth.accounts.firefox.com</li>\n    <li>profile.accounts.firefox.com</li>\n    <li>support.mozilla.org</li>\n    <li>sync.services.mozilla.com</li>\n    <li>testpilot.firefox.com</li>\n  </ul>\n  <p>If you try to inject a content script into a page in these domains, it will fail and the page will log a <a href=\"/fr/docs/Web/HTTP/CSP\">CSP</a> error.</p>\n  <p>Because these restrictions include addons.mozilla.org, users may attempt to use your extension immediately after installation—only to find that it doesn't work! You may want to add an appropriate warning, or an <a href=\"https://extensionworkshop.com/documentation/develop/onboard-upboard-offboard-users/\" class=\"external\" rel=\" noopener\">onboarding page</a> to move users away from addons.mozilla.org.</p>\n</div>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note :</strong> Les valeurs ajoutées à la portée globale d'un script de contenu avec <code>var foo</code> ou <code>window.foo = \"bar\"</code> peuvent disparaître à cause du bogue <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1408996\" class=\"external\" rel=\" noopener\">1408996</a>.</p>\n</div>"}},{"type":"prose","value":{"id":"charger_des_scripts_de_contenu","title":"Charger des scripts de contenu","isH3":false,"content":"<p>Il est possible de charger un script de contenu dans une page web de trois manières différentes :</p>\n<ol>\n  <li><strong>Lors de la phase d'installation, pour les pages qui correspondent à certains motifs d'URL :</strong> en utilisant la clé <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\"><code>content_scripts</code></a> dans le fichier <code>manifest.json</code>, vous pouvez demander au navigateur de charger un script de contenu chaque fois que le navigateur charge une page dont l'URL <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">correspond à un motif donné</a>.</li>\n  <li><strong>Lors de l'exécution, pour les pages qui correspondent à certains motifs d'URL :</strong> en utilisant l'API <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts\"><code>contentScripts</code></a>, vous pouvez demander au navigateur de charger un script de contenu chaque fois que le navigateur charge une page dont l'URL <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">correspond à un motif donné</a>. Cette méthode est la version dynamique de la première méthode.</li>\n  <li><strong>Lors de l'exécution, pour certains onglets spécifiques :</strong> en utilisant la méthode <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/Tabs/executeScript\"><code>tabs.executeScript()</code></a>, vous pouvez charger un script de contenu dans un onglet spécifique quand vous le souhaitez (par exemple lorsqu'un utilisateur clique sur un <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Browser_action\">bouton d'action du navigateur</a>).</li>\n</ol>\n<p>Il n'y a qu'une seule portée globale pour chaque <em>frame</em> et pour chaque extension. Cela signifie que les variables d'un script de contenu peuvent être accédées directement par un autre script de contenu, indépendamment de la manière dont le script de contenu a été chargé.</p>\n<p>À l'aide des méthodes (1) et (2), vous ne pouvez charger des scripts que dans des pages dont les URL peuvent être représentées par un <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">motif de correspondance</a>.</p>\n<p>En utilisant la méthode (3), vous pouvez également charger des scripts dans des pages packagées avec votre extension, mais vous ne pouvez pas charger des scripts dans des pages privilégiées du navigateur (comme <a href=\"\"><code>about:debugging</code></a> ou <a href=\"\"><code>about:addons</code></a>).</p>"}},{"type":"prose","value":{"id":"environnement_des_scripts_de_contenu","title":"Environnement des scripts de contenu","isH3":false,"content":""}},{"type":"prose","value":{"id":"accès_au_dom","title":"Accès au DOM","isH3":true,"content":"<p>Les scripts de contenu peuvent accéder et modifier le DOM de la page à la manière des scripts classique. Ils peuvent également observer tout changement du DOM effectué par les scripts de la page.</p>\n<p>Cependant, les scripts de contenu reçoivent une «&nbsp;vue propre du DOM&nbsp;». Cela signifie que :</p>\n<ul>\n  <li>Les scripts de contenu ne peuvent pas accéder aux variables JavaScript définies par les scripts de la page.</li>\n  <li>Si un script de page redéfinit une propriété intrinsèque du DOM, le script de contenu verra la version originale de cette propriété et non la version redéfinie.</li>\n</ul>\n<p>Dans Firefox, ce comportement s'appelle <a href=\"https://firefox-source-docs.mozilla.org/dom/scriptSecurity/xray_vision.html\" class=\"only-in-en-us external\" title=\"Currently only available in English (US)\" rel=\" noopener\">Vision Xray (en-US)</a>.</p>\n<p>Prenons par exemple la page web suivante&nbsp;:</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html; charset=utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>page-scripts/page-script.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>Le script «&nbsp;page-script.js&nbsp;» est écrit ci-dessous&nbsp;:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// page-script.js</span>\n\n<span class=\"token comment\">// ajouter un élément au DOM</span>\n<span class=\"token keyword\">var</span> p <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"p\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\np<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">\"Ce paragraphe a été ajouté par un script de la page.\"</span><span class=\"token punctuation\">;</span>\np<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"page-script-para\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// définition d’une nouvelle propriété pour la fenêtre</span>\nwindow<span class=\"token punctuation\">.</span>toto <span class=\"token operator\">=</span> <span class=\"token string\">\"Cette variable globale a été ajoutée par un script de la page.\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// redéfinition de la fonction intégrée window.confirm()</span>\nwindow<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">confirm</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Ce script de page peut aussi redéfinir ’confirm’.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Et maintenant une extension injecte ce script de contenu dans la page&nbsp;:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\n<span class=\"token comment\">// peut accéder au DOM et le modifier</span>\n<span class=\"token keyword\">var</span> pageScriptPara <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"page-script-para\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\npageScriptPara<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ne peut pas voir les propriétés ajoutées par un script de la page</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>toto<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// non défini</span>\n\n<span class=\"token comment\">// voit la forme originale des propriétés redéfinies</span>\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Êtes-vous sûr ?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// appelle la méthode window.confirm() originale</span>\n</code></pre></div>\n<p>L'inverse est également vrai&nbsp;: les scripts de la page ne peuvent pas voir les propriétés JavaScript ajoutées par les scripts de contenu.</p>\n<p>Ceci signifie que le script de contenu peut compter sur un comportement prévisible des propriétés du DOM et n'a pas à se soucier d'un éventuel conflit entre les variables qu'il définit et celles des scripts de page.</p>\n<p>Une des conséquences pratiques de ce comportement est que les scripts de contenu n’ont accès à aucune des bibliothèques JavaScript chargées par la page. Par exemple, si la page inclut jQuery, le script de contenu ne pourra pas le voir.</p>\n<p>Si un script de contenu veut utiliser une bibliothèque JavaScript, alors la bibliothèque doit être injectée en tant que script de contenu aux côtés du script de contenu qui veut l’utiliser.</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token property\">\"content_scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"matches\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"*://*.mozilla.org/*\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"js\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"jquery.js\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"content-script.js\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect3\">\n  <p><strong>Note :</strong> Firefox <em>fournis</em> certaines API qui permettent aux scripts de contenu d'accéder aux objets JavaScript créés par les scripts de page et d'exposer leurs propres objets JavaScript aux scripts de page.</p>\n  <p>Voir <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">Partage d'objets avec des scripts de page</a> pour plus de détails.</p>\n</div>"}},{"type":"prose","value":{"id":"les_api_webextension_accessibles","title":"Les API WebExtension accessibles","isH3":true,"content":"<p>En plus des API standard du DOM, les scripts de contenu peuvent utiliser les API WebExtension suivantes&nbsp;:</p>\n<p>Depuis l'API <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/extension\"><code>extension</code></a>&nbsp;:</p>\n<ul>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/extension#geturl()\"><code>getURL()</code></a></li>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/extension#inincognitocontext\"><code>inIncognitoContext</code></a></li>\n</ul>\n<p>Depuis l'API <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime\"><code>runtime</code></a>&nbsp;:</p>\n<ul>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#connect()\"><code>connect()</code></a></li>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#getmanifest()\"><code>getManifest()</code></a></li>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#geturl()\"><code>getURL()</code></a></li>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#onconnect\"><code>onConnect</code></a></li>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#onmessage\"><code>onMessage</code></a></li>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#sendmessage()\"><code>sendMessage()</code></a></li>\n</ul>\n<p>Depuis l'API <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n\"><code>i18n</code></a>&nbsp;:</p>\n<ul>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getMessagee\"><code>getMessage()</code></a></li>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getAcceptLanguages\"><code>getAcceptLanguages()</code></a></li>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n/getUILanguage\"><code>getUILanguage()</code></a></li>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/i18n/detectLanguage\"><code>detectLanguage()</code></a></li>\n</ul>\n<p>A partir des <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/menus\"><code>menus</code></a>:</p>\n<ul>\n  <li><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/menus/getTargetElement\"><code>getTargetElement</code></a></li>\n</ul>\n<p>L'ensemble des propriétés et méthodes de l'API <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/storage\"><code>storage</code></a>.</p>"}},{"type":"prose","value":{"id":"xhr_et_fetch","title":"XHR et Fetch","isH3":true,"content":"<p>Les scripts de contenu peuvent effectuer des requêtes en utilisant les API classiques <a href=\"/fr/docs/Web/API/XMLHttpRequest\"><code>window.XMLHttpRequest</code></a> et <a href=\"/fr/docs/Web/API/Fetch_API\"><code>window.fetch()</code></a>.</p>\n<p>Les scripts de contenu obtiennent les mêmes privilèges interdomaines que le reste de l'extension : si l'extension a demandé un accès interdomaine pour un domaine à l'aide de la clé <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\"><code>permissions</code></a> dans le fichier <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/manifest.json\"><code>manifest.json</code></a>, ses scripts de contenu auront également accès à ce domaine.</p>\n<p>Ceci est accompli en exposant des instances XHR et <em>fetch</em> privilégiées dans le script de contenu. Cela a pour effet secondaire de ne pas définir les en-têtes <a href=\"/fr/docs/Web/HTTP/Headers/Origin\"><code>Origin</code></a> et <a href=\"/fr/docs/Web/HTTP/Headers/Referer\"><code>Referer</code></a> tels que la page elle-même l'aurait fait. Cela est souvent préférable afin d'éviter que la requête révèle la différence d'origine. À partir de Firefox 58, les extensions qui doivent exécuter des requêtes se comportant comme si elles étaient envoyées par le contenu lui-même peuvent utiliser <code>content.XMLHttpRequest</code> et <code>content.fetch()</code>. Pour les extensions visant une compatibilité entre les navigateurs, il est nécessaire de vérifier la présence de ces API avant de les utiliser.</p>"}},{"type":"prose","value":{"id":"communication_avec_les_scripts_darrière-plan","title":"Communication avec les scripts d'arrière-plan","isH3":false,"content":"<p>Bien que les scripts de contenu ne puissent pas utiliser la totalité des API WebExtension, ils peuvent communiquer avec les scripts d'arrière-plan de l'extension via l'API de messagerie et ont donc indirectement accès aux mêmes API que ces derniers.</p>\n<p>Par défault, il existe deux moyens de communication entre les scripts d'arrière-plan et les scripts de contenu&nbsp;: vous pouvez envoyer des messages un par un, avec des réponses optionelles, ou vous pouvez établir une connexion continue entre les scripts, et utiliser cette connexion pour échanger des messages.</p>"}},{"type":"prose","value":{"id":"un_message_à_la_fois","title":"Un message à la fois","isH3":true,"content":"<p>Pour envoyer un message à la fois, vous pouvez utiliser les API suivantes :</p>\n<table class=\"standard-table\">\n  <thead>\n    <tr>\n      <th scope=\"row\"></th>\n      <th scope=\"col\">Dans le script de contenu</th>\n      <th scope=\"col\">Dans les scripts d'arrière-plan</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th scope=\"row\">Envoyer un message</th>\n      <td><code><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#sendmessage()\">browser.runtime.sendMessage()</a></code></td>\n      <td><code><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/Tabs/sendMessage\">browser.tabs.sendMessage()</a></code></td>\n    </tr>\n    <tr>\n      <th scope=\"row\">Recevoir un message</th>\n      <td><code><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\">browser.runtime.onMessage</a></code></td>\n      <td><code><a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime#onmessage\">browser.runtime.onMessage</a></code></td>\n    </tr>\n  </tbody>\n</table>\n<p>Par exemple, voici un script de contenu qui écoute les évènements de clic sur une page web. Si le clic était sur un lien, il envoie un message à la page d'arrière-plan avec l'URL cible&nbsp;:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> notifyExtension<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">notifyExtension</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>tagName <span class=\"token operator\">!=</span> <span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  browser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span><span class=\"token function\">sendMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string-property property\">\"url\"</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Le script d'arrière-plan écoute les messages et affiche une notification en utilisant l'API <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/notifications\"><code>notification</code></a> :</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// background-script.js</span>\n\nbrowser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span>onMessage<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>notify<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">notify</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  browser<span class=\"token punctuation\">.</span>notifications<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"basic\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"iconUrl\"</span><span class=\"token operator\">:</span> browser<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span><span class=\"token function\">getURL</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"link.png\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Vous avez cliqué sur un lien&amp;nbsp;!\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"message\"</span><span class=\"token operator\">:</span> message<span class=\"token punctuation\">.</span>url\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Ce code d'exemple est légèrement dérivé de l'exemple <a href=\"https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n\" class=\"external\" rel=\" noopener\">notify-link-clicks-i18n</a> sur GitHub.</p>"}},{"type":"prose","value":{"id":"les_messages_en_flux_continu","title":"Les messages en flux continu","isH3":true,"content":"<p>L'envoi de messages distincts peut vite devenir lourd si de nombreux messages sont envoyés entre les scripts d'arrière plan et les scripts de contenu.</p>\n<p>L'une des alternatives possibles est d'établir une connexion longue durée entre les deux scripts et d'utiliser cette connexion afin d'échanger des messages.</p>\n<p>De chaque côté (contenu d'une part, arrière-plan d'autre part), les scripts possèdent un objet <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port\"><code>runtime.Port</code></a> dont ils peuvent se servir pour échanger des messages.</p>\n<p>Pour créer la connexion&nbsp;:</p>\n<ul>\n  <li>L'un des côtés se tient à l'écoute des connexions avec <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnect\"><code>runtime.onConnect</code></a>.</li>\n  <li>L'autre côté appelle <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/tabs/connect\"><code>tabs.connect()</code></a> (pour se connecter à un script de contenu) ou <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/connect\"><code>runtime.connect()</code></a> (pour se connecter à un script d'arrière plan). Ces deux méthodes renvoient un objet <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port\"><code>runtime.Port</code></a>.</li>\n  <li>Le gestionnaire d'évènement <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnect\"><code>runtime.onConnect</code></a> reçoit alors en argument un objet <a href=\"/fr/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port\"><code>runtime.Port</code></a> qui lui est propre.</li>\n</ul>\n<p>Une fois que chaque côté possède son propre port, ils peuvent échanger en utilisant <code>runtime.Port.postMessage()</code> pour envoyer des message et <code>runtime.Port.onMessage</code> pour en recevoir.</p>\n<p>Par exemple, dès le chargement, ce script de contenu&nbsp;:</p>\n<ul>\n  <li>se connecte au script d'arrière plan et stocke l'objet <code>Port</code> dans une variable <code>myPort</code></li>\n  <li>écoute des messages sur <code>myPort</code>, et les enregistre.</li>\n  <li>envoie des messages au script d'arrière plan via <code>myPort</code>, quand l'utlisateur clique sur le document.</li>\n</ul>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\n<span class=\"token keyword\">var</span> myPort <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span><span class=\"token string\">\"port-from-cs\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmyPort<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">greeting</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ici le script de contenu\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmyPort<span class=\"token punctuation\">.</span>onMessage<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">m</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Dans le script de contenu, réception d'un message du script d'arrière-plan\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">.</span>greeting<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ndocument<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  myPort<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">greeting</span><span class=\"token operator\">:</span> <span class=\"token string\">\"clic sur la page&amp;nbsp;!\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Le script d'arrière plan qui correspond ·</p>\n<ul>\n  <li>Écoute les tentatives de connexion depuis le script de contenu.</li>\n  <li>Quand il reçoit une tentative de connexion&nbsp;:\n    <ul>\n      <li>Enregistre le port dans une variable nommée <code>portFromCS</code></li>\n      <li>Envoie un message au script de contenu en utilisant le port</li>\n      <li>Commence à écouter les messages reçus sur le port et les enregistre.</li>\n    </ul>\n  </li>\n  <li>Envoie des messages au script de contenu en utilisant <code>portFromCS</code>, quand l'utilisateur clique sur l'action navigateur de l'add-on</li>\n</ul>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// background-script.js</span>\n\n<span class=\"token keyword\">var</span> portFromCS<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">connected</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  portFromCS <span class=\"token operator\">=</span> p<span class=\"token punctuation\">;</span>\n  portFromCS<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">greeting</span><span class=\"token operator\">:</span> <span class=\"token string\">\"salut, script de contenu&amp;nbsp;!\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  portFromCS<span class=\"token punctuation\">.</span>onMessage<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">m</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Dans le script d'arrière-plan, réception d'un message du script de contenu.\"</span><span class=\"token punctuation\">)</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">.</span>greeting<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nbrowser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span>onConnect<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>connected<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nbrowser<span class=\"token punctuation\">.</span>browserAction<span class=\"token punctuation\">.</span>onClicked<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  portFromCS<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">greeting</span><span class=\"token operator\">:</span> <span class=\"token string\">\"clic sur le bouton&amp;nbsp;!\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h4 id=\"scripts_de_contenu_multiples\">Scripts de contenu multiples</h4>\n<p>Si plusieurs scripts de contenu communiquent en même temps, vous pouvez stocker chaque connexion dans un tableau.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// background-script.js</span>\n\n<span class=\"token keyword\">var</span> ports <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">connected</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  ports<span class=\"token punctuation\">[</span>p<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">.</span>tab<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> p<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//...</span>\n<span class=\"token punctuation\">}</span>\n\nbrowser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span>onConnect<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>connected<span class=\"token punctuation\">)</span>\n\nbrowser<span class=\"token punctuation\">.</span>browserAction<span class=\"token punctuation\">.</span>onClicked<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  ports<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      p<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">greeting</span><span class=\"token operator\">:</span> <span class=\"token string\">\"clic sur le bouton !\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"communiquer_avec_la_page_web","title":"Communiquer avec la page web","isH3":false,"content":"<p>Bien que les scripts de contenu ne puissent (par défaut) accéder aux objets créés par les scripts de page, ils peuvent cependant communiquer avec les scripts de page en utilisant les API <a href=\"/fr/docs/Web/API/Window/postMessage\"><code>window.postMessage</code></a> et <a href=\"/fr/docs/Web/API/EventTarget/addEventListener\"><code>window.addEventListener</code></a> du DOM.</p>\n<p>Par exemple&nbsp;:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// page-script.js</span>\n\n<span class=\"token keyword\">var</span> messenger <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"from-page-script\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmessenger<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> messageContentScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">messageContentScript</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">direction</span><span class=\"token operator\">:</span> <span class=\"token string\">\"from-page-script\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Message de la page\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>source <span class=\"token operator\">==</span> window <span class=\"token operator\">&amp;&amp;</span>\n      event<span class=\"token punctuation\">.</span>data <span class=\"token operator\">&amp;&amp;</span>\n      event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>direction <span class=\"token operator\">==</span> <span class=\"token string\">\"from-page-script\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Le script de contenu a reçu ce message&amp;nbsp;: \\\"\"</span> <span class=\"token operator\">+</span> event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>message <span class=\"token operator\">+</span> <span class=\"token string\">\"\\\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Pour un exemple complet et fonctionnel, <a href=\"https://mdn.github.io/webextensions-examples/content-script-page-script-messaging.html\" class=\"external\" rel=\" noopener\">visitez la page de démo sur Github</a> et suivez les instructions.</p>\n<div class=\"notecard warning\" id=\"sect4\">\n  <p><strong>Attention :</strong> Notez que vous devez être très prudent lorsque vous interagissez avec du contenu Web non fiable de cette manière. Les extensions sont du code privilégié qui peut avoir de puissantes capacités et les pages Web hostiles peuvent facilement les amener à accéder à ces capacités.</p>\n  <p>Pour donner un exemple trivial, supposons que le code du script de contenu qui reçoit le message ressemble à ceci&nbsp;:</p>\n  <div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>source <span class=\"token operator\">==</span> window <span class=\"token operator\">&amp;&amp;</span>\n      event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>direction <span class=\"token operator\">&amp;&amp;</span>\n      event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>direction <span class=\"token operator\">==</span> <span class=\"token string\">\"from-page-script\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n  <p>Maintenant, le script de page peut exécuter n'importe quel code avec tous les privilèges du script de contenu.</p>\n</div>"}},{"type":"prose","value":{"id":"utilisation_de_eval_dans_les_scripts_de_contenu","title":"Utilisation de <code>eval()</code> dans les scripts de contenu","isH3":false,"content":"<p>Dans Chrome, <a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/eval\"><code>eval()</code></a> exécute toujours le code dans le contexte du script de contenu et pas dans le contexte de la page.</p>\n<p>Dans Firefox&nbsp;:</p>\n<ul>\n  <li>Si vous appelez <code>eval()</code>, le code est exécuté dans le contexte du <strong>script de contenu</strong></li>\n  <li>Si vous appelez <code>window.eval()</code>, le code est exécute dans le contexte de la <strong>page</strong>.</li>\n</ul>\n<p>Par exemple, considérons un script de contenu comme ceci &nbsp;:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string\">'window.x = 1;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string\">'window.y = 2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Dans le script de contenu, window.x: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>window<span class=\"token punctuation\">.</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Dans le script de contenu, window.y: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>window<span class=\"token punctuation\">.</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">\"check\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Ce code crée simplement des variables x et y en utilisant <code>window.eval()</code> et <code>eval()</code> puis enregistre leurs valeurs et envoie un message à la page.</p>\n<p>À la réception du message, le script de page enregistre les mêmes variables :</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>source <span class=\"token operator\">===</span> window <span class=\"token operator\">&amp;&amp;</span> event<span class=\"token punctuation\">.</span>data <span class=\"token operator\">&amp;&amp;</span> event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>message <span class=\"token operator\">===</span> <span class=\"token string\">\"check\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Dans le script de la page, window.x: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>window<span class=\"token punctuation\">.</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Dans le script de la page, window.y: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>window<span class=\"token punctuation\">.</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Dans Chrome, cela produira le résultat suivant :</p>\n<pre class=\"notranslate\">Dans le script de contenu, window.x: 1\nDans le script de contenu, window.y: 2\nDans le script de la page, window.x: undefined\nDans le script de la page, window.y: undefined\n</pre>\n<p>Dans Firefox, on aura le résultat suivant :</p>\n<pre class=\"notranslate\">Dans le script de contenu, window.x: undefined\nDans le script de contenu, window.y: 2\nDans le script de la page, window.x: 1\nDans le script de la page, window.y: undefined\n</pre>\n<p>La même chose s'applique pour <a href=\"/fr/docs/Web/API/setTimeout\"><code>setTimeout()</code></a>, <a href=\"/en-US/docs/Web/API/setInterval\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">setInterval() (en-US)</a>, et <a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/Function\"><code>Function()</code></a>.</p>\n<div class=\"notecard warning\" id=\"sect5\">\n  <p><strong>Attention :</strong> Lorsque vous exécutez du code dans le contexte de la page, l'avertissement précédent reste nécessaire : l'environnement de la page est contrôlé par des pages web potentiellement malveillantes qui peuvent redéfinir les objets avec lesquels vous interagissez&nbsp;:</p>\n  <div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// page.js redéfinit console.log</span>\n\n<span class=\"token keyword\">var</span> original <span class=\"token operator\">=</span> console<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">log</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">original</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n  <div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// content-script.js appelle la version redéfinie</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string\">'console.log(false)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n</div>","titleAsText":"Utilisation de eval() dans les scripts de contenu"}}],"toc":[{"text":"Charger des scripts de contenu","id":"charger_des_scripts_de_contenu"},{"text":"Environnement des scripts de contenu","id":"environnement_des_scripts_de_contenu"},{"text":"Communication avec les scripts d'arrière-plan","id":"communication_avec_les_scripts_darrière-plan"},{"text":"Communiquer avec la page web","id":"communiquer_avec_la_page_web"},{"text":"Utilisation de <code>eval()</code> dans les scripts de contenu","id":"utilisation_de_eval_dans_les_scripts_de_contenu"}],"summary":"Un script de contenu (content script en anglais) est une partie de votre extension qui s’exécute dans le contexte d’une page web donnée (par opposition aux scripts d’arrière-plan qui font partie de l'extension, ou aux scripts qui font partie du site Web lui-même, tels que ceux chargés en utilisant l'élément <script>).","popularity":0.0002,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Content scripts","locale":"en-US","native":"English (US)"},{"title":"コンテンツスクリプト","locale":"ja","native":"日本語"},{"title":"Content scripts","locale":"ko","native":"한국어"},{"title":"Встраиваемый скрипт","locale":"ru","native":"Русский"},{"title":"Content scripts","locale":"zh-CN","native":"中文 (简体)"},{"title":"內容腳本","locale":"zh-TW","native":"正體中文 (繁體)"}],"source":{"folder":"fr/mozilla/add-ons/webextensions/content_scripts","github_url":"https://github.com/mdn/translated-content/blob/main/files/fr/mozilla/add-ons/webextensions/content_scripts/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/fr/docs/Mozilla","title":"Mozilla"},{"uri":"/fr/docs/Mozilla/Add-ons","title":"Modules"},{"uri":"/fr/docs/Mozilla/Add-ons/WebExtensions","title":"WebExtensions"},{"uri":"/fr/docs/Mozilla/Add-ons/WebExtensions/Content_scripts","title":"Scripts de contenu"}],"pageTitle":"Scripts de contenu - Mozilla | MDN","noIndexing":false}}</script></body></html>