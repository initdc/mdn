{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"IDBRequest.transaction","mdn_url":"/fr/docs/Web/API/IDBRequest/transaction","locale":"fr","native":"Français","sidebarHTML":"<ol><li><strong><a href=\"/fr/docs/Web/API/IndexedDB_API\">IndexedDB API</a></strong></li><li><strong><a href=\"/fr/docs/Web/API/IDBRequest\"><code>IDBRequest</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Propriétés</summary><ol><li><a href=\"/fr/docs/Web/API/IDBRequest/error\"><code>error</code></a></li><li><a href=\"/fr/docs/Web/API/IDBRequest/readyState\"><code>readyState</code></a></li><li><a href=\"/fr/docs/Web/API/IDBRequest/result\"><code>result</code></a></li><li><a href=\"/fr/docs/Web/API/IDBRequest/source\"><code>source</code></a></li><li><em><code>transaction</code></em></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Événements</summary><ol><li><a href=\"/fr/docs/Web/API/IDBRequest/error_event\"><code>error</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Héritage&nbsp;:</summary><ol><li><a href=\"/fr/docs/Web/API/EventTarget\"><code>EventTarget</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Pages liées à IndexedDB</summary><ol><li><a href=\"/fr/docs/Web/API/IDBCursor\"><code>IDBCursor</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBCursorWithValue\"><code>IDBCursorWithValue</code> <small>(en-US)</small></a></li><li><a href=\"/fr/docs/Web/API/IDBDatabase\"><code>IDBDatabase</code></a></li><li><a href=\"/fr/docs/Web/API/IDBFactory\"><code>IDBFactory</code></a></li><li><a href=\"/fr/docs/Web/API/IDBIndex\"><code>IDBIndex</code></a></li><li><a href=\"/fr/docs/Web/API/IDBKeyRange\"><code>IDBKeyRange</code></a></li><li><a href=\"/fr/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a></li><li><a href=\"/fr/docs/Web/API/IDBOpenDBRequest\"><code>IDBOpenDBRequest</code></a></li><li><a href=\"/fr/docs/Web/API/IDBTransaction\"><code>IDBTransaction</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBVersionChangeEvent\"><code>IDBVersionChangeEvent</code> <small>(en-US)</small></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>La propriété <strong><code>transaction</code></strong> de l'interface IDBRequest renvoie la <a href=\"/fr/docs/Web/API/IDBTransaction\" title=\"transaction\"><code>transaction</code></a> dans laquelle on fait la requête.La propriètè peut renvoiyer <code>null</code> si requête se fait sans transaction, comme un objet IDBRequest renvoyé par <a href=\"/fr/docs/Web/API/IDBFactory/open\"><code>IDBFactory.open</code></a> dans ce cas on est juste connecté à la base de données.</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note :</strong> Durant la gestion d'un événement <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBOpenDBRequest/upgradeneeded_event\"><code>upgradeneeded</code> <small>(en-US)</small></a> qui met à jour la version de la base de données, la propriété <strong><code>transaction</code></strong> doit être une <a href=\"/fr/docs/Web/API/IDBTransaction\" title=\"transaction\"><code>transaction</code></a> ouverte en <a href=\"/fr/docs/Web/API/IDBTransaction/mode\" title=\"mode\"><code>mode</code></a> <code>\"versionchange\"</code>, on peut alors accéder aux <a href=\"/fr/docs/Web/API/IDBObjectStore\" title=\"magasins d'objets\"><code>magasins d'objets</code></a> et <a href=\"/fr/docs/Web/API/IDBIndex\" title=\"index\"><code>index</code></a> ou annulé la mise à niveau. Après quoi, la propriété <strong><code>transaction</code></strong> renverra encore <code>null</code>.</p>\n</div><div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note:</strong> Cette fonctionnalité est disponible via les <a href=\"/fr/docs/Web/API/Web_Workers_API\">Web Workers</a></p>\n</div>"}},{"type":"prose","value":{"id":"syntaxe","title":"Syntaxe","isH3":false,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> myTransaction <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>transaction<span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"valeur","title":"Valeur","isH3":true,"content":"<p>Une <a href=\"/fr/docs/Web/API/IDBTransaction\" title=\"transaction\"><code>transaction</code></a>.</p>"}},{"type":"prose","value":{"id":"exemple","title":"Exemple","isH3":false,"content":"<p>L'exemple suivant demande un titre d'enregistrement donné, <code>onsuccess</code> obtient l'enregistrement associé du <a href=\"/fr/docs/Web/API/IDBObjectStore\" title=\"magasin d'objects\"><code>magasin d'objects</code></a> (mis à disposition en tant que <code>objectStoreTitleRequest.result</code>), on met à jour une propriété de l'enregistrement, puis le sauve dans le magasin d'objects. La <a href=\"/fr/docs/Web/API/IDBTransaction\" title=\"transaction\"><code>transaction</code></a> à l'origine de la deuxième <a class=\"page-not-created\" title=\"Cette documentation n'a pas encore été rédigée, vous pouvez aider en contribuant&nbsp;!\"><code>requête</code></a> est affichée sur la console du développeur (Ps, les deux requêtes proviennent de la même transaction). En bas est une fonction onerror qui affiche le code d'erreur si la requête échoue. Pour un exemple de travail complet, voir notre <a href=\"https://github.com/mdn/to-do-notifications/\" class=\"external\" rel=\" noopener\">To-do Notifications</a> app (<a href=\"https://mdn.github.io/to-do-notifications/\" class=\"external\" rel=\" noopener\">view example live</a>).</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> title <span class=\"token operator\">=</span> <span class=\"token string\">\"Walk dog\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Ouvrez une transaction comme d'habitude</span>\n<span class=\"token keyword\">var</span> objectStore <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'toDoList'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"readwrite\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">objectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">'toDoList'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Obtenez l'objet toDoList qui a ce titre</span>\n<span class=\"token keyword\">var</span> objectStoreTitleRequest <span class=\"token operator\">=</span> objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nobjectStoreTitleRequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Prenez l'objet de données renvoyé comme résultat</span>\n  <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> objectStoreTitleRequest<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Mettre à jour la valeur notified de l'objet à \"yes\"</span>\n  data<span class=\"token punctuation\">.</span>notified <span class=\"token operator\">=</span> <span class=\"token string\">\"yes\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Créer une autre requête qui insère le nouvelle élément dans la base de données</span>\n  <span class=\"token keyword\">var</span> updateTitleRequest <span class=\"token operator\">=</span> objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Affiche la transaction à l'origine de la deuxième requête</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" la transaction à l'origine de ces requêtes est \"</span> <span class=\"token operator\">+</span> updateTitleRequest<span class=\"token punctuation\">.</span>transaction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Lorsque cette requête réussit, appelle de la fonction displayData() pour mettre à jour l'affichage</span>\n  updateTitleRequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">displayData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nobjectStoreTitleRequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Si une erreur pendant la requête, on l'affiche</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Il y a eu une erreur dans la récupération des données: \"</span> <span class=\"token operator\">+</span> objectStoreTitleRequest<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Cet exemple montre comment la propriété <strong><code>transaction</code></strong> peut être utilisé pendant une mise à niveau de version pour accéder à des <a href=\"/fr/docs/Web/API/IDBObjectStore\" title=\"magasins d'objects\"><code>magasins d'objects</code></a> existants:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> openRequest <span class=\"token operator\">=</span> indexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'db'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>openRequest<span class=\"token punctuation\">.</span>transaction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Affiche \"null\".</span>\n\nopenRequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onupgradeneeded</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>openRequest<span class=\"token punctuation\">.</span>transaction<span class=\"token punctuation\">.</span>mode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Affiche \"versionchange\".</span>\n  <span class=\"token keyword\">var</span> db <span class=\"token operator\">=</span> openRequest<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>oldVersion <span class=\"token operator\">&lt;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Nouvelle base de données, créer un magasin d'objets \"livres\".</span>\n    db<span class=\"token punctuation\">.</span><span class=\"token function\">createObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">'books'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>oldVersion <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Mise à niveau de la base de données v1: ajoute un index sur \"title\" pour stocker les livres.</span>\n    <span class=\"token keyword\">var</span> bookStore <span class=\"token operator\">=</span> openRequest<span class=\"token punctuation\">.</span>transaction<span class=\"token punctuation\">.</span><span class=\"token function\">objectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">'books'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    bookStore<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">'by_title'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'title'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nopenRequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>openRequest<span class=\"token punctuation\">.</span>transaction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Affiche \"null\".</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Spécifications","id":"spécifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/IndexedDB/#ref-for-dom-idbrequest-transaction①","title":"Indexed Database API 3.0"}],"query":"api.IDBRequest.transaction"}},{"type":"browser_compatibility","value":{"title":"Compatibilité des navigateurs","id":"compatibilité_des_navigateurs","isH3":false,"query":"api.IDBRequest.transaction","dataURL":"/fr/docs/Web/API/IDBRequest/transaction/bcd.json"}},{"type":"prose","value":{"id":"voir_aussi","title":"Voir aussi","isH3":false,"content":"<ul>\n  <li><a href=\"/fr/docs/Web/API/IndexedDB_API/Using_IndexedDB\">Using IndexedDB</a></li>\n  <li>Starting transactions: <a href=\"/fr/docs/Web/API/IDBDatabase\"><code>IDBDatabase</code></a></li>\n  <li>Using transactions: <a href=\"/fr/docs/Web/API/IDBTransaction\"><code>IDBTransaction</code></a></li>\n  <li>Setting a range of keys: <a href=\"/fr/docs/Web/API/IDBKeyRange\"><code>IDBKeyRange</code></a></li>\n  <li>Retrieving and making changes to your data: <a href=\"/fr/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a></li>\n  <li>Using cursors: <a href=\"/fr/docs/Web/API/IDBCursor\"><code>IDBCursor</code></a></li>\n  <li>Reference example: <a href=\"https://github.com/mdn/to-do-notifications/tree/gh-pages\" class=\"external\" rel=\" noopener\">To-do Notifications</a> (<a href=\"https://mdn.github.io/to-do-notifications/\" class=\"external\" rel=\" noopener\">view example live</a>.)</li>\n</ul>"}}],"toc":[{"text":"Syntaxe","id":"syntaxe"},{"text":"Exemple","id":"exemple"},{"text":"Spécifications","id":"spécifications"},{"text":"Compatibilité des navigateurs","id":"compatibilité_des_navigateurs"},{"text":"Voir aussi","id":"voir_aussi"}],"summary":"La propriété transaction de l'interface IDBRequest renvoie la transaction dans laquelle on fait la requête.La propriètè peut renvoiyer null si requête se fait sans transaction, comme un objet IDBRequest renvoyé par IDBFactory.open dans ce cas on est juste connecté à la base de données.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"IDBRequest.transaction","locale":"en-US","native":"English (US)"}],"source":{"folder":"fr/web/api/idbrequest/transaction","github_url":"https://github.com/mdn/translated-content/blob/main/files/fr/web/api/idbrequest/transaction/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/fr/docs/Web","title":"Technologies web pour développeurs"},{"uri":"/fr/docs/Web/API","title":"Référence Web API"},{"uri":"/fr/docs/Web/API/IDBRequest","title":"IDBRequest"},{"uri":"/fr/docs/Web/API/IDBRequest/transaction","title":"IDBRequest.transaction"}],"pageTitle":"IDBRequest.transaction - Référence Web API | MDN","noIndexing":false}}