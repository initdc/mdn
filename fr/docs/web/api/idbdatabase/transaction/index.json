{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"IDBDatabase.transaction()","mdn_url":"/fr/docs/Web/API/IDBDatabase/transaction","locale":"fr","native":"Français","sidebarHTML":"<ol><li><strong><a href=\"/fr/docs/Web/API/IndexedDB_API\">IndexedDB API</a></strong></li><li><strong><a href=\"/fr/docs/Web/API/IDBDatabase\"><code>IDBDatabase</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Propriétés</summary><ol><li><a href=\"/fr/docs/Web/API/IDBDatabase/name\"><code>name</code></a></li><li><a href=\"/fr/docs/Web/API/IDBDatabase/objectStoreNames\"><code>objectStoreNames</code></a></li><li><a href=\"/fr/docs/Web/API/IDBDatabase/version\"><code>version</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Méthodes</summary><ol><li><a href=\"/fr/docs/Web/API/IDBDatabase/close\"><code>close()</code></a></li><li><a href=\"/fr/docs/Web/API/IDBDatabase/createObjectStore\"><code>createObjectStore()</code></a></li><li><a href=\"/fr/docs/Web/API/IDBDatabase/deleteObjectStore\"><code>deleteObjectStore()</code></a></li><li><em><code>transaction()</code></em></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Événements</summary><ol><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBDatabase/close_event\"><code>close</code> <small>(en-US)</small></a></li><li><a href=\"/fr/docs/Web/API/IDBDatabase/versionchange_event\"><code>versionchange</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Héritage&nbsp;:</summary><ol><li><a href=\"/fr/docs/Web/API/EventTarget\"><code>EventTarget</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Pages liées à IndexedDB</summary><ol><li><a href=\"/fr/docs/Web/API/IDBCursor\"><code>IDBCursor</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBCursorWithValue\"><code>IDBCursorWithValue</code> <small>(en-US)</small></a></li><li><a href=\"/fr/docs/Web/API/IDBFactory\"><code>IDBFactory</code></a></li><li><a href=\"/fr/docs/Web/API/IDBIndex\"><code>IDBIndex</code></a></li><li><a href=\"/fr/docs/Web/API/IDBKeyRange\"><code>IDBKeyRange</code></a></li><li><a href=\"/fr/docs/Web/API/IDBObjectStore\"><code>IDBObjectStore</code></a></li><li><a href=\"/fr/docs/Web/API/IDBOpenDBRequest\"><code>IDBOpenDBRequest</code></a></li><li><a href=\"/fr/docs/Web/API/IDBRequest\"><code>IDBRequest</code></a></li><li><a href=\"/fr/docs/Web/API/IDBTransaction\"><code>IDBTransaction</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/IDBVersionChangeEvent\"><code>IDBVersionChangeEvent</code> <small>(en-US)</small></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>La méthode <strong><code>transaction</code></strong> de l'interface <a href=\"/fr/docs/Web/API/IDBDatabase\"><code>IDBDatabase</code></a> renvoie une <a href=\"/fr/docs/Web/API/IDBTransaction\" title=\"transaction\"><code>transaction</code></a> sur laquelle on peut appeler la méthode <a href=\"/fr/docs/Web/API/IDBTransaction/objectStore\"><code>IDBTransaction.objectStore</code></a> pour accéder aux magasins d'objets de la base de donnée.</p><div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> Cette fonctionnalité est disponible via les <a href=\"/fr/docs/Web/API/Web_Workers_API\">Web Workers</a></p>\n</div>"}},{"type":"prose","value":{"id":"syntaxe","title":"Syntaxe","isH3":false,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> transaction <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span>storeNames<span class=\"token punctuation\">,</span> mode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"paramètres","title":"Paramètres","isH3":false,"content":"<dl>\n  <dt id=\"storenames\">storeNames</dt>\n  <dd>\n    <p>un tableau de noms de magasins d'objets entrant dans le cadre de cette transaction. Indique seulement les magasins d'objets dont on a besoin. Si l’on n’a besoin que d’un seul magasin d'objet, on peut simplement passer son nom. Les lignes suivantes sont équivalentes :</p>\n    <div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> transaction <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'my-store-name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> transaction <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my-store-name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n    <p>Pour utiliser tous les magasins d'objets de la base de donnée, on peut appeler la methode <a href=\"/fr/docs/Web/API/IDBDatabase/objectStoreNames\"><code>IDBDatabase.objectStoreNames</code></a>:</p>\n    <div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> transaction <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>objectStoreNames<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n    <p>Passer un tableau vide lèvera une exception.</p>\n  </dd>\n  <dt id=\"mode\">mode <span class=\"badge inline optional\">Facultatif</span></dt>\n  <dd>\n    <p>Le <a class=\"page-not-created\" title=\"Cette documentation n'a pas encore été rédigée, vous pouvez aider en contribuant&nbsp;!\"><code>mode</code></a> d’<a href=\"/fr/docs/Web/API/IDBObjectStore\" title=\"accès aux magasins d'objets\"><code>accès aux magasins d'objets</code></a> à la base de données (par default <code>readonly</code>):</p>\n    <table class=\"standard-table\">\n      <thead>\n        <tr>\n          <th scope=\"col\">Valeur</th>\n          <th scope=\"col\">Explication</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td><code>readonly</code></td>\n          <td>\n            permet de prendre des objets dans les magasins d'objets, de lire les\n            index et de faire des curseurs.\n          </td>\n        </tr>\n        <tr>\n          <td><code>readwrite</code></td>\n          <td>\n            Permet en plus de que l'on peut faire en readonly, d’ajouter et mettre à\n            jour des objets dans les magasins d'objets.\n          </td>\n        </tr>\n        <tr>\n          <td><code>versionchange</code></td>\n          <td>\n            Permet toute les opérations, y compris celles qui suppriment ou ajoutent\n            des <a class=\"page-not-created\" title=\"Cette documentation n'a pas encore été rédigée, vous pouvez aider en contribuant&nbsp;!\"><code>magasins d'objets</code></a> ou\n            des <a href=\"/fr/docs/Web/API/IDBIndex\" title=\"index\"><code>index</code></a>. Ce mode met à jour le\n            numéro de version de la base de données, il se sert au début de\n            <a class=\"page-not-created\" title=\"Cette documentation n'a pas encore été rédigée, vous pouvez aider en contribuant&nbsp;!\"><code>IDBDatabase.setVersion</code></a>. Les\n            <a href=\"/fr/docs/Web/API/IDBTransaction\" title=\"transactions\"><code>transactions</code></a> dans ce\n            mode ne peuvent pas fonctionner en même temps que d'autres.\n          </td>\n        </tr>\n        <tr>\n          <td><code>readwriteflush</code></td>\n          <td>\n            <p>\n              Si vous devez vous assurer de l'efficacité d'une transaction pour une\n              raison quelconque (par exemple, vous stockez des données critiques qui\n              ne peuvent être recalculées plus tard), vous pouvez forcer\n              l’enregistrement complet sur disque avant de déclencher l’événement\n              <code>complete</code> en utilisant le mode\n              <code>readwriteflush</code> (non standard) expérimental ( voir\n              <a href=\"/fr/docs/Web/API/IDBDatabase/transaction\" aria-current=\"page\"><code>IDBDatabase.transaction</code></a> ). C'est\n              expérimental, et ne peut être utilisé que si le\n              <code>dom.indexedDB.experimental </code>pref est réglé sur\n              <code>true </code>dans <code>about:config.</code>\n            </p>\n            <div class=\"note notecard\" id=\"sect2\">\n              <p>\n                <strong>Note :</strong> Depuis Firefox 40, les transactions\n                IndexedDB diminuent en efficacité pour gagner en efficience (voir\n                <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1112702\" class=\"external\" rel=\" noopener\">bug&nbsp;1112702</a>.) Auparavant, dans une transaction en\n                <code><a href=\"#const_read_write\">readwrite</a></code> l'événement\n                complete était déclanché seulement lorsque toutes les données\n                étaient écrites sur le disque. Maintenant l'événement\n                <code>complete</code> est déclenché après que l'OS ai envoyé l'ordre\n                d'écrire les données, mais potentiellement avant qu'elles aient été\n                écrites sur le disque. L'événement <code>complete</code> peut ainsi\n                se déclancher plus rapidement qu'auparavant, cependant, il existe\n                une chance infime pour que l'ensemble de la transaction soit perdue\n                si le système d'exploitation plante ou s'il y a une perte de courant\n                avant que les données aient été écites sur le disque. Étant donné\n                que ces événements catastrophiques sont rares la plupart des\n                utilisateurs ne devraient pas avoir à s'en préoccuper davantage.\n              </p>\n            </div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <p>Pour éviter des pertes de performance, n’utilisez le mode <code>readwrite</code> que si vous avez effectivement besoin d’écrire ou de mettre à jour des données sur la base.\")}} Si on a besoin d’accéder à un magasin d'objets pour écrire ou mettre à jour des enregistrement, on utilise la sytaxe:</p>\n    <div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> transaction <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'monMagasin'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'readwrite'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"renvoie","title":"Renvoie","isH3":false,"content":"<p>Une <a href=\"/fr/docs/Web/API/IDBTransaction\" title=\"transaction\"><code>transaction</code></a>.</p>"}},{"type":"prose","value":{"id":"exceptions","title":"Exceptions","isH3":false,"content":"<dl>\n  <dt id=\"invalidstateerror\"><code>InvalidStateError</code></dt>\n  <dd>\n    <p>Cette <a href=\"/fr/docs/Web/API/DOMException\" title=\"exception\"><code>exception</code></a> est levée si la méthode <code>close()</code> a été appelée sur cette connexion à la base de donnée.</p>\n  </dd>\n  <dt id=\"notfounderror\"><code>NotFoundError</code></dt>\n  <dd>\n    <p>Cette <a href=\"/fr/docs/Web/API/DOMException\" title=\"exception\"><code>exception</code></a> est levée si un magasin d'objets indiqué dans le paramètre <code>storeNames</code> n'existe pas ou plus.</p>\n  </dd>\n  <dt id=\"typeerror\"><code>TypeError</code></dt>\n  <dd>\n    <p>Cette <a href=\"/fr/docs/Web/API/DOMException\" title=\"exception\"><code>exception</code></a> est levée si la valeur du paramètre <code>mode</code> n'est pas valide.</p>\n  </dd>\n  <dt id=\"invalidaccesserror\"><code>InvalidAccessError</code></dt>\n  <dd>\n    <p>Cette <a href=\"/fr/docs/Web/API/DOMException\" title=\"exception\"><code>exception</code></a> est levée si la liste passée à <code>storeNames</code> est vide</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"exemple","title":"Exemple","isH3":false,"content":"<p>Dans cet exemple, on ouvre simplement une connexion à la base de donnée puis une transaction sur cette connexion.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> db<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Connexion à la base de donnée</span>\n<span class=\"token keyword\">var</span> DBOpenRequest <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>indexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"toDoList\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nDBOpenRequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  note<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">+=</span> <span class=\"token string\">'&lt;li&gt;Base de donnée initialisée.&lt;/li&gt;'</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// affecte la connexion à la variable db</span>\n  db <span class=\"token operator\">=</span> DBOpenRequest<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// exécute la fonction displayData() qui affiche la liste des taches présentes dans la base de donnée</span>\n  <span class=\"token function\">displayData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ouvre une transaction en lecture/écriture prête pour l'ajout d'enregistrement.</span>\n<span class=\"token keyword\">var</span> transaction <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"toDoList\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"readwrite\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// affiche le succès de l'ouverture de la transaction</span>\ntransaction<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">oncomplete</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  note<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">+=</span> <span class=\"token string\">'&lt;li&gt;Fin de transaction: les modifications sur la base de donnée sont terminées.&lt;/li&gt;'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\ntransaction<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  note<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">+=</span> <span class=\"token string\">'&lt;li&gt;La transaction n'</span>a pas pu être initiée<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">&gt;</span>'<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// On peut maintenant accéder au magasin d'objet</span>\n<span class=\"token keyword\">var</span> objectStore <span class=\"token operator\">=</span> transaction<span class=\"token punctuation\">.</span><span class=\"token function\">objectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"toDoList\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// etc.</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect3\">\n  <p><strong>Note :</strong> Pour un exemple de travail complet, voir notre <a href=\"https://github.com/mdn/to-do-notifications/\" class=\"external\" rel=\" noopener\">To-do Notifications</a> app (<a href=\"https://mdn.github.io/to-do-notifications/\" class=\"external\" rel=\" noopener\">view example live</a>).</p>\n</div>"}},{"type":"specifications","value":{"title":"Spécifications","id":"spécifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/IndexedDB/#ref-for-dom-idbdatabase-transaction③","title":"Indexed Database API 3.0"}],"query":"api.IDBDatabase.transaction"}},{"type":"browser_compatibility","value":{"title":"Compatibilité des navigateurs","id":"compatibilité_des_navigateurs","isH3":false,"query":"api.IDBDatabase.transaction","dataURL":"/fr/docs/Web/API/IDBDatabase/transaction/bcd.json"}},{"type":"prose","value":{"id":"voir_aussi","title":"Voir aussi","isH3":false,"content":"<ul>\n  <li><a href=\"/fr/docs/Web/API/IndexedDB_API/Using_IndexedDB\" title=\"Utiliser IndexedDB\"><code>Utiliser IndexedDB</code></a></li>\n  <li><a href=\"/fr/docs/Web/API/IDBDatabase\" title=\"Débuter une connexion\"><code>Débuter une connexion</code></a></li>\n  <li><a href=\"/fr/docs/Web/API/IDBTransaction\" title=\"Utilisé les transactions\"><code>Utilisé les transactions</code></a></li>\n  <li><a href=\"/fr/docs/Web/API/IDBKeyRange\" title=\"Définir l'intervalle des clés\"><code>Définir l'intervalle des clés</code></a></li>\n  <li><a href=\"/fr/docs/Web/API/IDBObjectStore\" title=\"Accès aux magasins d'objets\"><code>Accès aux magasins d'objets</code></a></li>\n  <li><a href=\"/fr/docs/Web/API/IDBCursor\" title=\"Utiliser les curseur\"><code>Utiliser les curseur</code></a></li>\n  <li>Exemple de référence: <a href=\"https://github.com/mdn/to-do-notifications/tree/gh-pages\" class=\"external\" rel=\" noopener\">To-do Notifications</a> (<a href=\"https://mdn.github.io/to-do-notifications/\" class=\"external\" rel=\" noopener\">view example live</a>.)</li>\n</ul>"}}],"toc":[{"text":"Syntaxe","id":"syntaxe"},{"text":"Paramètres","id":"paramètres"},{"text":"Renvoie","id":"renvoie"},{"text":"Exceptions","id":"exceptions"},{"text":"Exemple","id":"exemple"},{"text":"Spécifications","id":"spécifications"},{"text":"Compatibilité des navigateurs","id":"compatibilité_des_navigateurs"},{"text":"Voir aussi","id":"voir_aussi"}],"summary":"La méthode transaction de l'interface IDBDatabase renvoie une transaction sur laquelle on peut appeler la méthode IDBTransaction.objectStore pour accéder aux magasins d'objets de la base de donnée.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"IDBDatabase.transaction()","locale":"en-US","native":"English (US)"},{"title":"IDBDatabase.transaction()","locale":"es","native":"Español"}],"source":{"folder":"fr/web/api/idbdatabase/transaction","github_url":"https://github.com/mdn/translated-content/blob/main/files/fr/web/api/idbdatabase/transaction/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/fr/docs/Web","title":"Technologies web pour développeurs"},{"uri":"/fr/docs/Web/API","title":"Référence Web API"},{"uri":"/fr/docs/Web/API/IDBDatabase","title":"IDBDatabase"},{"uri":"/fr/docs/Web/API/IDBDatabase/transaction","title":"IDBDatabase.transaction()"}],"pageTitle":"IDBDatabase.transaction() - Référence Web API | MDN","noIndexing":false}}