{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Pointer Lock API","mdn_url":"/fr/docs/Web/API/Pointer_Lock_API","locale":"fr","native":"Français","sidebarHTML":"<ol><li><strong><a href=\"/fr/docs/Web/API/Pointer_Lock_API\">Pointer Lock API</a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Propriétés</summary><ol><li><a href=\"/fr/docs/Web/API/Document/pointerLockElement\"><code>Document.pointerLockElement</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Méthodes</summary><ol><li><a href=\"/fr/docs/Web/API/Element/requestPointerLock\"><code>Element.requestPointerLock()</code></a></li><li><a href=\"/fr/docs/Web/API/Document/exitPointerLock\"><code>Document.exitPointerLock()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Événements</summary><ol><li><a href=\"/fr/docs/Web/API/Document/pointerlockchange_event\"><code>Document</code>: <code>pointerlockchange</code></a></li><li><a href=\"/fr/docs/Web/API/Document/pointerlockerror_event\"><code>Document</code>: <code>pointerlockerror</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p><strong>Pointer lock</strong> (en français <em>Verrouillage du pointeur</em>, précedement appelé mouse lock) permet d'obtenir des informations sur le déplacement de la souris à travers le temps, et ne se cantonne pas à fournir la position absolue du curseur sur l'écran. Cette interface donne accès aux données brutes de la souris, permet de verrouiller la cible des évènements à un élément unique, limiter jusqu'où le mouvement de la souris peut aller dans une direction donnée et cacher le curseur de la vue.</p>\n<p>Cette API est utile pour les applications qui ont besoin d'écouter la souris pour contrôler des mouvements ou faire pivoter des objets sur leurs axes. Les jeux 3D de type FPS (First Person Shooter), les outils de modelisation, les vidéos immersives ou encore les cartes satellites sont autant de candidats idéals. L'utilisateur peut en effet changer l'angle de vue en bougeant simplement sa souris et sans cliquer sur aucun bouton ce qui les laisse donc disponibles pour effectuer d'autres actions.</p>\n<p>Comme Pointer lock continue de déclencher des évènements même quand le curseur est en dehors des limites du navigateur ou de l'écran, les joueurs peuvent cliquer sur les boutons et déplacer le curseur de la souris sans se soucier de quitter la zone de jeu et de cliquer accidentellement sur une autre application qui changerait le focus de la souris en dehors du jeu.</p>"}},{"type":"prose","value":{"id":"concepts_de_base","title":"Concepts de base","isH3":false,"content":"<p>Pointer Lock partage des similtudes avec la <a href=\"/fr/docs/Web/API/Element/setCapture\">capture de souris</a>. La capture de souris offre un flot ininterrompu d'évènements sur un élément cible quand la souris glisse mais s'arrête quand le bouton est relaché. Pour cette raison, Pointer lock diffère de la capture de souris sur les points suivants :</p>\n<ul>\n  <li>Persistance. Pointer lock ne libère pas la souris tant qu'un appel explicite à l'API n'a pas été effectué ou que l'utilisateur n'a pas fait un mouvement spécifique.</li>\n  <li>Ne se limite pas aux bordures du navigateur ou de l'écran.</li>\n  <li>Continue de déclencher des évènements peu importe l'état des boutons de la souris.</li>\n  <li>Cache le curseur.</li>\n</ul>"}},{"type":"prose","value":{"id":"vue_densemble_des_méthodespropriétées","title":"Vue d'ensemble des méthodes/propriétées","isH3":false,"content":"<p>Cette section fournit une brève description de chaque propriété et méthode associée à la spécification de Pointer Lock.</p>"}},{"type":"prose","value":{"id":"requestpointerlock","title":"requestPointerLock()","isH3":true,"content":"<p>L'API Pointer lock, de manière similaire à l'<a href=\"/fr/docs/Web/API/Fullscreen_API\">API Fullscreen</a>, étend les les éléments DOM en ajoutant une nouvelle méthode, <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Element/requestPointerLock\"><code>requestPointerLock()</code> <small>(en-US)</small></a>. Comme le préfixe fournisseur a récemment été retiré, vous devriez utiliser la syntaxe ci-dessous, par exemple pour demander un verrouillage deu pointeur sur un élément <code>canvas</code>:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>canvas<span class=\"token punctuation\">.</span>requestPointerLock <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span>requestPointerLock <span class=\"token operator\">||</span>\n                            canvas<span class=\"token punctuation\">.</span>mozRequestPointerLock <span class=\"token operator\">||</span>\n                            canvas<span class=\"token punctuation\">.</span>webkitPointerLockElement<span class=\"token punctuation\">;</span>\n\ncanvas<span class=\"token punctuation\">.</span><span class=\"token function\">requestPointerLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"pointerlockelement_et_exitpointerlock","title":"pointerLockElement et exitPointerLock()","isH3":true,"content":"<p>L'API Pointer Lock étend également l'interface <a href=\"/fr/docs/Web/API/Document\"><code>Document</code></a>, ajoutant à la fois une nouvelle propriété et une nouvelle méthode. La propriété <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Document/pointerLockElement\"><code>pointerLockElement</code> <small>(en-US)</small></a> est utilisée pour accéder à l'élément actuellement verrouillé (s'il y en a). La méthode <a href=\"/fr/docs/Web/API/Document/exitPointerLock\" title=\"exitPointerLock()\"><code>exitPointerLock()</code></a> est utilisée pour libérer le verrou du pointeur.</p>\n<p>La propriété <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Document/pointerLockElement\"><code>pointerLockElement</code> <small>(en-US)</small></a> est utile pour déterminer si un élément est actuellement verrouillé (pour une vérification booléenne par exemple) et également pour obtenir une référence vers l'élément s'il existe.</p>\n<p>Voici un exemple d'utilisation de <code>pointerLockElement</code>:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span>pointerLockElement <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>pointerLockElement    <span class=\"token operator\">||</span>\n                              document<span class=\"token punctuation\">.</span>mozPointerLockElement <span class=\"token operator\">||</span>\n                              document<span class=\"token punctuation\">.</span>webkitPointerLockElement<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 1) Utiliser une vérification booléenne--le pointeur est-il verrouillé?</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span>document<span class=\"token punctuation\">.</span>pointerLockElement<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// pointeur verrouillé</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// pointeur non verrouillé</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 2) Accéder à l'élément verrouillé</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>pointerLockElement <span class=\"token operator\">===</span> someElement<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// someElement est l'élément sur lequel le pointeur est verrouillé</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>La méthode <a href=\"/fr/docs/Web/API/Document/exitPointerLock\"><code>Document.exitPointerLock()</code></a> est utilisée pour libérer le verrouillage du pinteur, et, comme <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Element/requestPointerLock\"><code>requestPointerLock</code> <small>(en-US)</small></a>, marche de manière asynchrone, on utilise les événements <a href=\"/en-US/docs/Web/API/Document/pointerlockchange_event\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">pointerlockchange (en-US)</a> et <a href=\"/en-US/docs/Web/API/Document/pointerlockerror_event\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">pointerlockerror (en-US)</a>, que vous verrez plus en détails ci-dessous.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span>exitPointerLock <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>exitPointerLock    <span class=\"token operator\">||</span>\n                           document<span class=\"token punctuation\">.</span>mozExitPointerLock <span class=\"token operator\">||</span>\n                           document<span class=\"token punctuation\">.</span>webkitExitPointerLock<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Essaie de déverrouiller</span>\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">exitPointerLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"événement_pointerlockchange","title":"Événement pointerlockchange","isH3":false,"content":"<p>Quand l'état de verrouillage du pointeur change — par exemple quand on appelle <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Element/requestPointerLock\"><code>requestPointerLock()</code> <small>(en-US)</small></a>, <a href=\"/fr/docs/Web/API/Document/exitPointerLock\" title=\"exitPointerLock()\"><code>exitPointerLock()</code></a>, que l'utilisateur presse la touche ECHAP, etc.—l'événement <a href=\"/en-US/docs/Web/API/Document/pointerlockchange_event\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">pointerlockchange (en-US)</a> est envoyé au <code>document</code>. C'est un simple événement qui ne contient pas de données supplémentaires.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span>pointerLockElement <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>pointerLockElement    <span class=\"token operator\">||</span>\n                              document<span class=\"token punctuation\">.</span>mozPointerLockElement <span class=\"token operator\">||</span>\n                              document<span class=\"token punctuation\">.</span>webkitPointerLockElement<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">pointerLockChange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span>document<span class=\"token punctuation\">.</span>pointerLockElement<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Verrouillé.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Non verrouillé.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pointerlockchange'</span><span class=\"token punctuation\">,</span> pointerLockChange<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mozpointerlockchange'</span><span class=\"token punctuation\">,</span> pointerLockChange<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webkitpointerlockchange'</span><span class=\"token punctuation\">,</span> pointerLockChange<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"événement_pointerlockerror","title":"Événement pointerlockerror","isH3":false,"content":"<p>Quand une erreur est causée par l'appel de <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Element/requestPointerLock\"><code>requestPointerLock()</code> <small>(en-US)</small></a> ou <a href=\"/fr/docs/Web/API/Document/exitPointerLock\" title=\"exitPointerLock()\"><code>exitPointerLock()</code></a>, l'événement <a href=\"/en-US/docs/Web/API/Document/pointerlockerror_event\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">pointerlockerror (en-US)</a> est envoyé au <code>document</code>. C'est un simple événement qui ne contient pas de données supplémentaires.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pointerlockerror'</span><span class=\"token punctuation\">,</span> lockError<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mozpointerlockerror'</span><span class=\"token punctuation\">,</span> lockError<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webkitpointerlockerror'</span><span class=\"token punctuation\">,</span> pointerLockChange<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">lockError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Pointer lock failed\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note :</strong> Jusqu'à Firefox 50, les événements ci-dessus étaient préfixés avec <code>moz</code>.</p>\n</div>"}},{"type":"prose","value":{"id":"extensions_aux_événements_de_souris","title":"Extensions aux événements de souris","isH3":false,"content":"<p>L'API Pointer lock étend l'interface <a href=\"/fr/docs/Web/API/MouseEvent\"><code>MouseEvent</code></a> normale avec les attributs de mouvement. Deux nouveaux attributs sont ajoutés aux événements de souris —<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/movementX\"><code>movementX</code> <small>(en-US)</small></a> et <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/movementY\"><code>movementY</code> <small>(en-US)</small></a>— fournissant le changement de position de la souris. Ces paramètres ont pour valeur les différences entre les valeurs des propriétés de <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/screenX\"><code>screenX</code> <small>(en-US)</small></a> / <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/screenY\"><code>screenY</code> <small>(en-US)</small></a> stockées dans les événements <a href=\"/fr/docs/Web/API/Element/mousemove_event\"><code>mousemove</code></a>, <code>eNow</code> et <code>ePrevious</code>. En d'autres termes, <code>movementX = eNow.screenX - ePrevious.screenX</code>.</p>"}},{"type":"prose","value":{"id":"état_verrouillé","title":"État verrouillé","isH3":true,"content":"<p>Quand le verrouillage du pointeur est activé, les propriétés standard <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/clientX\"><code>clientX</code> <small>(en-US)</small></a>, <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/clientY\"><code>clientY</code> <small>(en-US)</small></a>, <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/screenX\"><code>screenX</code> <small>(en-US)</small></a>, et <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/screenY\"><code>screenY</code> <small>(en-US)</small></a> sont gardées constantes, comme si la souris ne bougeait pas. Les propriétés <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/movementX\"><code>movementX</code> <small>(en-US)</small></a> et <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/movementY\"><code>movementY</code> <small>(en-US)</small></a> continuent de fournir le changement de position de la souris. Il n'y a pas de limite aux valeurs <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/movementX\"><code>movementX</code> <small>(en-US)</small></a> et <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/movementY\"><code>movementY</code> <small>(en-US)</small></a>, si la souris continue de bouger toujours dans la même direction. Le curseur de la souris n'existe pas et il ne peut pas sortir de la fenêtre ou être bloqué par un bord de l'écran.</p>"}},{"type":"prose","value":{"id":"état_déverrouillé","title":"État déverrouillé","isH3":true,"content":"<p>Les paramètres <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/movementX\"><code>movementX</code> <small>(en-US)</small></a> et <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/movementY\"><code>movementY</code> <small>(en-US)</small></a> sont disponibles quel que soit l'état de la souris, verrou ou non.</p>\n<p>Quand la souris est déverrouillée, il est possible que le curseur soit en dehors de la fenêtre et il est alors remis automatiquement à l'intérieur. Si cela arrive, <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/movementX\"><code>movementX</code> <small>(en-US)</small></a> et <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/MouseEvent/movementY\"><code>movementY</code> <small>(en-US)</small></a> sont définis à zéro.</p>"}},{"type":"prose","value":{"id":"simple_exemple_pas_à_pas","title":"Simple exemple pas à pas","isH3":false,"content":"<p>Nous avons écrit une <a href=\"https://mdn.github.io/dom-examples/pointer-lock/\" class=\"external\" rel=\" noopener\">démo de verrouillage de pointer</a> pour vous montrer comment l'utiliser pour mettre en place un système de contrôle simple (<a href=\"https://github.com/mdn/dom-examples/tree/master/pointer-lock\" class=\"external\" rel=\" noopener\">voir le code source</a>). La démo ressemble à ça:</p>\n<p>\n  <img src=\"/en-US/docs/Web/API/Pointer_Lock_API/pointer-lock.png\" alt=\"Un cercle rouge sur un arrière-plan noir.\" width=\"640\" height=\"362\" loading=\"lazy\">\n</p>\n<p>Cette démo utilise JavaScript pour dessiner une balle dans un élément <a href=\"/fr/docs/Web/HTML/Element/canvas\"><code>&lt;canvas&gt;</code></a>. Quand vous cliquez sur le canvas, le verrouillage du pointeur est utilisé pour supprimer le curseur de la souris à l'écran et vous permettre de déplacer la balle avec la souris. Voyons comment cela fonctionne.</p>\n<p>On définit les positions initiales x et y sur le canvas:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> x <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> y <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Les méthodes de verrouillage de pointeur sont préfixées dans les anciennes versions des navigateurs, on prend donc en compte les différentes implémentations des navigateurs:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>canvas<span class=\"token punctuation\">.</span>requestPointerLock <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span>requestPointerLock <span class=\"token operator\">||</span>\n                            canvas<span class=\"token punctuation\">.</span>mozRequestPointerLock <span class=\"token operator\">||</span>\n                            canvas<span class=\"token punctuation\">.</span>webkitRequestPointerLock<span class=\"token punctuation\">;</span>\n\ndocument<span class=\"token punctuation\">.</span>exitPointerLock <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>exitPointerLock <span class=\"token operator\">||</span>\n                           document<span class=\"token punctuation\">.</span>mozExitPointerLock <span class=\"token operator\">||</span>\n                           document<span class=\"token punctuation\">.</span>webkitExitPointerLock<span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Maintenant, on définit un gestionnaire d'événement qui appelle la méthode <code>requestPointerLock()</code> quand le canvas est cliqué, ce qui déclenche le verrouillage du pointeur.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>canvas<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclick</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  canvas<span class=\"token punctuation\">.</span><span class=\"token function\">requestPointerLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Et maintenant le gestionnaire d'événement pour le verrouillage: <code>pointerlockchange</code>. Quand cet événement se déclenche, on appelle <code>lockChangeAlert()</code> pour gérer le changement.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Gestionnaire d'événement de changement d'état du verrouilllage pour les différents navigateurs</span>\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pointerlockchange'</span><span class=\"token punctuation\">,</span> lockChangeAlert<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mozpointerlockchange'</span><span class=\"token punctuation\">,</span> lockChangeAlert<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webkitpointerlockchange'</span><span class=\"token punctuation\">,</span> lockChangeAlert<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>La fonction suivante vérifie si la propriété <code>pointLockElement</code> est sur notre canvas. Si c'est le cas, on attache un gestionnaire d'événement pour gérer les mouvements de la souris avec la fonction <code>updatePosition()</code>. Sinon, elle enlève le gestionnaire d'événement.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">lockChangeAlert</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>pointerLockElement <span class=\"token operator\">===</span> canvas<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'The pointer lock status is now locked'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    document<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mousemove\"</span><span class=\"token punctuation\">,</span> updatePosition<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'The pointer lock status is now unlocked'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    document<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mousemove\"</span><span class=\"token punctuation\">,</span> updatePosition<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>La fonction <code>updatePosition()</code> met à jour la position de la balle sur le canvas (les valeurs <code>x</code> et <code>y</code>), et inclut également des instructions <code>if()</code> pour vérifier si la balle est sortie des bords du canvas. Dans ce cas, la balle se ressort au bord opposé. Elle vérifie également si un appel à <a href=\"/fr/docs/Web/API/Window/requestAnimationFrame\"><code>requestAnimationFrame()</code></a> a été effectué et si ce n'est pas le cas, l'appelle pour qu'elle déclenche la fonction <code>canvasDraw()</code> et mette à jour le canvas. Un tracker est mis en place pour afficher les valeurs X et Y à l'écran, pour référence.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> tracker <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tracker'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> animation<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">updatePosition</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  x <span class=\"token operator\">+=</span> e<span class=\"token punctuation\">.</span>movementX<span class=\"token punctuation\">;</span>\n  y <span class=\"token operator\">+=</span> e<span class=\"token punctuation\">.</span>movementY<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">&gt;</span> canvas<span class=\"token punctuation\">.</span>width <span class=\"token operator\">+</span> <span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    x <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">&gt;</span> canvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">+</span> <span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    y <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">&lt;</span> <span class=\"token operator\">-</span><span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    x <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span>width <span class=\"token operator\">+</span> <span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">&lt;</span> <span class=\"token operator\">-</span><span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    y <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">+</span> <span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  tracker<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">\"X position: \"</span> <span class=\"token operator\">+</span> x <span class=\"token operator\">+</span> <span class=\"token string\">\", Y position: \"</span> <span class=\"token operator\">+</span> y<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>animation<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    animation <span class=\"token operator\">=</span> <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      animation <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">canvasDraw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>La fonction <code>canvasDraw()</code> affiche la balle aux position <code>x</code> et <code>y</code> en cours:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">canvasDraw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">\"#f00\"</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">beginPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">arc</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token constant\">RADIUS</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">degToRad</span><span class=\"token punctuation\">(</span><span class=\"token number\">360</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"iframe_limitations","title":"iframe limitations","isH3":false,"content":"<p>Le verrouilage du pointeur ne peut concerner qu'une seule iframe à la fois. Quand vous verrouillez une iframe, vous ne pouvez pas essayer de verrouiller une autre iframe et y transférer la cible; une erreur sera levée. Pour éviter cette limitation, déverrouillez d'abord la première iframe, puis verrouillez la seconde.</p>\n<p>Tandis que cela fonctionne pour les iframes par défaut, les iframes en \"sandbox\" bloquent le verrouillage. La possibilité d'éviter cette limitation, sous la forme de la combinaison attribut/valeur <code>&lt;iframe sandbox=\"allow-pointer-lock\"&gt;</code>, devrait bientôt apparaître dans Chrome.</p>"}},{"type":"specifications","value":{"title":"Spécifications","id":"spécifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/pointerlock/#dom-element-requestpointerlock","title":"Pointer Lock 2.0"}],"query":"api.Element.requestPointerLock"}},{"type":"browser_compatibility","value":{"title":"Compatibilité des navigateurs","id":"compatibilité_des_navigateurs","isH3":false,"query":"api.Element.requestPointerLock","dataURL":"/fr/docs/Web/API/Pointer_Lock_API/bcd.json"}},{"type":"prose","value":{"id":"voir_aussi","title":"Voir aussi","isH3":false,"content":"<ul>\n  <li><a href=\"/fr/docs/Web/API/MouseEvent\"><code>MouseEvent</code></a></li>\n</ul>"}}],"toc":[{"text":"Concepts de base","id":"concepts_de_base"},{"text":"Vue d'ensemble des méthodes/propriétées","id":"vue_densemble_des_méthodespropriétées"},{"text":"Événement pointerlockchange","id":"événement_pointerlockchange"},{"text":"Événement pointerlockerror","id":"événement_pointerlockerror"},{"text":"Extensions aux événements de souris","id":"extensions_aux_événements_de_souris"},{"text":"Simple exemple pas à pas","id":"simple_exemple_pas_à_pas"},{"text":"iframe limitations","id":"iframe_limitations"},{"text":"Spécifications","id":"spécifications"},{"text":"Compatibilité des navigateurs","id":"compatibilité_des_navigateurs"},{"text":"Voir aussi","id":"voir_aussi"}],"summary":"Pointer lock (en français Verrouillage du pointeur, précedement appelé mouse lock) permet d'obtenir des informations sur le déplacement de la souris à travers le temps, et ne se cantonne pas à fournir la position absolue du curseur sur l'écran. Cette interface donne accès aux données brutes de la souris, permet de verrouiller la cible des évènements à un élément unique, limiter jusqu'où le mouvement de la souris peut aller dans une direction donnée et cacher le curseur de la vue.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Pointer Lock API","locale":"en-US","native":"English (US)"},{"title":"API Pointer Lock","locale":"es","native":"Español"},{"title":"Pointer Lock API","locale":"ja","native":"日本語"},{"title":"Pointer Lock API","locale":"ru","native":"Русский"},{"title":"Pointer Lock API","locale":"zh-CN","native":"中文 (简体)"},{"title":"Pointer Lock API","locale":"zh-TW","native":"正體中文 (繁體)"}],"source":{"folder":"fr/web/api/pointer_lock_api","github_url":"https://github.com/mdn/translated-content/blob/main/files/fr/web/api/pointer_lock_api/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/fr/docs/Web","title":"Technologies web pour développeurs"},{"uri":"/fr/docs/Web/API","title":"Référence Web API"},{"uri":"/fr/docs/Web/API/Pointer_Lock_API","title":"Pointer Lock API"}],"pageTitle":"Pointer Lock API - Référence Web API | MDN","noIndexing":false}}