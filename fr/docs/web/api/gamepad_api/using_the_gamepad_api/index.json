{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Utiliser l'API Gamepad","mdn_url":"/fr/docs/Web/API/Gamepad_API/Using_the_Gamepad_API","locale":"fr","native":"Français","sidebarHTML":"<ol><li><strong><a href=\"/fr/docs/Web/API/Gamepad_API\">Gamepad API</a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Guides</summary><ol><li><a href=\"/fr/docs/Web/API/Gamepad_API/Using_the_Gamepad_API\">Using the Gamepad API</a></li><li><a href=\"/fr/docs/Games/Techniques/Controls_Gamepad_API\">Implementing controls using the Gamepad API</a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Interfaces</summary><ol><li><a href=\"/fr/docs/Web/API/Gamepad\"><code>Gamepad</code></a></li><li><a href=\"/fr/docs/Web/API/GamepadButton\"><code>GamepadButton</code></a></li><li><a href=\"/fr/docs/Web/API/GamepadEvent\"><code>GamepadEvent</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Méthodes</summary><ol><li><a href=\"/fr/docs/Web/API/Navigator/getGamepads\"><code>Navigator.getGamepads()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Événements</summary><ol><li><a href=\"/fr/docs/Web/API/Window/gamepadconnected_event\"><code>Window</code>: <code>gamepadconnected</code></a></li><li><a href=\"/fr/docs/Web/API/Window/gamepaddisconnected_event\"><code>Window</code>: <code>gamepaddisconnected</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>HTML5 a introduit de nombreuses briques technologiques qui permettent le développement de jeux interactifs. Les fonctionnalités offertes par <code>&lt;canvas&gt;</code>, WebGL, <code>&lt;audio&gt;</code>, et <code>&lt;video&gt;</code>, ainsi que les API JavaScript correspondantes, ont suffisamment gagné en maturité pour réaliser des tâches qui nécessitaient auparavant du code natif. L'API <i lang=\"en\">Gamepad</i> est un outil qui permet d'accéder et d'utiliser les manettes et autres contrôleurs de jeux.</p>\n<p>L'API <a href=\"/fr/docs/Web/API/Gamepad_API\"><i lang=\"en\">Gamepad</i></a> introduit de nouveaux évènements sur l'objet <a href=\"/fr/docs/Web/API/Window\"><code>Window</code></a> qui permettent de lire l'état de la manette. En plus de ces évènements, l'API ajoute également un objet <a href=\"/fr/docs/Web/API/Gamepad\"><code>Gamepad</code></a>, qui permet de connaître l'état d'une manette connectée et une méthode <a href=\"/fr/docs/Web/API/Navigator/getGamepads\"><code>navigator.getGamepads()</code></a> qu'on peut utiliser pour obtenir la liste des manettes connues sur la page.</p>"}},{"type":"prose","value":{"id":"connecter_une_manette","title":"Connecter une manette","isH3":false,"content":"<p>Lorsqu'une nouvelle manette est connectée à l'ordinateur, la page qui a le focus reçoit d'abord un évènement <a href=\"/fr/docs/Web/API/Window/gamepadconnected_event\"><code>gamepadconnected</code></a>. Si une manette est déjà connectée lorsque la page est chargée, l'évènement <a href=\"/fr/docs/Web/API/Window/gamepadconnected_event\"><code>gamepadconnected</code></a> est émis sur la page lorsque la personne appuie sur un bouton ou déplace un axe.</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note :</strong> Dans Firefox, les manettes sont uniquement exposées à la page après qu'il y a eu une interaction de la personne avec la page. Cela permet d'éviter à ce que les manettes soient utilisées pour créer une empreinte, de faciliter le pistage. Une fois qu'une manette a interagi avec la page, les autres manettes connectées seront automatiquement visibles.</p>\n</div>\n<p>On peut utiliser <a href=\"/fr/docs/Web/API/Window/gamepadconnected_event\"><code>gamepadconnected</code></a> comme ceci&nbsp;:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gamepadconnected\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Manette connectée à l'indice %d : %s. %d boutons, %d axes.\"</span><span class=\"token punctuation\">,</span>\n    e<span class=\"token punctuation\">.</span>gamepad<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>gamepad<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n    e<span class=\"token punctuation\">.</span>gamepad<span class=\"token punctuation\">.</span>buttons<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>gamepad<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Chaque manette dispose d'un identifiant unique qui lui est associé et qui est disponible via la propriété <a href=\"/en-US/docs/Web/API/GamepadEvent/gamepad\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">gamepad (en-US)</a> de l'évènement.</p>"}},{"type":"prose","value":{"id":"déconnecter_une_manette","title":"Déconnecter une manette","isH3":false,"content":"<p>Lorsqu'une manette est déconnectée et si la page avait déjà reçu des données pour cette manette (par exemple avec <a href=\"/fr/docs/Web/API/Window/gamepadconnected_event\"><code>gamepadconnected</code></a>), un deuxième évènement est envoyé sur la fenêtre, <a href=\"/fr/docs/Web/API/Window/gamepaddisconnected_event\"><code>gamepaddisconnected</code></a>&nbsp;:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gamepaddisconnected\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Manette déconnectée à l'indice %d : %s\"</span><span class=\"token punctuation\">,</span>\n    e<span class=\"token punctuation\">.</span>gamepad<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>gamepad<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>La propriété <a href=\"/en-US/docs/Web/API/Gamepad/index\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">index (en-US)</a> de l'objet porté par <code>gamepad</code> sera unique pour chaque appareil connecté au système, même si plusieurs manettes du même type sont utilisées. La propriété <code>index</code> fonctionne également comme l'indice qui peut être utilisé pour parcourir le tableau (<a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/Array\"><code>Array</code></a>) renvoyé par la méthode <a href=\"/fr/docs/Web/API/Navigator/getGamepads\"><code>Navigator.getGamepads()</code></a>.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> gamepads <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">gamepadHandler</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> connecting</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> gamepad <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>gamepad<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Note :</span>\n  <span class=\"token comment\">// gamepad === navigator.getGamepads()[gamepad.index]</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>connecting<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    gamepads<span class=\"token punctuation\">[</span>gamepad<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> gamepad<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">delete</span> gamepads<span class=\"token punctuation\">[</span>gamepad<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gamepadconnected\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token function\">gamepadHandler</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gamepaddisconnected\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token function\">gamepadHandler</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>L'exemple qui précède illustre également comment la propriété <code>gamepad</code> peut être retenue après la fin de l'évènement. Nous utiliserons cette technique plus tard pour faire des requêtes sur l'état de l'appareil.</p>"}},{"type":"prose","value":{"id":"utiliser_lobjet_gamepad","title":"Utiliser l'objet <code>Gamepad</code>","isH3":false,"content":"<p>Comme vous pouvez le voir, les évènements <code>gamepad</code> présentés ci-avant incluent une propriété <code>gamepad</code> rattachée à l'objet de l'évènement. Cette propriété fournit un objet <a href=\"/fr/docs/Web/API/Gamepad\"><code>Gamepad</code></a>. On peut utiliser cet objet afin de déterminer la manette qui a causé l'évènement (avec son identifiant), car plusieurs manettes pourraient être connectées simultanément. On peut faire bien plus avec cet objet <a href=\"/fr/docs/Web/API/Gamepad\"><code>Gamepad</code></a>, y compris garder une référence vers celui-ci et l'utiliser pour déterminer les boutons et axes utilisés à tout moment. Une telle utilisation est souvent nécessaire pour les jeux ou les pages interactives lorsqu'il faut connaître l'état de la manette à l'instant T et l'état dans lequel elle sera au moment du prochain évènement.</p>\n<p>Généralement, ces opérations sont effectuées en utilisant un objet <a href=\"/fr/docs/Web/API/Gamepad\"><code>Gamepad</code></a> avec une boucle d'animation (par exemple avec <a href=\"/fr/docs/Web/API/Window/requestAnimationFrame\"><code>requestAnimationFrame</code></a>), où on peut développer la logique du jeu afin de choisir quoi faire pour la <i lang=\"en\">frame</i> courante selon l'état de la (ou des) manette(s).</p>\n<p>La méthode <a href=\"/fr/docs/Web/API/Navigator/getGamepads\"><code>Navigator.getGamepads()</code></a> renvoie un tableau de l'ensemble des appareils qui sont actuellement visibles de la page web sous la forme d'objets <a href=\"/fr/docs/Web/API/Gamepad\"><code>Gamepad</code></a> (la première valeur vaut toujours <code>null</code>, et c'est <code>null</code> qui est renvoyé s'il n'y a pas de manettes connectées). On peut l'utiliser pour obtenir les mêmes informations. Ainsi, le premier exemple de code ci-avant pourrait être réécrit de la façon suivante&nbsp;:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gamepadconnected\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> gp <span class=\"token operator\">=</span> navigator<span class=\"token punctuation\">.</span><span class=\"token function\">getGamepads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>gamepad<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Manette connectée à l'indice %d : %s. %d boutons, %d axes.\"</span><span class=\"token punctuation\">,</span>\n    gp<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">,</span> gp<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n    gp<span class=\"token punctuation\">.</span>buttons<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span> gp<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Les propriétés d'un objet <a href=\"/fr/docs/Web/API/Gamepad\"><code>Gamepad</code></a> sont&nbsp;:</p>\n<dl>\n  <dt id=\"id\"><code>id</code></dt>\n  <dd>\n    <p>Une chaîne de caractères contenant des informations sur la manette. Le format n'est pas spécifié de façon stricte. Pour Firefox, ce sera trois informations séparées par des tirets (<code>-</code>)&nbsp;: deux chaînes de caractères avec 4 chiffres hexadécimaux indiquant l'éditeur du pilote USB et l'identifiant produit de la manette puis le nom de la manette fourni par le pilote. Ces informations doivent permettre de trouver la correspondance des touches de l'appareil et de fournir des retours pertinents à la personne qui utilise la manette.</p>\n  </dd>\n  <dt id=\"index\"><code>index</code></dt>\n  <dd>\n    <p>Un entier, unique pour chaque manette actuellement connectée au système. Elle peut être utilisée afin de distinguer une manette parmi plusieurs. On notera que déconnecter un appareil puis en reconnecter un nouveau pourra réutiliser un des indices précédemment utilisé.</p>\n  </dd>\n  <dt id=\"mapping\"><code>mapping</code></dt>\n  <dd>\n    <p>Une chaîne de caractères qui indique si le navigateur a adapté les contrôles de l'appareil sur une disposition connue. Il existe actuellement une seule disposition prise en charge, <a href=\"https://dvcs.w3.org/hg/gamepad/raw-file/default/gamepad.html#remapping\" class=\"external\" rel=\" noopener\">la manette standard</a>. Si le navigateur est capable de faire correspondre les contrôles de l'appareil avec cette disposition, la propriété <code>mapping</code> vaudra la chaîne de caractères <code>standard</code>.</p>\n  </dd>\n  <dt id=\"connected\"><code>connected</code></dt>\n  <dd>\n    <p>Un booléen qui indique si la manette est toujours connectée au système (<code>true</code> si c'est le cas, <code>false</code> sinon).</p>\n  </dd>\n  <dt id=\"buttons\"><code>buttons</code></dt>\n  <dd>\n    <p>Un tableau d'objets <a href=\"/en-US/docs/Web/API/GamepadButton\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">GamepadButton (en-US)</a> représentant les boutons présents sur l'appareil. Chaque objet <a href=\"/en-US/docs/Web/API/GamepadButton\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">GamepadButton (en-US)</a> aura deux propriétés, <code>pressed</code> et <code>value</code>&nbsp;:</p>\n    <dl>\n      <dt id=\"pressed\"><code>pressed</code></dt>\n      <dd>\n        <p>Un booléen qui indique si le bouton est actuellement enfoncé/appuyé (<code>true</code>) ou relâché (<code>false</code>).</p>\n      </dd>\n      <dt id=\"value\"><code>value</code></dt>\n      <dd>\n        <p>Un nombre flottant utilisée pour représenter la valeur des boutons analogiques comme les gâchettes. Les valeurs sont normalisées sur l'intervalle <code>[0.0, 1.0]</code>, avec <code>0.0</code> qui représente un bouton sur lequel il n'y a aucune pression et <code>1.0</code> qui représente un bouton complètement appuyé/enfoncé.</p>\n      </dd>\n    </dl>\n  </dd>\n  <dt id=\"axes\"><code>axes</code></dt>\n  <dd>\n    <p>Un tableau qui représente les contrôles où des axes sont présents sur l'appareil (par exemple les joysticks analogiques). Chaque élément du tableau est une valeur flottante sur l'intervalle <code>[-1.0, 1.0]</code> qui représente la position sur un axe, de la valeur la plus faible (<code>-1.0</code>), à la valeur la plus haute (<code>1.0</code>).</p>\n  </dd>\n  <dt id=\"timestamp\"><code>timestamp</code></dt>\n  <dd>\n    <p>: Un objet <a href=\"/fr/docs/Web/API/DOMHighResTimeStamp\"><code>DOMHighResTimeStamp</code></a> indiquant le dernier instant auquel les données des manettes ont été mises à jour. Cela permet de déterminer si les données fournies par <code>axes</code> et <code>button</code> ont été mises à jour par le matériel. Cette valeur doit être relative à l'attribut <code>navigationStart</code> de l'interface <a href=\"/fr/docs/Web/API/PerformanceTiming\"><code>PerformanceTiming</code></a>. Les valeurs augmentent de façon monotone, ce qui signifie qu'on peut les comparer pour déterminer l'ordre des mises à jour (les valeurs les plus récentes seront toujours supérieures aux valeurs antérieures). Cette propriété n'est actuellement pas prise en charge par Firefox.</p>\n  </dd>\n</dl>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note :</strong> L'objet <code>Gamepad</code> est disponible sur l'évènement <a href=\"/fr/docs/Web/API/Window/gamepadconnected_event\"><code>gamepadconnected</code></a> plutôt que sur l'objet <a href=\"/fr/docs/Web/API/Window\"><code>Window</code></a> pour des raisons de sécurité. Une fois qu'une référence est obtenue, on peut consulter ses propriétés pour obtenir des informations à propos de la manette. Sous le capot, cet objet est mis à jour à chaque fois que l'état de la manette change.</p>\n</div>","titleAsText":"Utiliser l'objet Gamepad"}},{"type":"prose","value":{"id":"utiliser_les_informations_des_boutons","title":"Utiliser les informations des boutons","isH3":true,"content":"<p>Prenons un exemple simple, qui affiche les informations de connexion d'une seule manette (on ignore ici les connexions des manettes qui auraient lieu après) et qui permet de déplacer une balle sur l'écran à l'aide des quatre boutons situés sur le côté droit de la manette. Vous pouvez <a href=\"https://chrisdavidmills.github.io/gamepad-buttons/\" class=\"external\" rel=\" noopener\">voir la démonstration en direct</a>, ainsi que <a href=\"https://github.com/chrisdavidmills/gamepad-buttons/tree/master\" class=\"external\" rel=\" noopener\">le code source correspondant</a> sur GitHub.</p>\n<p>Pour commencer, on déclare quelques variables&nbsp;:</p>\n<ul>\n  <li><code>gamepadInfo</code> qui correspond au paragraphe dans lequel on écrit les informations de connexion</li>\n  <li><code>ball</code> qui est la balle qu'on souhaite déplacer</li>\n  <li><code>start</code> qui est la variable utilisée comme identifiant pour <code>requestAnimationFrame()</code></li>\n  <li><code>a</code> et <code>b</code> qui serviront de modificateurs de position pour la balle</li>\n</ul>\n<p>On a également (dans le code, mais pas ici par souci de concision), des variables pour faciliter l'accès à <a href=\"/fr/docs/Web/API/Window/requestAnimationFrame\"><code>requestAnimationFrame()</code></a> et <a href=\"/fr/docs/Web/API/Window/cancelAnimationFrame\"><code>cancelAnimationFrame()</code></a> dans les différents navigateurs.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> gamepadInfo <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gamepad-info\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> ball <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ball\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> start<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> a <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> b <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Ensuite, on utilise l'évènement <a href=\"/fr/docs/Web/API/Window/gamepadconnected_event\"><code>gamepadconnected</code></a> pour vérifier si une manette est connectée. Lorsqu'une manette est connectée, on récupère l'objet correspondant avec <a href=\"/fr/docs/Web/API/Navigator/getGamepads\"><code>Navigator.getGamepads()[0]</code></a> et on affiche les informations dans l'élément <code>div</code> correspondant puis on déclenche la fonction <code>gameLoop()</code> qui démarre la procédure pour le mouvement de la balle.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gamepadconnected\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> gp <span class=\"token operator\">=</span> navigator<span class=\"token punctuation\">.</span><span class=\"token function\">getGamepads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>gamepad<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  gamepadInfo<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">\"Manette connectée à l'indice\"</span> <span class=\"token operator\">+</span> gp<span class=\"token punctuation\">.</span>index <span class=\"token operator\">+</span> <span class=\"token string\">\" : \"</span> <span class=\"token operator\">+</span> gp<span class=\"token punctuation\">.</span>id <span class=\"token operator\">+</span> <span class=\"token string\">\". Elle a \"</span> <span class=\"token operator\">+</span> gp<span class=\"token punctuation\">.</span>buttons<span class=\"token punctuation\">.</span>length <span class=\"token operator\">+</span> <span class=\"token string\">\" boutons et \"</span> <span class=\"token operator\">+</span> gp<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">.</span>length <span class=\"token operator\">+</span> <span class=\"token string\">\" axes.\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">gameLoop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>On gère également l'évènement <a href=\"/fr/docs/Web/API/Window/gamepaddisconnected_event\"><code>gamepaddisconnected</code></a> pour vérifier si la manette a été déconnectée. Si c'est le cas, on arrête la boucle <a href=\"/fr/docs/Web/API/Window/requestAnimationFrame\"><code>requestAnimationFrame()</code></a> (voir après) et on réinitialise les informations affichées sur la manette.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gamepaddisconnected\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  gamepadInfo<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">\"En attente d'une manette.\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">cancelRequestAnimationFrame</span><span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Pour Chrome, les choses sont différentes. Le navigateur ne stocke qu'un instantané de l'état de la manette et il faut donc continuellement rafraîchir l'état connu avant d'utiliser l'objet <a href=\"/fr/docs/Web/API/Gamepad\"><code>Gamepad</code></a> lorsque celui-ci devient disponible. Dans le code qui suit, on fait cela avec <a href=\"/en-US/docs/Web/API/setInterval\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">setInterval() (en-US)</a>. Une fois que l'objet est disponible, les informations sont affichées, la boucle de jeu commence et l'intervalle de répétition pour l'état de la manette est arrêté avec <a href=\"/fr/docs/Web/API/clearInterval\"><code>clearInterval</code></a>. Pour les versions les plus anciennes de Chrome, <a href=\"/fr/docs/Web/API/Navigator/getGamepads\"><code>Navigator.getGamepads()</code></a> est implémentée avec un préfixe <code>webkit</code>. Pour une rétro-compatibilité, on essaie ici de détecter et de gérer les deux cas (avec et sans préfixe).</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> interval<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ongamepadconnected'</span> <span class=\"token keyword\">in</span> window<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Les évènements gamepad ne sont pas disponibles</span>\n  <span class=\"token comment\">// On boucle pour connaître l'état à la place</span>\n  interval <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>pollGamepads<span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">pollGamepads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> gamepads <span class=\"token operator\">=</span> navigator<span class=\"token punctuation\">.</span>getGamepads <span class=\"token operator\">?</span> navigator<span class=\"token punctuation\">.</span><span class=\"token function\">getGamepads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>navigator<span class=\"token punctuation\">.</span>webkitGetGamepads <span class=\"token operator\">?</span> navigator<span class=\"token punctuation\">.</span>webkitGetGamepads <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> gamepads<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> gp <span class=\"token operator\">=</span> gamepads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>gp<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      gamepadInfo<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">\"Manette connectée à l'indice \"</span> <span class=\"token operator\">+</span> gp<span class=\"token punctuation\">.</span>index <span class=\"token operator\">+</span> <span class=\"token string\">\" : \"</span> <span class=\"token operator\">+</span> gp<span class=\"token punctuation\">.</span>id <span class=\"token operator\">+</span>\n        <span class=\"token string\">\". Elle a \"</span> <span class=\"token operator\">+</span> gp<span class=\"token punctuation\">.</span>buttons<span class=\"token punctuation\">.</span>length <span class=\"token operator\">+</span> <span class=\"token string\">\" boutons et \"</span> <span class=\"token operator\">+</span> gp<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">.</span>length <span class=\"token operator\">+</span> <span class=\"token string\">\" axes.\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">gameLoop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>interval<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Voyons maintenant la boucle de jeu principale. Pour chaque exécution de la boucle, on regarde si un des quatre boutons est pressé. Si c'est le cas, on met à jour les variables de mouvement <code>a</code> et <code>b</code> de façon correspondante. Ensuite, on met à jour les propriétés CSS <a href=\"/fr/docs/Web/CSS/left\"><code>left</code></a> et <a href=\"/fr/docs/Web/CSS/top\"><code>top</code></a> avec les valeurs respectives de <code>a</code> et <code>b</code>. En pratique, cela aura pour effet de déplacer la balle sur l'écran.</p>\n<p>Une fois que tout ça est fait, on utilise <code>requestAnimationFrame()</code> pour passer à la <i lang=\"en\">frame</i> suivante, où on exécute à nouveau <code>gameLoop()</code>.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">buttonPressed</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> b<span class=\"token punctuation\">.</span>pressed<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> b <span class=\"token operator\">==</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">gameLoop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> gamepads <span class=\"token operator\">=</span> navigator<span class=\"token punctuation\">.</span>getGamepads <span class=\"token operator\">?</span> navigator<span class=\"token punctuation\">.</span><span class=\"token function\">getGamepads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>navigator<span class=\"token punctuation\">.</span>webkitGetGamepads <span class=\"token operator\">?</span> navigator<span class=\"token punctuation\">.</span><span class=\"token function\">webkitGetGamepads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>gamepads<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">let</span> gp <span class=\"token operator\">=</span> gamepads<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">buttonPressed</span><span class=\"token punctuation\">(</span>gp<span class=\"token punctuation\">.</span>buttons<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    b<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">buttonPressed</span><span class=\"token punctuation\">(</span>gp<span class=\"token punctuation\">.</span>buttons<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    b<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">buttonPressed</span><span class=\"token punctuation\">(</span>gp<span class=\"token punctuation\">.</span>buttons<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    a<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">buttonPressed</span><span class=\"token punctuation\">(</span>gp<span class=\"token punctuation\">.</span>buttons<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    a<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  ball<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>left <span class=\"token operator\">=</span> a <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"px\"</span><span class=\"token punctuation\">;</span>\n  ball<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>top <span class=\"token operator\">=</span> b <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"px\"</span><span class=\"token punctuation\">;</span>\n\n  start <span class=\"token operator\">=</span> <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>gameLoop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"exemple_complet_afficher_létat_de_la_manette","title":"Exemple complet&nbsp;: afficher l'état de la manette","isH3":false,"content":"<p>Cet exemple illustre comment utiliser l'objet <a href=\"/fr/docs/Web/API/Gamepad\"><code>Gamepad</code></a> ainsi que les évènements <a href=\"/fr/docs/Web/API/Window/gamepadconnected_event\"><code>gamepadconnected</code></a> et <a href=\"/fr/docs/Web/API/Window/gamepaddisconnected_event\"><code>gamepaddisconnected</code></a> afin d'afficher l'état de l'ensemble des manettes connectées au système. Vous pouvez <a href=\"https://luser.github.io/gamepadtest/\" class=\"external\" rel=\" noopener\">voir la démonstration fonctionner</a> et consulter <a href=\"https://github.com/luser/gamepadtest\" class=\"external\" rel=\" noopener\">le code source complet sur GitHub</a>.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> haveEvents <span class=\"token operator\">=</span> <span class=\"token string\">'ongamepadconnected'</span> <span class=\"token keyword\">in</span> window<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> controllers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">connecthandler</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">addgamepad</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>gamepad<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">addgamepad</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">gamepad</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  controllers<span class=\"token punctuation\">[</span>gamepad<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> gamepad<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> d <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  d<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"controller\"</span> <span class=\"token operator\">+</span> gamepad<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> t <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"h1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  t<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">createTextNode</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gamepad: \"</span> <span class=\"token operator\">+</span> gamepad<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  d<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> b <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  b<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">\"buttons\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> gamepad<span class=\"token punctuation\">.</span>buttons<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> e <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"span\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    e<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">\"button\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//e.id = \"b\" + i;</span>\n    e<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> i<span class=\"token punctuation\">;</span>\n    b<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  d<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> a <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  a<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">\"axes\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> gamepad<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> p <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"progress\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    p<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">\"axis\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//p.id = \"a\" + i;</span>\n    p<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"max\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    p<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    p<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> i<span class=\"token punctuation\">;</span>\n    a<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  d<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Voir https://github.com/luser/gamepadtest/blob/master/index.html</span>\n  <span class=\"token keyword\">let</span> start <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"start\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    start<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">\"none\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>updateStatus<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">disconnecthandler</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">removegamepad</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>gamepad<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">removegamepad</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">gamepad</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> d <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"controller\"</span> <span class=\"token operator\">+</span> gamepad<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">delete</span> controllers<span class=\"token punctuation\">[</span>gamepad<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">updateStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>haveEvents<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">scangamepads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> j<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>j <span class=\"token keyword\">in</span> controllers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> controller <span class=\"token operator\">=</span> controllers<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> d <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"controller\"</span> <span class=\"token operator\">+</span> j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> buttons <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> controller<span class=\"token punctuation\">.</span>buttons<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> b <span class=\"token operator\">=</span> buttons<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">let</span> val <span class=\"token operator\">=</span> controller<span class=\"token punctuation\">.</span>buttons<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">let</span> pressed <span class=\"token operator\">=</span> val <span class=\"token operator\">==</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        pressed <span class=\"token operator\">=</span> val<span class=\"token punctuation\">.</span>pressed<span class=\"token punctuation\">;</span>\n        val <span class=\"token operator\">=</span> val<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">let</span> pct <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span>val <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"%\"</span><span class=\"token punctuation\">;</span>\n      b<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>backgroundSize <span class=\"token operator\">=</span> pct <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span> <span class=\"token operator\">+</span> pct<span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pressed<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        b<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">\"button pressed\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        b<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">\"button\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">let</span> axes <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"axis\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> controller<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> a <span class=\"token operator\">=</span> axes<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      a<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token string\">\": \"</span> <span class=\"token operator\">+</span> controller<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      a<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">,</span> controller<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>updateStatus<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">scangamepads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> gamepads <span class=\"token operator\">=</span> navigator<span class=\"token punctuation\">.</span>getGamepads <span class=\"token operator\">?</span> navigator<span class=\"token punctuation\">.</span><span class=\"token function\">getGamepads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>navigator<span class=\"token punctuation\">.</span>webkitGetGamepads <span class=\"token operator\">?</span> navigator<span class=\"token punctuation\">.</span><span class=\"token function\">webkitGetGamepads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> gamepads<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>gamepads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>gamepads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>index <span class=\"token keyword\">in</span> controllers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        controllers<span class=\"token punctuation\">[</span>gamepads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> gamepads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">addgamepad</span><span class=\"token punctuation\">(</span>gamepads<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gamepadconnected\"</span><span class=\"token punctuation\">,</span> connecthandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gamepaddisconnected\"</span><span class=\"token punctuation\">,</span> disconnecthandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>haveEvents<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>scangamepads<span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>","titleAsText":"Exemple complet : afficher l'état de la manette"}},{"type":"specifications","value":{"title":"Spécifications","id":"spécifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/gamepad/#gamepad-interface","title":"Gamepad"},{"bcdSpecificationURL":"https://w3c.github.io/gamepad/extensions.html#partial-gamepad-interface","title":"Gamepad Extensions"}],"query":"api.Gamepad"}},{"type":"browser_compatibility","value":{"title":"Compatibilité des navigateurs","id":"compatibilité_des_navigateurs","isH3":false,"query":"api.Gamepad","dataURL":"/fr/docs/Web/API/Gamepad_API/Using_the_Gamepad_API/bcd.json"}}],"toc":[{"text":"Connecter une manette","id":"connecter_une_manette"},{"text":"Déconnecter une manette","id":"déconnecter_une_manette"},{"text":"Utiliser l'objet <code>Gamepad</code>","id":"utiliser_lobjet_gamepad"},{"text":"Exemple complet&nbsp;: afficher l'état de la manette","id":"exemple_complet_afficher_létat_de_la_manette"},{"text":"Spécifications","id":"spécifications"},{"text":"Compatibilité des navigateurs","id":"compatibilité_des_navigateurs"}],"summary":"HTML5 a introduit de nombreuses briques technologiques qui permettent le développement de jeux interactifs. Les fonctionnalités offertes par <canvas>, WebGL, <audio>, et <video>, ainsi que les API JavaScript correspondantes, ont suffisamment gagné en maturité pour réaliser des tâches qui nécessitaient auparavant du code natif. L'API Gamepad est un outil qui permet d'accéder et d'utiliser les manettes et autres contrôleurs de jeux.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Using the Gamepad API","locale":"en-US","native":"English (US)"},{"title":"ゲームパッド API の使用","locale":"ja","native":"日本語"},{"title":"Using the Gamepad API","locale":"ko","native":"한국어"},{"title":"Using the Gamepad API","locale":"ru","native":"Русский"},{"title":"使用 Gamepad API","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"fr/web/api/gamepad_api/using_the_gamepad_api","github_url":"https://github.com/mdn/translated-content/blob/main/files/fr/web/api/gamepad_api/using_the_gamepad_api/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/fr/docs/Web","title":"Technologies web pour développeurs"},{"uri":"/fr/docs/Web/API","title":"Référence Web API"},{"uri":"/fr/docs/Web/API/Gamepad_API","title":"Gamepad API"},{"uri":"/fr/docs/Web/API/Gamepad_API/Using_the_Gamepad_API","title":"Utiliser l'API Gamepad"}],"pageTitle":"Utiliser l'API Gamepad - Référence Web API | MDN","noIndexing":false}}