{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"L’algorithme de clonage structuré","mdn_url":"/fr/docs/Web/API/Web_Workers_API/Structured_clone_algorithm","locale":"fr","native":"Français","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>L’algorithme de clonage structuré est un nouvel algorithme <a href=\"https://www.w3.org/html/wg/drafts/html/master/infrastructure.html#safe-passing-of-structured-data\" class=\"external\" rel=\" noopener\">défini par la spécification HTML5</a> pour sérialiser les objets JavaScript complexes. Il est plus puissant que <a href=\"/en-US/JSON\">JSON</a> en cela qu’il supporte la sérialisation d’objets contenant des graphes cycliques — des objets peuvent faire référence à des objets faisant référence à d’autres objets dans le même graphe. De plus, dans certains cas, l’algorithme de clonage structuré peut être plus efficace que JSON.</p>\n<p>L’algorithme, essentiellement, parcourt tous les champs de l’objet original, copiant les valeurs de chaque champ dans un nouvel objet. Si un champ est lui-même un objet avec des champs, ces champs sont parcourus de manière récursive jusqu’à ce que chaque champ et sous-champ aient été copié dans le nouvel objet.</p>"}},{"type":"prose","value":{"id":"avantages_par_rapport_à_json","title":"Avantages par rapport à JSON","isH3":false,"content":"<p>Il y a quelques avantages notables à utiliser l’algorithme de clonage structuré plutôt que JSON&nbsp;:</p>\n<ul>\n  <li>Le clonage structuré peut copier des objets <a href=\"/en-US/JavaScript/Reference/Global_Objects/RegExp\"><code>RegExp</code></a>.</li>\n  <li>Le clonage structuré peut copier des objets <a href=\"/fr/docs/Web/API/Blob\"><code>Blob</code></a>, <a href=\"/fr/docs/Web/API/File\"><code>File</code></a> et <a href=\"/fr/docs/Web/API/FileList\"><code>FileList</code></a>.</li>\n  <li>Le clonage structuré peut copier des objets <a href=\"/fr/docs/Web/API/ImageData\"><code>ImageData</code></a>. Les dimensions du <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray\"><code>CanvasPixelArray</code> <small>(en-US)</small></a> du clone correspondront à celles de l’original, et il recevra une copie des mêmes données de pixels.</li>\n  <li>Le clonage structuré copie correctement les objets contenant des graphes de références cycliques.</li>\n</ul>"}},{"type":"prose","value":{"id":"ce_qui_ne_marche_pas_avec_le_clonage_structuré","title":"Ce qui ne marche pas avec le clonage structuré","isH3":false,"content":"<ul>\n  <li>Les objets <a href=\"/en-US/JavaScript/Reference/Global_Objects/Error\"><code>Error</code></a> et <a href=\"/en-US/JavaScript/Reference/Global_Objects/Function\"><code>Function</code></a> ne peuvent pas être copiés par l’algorithme de clonage structuré&nbsp;; toute tentative de le faire émettra une exception <code>DATA_CLONE_ERR</code>.</li>\n  <li>De la même manière, toute tentative de cloner des nœuds DOM émettra une exception <code>DATA_CLONE_ERR</code>.</li>\n  <li>Certains paramètres d’objets ne sont pas préservés&nbsp;:\n    <ul>\n      <li>Le champ <code>lastIndex</code> des objets <a href=\"/en-US/JavaScript/Reference/Global_Objects/RegExp\"><code>RegExp</code></a> n’est pas préservé.</li>\n      <li>Les descripteurs de propriétés, accesseurs et mutateurs (ainsi que les fonctionnalités de métadonnées similaires) ne sont pas copiés. Par exemple, si un objet est marqué en lecture seule <em>via</em> un descripteur de propriété, il sera en lecture et écriture dans le clone, car c’est la condition par défaut.</li>\n      <li>La chaîne de prototypes n’est ni parcourue, ni copiée.</li>\n    </ul>\n  </li>\n</ul>"}},{"type":"prose","value":{"id":"types_supportés","title":"Types supportés","isH3":false,"content":"<table>\n  <thead>\n    <tr>\n      <th>Type d’objet</th>\n      <th>Notes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"/fr/docs/Web/JavaScript/Data_structures#primitive_values\">Tous types primitifs</a></td>\n      <td>À l’exception des symboles</td>\n    </tr>\n    <tr>\n      <td>Objet <a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/Boolean\">Booléen</a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td>Objet String</td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/Date\">Date</a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/RegExp\">RegExp</a></td>\n      <td>Le champ <code>lastIndex</code> n’est pas préservé</td>\n    </tr>\n    <tr>\n      <td><a href=\"/fr/docs/Web/API/Blob\"><code>Blob</code></a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/fr/docs/Web/API/File\"><code>File</code></a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/fr/docs/Web/API/FileList\"><code>FileList</code></a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/fr/docs/Web/API/ArrayBuffer\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">ArrayBuffer</a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">ArrayBufferView (en-US)</a></td>\n      <td>Ce qui implique tous les <a href=\"/fr/docs/Web/JavaScript/Typed_arrays\">tableaux typés</a> tels que <code>Int32Array</code>, etc.</td>\n    </tr>\n    <tr>\n      <td><a href=\"/fr/docs/Web/API/ImageData\"><code>ImageData</code></a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/Array\">Array</a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/Object\">Object</a></td>\n      <td>Inclut seulement les objets plats (par ex. depuis un objet littéral)</td>\n    </tr>\n    <tr>\n      <td><a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/Map\">Map</a></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/Set\">Set</a></td>\n      <td></td>\n    </tr>\n  </tbody>\n</table>"}},{"type":"prose","value":{"id":"alternative_copie_profonde","title":"Alternative&nbsp;: copie profonde","isH3":false,"content":"<p>Si vous voulez une <strong>copie profonde</strong> d’un objet (c’est-à-dire une copie récursive de toutes les propriétés imbriquées, en parcourant la chaîne des prototypes), vous devez employer une autre approche. Ce qui suit est un exemple possible.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">objectToBeCloned</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Cas basique.</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>objectToBeCloned <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> objectToBeCloned<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">var</span> objectClone<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Filtre les objets spéciaux.</span>\n  <span class=\"token keyword\">var</span> Constructor <span class=\"token operator\">=</span> objectToBeCloned<span class=\"token punctuation\">.</span>constructor<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>Constructor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Implémenter d’autres objets spéciaux ici.</span>\n    <span class=\"token keyword\">case</span> <span class=\"token literal-property property\">RegExp</span><span class=\"token operator\">:</span>\n      objectClone <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Constructor</span><span class=\"token punctuation\">(</span>objectToBeCloned<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token literal-property property\">Date</span><span class=\"token operator\">:</span>\n      objectClone <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Constructor</span><span class=\"token punctuation\">(</span>objectToBeCloned<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n      objectClone <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Clone chaque propriété.</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> prop <span class=\"token keyword\">in</span> objectToBeCloned<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    objectClone<span class=\"token punctuation\">[</span>prop<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">clone</span><span class=\"token punctuation\">(</span>objectToBeCloned<span class=\"token punctuation\">[</span>prop<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> objectClone<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note :</strong> Cet algorithme ne prend en charge que les objets spéciaux <a href=\"/en-US/JavaScript/Reference/Global_Objects/RegExp\"><code>RegExp</code></a>, <a href=\"/en-US/JavaScript/Reference/Global_Objects/Array\"><code>Array</code></a> et <a href=\"/en-US/JavaScript/Reference/Global_Objects/Date\"><code>Date</code></a>. Vous pouvez implémenter d’autres cas spéciaux selon vos besoins.</p>\n</div>","titleAsText":"Alternative : copie profonde"}},{"type":"prose","value":{"id":"voir_aussi","title":"Voir aussi","isH3":false,"content":"<ul>\n  <li><a href=\"https://www.w3.org/TR/html5/infrastructure.html#safe-passing-of-structured-data\" class=\"external\" rel=\" noopener\">Spécification HTML5&nbsp;: Passage sécurisé de données structurées</a></li>\n  <li><a href=\"/fr/docs/Web/API/Window/history\"><code>window.history</code></a></li>\n  <li><a href=\"/fr/docs/Web/API/Window/postMessage\"><code>window.postMessage()</code></a></li>\n  <li><a href=\"/fr/docs/Web/API/Web_Workers_API\">Web Workers</a></li>\n  <li><a href=\"/fr/docs/Components.utils.cloneInto\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Components.utils.cloneInto</a></li>\n</ul>"}}],"toc":[{"text":"Avantages par rapport à JSON","id":"avantages_par_rapport_à_json"},{"text":"Ce qui ne marche pas avec le clonage structuré","id":"ce_qui_ne_marche_pas_avec_le_clonage_structuré"},{"text":"Types supportés","id":"types_supportés"},{"text":"Alternative&nbsp;: copie profonde","id":"alternative_copie_profonde"},{"text":"Voir aussi","id":"voir_aussi"}],"summary":"L’algorithme de clonage structuré est un nouvel algorithme défini par la spécification HTML5 pour sérialiser les objets JavaScript complexes. Il est plus puissant que JSON en cela qu’il supporte la sérialisation d’objets contenant des graphes cycliques — des objets peuvent faire référence à des objets faisant référence à d’autres objets dans le même graphe. De plus, dans certains cas, l’algorithme de clonage structuré peut être plus efficace que JSON.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"The structured clone algorithm","locale":"en-US","native":"English (US)"},{"title":"構造化複製アルゴリズム","locale":"ja","native":"日本語"},{"title":"The structured clone algorithm","locale":"ko","native":"한국어"},{"title":"Алгоритм структурированного клонирования","locale":"ru","native":"Русский"},{"title":"结构化克隆算法","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"fr/web/api/web_workers_api/structured_clone_algorithm","github_url":"https://github.com/mdn/translated-content/blob/main/files/fr/web/api/web_workers_api/structured_clone_algorithm/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/fr/docs/Web","title":"Technologies web pour développeurs"},{"uri":"/fr/docs/Web/API","title":"Référence Web API"},{"uri":"/fr/docs/Web/API/Web_Workers_API","title":"API Web Workers"},{"uri":"/fr/docs/Web/API/Web_Workers_API/Structured_clone_algorithm","title":"L’algorithme de clonage structuré"}],"pageTitle":"L’algorithme de clonage structuré - Référence Web API | MDN","noIndexing":false}}