{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Public Key Pinning","mdn_url":"/fr/docs/Web/Security/Certificate_Transparency","locale":"fr","native":"Français","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>L'extention <strong>Public Key Pinning pour HTTP</strong> (HPKP) est une fonctionnalité de sécurité qui dit au client web d'associer une clé publique cryptographique avec un certain serveur web pour éviter les attaques <a href=\"https://fr.wikipedia.org/wiki/Attaque_de_l%27homme_du_milieu\" class=\"external\" rel=\" noopener\">MITM</a> avec des certificats contrefaits.</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note :</strong> La Public Key Pinning décrite ici est différente du limité <a href=\"http://monica-at-mozilla.blogspot.de/2014/08/firefox-32-supports-public-key-pinning.html\" class=\"external\" rel=\" noopener\">preload list based key pinning</a> introduit dans Firefox 32.</p>\n</div>\n<p>Pour s'assurer de l’authenticité de la clé publique du serveur utilisé dans une session TLS, cette clé publique est enveloppée dans un certificat X.509 qui est généralement signé par une autorité de certifications (CA, pour Certificate Authority). Les clients web tels que les navigateurs font confiance à beaucoup de ces autorités de certifications, et chacune d'entre elles peut créer des certificats pour des domaines arbitraires. Si un attaquant est capable de compromettre une seule de ces CA, il peut pratiquer des attaques <a href=\"/fr/docs/Glossary/MitM\">MitM</a> sur diverses connections TLS. HPKP peut contourner cette menace pour le protocole HTTPS en disant au client web quelles clés publiques appartiennent à un certain serveur web.</p>\n<p>HPKP est une technique qui s'appuie sur la confiance au premier accès (TOFU, <em>Trust on First Use</em>). La première fois un serveur web dit au client en utilisant l'en-tête HTTP HPKP quelles clés publiques lui appartiennent, le client sauvegarde cette information pour une période de temps donnée. Quand le client visite le serveur à nouveau, il s'attend à un certificat contenant une clé publique dont l'empreinte est sauvegardée. Si le serveur présente une clé publique inconnue, le client doit présenter un avertissement à l'utilisateur.</p>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note :</strong> Firefox (et Chrome) <strong>désactivent la vérification de l'épinglage</strong> lorsqu'un site épinglé présentent une chaine de certificats qui se termine par <strong>un certificat racine installé par l'utilisateur</strong> (et non un certificat racine de base).</p>\n</div>"}},{"type":"prose","value":{"id":"activer_hpkp","title":"Activer HPKP","isH3":false,"content":"<p>Activer cette fonctionnalité pour votre site est simple : il faut juste retourner l'en tête HTTP <code>Public-Key-Pins</code> HTTP quand le site est accédé via HTTPS :</p>\n<pre class=\"notranslate\">Public-Key-Pins: pin-sha256=\"base64==\"; max-age=expireTime [; includeSubdomains][; report-uri=\"reportURI\"]\n</pre>\n<dl>\n  <dt id=\"pin-sha256\"><code>pin-sha256</code></dt>\n  <dd>\n    <p>La chaîne de caractère entre guillemets est l’empreinte du <em>Subject Public Key Information</em> (SPKI) encodé en base 64. Il est possible de spécifier plusieurs épinglage (pin) pour différentes clé publiques. Certains navigateurs pourraient autoriser dans le future d'autres algorithmes de hachage que SHA-256. Voir plus bas comment extraire cette information depuis le fichier d'un certificat ou d'une clé.</p>\n  </dd>\n  <dt id=\"max-age\"><code>max-age</code></dt>\n  <dd>\n    <p>Le temps, en seconde, pendant laquelle le navigateur doit mémoriser que le site ne doit être visité qu'avec l'une des clés épinglées.</p>\n  </dd>\n  <dt id=\"includesubdomains\"><code>includeSubdomains</code> <span class=\"badge inline optional\">Facultatif</span></dt>\n  <dd>\n    <p>Si ce paramètre optionnel est spécifié, cette règle s'applique aussi a tous les sous-domaines du domaine actuel.</p>\n  </dd>\n  <dt id=\"report-uri\"><code>report-uri</code> <span class=\"badge inline optional\">Facultatif</span></dt>\n  <dd>\n    <p>Si ce paramètre optionnel est spécifié, les échecs de validation sont notifiés à l'URL donnée.</p>\n  </dd>\n</dl>\n<div class=\"notecard note\" id=\"sect3\">\n  <p><strong>Note :</strong> La spécification actuelle <strong>impose</strong> d'inclure au minimum une seconde clé dite de sauvegarde, qui n'est pas encore utilisée en production. Cela permet de changer de clé publique sans bloquer l'accès aux clients qui auraient déjà noté les clés épinglés. C'est important par exemple dans le cas où la clé actuellement utilisées serait compromise, ce qui forcerait l'utilisation d'une clé différente (la clé de sauvegarde dans ce cas).</p>\n</div>\n<div class=\"notecard note\" id=\"sect4\">\n  <p><strong>Note :</strong> Firefox n'implémente pas encore les rapports de violation d'épinglage. Chrome les implémente à partie de la version 46.</p>\n  <ul>\n    <li>Firefox: <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1091176\" class=\"external\" rel=\" noopener\">Bug 1091176 - Implement report-uri directive for HPKP</a> et <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=787133\" class=\"external\" rel=\" noopener\">Bug 787133 - (hpkp) Implement Public Key Pinning Extension for HTTP (HPKP)</a></li>\n    <li>Chrome: <a href=\"https://developers.google.com/web/updates/2015/09/HPKP-reporting-with-chrome-46\" class=\"external\" rel=\" noopener\">https://developers.google.com/web/updates/2015/09/HPKP-reporting-with-chrome-46</a> , <a href=\"https://www.chromestatus.com/feature/4669935557017600\" class=\"external\" rel=\" noopener\">HTTP Public Key Pinning violating reporting</a> et <a href=\"https://code.google.com/p/chromium/issues/detail?id=445793\" class=\"external\" rel=\" noopener\">Issue 445793: HPKP Reporting on invalid pins</a></li>\n  </ul>\n</div>"}},{"type":"prose","value":{"id":"extraire_la_clé_publique_encodé_en_base64","title":"Extraire la clé publique encodé en Base64","isH3":true,"content":"<p>En premier, vous devez extraire la clé publique depuis votre fichier de certificats ou de clés puis l'encoder en base 64.</p>\n<p>Les commandes suivantes vous aideront à extraire la clé publique et à l'encoder en base 64 depuis le fichier d'une clé, d'un certificat ou d'un CSR (Certificate Signing Request).</p>\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code>openssl rsa -in my-key-file.key -outform der -pubout <span class=\"token operator\">|</span> openssl dgst -sha256 -binary <span class=\"token operator\">|</span> openssl enc -base64\n</code></pre></div>\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code>openssl req -in my-signing-request.csr -pubkey -noout <span class=\"token operator\">|</span> openssl rsa -pubin -outform der <span class=\"token operator\">|</span> openssl dgst -sha256 -binary <span class=\"token operator\">|</span> openssl enc -base64\n</code></pre></div>\n<div class=\"code-example\"><pre class=\"brush: bash notranslate\"><code>openssl x509 -in my-certificate.crt -pubkey -noout <span class=\"token operator\">|</span> openssl rsa -pubin -outform der <span class=\"token operator\">|</span> openssl dgst -sha256 -binary <span class=\"token operator\">|</span> openssl enc -base64\n</code></pre></div>"}},{"type":"prose","value":{"id":"exemple_dentête_hpkp","title":"Exemple d'entête HPKP","isH3":true,"content":"<pre class=\"notranslate\">Public-Key-Pins: pin-sha256=\"cUPcTAZWKaASuYWhhneDttWpY3oBAkE3h2+soZS7sWs=\"; pin-sha256=\"M8HztCzM3elUxkcjR2S5P4hhyBNf6lHkmjAHKhpGPWE=\"; max-age=5184000; includeSubdomains; report-uri=\"https://www.example.net/hpkp-report\"\n</pre>\n<p>Dans cet exemple, <strong>pin-sha256=\"cUPcTAZWKaASuYWhhneDttWpY3oBAkE3h2+soZS7sWs=\"</strong> épingle la clé publique utilisée en production par le serveur. La deuxième déclaration d'épinglage <strong>pin-sha256=\"M8HztCzM3elUxkcjR2S5P4hhyBNf6lHkmjAHKhpGPWE=\"</strong> représente la clé de sauvegarde. <strong>max-age=5184000</strong> dit au client de mémoriser cette information pendant deux mois, ce qui est un temps raisonnable d'après la RFC. Cet épinglage s'applique aussi à tous les sous-domaines, car <strong>includeSubdomains</strong> est présent. Enfin, <strong>report-uri=\"https://www.example.net/hpkp-report\"</strong> indique où envoyer les rapports d'erreurs de validation.</p>"}},{"type":"prose","value":{"id":"mettre_en_place_le_header_hpkp_sur_votre_serveur_web","title":"Mettre en place le header HPKP sur votre serveur web","isH3":true,"content":"<p>Les étapes concrètes nécessaires pour délivrer l'en-tête HPKP dépendent du serveur web que vous utilisez.</p>\n<div class=\"notecard note\" id=\"sect5\">\n  <p><strong>Note :</strong> Ces exemples utilisent un a max-age de deux mois et incluent aussi tous les sous-domaines. Il est conseillé de vérifier que cela convient à votre serveur.</p>\n</div>\n<p>Inclure une ligne similaire à votre configuration activera HPKP, en remplaçant les valeurs en pointillé des lignes <code>pin-sha256=\"...\"</code>&nbsp;:</p>\n<h4 id=\"apache\">Apache</h4>\n<pre class=\"notranslate\">Header always set Public-Key-Pins \"pin-sha256=\\\"base64+primary==\\\"; pin-sha256=\\\"base64+backup==\\\"; max-age=5184000; includeSubDomains\"\n</pre>\n<p><strong>Note :</strong> Cela demande le module <code>mod_headers</code> activé.</p>\n<h4 id=\"nginx\">Nginx</h4>\n<pre class=\"notranslate\">add_header Public-Key-Pins 'pin-sha256=\"base64+primary==\"; pin-sha256=\"base64+backup==\"; max-age=5184000; includeSubDomains';\n</pre>\n<p><strong>Note :</strong> Cela demande le module <code>ngx_http_headers_module</code>.</p>\n<h4 id=\"lighttpd\">Lighttpd</h4>\n<pre class=\"notranslate\">setenv.add-response-header  = ( \"Public-Key-Pins\" =&gt; \"pin-sha256=\\\"base64+primary==\\\"; pin-sha256=\\\"base64+backup==\\\"; max-age=5184000; includeSubDomains\")\n</pre>\n<p><strong>Note:</strong> Cela demande le module <code>mod_setenv</code> chargé, ce qui peut être fait en ajoutant la ligne suivante (s'il n'est pas déjà chargé) :</p>\n<pre class=\"notranslate\">server.modules += ( \"mod_setenv\" )\n</pre>"}},{"type":"prose","value":{"id":"spécifications","title":"Spécifications","isH3":false,"content":"<table>\n  <thead>\n    <tr>\n      <th>Spécification</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><a href=\"https://datatracker.ietf.org/doc/html/rfc7469#section-2.1\" class=\"external\" rel=\" noopener\">RFC 7469, section 2.1: Public-Key-Pins</a></td>\n      <td>Extension de l'épinglage des clés publiques pour HTTP</td>\n    </tr>\n  </tbody>\n</table>"}},{"type":"browser_compatibility","value":{"title":"Compatibilité des navigateurs","id":"compatibilité_des_navigateurs","isH3":false,"query":"http.headers.Public-Key-Pins","dataURL":"/fr/docs/Web/Security/Certificate_Transparency/bcd.json"}},{"type":"prose","value":{"id":"voir_aussi","title":"Voir aussi","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/HTTP/Headers/Expect-CT\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Public-Key-Pins (en-US)</a></li>\n  <li><a href=\"/en-US/docs/Web/HTTP/Headers/Expect-CT\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Public-Key-Pins-Report-Only (en-US)</a></li>\n  <li>Browser test site: <a href=\"https://projects.dm.id.lv/Public-Key-Pins_test\" class=\"external\" rel=\" noopener\">HSTS and HPKP test</a></li>\n  <li><a href=\"/en-US/docs/Web/HTTP/Headers/Expect-CT\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Expect-CT (en-US)</a></li>\n</ul>"}}],"toc":[{"text":"Activer HPKP","id":"activer_hpkp"},{"text":"Spécifications","id":"spécifications"},{"text":"Compatibilité des navigateurs","id":"compatibilité_des_navigateurs"},{"text":"Voir aussi","id":"voir_aussi"}],"summary":"L'extention Public Key Pinning pour HTTP (HPKP) est une fonctionnalité de sécurité qui dit au client web d'associer une clé publique cryptographique avec un certain serveur web pour éviter les attaques MITM avec des certificats contrefaits.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Certificate Transparency","locale":"en-US","native":"English (US)"},{"title":"証明書の透明性","locale":"ja","native":"日本語"},{"title":"HTTP Public Key Pinning (HPKP)","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"fr/web/security/certificate_transparency","github_url":"https://github.com/mdn/translated-content/blob/main/files/fr/web/security/certificate_transparency/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/fr/docs/Web","title":"Technologies web pour développeurs"},{"uri":"/fr/docs/Web/Security","title":"Sécurité Web"},{"uri":"/fr/docs/Web/Security/Certificate_Transparency","title":"Public Key Pinning"}],"pageTitle":"Public Key Pinning - Sécurité Web | MDN","noIndexing":false}}