{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Décoder et encoder en base64","mdn_url":"/fr/docs/Glossary/Base64","locale":"fr","native":"Français","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p><strong>Base64</strong> est un groupe de schéma pour encoder des données binaires sous forme d'un texte au format ASCII grâce à la représentation de ces données en base 64. Le terme base64 vient à l'origine de l'encodage utilisé pour transférer certains <a href=\"https://fr.wikipedia.org/wiki/Multipurpose_Internet_Mail_Extensions#Content-Transfer-Encoding\" class=\"external\" rel=\" noopener\">contenus MIME</a>.</p>\n<p>Les schémas d'encodage en base64 sont principalement utilisés lorsqu'il s'agit d'enregistrer ou d'envoyer des données binaires via un media qui a été conçu pour gérer du texte. Cette transformation permet de conserver l'intégrité et la véracité des données envoyées lors du transport. Base64 est utilisé par plusieurs applications, notamment celles qui gèrent les courriels avec <a href=\"https://fr.wikipedia.org/wiki/MIME\" class=\"external\" rel=\" noopener\">MIME</a>, et le stockage de données complexes en <a href=\"/en-US/docs/Web/XML\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">XML (en-US)</a>.</p>\n<p>Pour JavaScript, il existe deux fonctions utilisées pour encoder et décoder des chaînes en base64 :</p>\n<ul>\n  <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/atob\"><code>atob()</code> <small>(en-US)</small></a></li>\n  <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/btoa\"><code>btoa()</code> <small>(en-US)</small></a></li>\n</ul>\n<p>La fonction <code>atob()</code> permet de décoder des données encodées en une chaîne de caractères en base 64. La fonction <code>btoa()</code>, quant à elle, permet de créer une chaîne ASCII en base64 à partir d'une « chaîne » de données binaires.</p>\n<p>Les deux méthodes, <code>atob()</code> et <code>btoa()</code>, fonctionnent sur des chaînes de caractères. Si vous voulez utiliser des <a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\"><code>ArrayBuffers</code></a>, lisez <a href=\"#solution_.232_.e2.80.93_rewriting_atob()_and_btoa()_using_typedarrays_and_utf-8\">ce paragraphe</a>.</p>"}},{"type":"prose","value":{"id":"documentation","title":"Documentation","isH3":false,"content":"<dl>\n  <dt id=\"uris_de_données\"><a href=\"/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">URIs de données (en-US)</a></dt>\n  <dd>\n    <p>Les URIs de données, définies par la <a href=\"https://tools.ietf.org/html/rfc2397\" class=\"external\" rel=\" noopener\">RFC 2397</a>, permettent aux créateurs de contenus d'intégrer des fichiers en ligne dans des documents.</p>\n  </dd>\n  <dt id=\"base64\"><a href=\"https://fr.wikipedia.org/wiki/Base_64\" class=\"external\" rel=\" noopener\">Base64</a></dt>\n  <dd>\n    <p>Article Wikipédia sur l'encodage en base64.</p>\n  </dd>\n  <dt id=\"atob_en-us\"><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/atob\"><code>atob()</code> <small>(en-US)</small></a></dt>\n  <dd>\n    <p>Méthode permettant de décoder une chaîne de donnée qui a été encodée en base64.</p>\n  </dd>\n  <dt id=\"btoa_en-us\"><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/btoa\"><code>btoa()</code> <small>(en-US)</small></a></dt>\n  <dd>\n    <p>Méthode permettant de créer une chaîne ASCII en base64 à partir d'une « chaîne » de données binaires.</p>\n  </dd>\n  <dt id=\"le_«_problème_unicode_»\"><a href=\"#the_.22unicode_problem.22\">Le « problème Unicode »</a></dt>\n  <dd>\n    <p>Pour la plupart des navigateurs, l'utilisation de <code>btoa()</code> sur une chaîne de caractères Unicode entraînera une exception <code>Character Out Of Range</code>. Ce paragraphe indique quelques solutions.</p>\n  </dd>\n  <dt id=\"urischeme\"><a href=\"/fr/docs/URIScheme\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">URIScheme</a></dt>\n  <dd>\n    <p>Une liste de schémas URI supportés par Mozilla.</p>\n  </dd>\n  <dt id=\"stringview\"><a href=\"/fr/docs/Mozilla/Add-ons/Code_snippets/StringView\"><code>StringView</code></a></dt>\n  <dd>\n    <p>Dans cet article, nous publions une bibliothèque dont les buts sont :</p>\n    <ul>\n      <li>de créer une interface pour les chaînes de caractères à la façon du langage <a href=\"https://fr.wikipedia.org/wiki/C_%28langage%29\" class=\"external\" rel=\" noopener\">C</a> (i.e. un tableau de code de caractères — <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">ArrayBufferView (en-US)</a> en JavaScript) basée sur l'interface JavaScript <a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\"><code>ArrayBuffer</code></a>,</li>\n      <li>de créer un ensemble de méthodes pour ces objets qui fonctionnent <strong>sur des tableaux de nombres</strong> plutôt que sur chaînes de caractères JavaScript immuables,</li>\n      <li>de travailler avec d'autres encodages Unicode, y compris ceux différent d'UTF-16 qui est l'encodage par défaut de JavaScript pour les <a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/String\"><code>DOMString</code></a>.</li>\n    </ul>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"outils","title":"Outils","isH3":false,"content":"<ul>\n  <li><a href=\"#solution_.232_.e2.80.93_rewriting_atob()_and_btoa()_using_typedarrays_and_utf-8\">Réécrire <code>atob()</code>et <code>btoa()</code> en utilisant des <code>TypedArray</code>s et l'UTF-8</a></li>\n  <li><a href=\"/fr/docs/Web/JavaScript/Typed_arrays/StringView\" class=\"page-not-created\" title=\"This is a link to an unwritten page\"><code>StringView</code> – une représentation des chaînes de caractères semblable à celle du langage C, basée sur les tableaux typés.</a></li>\n</ul>"}},{"type":"prose","value":{"id":"sujets_connexes","title":"Sujets connexes","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">ArrayBuffer (en-US)</a></li>\n  <li><a href=\"/fr/docs/Web/JavaScript/Typed_arrays\">Les tableaux typés</a></li>\n  <li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">ArrayBufferView (en-US)</a></li>\n  <li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Uint8Array (en-US)</a></li>\n  <li><a href=\"/fr/docs/Web/JavaScript/Typed_arrays/StringView\" class=\"page-not-created\" title=\"This is a link to an unwritten page\"><code>StringView</code> – une représentation des chaînes de caractères semblable à celle du langage C, basée sur les tableaux typés</a></li>\n  <li><a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/String\"><code>DOMString</code></a></li>\n  <li><a href=\"/fr/docs/Glossary/URI\"><code>URI</code></a></li>\n  <li><a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/encodeURI\"><code>encodeURI()</code></a></li>\n</ul>"}},{"type":"prose","value":{"id":"le_«_problème_unicode_»_2","title":"Le « problème Unicode »","isH3":false,"content":"<p>Les objets <a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/String\"><code>DOMString</code></a> sont des chaînes de caractères encodées sur 16 bits. Pour la plupart des navigateurs, lorsqu'on appelle <code>window.btoa</code> sur une chaîne Unicode, cela entraîne une exception <code>Character Out Of Range</code> si la représentation du caractère dépasse les 8 bits ASCII. Deux méthodes existent pour résoudre le problème :</p>\n<ul>\n  <li>échapper la chaîne dans son intégralité puis l'encoder,</li>\n  <li>convertir la chaîne UTF-16 <a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/String\"><code>DOMString</code></a> en un tableau UTF-8 de caractères puis l'encoder.</li>\n</ul>\n<p>Voici ces deux méthodes :</p>"}},{"type":"prose","value":{"id":"première_solution_–_échapper_la_chaîne_avant_de_lencoder","title":"Première solution – échapper la chaîne avant de l'encoder","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">utf8_to_b64</span><span class=\"token punctuation\">(</span> <span class=\"token parameter\">str</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">btoa</span><span class=\"token punctuation\">(</span><span class=\"token function\">unescape</span><span class=\"token punctuation\">(</span><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span> str <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">b64_to_utf8</span><span class=\"token punctuation\">(</span> <span class=\"token parameter\">str</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">decodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token function\">escape</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span><span class=\"token function\">atob</span><span class=\"token punctuation\">(</span> str <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Usage:</span>\n<span class=\"token function\">utf8_to_b64</span><span class=\"token punctuation\">(</span><span class=\"token string\">'✓ à la mode'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"4pyTIMOgIGxhIG1vZGU=\"</span>\n<span class=\"token function\">b64_to_utf8</span><span class=\"token punctuation\">(</span><span class=\"token string\">'4pyTIMOgIGxhIG1vZGU='</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"✓ à la mode\"</span>\n</code></pre></div>\n<p>Cette solution a été proposée dans un article de <a href=\"http://ecmanaut.blogspot.com/2006/07/encoding-decoding-utf8-in-javascript.html\" class=\"external\" rel=\" noopener\">Johan Sundström</a>.</p>"}},{"type":"prose","value":{"id":"seconde_solution_–_réécrire_atob_et_btoa_en_utilisant_des_typedarray_avec_de_lutf-8","title":"Seconde solution – réécrire <code>atob()</code> et <code>btoa()</code> en utilisant des <code>TypedArray</code> avec de l'UTF-8","isH3":true,"content":"<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note :</strong> Le code suivant peut également être utilisé pour obtenir un <a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\">ArrayBuffer</a> depuis une chaîne en base 64 (et vice-versa, voir ci-après). <strong>Pour un article concernant une bibliothèque complète sur les tableaux typés, voir <a href=\"/fr/docs/Mozilla/Add-ons/Code_snippets/StringView\">cet article</a></strong>.</p>\n</div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/*\\\n|*|\n|*|  utilitairezs de manipulations de chaînes base 64 / binaires / UTF-8\n|*|\n|*|  https://developer.mozilla.org/fr/docs/Décoder_encoder_en_base64\n|*|\n\\*/</span>\n\n<span class=\"token comment\">/* Décoder un tableau d'octets depuis une chaîne en base64 */</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">b64ToUint6</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">nChr</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">return</span> nChr <span class=\"token operator\">&gt;</span> <span class=\"token number\">64</span> <span class=\"token operator\">&amp;&amp;</span> nChr <span class=\"token operator\">&lt;</span> <span class=\"token number\">91</span> <span class=\"token operator\">?</span>\n      nChr <span class=\"token operator\">-</span> <span class=\"token number\">65</span>\n      nChr <span class=\"token operator\">&gt;</span> <span class=\"token number\">96</span> <span class=\"token operator\">&amp;&amp;</span> nChr <span class=\"token operator\">&lt;</span> <span class=\"token number\">123</span> <span class=\"token operator\">?</span>\n      nChr <span class=\"token operator\">-</span> <span class=\"token number\">71</span>\n       <span class=\"token operator\">:</span> nChr <span class=\"token operator\">&gt;</span> <span class=\"token number\">47</span> <span class=\"token operator\">&amp;&amp;</span> nChr <span class=\"token operator\">&lt;</span> <span class=\"token number\">58</span>\n         nChr <span class=\"token operator\">+</span> <span class=\"token number\">4</span>\n       <span class=\"token operator\">:</span> nChr <span class=\"token operator\">===</span> <span class=\"token number\">43</span> <span class=\"token operator\">?</span>\n      <span class=\"token number\">62</span>\n    <span class=\"token operator\">:</span> nChr <span class=\"token operator\">===</span> <span class=\"token number\">47</span> <span class=\"token operator\">?</span>\n      <span class=\"token number\">63</span>\n    <span class=\"token operator\">:</span>\n      <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">base64DecToArr</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">sBase64<span class=\"token punctuation\">,</span> nBlocksSize</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">var</span>\n    sB64Enc <span class=\"token operator\">=</span> sBase64<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">[^A-Za-z0-9\\+\\/]</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> nInLen <span class=\"token operator\">=</span> sB64Enc<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span>\n    nOutLen <span class=\"token operator\">=</span> nBlocksSize <span class=\"token operator\">?</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>nInLen <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token operator\">&gt;&gt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> nBlocksSize<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> nBlocksSize <span class=\"token operator\">:</span> nInLen <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token operator\">&gt;&gt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> taBytes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint8Array</span><span class=\"token punctuation\">(</span>nOutLen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> nMod3<span class=\"token punctuation\">,</span> nMod4<span class=\"token punctuation\">,</span> nUint24 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> nOutIdx <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> nInIdx <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> nInIdx <span class=\"token operator\">&lt;</span> nInLen<span class=\"token punctuation\">;</span> nInIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    nMod4 <span class=\"token operator\">=</span> nInIdx <span class=\"token operator\">&amp;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n    nUint24 <span class=\"token operator\">|=</span> <span class=\"token function\">b64ToUint6</span><span class=\"token punctuation\">(</span>sB64Enc<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span>nInIdx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">18</span> <span class=\"token operator\">-</span> <span class=\"token number\">6</span> <span class=\"token operator\">*</span> nMod4<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nMod4 <span class=\"token operator\">===</span> <span class=\"token number\">3</span> <span class=\"token operator\">||</span> nInLen <span class=\"token operator\">-</span> nInIdx <span class=\"token operator\">===</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>nMod3 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> nMod3 <span class=\"token operator\">&lt;</span> <span class=\"token number\">3</span> <span class=\"token operator\">&amp;&amp;</span> nOutIdx <span class=\"token operator\">&lt;</span> nOutLen<span class=\"token punctuation\">;</span> nMod3<span class=\"token operator\">++</span><span class=\"token punctuation\">,</span> nOutIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        taBytes<span class=\"token punctuation\">[</span>nOutIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> nUint24 <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token number\">16</span> <span class=\"token operator\">&gt;&gt;&gt;</span> nMod3 <span class=\"token operator\">&amp;</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">255</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      nUint24 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      \n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> taBytes<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/* encodage d'un tableau en une chaîne en base64 */</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">uint6ToB64</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">nUint6</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">return</span> nUint6 <span class=\"token operator\">&lt;</span> <span class=\"token number\">26</span> <span class=\"token operator\">?</span>\n      nUint6 <span class=\"token operator\">+</span> <span class=\"token number\">65</span>\n      nUint6 <span class=\"token operator\">&lt;</span> <span class=\"token number\">52</span> <span class=\"token operator\">?</span>\n      nUint6 <span class=\"token operator\">+</span> <span class=\"token number\">71</span>\n       <span class=\"token operator\">:</span> nUint6 <span class=\"token operator\">&lt;</span> <span class=\"token number\">62</span> <span class=\"token operator\">?</span>\n         nUint6 <span class=\"token operator\">-</span>\n       <span class=\"token operator\">:</span> nUint6 <span class=\"token operator\">===</span> <span class=\"token number\">62</span> <span class=\"token operator\">?</span>\n      <span class=\"token number\">43</span>\n    <span class=\"token operator\">:</span> nUint6 <span class=\"token operator\">===</span> <span class=\"token number\">63</span> <span class=\"token operator\">?</span>\n      <span class=\"token number\">47</span>\n    <span class=\"token operator\">:</span>\n      <span class=\"token number\">65</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">base64EncArr</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">aBytes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">var</span> nMod3 <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> sB64Enc <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> nLen <span class=\"token operator\">=</span> aBytes<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span> nUint24 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> nIdx <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> nIdx <span class=\"token operator\">&lt;</span> nLen<span class=\"token punctuation\">;</span> nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    nMod3 <span class=\"token operator\">=</span> nIdx <span class=\"token operator\">%</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nIdx <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>nIdx <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">/</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">76</span> <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> sB64Enc <span class=\"token operator\">+=</span> <span class=\"token string\">\"\\r\\n\"</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n    nUint24 <span class=\"token operator\">|=</span> aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span><span class=\"token number\">16</span> <span class=\"token operator\">&gt;&gt;&gt;</span> nMod3 <span class=\"token operator\">&amp;</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nMod3 <span class=\"token operator\">===</span> <span class=\"token number\">2</span> <span class=\"token operator\">||</span> aBytes<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> nIdx <span class=\"token operator\">===</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      sB64Enc <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token function\">uint6ToB64</span><span class=\"token punctuation\">(</span>nUint24 <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">18</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">uint6ToB64</span><span class=\"token punctuation\">(</span>nUint24 <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">12</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">uint6ToB64</span><span class=\"token punctuation\">(</span>nUint24 <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">6</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">uint6ToB64</span><span class=\"token punctuation\">(</span>nUint24 <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      nUint24 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> sB64Enc<span class=\"token punctuation\">.</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> sB64Enc<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> nMod3<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nMod3 <span class=\"token operator\">===</span> <span class=\"token number\">2</span> <span class=\"token operator\">?</span> <span class=\"token string\">''</span> <span class=\"token operator\">:</span> nMod3 <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token string\">'='</span> <span class=\"token operator\">:</span> <span class=\"token string\">'=='</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/* Tableau UTF-8 en DOMString et vice versa */</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">UTF8ArrToStr</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">aBytes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">var</span> sView <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> nPart<span class=\"token punctuation\">,</span> nLen <span class=\"token operator\">=</span> aBytes<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span> nIdx <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> nIdx <span class=\"token operator\">&lt;</span> nLen<span class=\"token punctuation\">;</span> nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    nPart <span class=\"token operator\">=</span> aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    sView <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span>\n      nPart <span class=\"token operator\">&gt;</span> <span class=\"token number\">251</span> <span class=\"token operator\">&amp;&amp;</span> nPart <span class=\"token operator\">&lt;</span> <span class=\"token number\">254</span> <span class=\"token operator\">&amp;&amp;</span> nIdx <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token operator\">&lt;</span> nLen <span class=\"token operator\">?</span> <span class=\"token comment\">/* six bytes */</span>\n        <span class=\"token comment\">/* (nPart - 252 &lt;&lt; 32) n'est pas possible pour ECMAScript donc, on utilise un contournement... : */</span>\n        <span class=\"token punctuation\">(</span>nPart <span class=\"token operator\">-</span> <span class=\"token number\">252</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1073741824</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">18</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span>\n      <span class=\"token operator\">:</span> nPart <span class=\"token operator\">&gt;</span> <span class=\"token number\">247</span> <span class=\"token operator\">&amp;&amp;</span> nPart <span class=\"token operator\">&lt;</span> <span class=\"token number\">252</span> <span class=\"token operator\">&amp;&amp;</span> nIdx <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">&lt;</span> nLen <span class=\"token operator\">?</span> <span class=\"token comment\">/* five bytes */</span>\n        <span class=\"token punctuation\">(</span>nPart <span class=\"token operator\">-</span> <span class=\"token number\">248</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">18</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span>\n      <span class=\"token operator\">:</span> nPart <span class=\"token operator\">&gt;</span> <span class=\"token number\">239</span> <span class=\"token operator\">&amp;&amp;</span> nPart <span class=\"token operator\">&lt;</span> <span class=\"token number\">248</span> <span class=\"token operator\">&amp;&amp;</span> nIdx <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token operator\">&lt;</span> nLen <span class=\"token operator\">?</span> <span class=\"token comment\">/* four bytes */</span>\n        <span class=\"token punctuation\">(</span>nPart <span class=\"token operator\">-</span> <span class=\"token number\">240</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">18</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span>\n      <span class=\"token operator\">:</span> nPart <span class=\"token operator\">&gt;</span> <span class=\"token number\">223</span> <span class=\"token operator\">&amp;&amp;</span> nPart <span class=\"token operator\">&lt;</span> <span class=\"token number\">240</span> <span class=\"token operator\">&amp;&amp;</span> nIdx <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">&lt;</span> nLen <span class=\"token operator\">?</span> <span class=\"token comment\">/* three bytes */</span>\n        <span class=\"token punctuation\">(</span>nPart <span class=\"token operator\">-</span> <span class=\"token number\">224</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span>\n      <span class=\"token operator\">:</span> nPart <span class=\"token operator\">&gt;</span> <span class=\"token number\">191</span> <span class=\"token operator\">&amp;&amp;</span> nPart <span class=\"token operator\">&lt;</span> <span class=\"token number\">224</span> <span class=\"token operator\">&amp;&amp;</span> nIdx <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token operator\">&lt;</span> nLen <span class=\"token operator\">?</span> <span class=\"token comment\">/* two bytes */</span>\n        <span class=\"token punctuation\">(</span>nPart <span class=\"token operator\">-</span> <span class=\"token number\">192</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> aBytes<span class=\"token punctuation\">[</span><span class=\"token operator\">++</span>nIdx<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">128</span>\n      <span class=\"token operator\">:</span> <span class=\"token comment\">/* nPart &lt; 127 ? */</span> <span class=\"token comment\">/* one byte */</span>\n        nPart\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> sView<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">strToUTF8Arr</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">sDOMStr</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">var</span> aBytes<span class=\"token punctuation\">,</span> nChr<span class=\"token punctuation\">,</span> nStrLen <span class=\"token operator\">=</span> sDOMStr<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span> nArrLen <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/* mapping... */</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> nMapIdx <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> nMapIdx <span class=\"token operator\">&lt;</span> nStrLen<span class=\"token punctuation\">;</span> nMapIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    nChr <span class=\"token operator\">=</span> sDOMStr<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span>nMapIdx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    nArrLen <span class=\"token operator\">+=</span> nChr <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x80</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> nChr <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x800</span> <span class=\"token operator\">?</span> <span class=\"token number\">2</span> <span class=\"token operator\">:</span> nChr <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x10000</span> <span class=\"token operator\">?</span> <span class=\"token number\">3</span> <span class=\"token operator\">:</span> nChr <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x200000</span> <span class=\"token operator\">?</span> <span class=\"token number\">4</span> <span class=\"token operator\">:</span> nChr <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x4000000</span> <span class=\"token operator\">?</span> <span class=\"token number\">5</span> <span class=\"token operator\">:</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  aBytes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint8Array</span><span class=\"token punctuation\">(</span>nArrLen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/* transcription... */</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> nIdx <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> nChrIdx <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> nIdx <span class=\"token operator\">&lt;</span> nArrLen<span class=\"token punctuation\">;</span> nChrIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    nChr <span class=\"token operator\">=</span> sDOMStr<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span>nChrIdx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&lt;</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/* one byte */</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> nChr<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&lt;</span>\n      <span class=\"token comment\">/* two bytes */</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">192</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> \n      <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x10000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/* three bytes *\n      aBytes[nIdx++] = 224 + (nChr &gt;&gt;&gt; 12);\n      aBytes[nIdx++] =\n      aBytes[nIdx++] = 128 + (nChr &amp; 63);\n      else if (nChr &lt; \n      /* four bytes */</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">240</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">6</span> <span class=\"token operator\">&amp;</span> \n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> \n      <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x4000000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/* five bytes */</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">248</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> \n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">12</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">6</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token comment\">/* if (nChr &lt;= 0x7fffffff) */</span> <span class=\"token punctuation\">{</span>\n         <span class=\"token comment\">/* six bytes */</span>\n         aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">252</span> <span class=\"token operator\">+</span> <span class=\"token comment\">/* (nChr &gt;&gt;&gt; 32) is not possible in ECMAScript! So...: */</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">/</span> <span class=\"token number\">1073741824</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">24</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">18</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">12</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&gt;&gt;&gt;</span> <span class=\"token number\">6</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      aBytes<span class=\"token punctuation\">[</span>nIdx<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>nChr <span class=\"token operator\">&amp;</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> aBytes<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h4 id=\"tests\">Tests</h4>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">/* Tests */</span>\n\n<span class=\"token keyword\">var</span> entréeChaîne <span class=\"token operator\">=</span> <span class=\"token string\">\"base64 \\u2014 Mozilla Developer Network\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> entréeUTF8 <span class=\"token operator\">=</span> <span class=\"token function\">strToUTF8Arr</span><span class=\"token punctuation\">(</span>entréeChaîne<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> base64 <span class=\"token operator\">=</span> <span class=\"token function\">base64EncArr</span><span class=\"token punctuation\">(</span>entréeUTF8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>base64<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> sortieUT8 <span class=\"token operator\">=</span> <span class=\"token function\">base64DecToArr</span><span class=\"token punctuation\">(</span>base64<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> sortieChaîne <span class=\"token operator\">=</span> <span class=\"token function\">UTF8ArrToStr</span><span class=\"token punctuation\">(</span>sortieUT8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>sortieChaîne<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h4 id=\"annexe_décoder_une_chaîne_en_base64_en_un_objet_uint8array_ou_arraybuffer\">Annexe : Décoder une chaîne en base64 en un objet <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Uint8Array (en-US)</a> ou <a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\">ArrayBuffer</a></h4>\n<p>Ces fonctions permettent de créer des objets <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">uint8Arrays (en-US)</a> ou <a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\">arrayBuffers</a> à partir de chaînes en base64 :</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> monTableau <span class=\"token operator\">=</span> <span class=\"token function\">base64DecToArr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"QmFzZSA2NCDigJQgTW96aWxsYSBEZXZlbG9wZXIgTmV0d29yaw==\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Base 64 \\u2014 Mozilla Developer Network\"</span>\n\n<span class=\"token keyword\">var</span> monBuffer <span class=\"token operator\">=</span> <span class=\"token function\">base64DecToArr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"QmFzZSA2NCDigJQgTW96aWxsYSBEZXZlbG9wZXIgTmV0d29yaw==\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>buffer<span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Base 64 \\u2014 Mozilla Developer Network\"</span>\n\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>monBuffer<span class=\"token punctuation\">.</span>byteLength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note :</strong> La fonction <code>base64DecToArr(sBase64[, nTailleBloc])</code> renvoie un <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">uint8Array (en-US)</a> d'octets. Si vous souhaitez utiliser un tampon mémoire de 16 bits, 32 bits, 64 bits pour les données brutes, utilisez l'argument <code>nTailleBloc</code>, qui représente le nombre d'octets dont la propriété <code>uint8Array.buffer.bytesLength</code> doit être un multiple (<code>1</code> ou pas de paramètre pour l'ASCII, <a href=\"/fr/docs/Web/API/btoa\">les chaînes binaires</a> ou les chaînes encodées UTF-8, <code>2</code> pour les chaînes UTF-16, <code>4</code> pour les chaînes UTF-32).</p>\n</div>\n<p>Pour une bibliothèque plus complète, voir <a href=\"/fr/docs/Web/JavaScript/Typed_arrays/StringView\" class=\"page-not-created\" title=\"This is a link to an unwritten page\"><code>StringView</code> – une représentation des chaînes de caractères semblable à celle du langage C, basée sur les tableaux typés</a></p>","titleAsText":"Seconde solution – réécrire atob() et btoa() en utilisant des TypedArray avec de l'UTF-8"}},{"type":"prose","value":{"id":"voir_aussi","title":"Voir aussi","isH3":false,"content":"<ul>\n  <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/atob\"><code>atob()</code> <small>(en-US)</small></a></li>\n  <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/btoa\"><code>btoa()</code> <small>(en-US)</small></a></li>\n  <li><a href=\"/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">URIs de données (en-US)</a></li>\n  <li><a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\">ArrayBuffer</a></li>\n  <li><a href=\"/fr/docs/Web/JavaScript/Typed_arrays\">Tableaux typés</a></li>\n  <li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">ArrayBufferView (en-US)</a></li>\n  <li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">Uint8Array (en-US)</a></li>\n  <li><a href=\"/fr/docs/Web/JavaScript/Typed_arrays/StringView\" class=\"page-not-created\" title=\"This is a link to an unwritten page\"><code>StringView</code> – une représentation des chaînes, basée sur les tableaux typés</a></li>\n  <li><a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/String\">DOMString</a></li>\n  <li><a href=\"/fr/docs/Glossary/URI\"><code>URI</code></a></li>\n  <li><a href=\"/fr/docs/Web/JavaScript/Reference/Global_Objects/encodeURI\"><code>encodeURI()</code></a></li>\n  <li><a href=\"/fr/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURIFixup\" class=\"page-not-created\" title=\"This is a link to an unwritten page\"><code>nsIURIFixup()</code></a></li>\n  <li><a href=\"https://fr.wikipedia.org/wiki/Base64\" class=\"external\" rel=\" noopener\">Article sur la base64 sur Wikipédia</a></li>\n</ul>"}}],"toc":[{"text":"Documentation","id":"documentation"},{"text":"Outils","id":"outils"},{"text":"Sujets connexes","id":"sujets_connexes"},{"text":"Le « problème Unicode »","id":"le_«_problème_unicode_»_2"},{"text":"Voir aussi","id":"voir_aussi"}],"summary":"Base64 est un groupe de schéma pour encoder des données binaires sous forme d'un texte au format ASCII grâce à la représentation de ces données en base 64. Le terme base64 vient à l'origine de l'encodage utilisé pour transférer certains contenus MIME.","popularity":0.001,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Base64","locale":"en-US","native":"English (US)"},{"title":"Base64 codificando y decodificando","locale":"es","native":"Español"},{"title":"Base64","locale":"ja","native":"日本語"},{"title":"Кодирование и декодирование в формате Base64","locale":"ru","native":"Русский"},{"title":"Base64 的编码与解码","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"fr/glossary/base64","github_url":"https://github.com/mdn/translated-content/blob/main/files/fr/glossary/base64/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/fr/docs/Glossary","title":"Glossaire MDN : définitions des termes du Web"},{"uri":"/fr/docs/Glossary/Base64","title":"Décoder et encoder en base64"}],"pageTitle":"Décoder et encoder en base64 - Glossaire MDN : définitions des termes du Web | MDN","noIndexing":false}}