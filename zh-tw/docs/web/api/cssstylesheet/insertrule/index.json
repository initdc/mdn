{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"CSSStyleSheet.insertRule()","mdn_url":"/zh-TW/docs/Web/API/CSSStyleSheet/insertRule","locale":"zh-TW","native":"正體中文 (繁體)","sidebarHTML":"<ol><li><strong><a href=\"/zh-TW/docs/Web/API/CSS_Object_Model\">CSS Object Model</a></strong></li><li><strong><a href=\"/zh-TW/docs/Web/API/CSSStyleSheet\"><code>CSSStyleSheet</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Constructor</summary><ol><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/CSSStyleSheet\"><code>CSSStyleSheet()</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Properties</summary><ol><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/cssRules\"><code>cssRules</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/ownerRule\"><code>ownerRule</code> <small>(en-US)</small></a></li><li><svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/rules\"><code>rules</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Methods</summary><ol><li><svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/addRule\"><code>addRule()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/deleteRule\"><code>deleteRule()</code> <small>(en-US)</small></a></li><li><em><code>insertRule()</code></em></li><li><svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/removeRule\"><code>removeRule()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/replace\"><code>replace()</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/replaceSync\"><code>replaceSync()</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Inheritance:</summary><ol><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/StyleSheet\"><code>StyleSheet</code> <small>(en-US)</small></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Related pages for CSSOM</summary><ol><li><a href=\"/zh-TW/docs/Web/API/AnimationEvent\"><code>AnimationEvent</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSS\"><code>CSS</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSConditionRule\"><code>CSSConditionRule</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSGroupingRule\"><code>CSSGroupingRule</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSKeyframeRule\"><code>CSSKeyframeRule</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSKeyframesRule\"><code>CSSKeyframesRule</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSMediaRule\"><code>CSSMediaRule</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSNamespaceRule\"><code>CSSNamespaceRule</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSPageRule\"><code>CSSPageRule</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSRule\"><code>CSSRule</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSRuleList\"><code>CSSRuleList</code> <small>(en-US)</small></a></li><li><a href=\"/zh-TW/docs/Web/API/CSSStyleDeclaration\"><code>CSSStyleDeclaration</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleRule\"><code>CSSStyleRule</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSSupportsRule\"><code>CSSSupportsRule</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CaretPosition\"><code>CaretPosition</code> <small>(en-US)</small></a></li><li><a href=\"/zh-TW/docs/Web/API/MediaQueryList\"><code>MediaQueryList</code></a></li><li><a href=\"/zh-TW/docs/Web/API/Screen\"><code>Screen</code></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/StyleSheet\"><code>StyleSheet</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/StyleSheetList\"><code>StyleSheetList</code> <small>(en-US)</small></a></li><li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/TransitionEvent\"><code>TransitionEvent</code> <small>(en-US)</small></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p><strong>CSSStyleSheet.insertRule()</strong> 方法新增一個新的 CSS 規則，到當前的樣式表，他伴隨著一些<a href=\"#restrictions\">限制</a>.</p>\n<p>更明確的說，雖然 <strong>insertRule()</strong> 只是一個 <a href=\"/zh-TW/docs/Web/API/CSSStyleSheet\"><code>CSSStyleSheet</code></a> 的方法， 他實際上插入這份規則到 <a href=\"/zh-TW/docs/Web/API/CSSStyleSheet\"><code>CSSStyleSheet</code></a>.<em>cssRules</em>, 在 <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSRuleList\"><code>CSSRuleList</code> <small>(en-US)</small></a> 之中。</p>\n<p>這份規則，必須包含的內容，取決於它的類型： 對於規則集 (rule-sets)，規則同時指定了選擇器和样式聲明。 對於規則 (at-rules)，規則同時指定 at 標識符（ at-identifier ）和規則內容。</p>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<div class=\"code-example\"><pre class=\"brush: plain notranslate\">stylesheet.insertRule(rule[, index])\n</pre></div>"}},{"type":"prose","value":{"id":"parameters","title":"Parameters","isH3":true,"content":"<dl>\n  <dt id=\"rule\"><strong>rule</strong></dt>\n  <dd>\n    <p><strong>一個 <a href=\"/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/String\"><code>DOMString</code></a> 包含要被插入的規則，這份規則同時指定了選擇器（ <a href=\"/en-US/docs/Learn/CSS/Building_blocks/Selectors\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">selector (en-US)</a> ）和样式聲明，或 at 標識符 (at-identifier ) 和規則內容。</strong></p>\n  </dd>\n  <dt id=\"index_選擇性\"><strong>index <span class=\"badge inline optional\">選擇性</span></strong></dt>\n  <dd>\n    <p>**無符號整數，代表在 **<a href=\"/zh-TW/docs/Web/API/CSSStyleSheet\"><code>CSSStyleSheet</code></a>.cssRules中插入的位置，其中 index-0 是第一個規則，而 index-max 就是最後一個規則，並且與 CSSStyleSheet 的長度相同。cssRules 在舊的實現中是必需的。查詢「瀏覽器兼容」取得詳細信息。 默認值為 0。</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"return_value","title":"Return value","isH3":true,"content":"<p>The index within the style sheet's rule-list of the newly inserted rule.</p>"}},{"type":"prose","value":{"id":"restrictions_限制","title":"Restrictions 限制","isH3":true,"content":"<p>\n  CSS 樣式表規則列表，有一些直覺的、和不是那麼直覺的<a href=\"https://drafts.csswg.org/cssom/#insert-a-css-rule\" class=\"external\" rel=\" noopener\">限制</a> ，影響著規則的插入方式和位置。\n  違反這些可能會導致 DOM 異常 (<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/DOMException\"><code>DOMException</code> <small>(en-US)</small></a>) 引發錯誤。\n</p>\n<ul>\n  <li>如果 index &gt; 樣式表中規則數量 (<code>CSSRuleList.length</code>)，他會中止，顯示 IndexSizeError (索引大小錯誤)。</li>\n  <li>如果 rule 無法在索引 0 插入，因為一些 CSS 因素的限制，他會中止，顯示 HierarchyRequestError (層次結構請求錯誤)。</li>\n  <li>如果規則參數中給出多個規則，他會中止，顯示 SyntaxError (語法錯誤)。</li>\n  <li>如果嘗試在樣式規則之後插入 <code>@import at-rule</code>，他會中止，顯示 HierarchyRequestError (層次結構請求錯誤)。</li>\n  <li>如果規則是 <code>@namespace at-rule</code>，且列表不只有 <code>@import at-rules</code> 和 / 或 <code>@namespace at-rules</code>他會中止，顯示 InvalidStateError (狀態錯誤無效)。</li>\n</ul>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":""}},{"type":"prose","value":{"id":"example_1","title":"Example 1","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// push a new rule onto the top of my stylesheet</span>\nmyStyle<span class=\"token punctuation\">.</span><span class=\"token function\">insertRule</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#blanc { color: white }\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"example_2","title":"Example 2","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">/**\n * Add a stylesheet rule to the document (may be better practice, however,\n * to dynamically change classes, so style information can be kept in\n * genuine stylesheets (and avoid adding extra elements to the DOM))\n * Note that an array is needed for declarations and rules since ECMAScript does\n * not afford a predictable object iteration order and since CSS is\n * order-dependent (i.e., it is cascading); those without need of\n * cascading rules could build a more accessor-friendly object-based API.\n * @param {Array} rules Accepts an array of JSON-encoded declarations\n * @example\naddStylesheetRules([\n  ['h2', // Also accepts a second argument as an array of arrays instead\n    ['color', 'red'],\n    ['background-color', 'green', true] // 'true' for !important rules\n  ],\n  ['.myClass',\n    ['background-color', 'yellow']\n  ]\n]);\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">addStylesheetRules</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">rules</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> styleEl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'style'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      styleSheet<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Append style element to head</span>\n  document<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>styleEl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Grab style sheet</span>\n  styleSheet <span class=\"token operator\">=</span> styleEl<span class=\"token punctuation\">.</span>sheet<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> rl <span class=\"token operator\">=</span> rules<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> rl<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> j <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> rule <span class=\"token operator\">=</span> rules<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> selector <span class=\"token operator\">=</span> rules<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> propStr <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// If the second argument of a rule is an array of arrays, correct our variables.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>rule<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">'[object Array]'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      rule <span class=\"token operator\">=</span> rule<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> pl <span class=\"token operator\">=</span> rule<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> pl<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> prop <span class=\"token operator\">=</span> rule<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      propStr <span class=\"token operator\">+=</span> prop<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">':'</span> <span class=\"token operator\">+</span> prop<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>prop<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> <span class=\"token string\">' !important'</span> <span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">';\\n'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Insert CSS Rule</span>\n    styleSheet<span class=\"token punctuation\">.</span><span class=\"token function\">insertRule</span><span class=\"token punctuation\">(</span>selector <span class=\"token operator\">+</span> <span class=\"token string\">'{'</span> <span class=\"token operator\">+</span> propStr <span class=\"token operator\">+</span> <span class=\"token string\">'}'</span><span class=\"token punctuation\">,</span> styleSheet<span class=\"token punctuation\">.</span>cssRules<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://drafts.csswg.org/cssom/#dom-cssstylesheet-insertrule","title":"CSS Object Model (CSSOM)"}],"query":"api.CSSStyleSheet.insertRule"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.CSSStyleSheet.insertRule","dataURL":"/zh-TW/docs/Web/API/CSSStyleSheet/insertRule/bcd.json"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/CSSStyleSheet/deleteRule\"><code>CSSStyleSheet.deleteRule</code> <small>(en-US)</small></a></li>\n  <li><a href=\"https://www-archive.mozilla.org/docs/web-developer/css1technote/css1tojs.html#priority\" class=\"external\" rel=\" noopener\">Cross-Browser CSS-rules ordering (CSS1)</a></li>\n  <li><a href=\"https://www.quirksmode.org/dom/w3c_css.html\" class=\"external\" rel=\" noopener\">Quirksmode - CSS</a></li>\n</ul>"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"CSSStyleSheet.insertRule() 方法新增一個新的 CSS 規則，到當前的樣式表，他伴隨著一些限制.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"CSSStyleSheet.insertRule()","locale":"en-US","native":"English (US)"},{"title":"CSSStyleSheet.insertRule()","locale":"es","native":"Español"},{"title":"CSSStyleSheet.insertRule()","locale":"ja","native":"日本語"},{"title":"CSSStyleSheet.insertRule()","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"zh-tw/web/api/cssstylesheet/insertrule","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-tw/web/api/cssstylesheet/insertrule/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-TW/docs/Web","title":"給開發者的網頁技術文件"},{"uri":"/zh-TW/docs/Web/API","title":"Web APIs"},{"uri":"/zh-TW/docs/Web/API/CSSStyleSheet","title":"CSSStyleSheet"},{"uri":"/zh-TW/docs/Web/API/CSSStyleSheet/insertRule","title":"CSSStyleSheet.insertRule()"}],"pageTitle":"CSSStyleSheet.insertRule() - Web APIs | MDN","noIndexing":false}}