<!DOCTYPE html><html lang="en-US" prefix="og: https://ogp.me/ns#"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon-48x48.97046865.png"><link rel="apple-touch-icon" href="/apple-touch-icon.0ea0fa02.png"><meta name="theme-color" content="#ffffff"><link rel="manifest" href="/manifest.56b1cedc.json"><link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="MDN Web Docs"><script>Array.prototype.flat&&Array.prototype.includes||document.write('<script src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.flat%2Ces6"><\/script>')</script><title>ä½¿ç”¨IndexedDB - Web APIs | MDN</title><link rel="preload" as="font" type="font/woff2" crossorigin="" href="/static/media/ZillaSlab-Bold.subset.0beac26b.woff2"><link rel="alternate" title="ä½¿ç”¨IndexedDB" href="https://developer.mozilla.org/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB" hreflang="zh-TW"><link rel="alternate" title="ä½¿ç”¨ IndexedDB" href="https://developer.mozilla.org/zh-CN/docs/Web/API/IndexedDB_API/Using_IndexedDB" hreflang="zh"><link rel="alternate" title="Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ IndexedDB" href="https://developer.mozilla.org/ru/docs/Web/API/IndexedDB_API/Using_IndexedDB" hreflang="ru"><link rel="alternate" title="Usando IndexedDB" href="https://developer.mozilla.org/pt-BR/docs/Web/API/IndexedDB_API/Using_IndexedDB" hreflang="pt"><link rel="alternate" title="IndexedDB ì‚¬ìš©í•˜ê¸°" href="https://developer.mozilla.org/ko/docs/Web/API/IndexedDB_API/Using_IndexedDB" hreflang="ko"><link rel="alternate" title="IndexedDB ã®ä½¿ç”¨" href="https://developer.mozilla.org/ja/docs/Web/API/IndexedDB_API/Using_IndexedDB" hreflang="ja"><link rel="alternate" title="Utiliser IndexedDB" href="https://developer.mozilla.org/fr/docs/Web/API/IndexedDB_API/Using_IndexedDB" hreflang="fr"><link rel="alternate" title="Usando IndexedDB" href="https://developer.mozilla.org/es/docs/Web/API/IndexedDB_API/Using_IndexedDB" hreflang="es"><link rel="alternate" title="Using IndexedDB" href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API/Using_IndexedDB" hreflang="en"><meta name="description" content="IndexedDB æä¾›äº†åœ¨ç€è¦½å™¨ä¸Šå„²å­˜ä¿ç•™è³‡æ–™çš„åŠŸèƒ½ï¼Œè—‰ç”±å®ƒï¼Œä¸è«–æ˜¯ç·šä¸Šæˆ–ç·šä¸‹æˆ‘å€‘çš„æ‡‰ç”¨éƒ½å¯ä»¥é€²è¡Œè³‡æ–™å­˜å–ã€‚"><meta property="og:url" content="https://developer.mozilla.org/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB"><meta property="og:title" content="ä½¿ç”¨IndexedDB - Web APIs | MDN"><meta property="og:description" content="IndexedDB æä¾›äº†åœ¨ç€è¦½å™¨ä¸Šå„²å­˜ä¿ç•™è³‡æ–™çš„åŠŸèƒ½ï¼Œè—‰ç”±å®ƒï¼Œä¸è«–æ˜¯ç·šä¸Šæˆ–ç·šä¸‹æˆ‘å€‘çš„æ‡‰ç”¨éƒ½å¯ä»¥é€²è¡Œè³‡æ–™å­˜å–ã€‚"><meta property="og:locale" content="zh-TW"><meta property="og:image" content="https://developer.mozilla.org/mdn-social-share.0ca9dbda.png"><meta property="twitter:card" content="summary_large_image"><meta name="robots" content="index, follow"><link rel="canonical" href="https://developer.mozilla.org/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB"><style media="print">.breadcrumbs-container,.document-toc-container,.language-menu,.language-toggle,.on-github,.page-footer,.page-header-main,nav.sidebar,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style><link href="/static/css/main.55b68e13.chunk.css" rel="stylesheet"><script src="/static/js/runtime-main.4bb4c356.js" defer=""></script><script src="/static/js/4.a756dea3.chunk.js" defer=""></script><script src="/static/js/main.d4d565e0.chunk.js" defer=""></script></head><body><div id="root"><ul id="nav-access" class="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-search" href="#main-q">Skip to search</a></li><li><a id="skip-select-language" href="#select-language">Skip to select language</a></li></ul><div class="page-wrapper document-page"><header class="page-header"><a href="/zh-TW/" class="logo" aria-label="MDN Web Docs"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451.74 135"><path d="M7.14 8.35v111.06h111.05V8.35zm103.71 56c-.48.92-1 1.79-1.46 2.71a3.44 3.44 0 01-3.54 2 2.4 2.4 0 00-1.55.5c-1.37.9-2.76 1.79-4.18 2.63a7.33 7.33 0 01-6.35.34 29.71 29.71 0 00-10.63-2 11.7 11.7 0 00-9.46 4.31 14.84 14.84 0 00-2.13 4.29c-1.24 3.07-2.3 21.38-2.3 26.05 0 0-17.62-3.42-34.15-20.34l4.31-11.32h-13.5l9.76-10.35h-16.8l9.77-10.34H12.69L30.45 34a40.9 40.9 0 0119.77-10.83c7.1-1.22 8.93-.53 13.31.77l2.43.73.85.25 3.1.95a12.56 12.56 0 006.21.09 11.37 11.37 0 018.25 1 8.24 8.24 0 014.1 6.22 7.29 7.29 0 003.61 5.49 59.45 59.45 0 009.32 4.11c2.27.86 4.54 1.84 6.79 2.72a6.81 6.81 0 012.86 2.06 4.81 4.81 0 011.1 2.73c.14 2 .37 4 .47 6a15.24 15.24 0 01-1.77 8.03zM320.12 39.62a5.42 5.42 0 00-4.53 2.13 7.36 7.36 0 00-1.7 4.43v2.36a6.28 6.28 0 001.7 4.46 5.63 5.63 0 004.3 1.82 5.12 5.12 0 004.57-2.27A9.7 9.7 0 00326 47a8.11 8.11 0 00-1.67-5.52 5.36 5.36 0 00-4.21-1.86zM387.38 39.53a5.52 5.52 0 00-4.7 2.15 8.8 8.8 0 00-1.63 5.49 9.23 9.23 0 001.58 5.45 5.38 5.38 0 004.7 2.25 5.61 5.61 0 004.74-2.2 8.91 8.91 0 001.68-5.59 8.24 8.24 0 00-1.75-5.52 5.76 5.76 0 00-4.62-2.03zM299.47 41.35a4.34 4.34 0 00-4-1.92 4.55 4.55 0 00-3.89 1.73 8.37 8.37 0 00-1.58 4.17h10.48a6.3 6.3 0 00-1.01-3.98zM357.74 30.75H352v23.31h5.72q5.47 0 8.35-3t2.93-8.65q0-5.43-2.88-8.55t-8.38-3.11z"></path><path d="M121.55 8.35v70.8h323V8.35zm42.21 22.45h-4V54h3.68v3.73h-11.25V54h3.31V36.79h-.19l-9.63 19.12h-2.12l-10-19.4h-.19V54h3.45v3.73h-11.15V54h3.68V30.8h-4v-3.73H133l11.66 22.56h.19l11.18-22.56h7.7zm29.12 22.67q-4.11 4.28-11.38 4.28h-14.06v-3.69h3.73V30.75h-3.73v-3.68h13.83q7.59 0 11.66 4.29a15.4 15.4 0 014 11 15.33 15.33 0 01-4.05 11.11zm38.89-22.67h-3.68v27h-2.6L208.08 35h-.19v19h4.67v3.73h-12.22V54h3.49V30.8h-4v-3.73h7.08l16.9 22.09h.19V30.8h-4.58v-3.73h12.32zm43.8 27h-3.31l-7.83-23.18h-.19l-7.55 23.18h-3.35l-8.78-27h-2.65v-3.73H253v3.73h-3.87L255 50.71h.23l6.61-19.91H259v-3.73h11v3.73h-2.78l6.61 20.1h.23l5.43-20.1h-4.15v-3.73h11v3.73h-2.54zm26.71-1.51a9.66 9.66 0 01-6.42 2 10.2 10.2 0 01-7.41-2.74c-1.89-1.82-2.83-4.47-2.83-7.93a12.37 12.37 0 012.64-8.12 9 9 0 017.32-3.21 8.62 8.62 0 016.75 2.69 9.65 9.65 0 012.45 6.52 13.67 13.67 0 01-.28 2.69H290q.29 6.71 6.18 6.7a5.2 5.2 0 003.71-1.18 5.82 5.82 0 001.67-2.83l3.45.71a7.21 7.21 0 01-2.73 4.65zm25.77-1.63c-1.51 2.4-3.92 3.61-7.22 3.61s-5.84-1.29-7.22-3.87c0 .25-.1.82-.21 1.7s-.19 1.44-.22 1.7H309c.16-1 .31-2 .47-3.07a21.42 21.42 0 00.24-3.16v-23h-3.4v-3.3h7.55V40.9a9.76 9.76 0 012.67-3.28 7.33 7.33 0 014.74-1.4 8.48 8.48 0 016.5 2.78q2.55 2.74 2.55 7.74a14.6 14.6 0 01-2.27 7.87zm41.39-1.14q-4.11 4.28-11.37 4.28H344v-3.74h3.73V30.75H344v-3.68h13.83q7.59 0 11.66 4.29a15.41 15.41 0 014.06 11 15.34 15.34 0 01-4.11 11.11zm25.65 1.68a10.53 10.53 0 01-7.9 3.07 10 10 0 01-7.63-3 10.93 10.93 0 01-2.8-7.83 12.13 12.13 0 012.69-7.93q2.69-3.3 8-3.3t8 3.28a12 12 0 012.64 7.76 10.86 10.86 0 01-3 7.9zm22.61.57c-1.4 1.66-3.63 2.5-6.68 2.5a9.58 9.58 0 01-7.15-2.76q-2.72-2.76-2.71-7.91a12.25 12.25 0 012.69-8 9.17 9.17 0 017.5-3.28 15 15 0 013.82.48 10.37 10.37 0 013.5 1.65l.85 5.47-3.35.38-.76-3.54a8.07 8.07 0 00-4.11-1 4.9 4.9 0 00-4.39 2.15 9.93 9.93 0 00-1.41 5.55 8.9 8.9 0 001.5 5.38 5.23 5.23 0 004.44 2c2.92 0 4.67-1.7 5.23-5.1l3.5.71a10.34 10.34 0 01-2.47 5.27zm20.48.75a11.68 11.68 0 01-6.63 1.75 15.52 15.52 0 01-8.26-2.08L424 51l3.26.33-.1 2.74a7 7 0 002.06.66 12.63 12.63 0 002.19.19 8.68 8.68 0 003.66-.75 2.5 2.5 0 001.63-2.36 2.25 2.25 0 00-1.32-2.2 12.65 12.65 0 00-3.28-1 47.39 47.39 0 01-3.9-.82 7.5 7.5 0 01-3.25-1.7 4.67 4.67 0 01-1.33-3.66c0-2.36.88-4 2.62-4.91a12 12 0 015.6-1.37 15 15 0 014.08.55 16.65 16.65 0 013.47 1.39l.47 5.1-3.3.37-.48-3.3a9.5 9.5 0 00-4.06-.9 5.62 5.62 0 00-2.87.66 2.33 2.33 0 00-1.15 2.25 2.13 2.13 0 001.3 2.07 11.91 11.91 0 003.21.92 36.69 36.69 0 013.82.83 7.46 7.46 0 013.21 1.74 4.9 4.9 0 011.3 3.73 5.56 5.56 0 01-2.66 4.91z"></path><path d="M181.17 30.75h-5.71v23.31h5.71q5.47 0 8.36-3t2.88-8.61q0-5.43-2.88-8.55t-8.36-3.15zM121.63 119.32V81.74h114.91v37.58zM153.22 109h-2v-6.85a4.8 4.8 0 00-1.58-4 5.57 5.57 0 00-3.55-1.26 5 5 0 00-4.92 3.26 4.19 4.19 0 00-1.88-2.46 5.82 5.82 0 00-3-.8 4.89 4.89 0 00-4.56 2.56v-2.21h-6.28v3.26h2v8.5h-2v3.23h9.11V109h-2.86v-5.25a4.4 4.4 0 01.69-2.56 2.47 2.47 0 012.21-1q2.57 0 2.56 3.63v8.41h6.29V109h-2v-5.25a4.47 4.47 0 01.67-2.56 2.42 2.42 0 012.19-1q2.63 0 2.63 3.63v8.41h6.28zm9.88-12.07q-4 0-6 2.36a8.41 8.41 0 00-2 5.66 7.25 7.25 0 002.17 5.62 8 8 0 005.65 2 8.54 8.54 0 005.94-2.11 7.27 7.27 0 002.34-5.67 8.21 8.21 0 00-2-5.51q-2.07-2.34-6.1-2.34zm-.1 12.35a3 3 0 01-2.63-1.33 5.68 5.68 0 01-.9-3.26 5 5 0 011-3.28 3.23 3.23 0 012.61-1.18 3.5 3.5 0 012.59 1.08 4.56 4.56 0 011.07 3.31 5.21 5.21 0 01-1 3.41 3.33 3.33 0 01-2.74 1.25zm25-2.3l-3.39-.29-.7 2.32H179l8.32-9.54-.32-2.23h-13.19l-.53 5.25 3.16.34.67-2.36h4.65l-8.25 9.53.44 2.26h13.13zm7.62-9.74h-4.46v5.39h4.46zm0 9.61h-4.46v5.39h4.46zm13.54-17.49h-4.23l-6.48 22.88h4.22zm8.68 0h-4.23l-6.45 22.88h4.19zm15 22.51l-.07-2.26a1.22 1.22 0 01-.56.1c-.69 0-1-.39-1-1.16v-6.49a4.39 4.39 0 00-1.8-3.84 7 7 0 00-4.16-1.28 14.55 14.55 0 00-3.16.3 24.14 24.14 0 00-3.29 1.06l-.56 3.46 3.39.4.5-1.69a2.78 2.78 0 011.08-.37 11.3 11.3 0 011.25-.07c1.19 0 1.89.37 2.09 1.1a8.55 8.55 0 01.3 2.26v.5a8.91 8.91 0 00-1.18-.11h-1.21a12.64 12.64 0 00-4.81.88 3.53 3.53 0 00-2.18 3.64 3.66 3.66 0 001.48 3.33 5.63 5.63 0 003.11 1 4.67 4.67 0 003-.91 6.78 6.78 0 001.8-2 3 3 0 003.33 3 5.54 5.54 0 002.66-.85zm-9.25-2.32a1.69 1.69 0 01-1.36-.52 1.81 1.81 0 01-.43-1.21 1.67 1.67 0 01.86-1.68 4.63 4.63 0 012-.42 7.69 7.69 0 011.07.07l1.06.13a3.58 3.58 0 01-1.08 2.74 3.24 3.24 0 01-2.11.89z"></path></svg></a><button type="button" class="ghost main-menu-toggle" aria-haspopup="true" aria-label="Show Menu"></button><div class="page-header-main "><nav class="main-nav" aria-label="Main menu"><ul class="main-menu nojs"><li class="top-level-entry-container"><button id="technologies-button" type="button" class="top-level-entry" aria-haspopup="menu" aria-expanded="false">Technologies</button><ul class="technologies " role="menu" aria-labelledby="technologies-button"><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web" role="menuitem">Technologies Overview</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web/HTML" role="menuitem">HTML</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web/CSS" role="menuitem">CSS</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web/JavaScript" role="menuitem">JavaScript</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web/Guide/Graphics" role="menuitem">Graphics</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web/HTTP" role="menuitem">HTTP</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web/API" role="menuitem">APIs</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Mozilla/Add-ons/WebExtensions" role="menuitem">Browser Extensions</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web/MathML" role="menuitem">MathML</a></li></ul></li><li class="top-level-entry-container"><button id="references-guides-button" type="button" class="top-level-entry" aria-haspopup="menu" aria-expanded="false">References &amp; Guides</button><ul class="references-guides " role="menu" aria-labelledby="references-guides-button"><li role="none"><a tabindex="-1" href="/zh-TW/docs/Learn" role="menuitem">Learn web development</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web/Tutorials" role="menuitem">Tutorials</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web/Reference" role="menuitem">References</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web/Guide" role="menuitem">Developer Guides</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web/Accessibility" role="menuitem">Accessibility</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Games" role="menuitem">Game development</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/Web" role="menuitem">...more docs</a></li></ul></li><li class="top-level-entry-container"><button id="feedback-button" type="button" class="top-level-entry" aria-haspopup="menu" aria-expanded="false">Feedback</button><ul class="feedback " role="menu" aria-labelledby="feedback-button"><li role="none"><a tabindex="-1" href="/zh-TW/docs/MDN/Contribute/Feedback" role="menuitem">Send Feedback</a></li><li role="none"><a tabindex="-1" href="/zh-TW/docs/MDN/Contribute" role="menuitem">Contribute to MDN</a></li><li role="none"><a tabindex="-1" target="_blank" rel="noopener noreferrer" href="https://github.com/mdn/content/issues/new" role="menuitem">Report a content issue<!-- --> ğŸŒ</a></li><li role="none"><a tabindex="-1" target="_blank" rel="noopener noreferrer" href="https://github.com/mdn/yari/issues/new" role="menuitem">Report a platform issue<!-- --> ğŸŒ</a></li></ul></li></ul></nav><div class="header-search"><form action="/zh-TW/search" class="search-form search-widget" role="search"><label for="main-q" class="visually-hidden">Search MDN</label><input type="search" name="q" id="main-q" class="search-input-field" placeholder="Site search... (Press &quot;/&quot; to focus)" pattern="(.|\s)*\S(.|\s)*" required="" value=""><input type="submit" class="ghost search-button" value="" aria-label="Search"></form></div><div class="auth-container"></div></div></header><div class="breadcrumb-locale-container"><nav class="breadcrumbs-container" aria-label="Breadcrumb navigation"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/zh-TW/docs/Web"><span property="name">çµ¦é–‹ç™¼è€…çš„ç¶²é æŠ€è¡“æ–‡ä»¶</span></a><meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="/zh-TW/docs/Web/API"><span property="name">Web APIs</span></a><meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-penultimate" property="item" typeof="WebPage" href="/zh-TW/docs/Web/API/IndexedDB_API"><span property="name">IndexedDB</span></a><meta property="position" content="3"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-current-page" property="item" typeof="WebPage" href="/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB"><span property="name">ä½¿ç”¨IndexedDB</span></a><meta property="position" content="4"></li></ol></nav><ul class="language-toggle"><li><a href="#select-language" class="language-icon"><span class="show-desktop">Change language</span></a></li><li><a class="view-in-english" href="/en-US/docs/Web/API/IndexedDB_API/Using_IndexedDB"><span class="show-desktop">View in</span> English</a></li></ul></div><div class="localized-content-note notecard inline neutral"><a href="/en-US/docs/MDN/Contribute/Localize#active_locales">This page was translated from English by the community. Learn more and join the MDN Web Docs community.</a></div><aside class="document-toc-container"><section class="document-toc"><header><h2>Table of contents</h2><button type="button" class="ghost toc-trigger-mobile" aria-controls="toc-entries" aria-expanded="false">Table of contents</button></header><ul id="toc-entries"><li><a href="#é—œæ–¼æœ¬æ–‡">é—œæ–¼æœ¬æ–‡</a></li><li><a href="#åŸºæœ¬æ“ä½œæ­¥é©Ÿ">åŸºæœ¬æ“ä½œæ­¥é©Ÿ</a></li><li><a href="#å»ºç«‹å’Œçµæ§‹è³‡æ–™åº«">å»ºç«‹å’Œçµæ§‹è³‡æ–™åº«</a></li><li><a href="#æ–°å¢å’Œåˆªé™¤è³‡æ–™">æ–°å¢å’Œåˆªé™¤è³‡æ–™</a></li><li><a href="#ç§»é™¤è³‡æ–™">ç§»é™¤è³‡æ–™</a></li><li><a href="#è®€å–è³‡æ–™">è®€å–è³‡æ–™</a></li><li><a href="#ä½¿ç”¨æŒ‡æ¨™cursor">ä½¿ç”¨æŒ‡æ¨™(Cursor)</a></li><li><a href="#ç•¶ç¶²é æ‡‰ç”¨ç¨‹å¼æ–¼ç€è¦½å™¨å¦ä¸€å€‹åˆ†é é–‹å•Ÿæ™‚è®Šæ›´ç‰ˆæœ¬">ç•¶ç¶²é æ‡‰ç”¨ç¨‹å¼æ–¼ç€è¦½å™¨å¦ä¸€å€‹åˆ†é é–‹å•Ÿæ™‚è®Šæ›´ç‰ˆæœ¬</a></li><li><a href="#å®‰å…¨æ€§">å®‰å…¨æ€§</a></li><li><a href="#ç€è¦½å™¨é—œé–‰é¢¨éšª">ç€è¦½å™¨é—œé–‰é¢¨éšª</a></li><li><a href="#å®Œæ•´_indexeddb_ç¯„ä¾‹">å®Œæ•´ IndexedDB ç¯„ä¾‹</a></li><li><a href="#ä¸‹ä¸€æ­¥">ä¸‹ä¸€æ­¥</a></li><li><a href="#å»¶ä¼¸é–±è®€">å»¶ä¼¸é–±è®€</a></li></ul></section></aside><main id="content" class="main-content" role="main"><article class="main-page-content" lang="zh-TW"><h1>ä½¿ç”¨IndexedDB</h1><div><p>IndexedDB æä¾›äº†åœ¨ç€è¦½å™¨ä¸Šå„²å­˜ä¿ç•™è³‡æ–™çš„åŠŸèƒ½ï¼Œè—‰ç”±å®ƒï¼Œä¸è«–æ˜¯ç·šä¸Šæˆ–ç·šä¸‹æˆ‘å€‘çš„æ‡‰ç”¨éƒ½å¯ä»¥é€²è¡Œè³‡æ–™å­˜å–ã€‚</p></div><h2 id="é—œæ–¼æœ¬æ–‡"><a href="#é—œæ–¼æœ¬æ–‡" title="Permalink to é—œæ–¼æœ¬æ–‡">é—œæ–¼æœ¬æ–‡</a></h2><div><p>æœ¬æ–‡æœƒå¸¶é ˜å„ä½æ“ä½œéåŒæ­¥ IndexedDB çš„ APIï¼Œå¦‚æœä¸çŸ¥é“ç”šéº¼æ˜¯ IndexedDBï¼Œè«‹å…ˆçœ‹çœ‹<a href="/en-US/docs/Web/API/IndexedDB_API/Basic_Terminology">"IndexedDB åŸºæœ¬ç¤å¿µ"</a>ã€‚</p></div><h2 id="åŸºæœ¬æ“ä½œæ­¥é©Ÿ"><a href="#åŸºæœ¬æ“ä½œæ­¥é©Ÿ" title="Permalink to åŸºæœ¬æ“ä½œæ­¥é©Ÿ">åŸºæœ¬æ“ä½œæ­¥é©Ÿ</a></h2><div><p>æ“ä½œ IndexedDB çš„åŸºæœ¬æ­¥é©Ÿå»ºè­°å¦‚ä¸‹:</p>
<ol>
  <li>é–‹å•Ÿè³‡æ–™åº«å’Œäº¤æ˜“(transaction)ã€‚</li>
  <li>å»ºç«‹ç‰©ä»¶å­˜æª”(object store)</li>
  <li>ç™¼å‡ºè³‡æ–™åº«æ“ä½œè«‹æ±‚ï¼Œä¾‹å¦‚æ–°å¢æˆ–å–å¾—è³‡æ–™ã€‚</li>
  <li>è†è½å°æ‡‰ DOM äº‹ä»¶ç­‰å¾…æ“ä½œå®Œæˆã€‚</li>
  <li>å¾ result ç‰©ä»¶ä¸Šå–å¾—çµæœé€²è¡Œå…¶ä»–å·¥ä½œã€‚</li>
</ol>
<p>å¥½äº†ï¼ŒçŸ¥é“äº†ä¸Šè¿°æ¦‚å¿µå¾Œï¼Œæˆ‘å€‘å¯ä»¥ä¾†å¯¦éš›åšäº›ç”šéº¼ã€‚</p></div><h2 id="å»ºç«‹å’Œçµæ§‹è³‡æ–™åº«"><a href="#å»ºç«‹å’Œçµæ§‹è³‡æ–™åº«" title="Permalink to å»ºç«‹å’Œçµæ§‹è³‡æ–™åº«">å»ºç«‹å’Œçµæ§‹è³‡æ–™åº«</a></h2><div><p>ç”±æ–¼ IndexedDB çš„æ¨™æº–ä»åœ¨æ¼”é€²ï¼Œæ‰€ä»¥ç›®å‰ä¸€äº›å¯¦ä½œé‚„éœ€è¦åŠ ä¸Šç€è¦½å™¨å‰ç¶´æ¨™ç¤º(å¦‚ Gecko åŸºç¤ç€è¦½å™¨çš„å‰ç¶´æ¨™ç¤ºç‚º mozï¼ŒWebKit åŸºç¤ç€è¦½å™¨çš„å‰ç¶´æ¨™ç¤ºç‚º webkit)ï¼Œç€è¦½å™¨çš„å¯¦ä½œä¹Ÿå¯èƒ½æœƒæœ‰æ‰€å·®ç•°ï¼Œä¸éä¸€æ—¦å…±è­˜æ¨™æº–é”æˆï¼Œç„¡ç€è¦½å™¨å‰ç¶´æ¨™ç¤ºå¯¦ä½œå°‡å‡ºç¾ã€‚å…¶å¯¦ï¼ŒInternet Explorer 10, Firefox 16, Chrome 24 å·²ç¶“æœ‰äº†ç„¡ç€è¦½å™¨å‰ç¶´æ¨™ç¤ºå¯¦ä½œã€‚</p></div><h3 id="æ“ä½œå¯¦é©—æ€§è³ªçš„_indexeddb"><a href="#æ“ä½œå¯¦é©—æ€§è³ªçš„_indexeddb" title="Permalink to æ“ä½œå¯¦é©—æ€§è³ªçš„ IndexedDB">æ“ä½œå¯¦é©—æ€§è³ªçš„ IndexedDB</a></h3><div><p>å¦‚æœéœ€è¦è©¦é©—ç€è¦½å™¨çš„å‰ç¶´æ¨™ç¤ºï¼Œå¯ä»¥å¦‚ä¸‹:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// In the following line, you should include the prefixes of implementations you want to test.</span>
window<span class="token punctuation">.</span>indexedDB <span class="token operator">=</span> window<span class="token punctuation">.</span>indexedDB <span class="token operator">||</span> window<span class="token punctuation">.</span>mozIndexedDB <span class="token operator">||</span> window<span class="token punctuation">.</span>webkitIndexedDB <span class="token operator">||</span> window<span class="token punctuation">.</span>msIndexedDB<span class="token punctuation">;</span>
<span class="token comment">// DON'T use "var indexedDB = ..." if you're not in a function.</span>
<span class="token comment">// Moreover, you may need references to some window.IDB* objects:</span>
window<span class="token punctuation">.</span>IDBTransaction <span class="token operator">=</span> window<span class="token punctuation">.</span>IDBTransaction <span class="token operator">||</span> window<span class="token punctuation">.</span>webkitIDBTransaction <span class="token operator">||</span> window<span class="token punctuation">.</span>msIDBTransaction<span class="token punctuation">;</span>
window<span class="token punctuation">.</span>IDBKeyRange <span class="token operator">=</span> window<span class="token punctuation">.</span>IDBKeyRange <span class="token operator">||</span> window<span class="token punctuation">.</span>webkitIDBKeyRange <span class="token operator">||</span> window<span class="token punctuation">.</span>msIDBKeyRange<span class="token punctuation">;</span>
<span class="token comment">// (Mozilla has never prefixed these objects, so we don't need window.mozIDB*)</span>
</code></pre></div>
<p>è«‹æ³¨æ„ç€è¦½å™¨å‰ç¶´æ¨™ç¤ºçš„å¯¦ä½œå¯èƒ½ä¸å®Œæ•´ã€æœ‰äº›å•é¡Œæˆ–ä»ç„¶éµå®ˆèˆŠç‰ˆæ¨™æº–ï¼Œå› æ­¤ä¸å»ºè­°åœ¨æ­£å¼ç‰ˆç¨‹å¼ç¢¼ä¸­ä½¿ç”¨ã€‚èˆ‡å…¶å®£ç¨±æ”¯æ´åˆæœ‰å•é¡Œï¼Œå€’ä¸å¦‚ç›´æ¥ä¸æ”¯æ´ã€‚</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>indexedDB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div><h3 id="é–‹å•Ÿè³‡æ–™åº«"><a href="#é–‹å•Ÿè³‡æ–™åº«" title="Permalink to é–‹å•Ÿè³‡æ–™åº«">é–‹å•Ÿè³‡æ–™åº«</a></h3><div><p>é–‹é ­å¦‚ä¸‹:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// Let us open our database</span>
<span class="token keyword">var</span> request <span class="token operator">=</span> window<span class="token punctuation">.</span>indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"MyTestDatabase"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>æ³¨æ„åˆ°äº†å—ï¼Œé–‹å•Ÿè³‡æ–™åº«å¿…é ˆè¦é€²è¡Œè«‹æ±‚ã€‚</p>
<p>é–‹å•Ÿè«‹æ±‚ä¸¦ä¸æœƒç«‹åˆ»é–‹å•Ÿè³‡æ–™åº«æˆ–äº¤æ˜“ï¼Œå‘¼å« open()æ–¹æ³•æœƒå›å‚³ä¸€å€‹<a href="/en-US/docs/Web/API/IDBOpenDBRequest" class="only-in-en-us" title="Currently only available in English (US)">IDBOpenDBRequest (en-US)</a>ç‰©ä»¶ï¼Œé€™å€‹ç‰©ä»¶æ“æœ‰å…©å€‹äº‹ä»¶(success å’Œ error)ã€‚å¤§éƒ¨åˆ† IndexedDB çš„éåŒæ­¥åŠŸèƒ½éƒ½æœƒå›å‚³ä¸€å€‹<a href="/en-US/docs/Web/API/IDBDatabase" class="only-in-en-us" title="Currently only available in English (US)">IDBDatabase (en-US)</a>é¡ç‰©ä»¶ï¼Œç„¶å¾Œæˆ‘å€‘å¯ä»¥è¨»å†ŠæˆåŠŸå’Œå¤±æ•—äº‹ä»¶è™•ç†å™¨ã€‚</p>
<p>Open æ–¹æ³•ç¬¬äºŒå€‹åƒæ•¸æ˜¯è³‡æ–™åº«ç‰ˆæœ¬ï¼Œè³‡æ–™åº«ç‰ˆæœ¬æ±ºå®šäº†è³‡æ–™åº«çµæ§‹ï¼Œä¹Ÿå°±æ˜¯è³‡æ–™åº«ç‰©ä»¶å­˜æª”çš„çµæ§‹ã€‚å¦‚æœè«‹æ±‚ç‰ˆæœ¬ä¸å­˜åœ¨(æ¯”å¦‚å› ç‚ºé€™æ˜¯ä¸€å€‹æ–°è³‡æ–™åº«æˆ–æ˜¯è³‡æ–™åº«ç‰ˆæœ¬å·²å‡ç´š)ï¼Œonupgradeneeded äº‹ä»¶æœƒè¢«è§¸ç™¼ï¼Œç„¶å¾Œæˆ‘å€‘å¯ä»¥åœ¨ onupgradeneeded äº‹ä»¶è™•ç†å™¨ä¸­å†å»ºç«‹æ–°çš„ç‰ˆæœ¬ï¼Œä¸‹é¢<a href="#updating_the_version_of_the_database">å‡ç´šè³‡æ–™åº«ç‰ˆæœ¬</a>æœ‰æ›´è©³ç´°çš„èªªæ˜ã€‚</p>
<h4 id="ç”¢ç”Ÿäº‹ä»¶è™•ç†å™¨">ç”¢ç”Ÿäº‹ä»¶è™•ç†å™¨</h4>
<p>å¹¾ä¹æ‰€æœ‰ç¬¬ä¸€ä»¶è¦å°è«‹æ±‚åšçš„äº‹éƒ½æ˜¯ç”¢ç”Ÿ success å’Œ error äº‹ä»¶è™•ç†å™¨:</p>
<div class="code-example"><pre class="brush: js notranslate"><code>request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Do something with request.errorCode!</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Do something with request.result!</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œsuccess äº‹ä»¶(ä¹Ÿå°±æ˜¯ DOM äº‹ä»¶çš„ type å±¬æ€§è¨­ç‚º success)æœƒä»¥ request ç‚ºç›®æ¨™è§¸ç™¼ï¼Œç„¶å¾Œ request ç‰©ä»¶ä¸Šçš„ onsuccess å‡½æ•¸æ¥è‘—è¢«å‘¼å«ï¼Œå…¶ä¸­ success äº‹ä»¶å°±æ˜¯åƒæ•¸ï¼›å¦å‰‡ error äº‹ä»¶(ä¹Ÿå°±æ˜¯ DOM äº‹ä»¶çš„ type å±¬æ€§è¨­ç‚º error)æœƒä»¥ request ç‚ºç›®æ¨™è§¸ç™¼ï¼Œç„¶å¾Œ request ç‰©ä»¶ä¸Šçš„ onerror å‡½æ•¸æ¥è‘—è¢«å‘¼å«ï¼Œå…¶ä¸­ error äº‹ä»¶å°±æ˜¯åƒæ•¸ã€‚</p>
<p>IndexedDB çš„ API è¨­è¨ˆä¸Šç›¡é‡æ¸›å°‘éŒ¯èª¤è™•ç†ï¼Œæ‰€ä»¥ä¸å¤ªå¸¸çœ‹åˆ°éŒ¯èª¤äº‹ä»¶ï¼Œä¸éé–‹å•Ÿè³‡æ–™åº«çš„æ™‚å€™é‚„æ˜¯æœ‰ä¸€äº›ç‹€æ³æœƒç”¢ç”¢ç”ŸéŒ¯èª¤ï¼Œæœ€å¸¸è¦‹çš„ç‹€æ³æ˜¯ä½¿ç”¨è€…æ‹’çµ•æˆ‘å€‘å»ºç«‹è³‡æ–™åº«ã€‚</p>
<p>IndexedDB è¨­è¨ˆç›®æ¨™ä¹‹ä¸€ç‚ºå­˜æ”¾å¤§é‡è³‡æ–™ä»¥ä¾›é›¢ç·šä½¿ç”¨(è«‹åƒè€ƒ<a href="/zh-TW/IndexedDB#Storage_limits" class="page-not-created" title="This is a link to an unwritten page">"å„²å­˜é™åˆ¶"</a>äº†è§£æ›´å¤šç´°ç¯€)ã€‚ä½†å¾ˆæ˜é¡¯åœ°ï¼Œç€è¦½å™¨åˆä¸æ¨‚è¦‹ä¸€äº›å»£å‘Šç¶²ç«™æˆ–æƒ¡æ„ç¶²ç«™æ±™æŸ“é›»è…¦ï¼Œæ‰€ä»¥ç•¶ä»»ä¸€å€‹ç¶²è·¯æ‡‰ç”¨ç¬¬ä¸€æ¬¡é–‹å•Ÿ IndexedDB è³‡æ–™åº«ï¼Œç€è¦½å™¨æœƒå¾µè©¢ä½¿ç”¨è€…æ˜¯å¦å‡†è¨±å…¶ä½œæ¥­ï¼›åŒæ™‚åœ¨ç§å¯†ç€è¦½ä¸­é–‹å•Ÿä½œæ¥­ä¹Ÿæœƒå¤±æ•—ï¼Œå› ç‚ºç§å¯†ç€è¦½ä¸æœƒç•™ä¸‹ä»»ä½•ç€è¦½ç—•è·¡ã€‚</p>
<p>é€™è£¡å‘¼å« indexedDB.open()é–‹å•Ÿ indexedDB è³‡æ–™åº«ä¸¦å›å‚³ request ç‰©ä»¶ï¼Œå‡è¨­ä½¿ç”¨è€…å…è¨±æˆ‘å€‘å»ºç«‹ indexedDB è³‡æ–™åº«ï¼Œæˆ‘å€‘ä¹Ÿæ”¶åˆ° suceess äº‹ä»¶è§¸ç™¼äº† success å›å‘¼å‡½æ•¸(callback)ï¼Œrequest ç‰©ä»¶çš„ result å±¬æ€§æœƒæ˜¯ä¸€å€‹ IDBDatabase ç‰©ä»¶ ï¼Œæ¥ä¸‹ä¾†ä¾¿æ˜¯è¦å„²å­˜é€™å€‹ç‰©ä»¶ä¹‹å¾Œä½¿ç”¨ã€‚ä¸‹æ–¹æ˜¯æ•´å€‹ä½œæ¥­çš„ç¤ºç¯„ç¨‹å¼ç¢¼:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">var</span> db<span class="token punctuation">;</span>
<span class="token keyword">var</span> request <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"MyTestDatabase"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Why didn't you allow my web app to use IndexedDB?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  db <span class="token operator">=</span> request<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<h4 id="éŒ¯èª¤è™•ç†">éŒ¯èª¤è™•ç†</h4>
<p>éŒ¯èª¤äº‹ä»¶æœƒå‘ä¸Šå‚³éï¼›éŒ¯èª¤äº‹ä»¶ä»¥ç”¢ç”ŸéŒ¯èª¤ä¹‹è«‹æ±‚ç‚ºç›®æ¨™è§¸ç™¼ï¼Œç„¶å¾Œä¸€è·¯å‚³éåˆ°äº¤æ˜“ï¼Œæœ€å¾Œåˆ°è³‡æ–™åº«ç‰©ä»¶ï¼›å¦‚æœä¸æƒ³è¦ç‚ºæ¯ä¸€å€‹è«‹æ±‚æ–°å¢éŒ¯èª¤è™•ç†å™¨ï¼Œå¯ä»¥æ”¹ç‚ºè³‡æ–™åº«ç‰©ä»¶åŠ å…¥ä¸€å€‹éŒ¯èª¤è™•ç†å™¨ã€‚</p>
<div class="code-example"><pre class="brush: js notranslate"><code>db<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Generic error handler for all errors targeted at this database's</span>
  <span class="token comment">// requests!</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Database error: "</span> <span class="token operator">+</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>errorCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>æœ€å¸¸è¦‹çš„éŒ¯èª¤ä¹‹ä¸€å°±æ˜¯ VER_ERRï¼Œè©²éŒ¯èª¤ä»£è¡¨ç¾åœ¨è³‡æ–™æ–™åº«ç‰ˆæœ¬å¤§æ–¼å˜—è©¦é–‹å•Ÿçš„è³‡æ–™åº«ç‰ˆæœ¬ï¼Œé€™é …éŒ¯èª¤å¿…é ˆè¦æœ‰éŒ¯èª¤è™•ç†å™¨è™•ç†ã€‚</p></div><h3 id="å»ºç«‹æˆ–æ›´æ–°è³‡æ–™åº«ç‰ˆæœ¬"><a href="#å»ºç«‹æˆ–æ›´æ–°è³‡æ–™åº«ç‰ˆæœ¬" title="Permalink to å»ºç«‹æˆ–æ›´æ–°è³‡æ–™åº«ç‰ˆæœ¬">å»ºç«‹æˆ–æ›´æ–°è³‡æ–™åº«ç‰ˆæœ¬</a></h3><div><p>æ–°ç‰ˆæœ¬è³‡æ–™åº«å»ºç«‹æœƒè§¸ç™¼ onupgradeneeded äº‹ä»¶ï¼Œåœ¨é€™å€‹äº‹ä»¶çš„è™•ç†å™¨ä¸­è¦å»ºç«‹é€™å€‹ç‰ˆæœ¬è³‡æ–™åº«éœ€è¦çš„ç‰©ä»¶å­˜æª”ã€‚</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// This event is only implemented in recent browsers</span>
request<span class="token punctuation">.</span><span class="token function-variable function">onupgradeneeded</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> db <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>

  <span class="token comment">// Create an objectStore for this database</span>
  <span class="token keyword">var</span> objectStore <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">createObjectStore</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">keyPath</span><span class="token operator">:</span> <span class="token string">"myKey"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>è³‡æ–™åº«ç‰ˆæœ¬æ˜¯ unsigned long long çš„æ•¸å­—ï¼Œæ‰€ä»¥èƒ½å¤ éå¸¸é•·ã€‚</p>
<div class="notecard warning" id="sect1">
  <p><strong>è­¦å‘Šï¼š</strong> è«‹æ³¨æ„é€™ä¹Ÿæ„å‘³è‘—ç‰ˆæœ¬ä¸èƒ½ç‚ºæµ®é»æ•¸ï¼Œå¦å‰‡å°æ•¸é»éƒ¨åˆ†å°‡æœƒç„¡æ¢ä»¶æ¨å»ï¼Œè€Œäº¤æ˜“ä¹Ÿå¯èƒ½ä¸æœƒé–‹å§‹ï¼Œupgradeneeded äº‹ä»¶ä¹Ÿä¸æœƒè§¸ç™¼ã€‚ä¸è¦åƒä»¥ä¸‹ä¾‹å­ä»¥ 2.4 ä½œç‰ˆæœ¬:</p>
  <div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">var</span> request <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"MyTestDatabase"</span><span class="token punctuation">,</span> <span class="token number">2.4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// don't do this, as the version will be rounded to 2</span>
</code></pre></div>
</div>
<p>å‡ç´šç‰ˆæœ¬è³‡æ–™åº«å»ºç«‹æœƒè§¸ç™¼ onupgradeneeded äº‹ä»¶ï¼Œé€™å€‹æ™‚å€™è³‡æ–™åº«è£¡é¢å·²ç¶“å«æœ‰å‰ç‰ˆæœ¬ä¸‹çš„ç‰©ä»¶å­˜æª”ï¼Œæ‰€ä»¥èªªä¸éœ€è¦å†æ¬¡å»ºç«‹é€™äº›ç‰©ä»¶å­˜æª”äº†ï¼Œå‰©ä¸‹çš„æ˜¯æ–°å¢æˆ–åˆªé™¤ç‰©ä»¶å­˜æª”ã€‚å¦‚æœæƒ³è¦æ›´å‹•æ—¢å­˜ç‰©ä»¶å­˜æª”(ä¾‹å¦‚æ”¹è®Šè³‡æ–™éµè·¯å¾‘)ï¼Œé‚£éº¼æœƒéœ€è¦å…ˆåˆªé™¤èˆŠçš„å†ç”¢ç”Ÿä¸€å€‹æ–°çš„(è«‹æ³¨æ„é€™ä¹Ÿæœƒåˆªé™¤ç‰©ä»¶å­˜æª”è£¡çš„è³‡æ–™ï¼Œæ‰€ä»¥å¦‚æœè³‡æ–™éœ€è¦ä¿ç•™çš„è©±ï¼Œè«‹åœ¨å‡ç´šå‰å…ˆè®€å‡ºè³‡æ–™å‚™ä»½ã€‚)</p>
<p>Webkit æ”¯æ´æœ€æ–°æ¨™æº–ä¸éåªæœ‰ Chrome 23 æ‰é–‹å§‹å°å…¥ï¼Œè€Œè¼ƒèˆŠä¸æ”¯æ´æœ€æ–°ç‰ˆæ¨™æº–çš„ç‰ˆæœ¬å‰‡ä¸æ”¯æ´ indexedDB.open(name, version).onupgradeneededã€‚é—œæ–¼å¦‚ä½•åœ¨èˆŠç‰ˆæ¨™æº–ä¸‹å‡ç´šè³‡æ–™åº«ç‰ˆæœ¬è«‹åƒè€ƒ<a href="/zh-TW/docs/Web/API/IDBDatabase?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBDatabase#setVersion%28%29_.0A.0ADeprecated" class="page-not-created" title="This is a link to an unwritten page">"IDBDatabase åƒè€ƒæ–‡ç« "</a>ã€‚</p></div><h3 id="çµæ§‹åŒ–è³‡æ–™åº«"><a href="#çµæ§‹åŒ–è³‡æ–™åº«" title="Permalink to çµæ§‹åŒ–è³‡æ–™åº«">çµæ§‹åŒ–è³‡æ–™åº«</a></h3><div><p>indexedDB ä¸ç”¨è³‡æ–™è¡¨è€Œæ˜¯ç‰©ä»¶å­˜æª”ï¼Œç‰©ä»¶å­˜æª”å¯ä»¥æœ‰å¾ˆå¤šã€‚ä¸€ç­†ç‰©ä»¶å­˜æª”è£¡çš„è³‡æ–™å€¼å°æ‡‰ä¸€ç­†è³‡æ–™éµï¼Œä¾æ“šä½¿ç”¨{è³‡æ–™éµè·¯å¾‘(<a href="/zh-TW/IndexedDB#gloss_key_path" class="page-not-created" title="This is a link to an unwritten page">key path</a>)}æˆ–{è³‡æ–™éµç”¢ç”Ÿå™¨(<a href="/zh-TW/IndexedDB#gloss_key_generator" class="page-not-created" title="This is a link to an unwritten page">key generator</a>)}ã€‚</p>
<p>ä¸‹è¡¨åˆ—å‡ºè³‡æ–™å»ºå„é¡ç”¢ç”Ÿé€”å¾‘:</p>
<table>
  <thead>
    <tr>
      <th>Key Path</th>
      <th>Key Generator</th>
      <th>æè¿°</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>No</td>
      <td>No</td>
      <td>ç‰©ä»¶å­˜æª”è³‡æ–™å€¼èƒ½ç‚ºä»»ä½•å‹åˆ¥ï¼Œå³ä½¿åƒæ•¸å­—æˆ–å­—ä¸²ã€‚æ¯ç•¶æ–°å¢ä¸€ç­†è³‡æ–™ï¼Œå¿…é ˆæä¾›ä¸åŒçš„è³‡æ–™éµã€‚</td>
    </tr>
    <tr>
      <td>Yes</td>
      <td>No</td>
      <td>ç‰©ä»¶å­˜æª”è³‡æ–™å€¼åƒ…èƒ½ç‚º Javacript ç‰©ä»¶ï¼Œè€Œè©²è³‡æ–™ç‰©ä»¶å¿…é ˆå«æœ‰å’Œè³‡æ–™éµè·¯å¾‘ç›¸åŒåç¨±ä¹‹å±¬æ€§æˆå“¡ã€‚</td>
    </tr>
    <tr>
      <td>No</td>
      <td>Yes</td>
      <td>ç‰©ä»¶å­˜æª”è³‡æ–™å€¼èƒ½ç‚ºä»»ä½•å‹åˆ¥ï¼Œè³‡æ–™éµè‡ªå‹•ç”¢ç”Ÿï¼Œä½†å¦‚æœæƒ³è¦æŒ‡å®šè³‡æ–™éµä¹Ÿå¯ä»¥å¦å¤–æä¾›è³‡æ–™éµã€‚</td>
    </tr>
    <tr>
      <td>Yes</td>
      <td>Yes</td>
      <td>ç‰©ä»¶å­˜æª”è³‡æ–™å€¼åƒ…èƒ½ç‚º Javascript ç‰©ä»¶ã€‚é€šå¸¸è¢«ç”¢ç”Ÿçš„æ–°è³‡æ–™éµçš„å€¼æœƒè¢«å­˜åœ¨ç‰©ä»¶å±¬æ€§åç¨±å’Œè³‡æ–™éµè·¯å¾‘åç¨±ç›¸åŒçš„ç‰©ä»¶å±¬æ€§ä¸‹ï¼Œå¦‚æœé€™å€‹å±¬æ€§å·²ç¶“å­˜åœ¨ï¼Œé€™å€‹å·²ç¶“å­˜åœ¨ä¹‹å±¬æ€§ä¹‹å€¼å°‡è¢«ç”¨ä½œç‚ºè³‡æ–™éµï¼Œè€Œéæ–°ç”¢ç”Ÿçš„è³‡æ–™éµã€‚</td>
    </tr>
  </tbody>
</table>
<p>æˆ‘å€‘å¯ä»¥æ›¿ä»»ä½•å„²å­˜è³‡æ–™ç‚ºç‰©ä»¶å‹æ…‹è€ŒéåŸå§‹è³‡æ–™å‹æ…‹çš„ç‰©ä»¶å­˜æª”å»ºç«‹ç´¢å¼•ï¼Œç´¢å¼•è®“æˆ‘å€‘èƒ½å¤ ç”¨ç‰©ä»¶å­˜æª”ä¸­è³‡æ–™ç‰©ä»¶å…§çš„æŸä¸€å€‹å±¬æ€§å€¼æŸ¥æ‰¾è³‡æ–™ï¼Œè€Œéåƒ…åƒ…ç‰©ä»¶çš„è³‡æ–™éµã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œåˆ©ç”¨ç´¢å¼•é‚„å¯ä»¥æ–½åŠ ç°¡å–®çš„å„²å­˜é™åˆ¶ï¼›å»ºç«‹ç´¢å¼•æ™‚è¨­å®šç¨ç‰¹æ——æ¨™(flag)ï¼Œé€™å€‹ç´¢å¼•ä¿è­‰åœ¨æ­¤ç´¢å¼•è³‡æ–™éµä¸‹ä¸æœƒå­˜åœ¨å…©å€‹ç‰©ä»¶å­˜æª”æ“æœ‰åŒæ¨£è³‡æ–™å€¼ï¼Œæ¯”å¦‚èªªç¾åœ¨æœ‰ä¸€å€‹å­˜æ”¾è¨±å¤šä½¿ç”¨è€…çš„ç‰©ä»¶å­˜æª”ï¼Œè€Œä¸”æˆ‘å€‘å¸Œæœ›ä¿è­‰ä¸æœƒå­˜åœ¨æœ‰å…©å€‹ä½¿ç”¨è€…çš„é›»å­éƒµä»¶åœ°å€ä¸€æ¨£ï¼Œæ­¤ä½¿ç´¢å¼•çš„ç¨ç‰¹æ——æ¨™ä¾¿å¯ä»¥å¹«åŠ©æˆ‘å€‘é”æˆç›®æ¨™ã€‚</p>
<p>ä»¥ä¸Šè½èµ·ä¾†å¯èƒ½æœƒæœ‰äº›è¤‡é›œï¼Œè«‹çœ‹ä¸€ä¸‹ä¸‹é¢çš„å¯¦ä¾‹:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// This is what our customer data looks like.</span>
<span class="token keyword">const</span> customerData <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">ssn</span><span class="token operator">:</span> <span class="token string">"444-44-4444"</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"Bill"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">"bill@company.com"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">ssn</span><span class="token operator">:</span> <span class="token string">"555-55-5555"</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"Donna"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">"donna@home.org"</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dbName <span class="token operator">=</span> <span class="token string">"the_name"</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> request <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>dbName<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Handle errors.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function-variable function">onupgradeneeded</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> db <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>

  <span class="token comment">// Create an objectStore to hold information about our customers. We're</span>
  <span class="token comment">// going to use "ssn" as our key path because it's guaranteed to be</span>
  <span class="token comment">// unique.</span>
  <span class="token keyword">var</span> objectStore <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">createObjectStore</span><span class="token punctuation">(</span><span class="token string">"customers"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">keyPath</span><span class="token operator">:</span> <span class="token string">"ssn"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Create an index to search customers by name. We may have duplicates</span>
  <span class="token comment">// so we can't use a unique index.</span>
  objectStore<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Create an index to search customers by email. We want to ensure that</span>
  <span class="token comment">// no two customers have the same email, so use a unique index.</span>
  objectStore<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">,</span> <span class="token string">"email"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Store values in the newly created objectStore.</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> customerData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    objectStore<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>customerData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>è«‹æ³¨æ„ onupgradeneeded äº‹ä»¶æ˜¯å”¯ä¸€èƒ½å¤ è®Šæ›´è³‡æ–™åº«çµæ§‹ä¹‹è™•ï¼Œåœ¨æ­¤äº‹ä»¶æ‰èƒ½å»ºç«‹æˆ–åˆªé™¤ç‰©ä»¶å­˜æª”ä»¥åŠå»ºç«‹å’Œåˆªé™¤ç´¢å¼•ã€‚</p>
<p>å‘¼å«<a href="/zh-TW/docs/Web/API/IDBDatabase?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBDatabase#setVersion%28%29_.0A.0ADeprecated" class="page-not-created" title="This is a link to an unwritten page">IDBDatabase</a>é¡åˆ¥ç‰©ä»¶çš„ createObjectStore æ–¹æ³•æœƒç«‹åˆ»å‰µé€ ä¸€å€‹ç‰©ä»¶å­˜æª”ï¼Œé€™å€‹æ–¹æ³•æ¥æ”¶å…©å€‹åƒæ•¸ï¼Œä¸€å€‹æ˜¯ç‰©ä»¶å­˜æª”åç¨±ï¼Œä¸€å€‹æ˜¯éå¿…å¡«çš„åƒæ•¸ç‰©ä»¶ï¼Œé›–ç„¶åƒæ•¸ç‰©ä»¶ä¸ç‚ºå¿…å¡«ä½†æ˜¯å»ç›¸ç•¶é‡è¦ï¼Œå› ç‚ºå®ƒè®“æˆ‘å€‘å®šç¾©äº†ä¸€äº›é‡è¦å±¬æ€§(è«‹åƒè€ƒ<a href="/zh-TW/docs/Web/API/IDBDatabase?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBDatabase#createObjectStore" class="page-not-created" title="This is a link to an unwritten page">createObjectStore</a>)ã€‚æœ¬ä¾‹ä¸­æˆ‘å€‘è¦æ±‚å»ºç«‹äº†ä¸€å€‹"customer"ç‰©ä»¶å­˜æª”ï¼Œå®šç¾©"ssn"å±¬æ€§ç‚ºè³‡æ–™ä»¶è·¯å¾‘ï¼Œä½¿ç”¨"ssn"ä½œç‚ºè³‡æ–™éµè·¯å¾‘æ˜¯å› ç‚ºæ¯å€‹å®¢æˆ¶çš„ ssn ç¢¼ä¸€å®šæ˜¯ç¨ç«‹çš„ã€‚ä¸€æ—¦æ±ºå®šäº†"ssn"ä½œç‚ºè³‡æ–™éµè·¯å¾‘ï¼Œé‚£éº¼æ¯ä¸€ç­†è³‡æ–™ä¸€å®šè¦å«æœ‰"ssn"ã€‚</p>
<p>æœ¬ä¾‹é‚„å‰µå»ºä¸€å€‹ç¨±ç‚º"name"çš„ç´¢å¼•ï¼Œ"name"ç´¢å¼•æŸ¥æ‰¾ç›®æ¨™ç‚ºè³‡æ–™çš„"name"å±¬æ€§ï¼Œä¸”ä¸è¨­ç«‹å…¶ç¨ç‰¹æ——æ¨™(unique ç‚º false)ï¼ŒåŒæ¨£åœ°ï¼Œæˆ‘å€‘åˆå‘¼å«<a href="/zh-TW/docs/Web/API/IDBObjectStore?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBObjectStore#createIndex()" class="page-not-created" title="This is a link to an unwritten page">createIndex</a>æ–¹æ³•å‰µå»ºäº†ä¸€å€‹"email"ç´¢å¼•ï¼Œä¸é"email"ç´¢å¼•å…·å‚™ç¨ç‰¹æ——æ¨™(unique ç‚º true)ã€‚é›–ç„¶å­˜åœ¨"name"ç´¢å¼•ï¼Œä½†è³‡æ–™ä¸ä¸€å®šè¦å«æœ‰"name"å±¬æ€§ï¼Œåªæ˜¯ç•¶æœç´¢"name"ç´¢å¼•æ™‚è³‡æ–™ä¸æœƒå‡ºç¾ã€‚</p>
<p>æ¥ä¸‹ä¾†æˆ‘å€‘å¯ä»¥é–‹å§‹ç”¨ ssn å¾ç‰©ä»¶å­˜æª”ä¸­å–å‡ºè³‡æ–™ï¼Œæˆ–æ˜¯ç”¨ç´¢å¼•æ‰¾å‡ºè³‡æ–™(è«‹åƒè€ƒ<a href="/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB#.e4.bd.bf.e7.94.a8.e7.b4.a2.e5.bc.95">ä½¿ç”¨ç´¢å¼•</a>)ã€‚</p></div><h3 id="ä½¿ç”¨è³‡æ–™éµç”¢ç”Ÿå™¨"><a href="#ä½¿ç”¨è³‡æ–™éµç”¢ç”Ÿå™¨" title="Permalink to ä½¿ç”¨è³‡æ–™éµç”¢ç”Ÿå™¨">ä½¿ç”¨è³‡æ–™éµç”¢ç”Ÿå™¨</a></h3><div><p>ç•¶å»ºç«‹ç‰©ä»¶å­˜æª”æ™‚è¨­å®š autoIncrement æ——æ¨™ç‚º ture å°‡å•Ÿå‹•è³‡æ–™éµç”¢ç”Ÿå™¨ï¼Œé è¨­ä¸Šè©²æ——æ¨™ç‚º falseã€‚</p>
<p>æœ‰äº†è³‡æ–™éµç”¢ç”Ÿå™¨ï¼Œç•¶æ–°å¢è³‡æ–™åˆ°ç‰©ä»¶å­˜æª”ä¸­ï¼Œè³‡æ–™éµç”¢ç”Ÿå™¨æœƒè‡ªå‹•å¹«æˆ‘å€‘ç”¢ç”Ÿè³‡æ–™éµã€‚è³‡æ–™éµç”¢ç”Ÿå™¨ç”¢ç”Ÿçš„è³‡æ–™éµç”±æ•´æ•¸ 1 é–‹å§‹ï¼Œè€ŒåŸºæœ¬ä¸Šæ–°ç”¢ç”Ÿçš„è³‡æ–™éµæ˜¯ç”±å‰ä¸€å€‹è³‡æ–™éµåŠ  1 ç”¢ç”Ÿã€‚è³‡æ–™éµçš„ç”¢ç”Ÿä¸æœƒå› ç‚ºè³‡æ–™åˆªé™¤æˆ–æ¸…ç©ºæ‰€æœ‰è³‡æ–™è€Œé‡æ–°é–‹å§‹èµ·ç®—ï¼Œæ‰€ä»¥è³‡æ–™éµå€¼æ˜¯ä¸€ç›´ç´¯åŠ ä¸Šå»çš„ï¼Œé™¤éè³‡æ–™åº«æ“ä½œä¸­æ–·ï¼Œæ•´å€‹äº¤æ˜“ä½œæ¥­è¢«å–æ¶ˆã€‚</p>
<p>æˆ‘å€‘å¯ä»¥å»ºç«‹ä¸€å€‹æœ‰è³‡æ–™éµç”¢ç”Ÿå™¨çš„ç‰©ä»¶å­˜æª”å¦‚ä¸‹:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// Open the indexedDB.</span>
<span class="token keyword">var</span> request <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>dbName<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

request<span class="token punctuation">.</span><span class="token function-variable function">onupgradeneeded</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> db <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>

    <span class="token comment">// Create another object store called "names" with the autoIncrement flag set as true.</span>
    <span class="token keyword">var</span> objStore <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">createObjectStore</span><span class="token punctuation">(</span><span class="token string">"names"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">autoIncrement</span> <span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Because the "names" object store has the key generator, the key for the name value is generated automatically.</span>
    <span class="token comment">// The added records would be like:</span>
    <span class="token comment">// key : 1 =&gt; value : "Bill"</span>
    <span class="token comment">// key : 2 =&gt; value : "Donna"</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> customerData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        objStore<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>customerData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>é—œæ–¼è³‡æ–™éµç”¢ç”Ÿå™¨ç´°ç¯€ï¼Œè«‹åƒè€ƒ<a href="https://www.w3.org/TR/IndexedDB/#key-generator-concept" class="external" rel=" noopener">"W3C Key Generators"</a>ã€‚</p></div><h2 id="æ–°å¢å’Œåˆªé™¤è³‡æ–™"><a href="#æ–°å¢å’Œåˆªé™¤è³‡æ–™" title="Permalink to æ–°å¢å’Œåˆªé™¤è³‡æ–™">æ–°å¢å’Œåˆªé™¤è³‡æ–™</a></h2><div><p>åœ¨æ“ä½œè³‡æ–™åº«ä¹‹å‰å¿…é ˆè¦å…ˆé€²è¡Œäº¤æ˜“ï¼Œäº¤æ˜“ä¾†è‡ªè³‡æ–™åº«ç‰©ä»¶ï¼Œåœ¨äº¤æ˜“ä¸­è¦æŒ‡å®šæ¶µè“‹ç‰©ä»¶å­˜æª”ç¯„åœï¼Œç„¶å¾Œä¹Ÿè¦æ±ºå®šæ˜¯è¦è®Šæ›´è³‡æ–™åº«æˆ–ç´”ç²¹è®€å–è³‡æ–™ã€‚äº¤æ˜“å…±æœ‰ä¸‰ç¨®ç¨®é¡ï¼Œåˆ†åˆ¥æ˜¯è®€å–(read-only)ï¼Œè®€å¯«(read/write), ä»¥åŠç‰ˆæœ¬è®Šæ›´(versionchange)ï¼Œå¦‚æœåªéœ€è¦è®€è³‡æ–™æœ€å¥½åªä½¿ç”¨è®€å–(read-only)äº¤æ˜“ï¼Œå› ç‚ºè®€å–(read-only)äº¤æ˜“å¯ä»¥å¤šé‡åŒæ­¥é€²è¡Œã€‚</p></div><h3 id="æ–°å¢è³‡æ–™åˆ°è³‡æ–™åº«"><a href="#æ–°å¢è³‡æ–™åˆ°è³‡æ–™åº«" title="Permalink to æ–°å¢è³‡æ–™åˆ°è³‡æ–™åº«">æ–°å¢è³‡æ–™åˆ°è³‡æ–™åº«</a></h3><div><p>å‰µå»ºè³‡æ–™åº«å¾Œï¼Œå¦‚æœè¦å¯«å…¥è³‡æ–™è«‹é€™éº¼åš:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">var</span> transaction <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"customers"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"readwrite"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Note: Older experimental implementations use the deprecated constant IDBTransaction.READ_WRITE instead of "readwrite".</span>
<span class="token comment">// In case you want to support such an implementation, you can just write:</span>
<span class="token comment">// var transaction = db.transaction(["customers"], IDBTransaction.READ_WRITE);</span>
</code></pre></div>
<p>å‘¼å«<a href="/zh-TW/docs/Web/API/IDBDatabase#transaction">transaction()</a>æ–¹æ³•æœƒå›å‚³ä¸€å€‹äº¤æ˜“ç‰©ä»¶ã€‚transaction()ç¬¬ä¸€å€‹æ¥å—åƒæ•¸ä»£è¡¨äº¤æ˜“æ¶µè“‹çš„ç‰©ä»¶å­˜æª”ï¼Œé›–ç„¶å‚³å…¥ç©ºé™£åˆ—æœƒè®“äº¤æ˜“æ¶µè“‹æ‰€æœ‰ç‰©ä»¶å­˜æª”ï¼Œä½†è«‹ä¸è¦é€™éº¼åšï¼Œå› ç‚ºæ ¹æ“šæ­£å¼æ¨™æº–å‚³å…¥ç©ºé™£åˆ—æ‡‰è©²è¦å°è‡´ InvalidAccessError éŒ¯èª¤ï¼›ç¬¬äºŒå€‹åƒæ•¸ä»£è¡¨äº¤æ˜“ç¨®é¡ï¼Œä¸å‚³å…¥çš„è©±é è¨­ç‚ºè®€å–äº¤æ˜“ï¼Œæœ¬ä¾‹è¦å¯«å…¥è³‡æ–™åº«æ‰€ä»¥å‚³å…¥è®€å¯«("readwrite")ã€‚</p>
<p>äº¤æ˜“çš„ç”Ÿå‘½é€±æœŸå’Œäº‹ä»¶å¾ªç’°é—œä¿‚å¯†åˆ‡ã€‚ç•¶æˆ‘å€‘ç™¼èµ·äº¤æ˜“åˆå›åˆ°äº‹ä»¶å¾ªç’°ä¸­å¾Œï¼Œå¦‚æœå¿½ç•¥ï¼Œé‚£éº¼äº¤æ˜“å°‡è½‰æˆçµæŸï¼Œå”¯ä¸€ä¿æŒäº¤æ˜“å­˜æ´»çš„æ–¹æ³•æ˜¯åœ¨äº¤æ˜“ä¸Šç™¼å‡ºè«‹æ±‚ï¼›ç•¶è«‹æ±‚å®Œæˆå¾Œæˆ‘å€‘æœƒæ”¶åˆ° DOM äº‹ä»¶ï¼Œå‡è¨­è«‹æ±‚çµæœæˆåŠŸï¼Œæˆ‘å€‘å¯ä»¥åœ¨äº‹ä»¶çš„å›å‘¼å‡½æ•¸(callback ä¸­)ç¹¼çºŒé€²è¡Œäº¤æ˜“ï¼Œåä¹‹ï¼Œå¦‚æœæˆ‘å€‘æ²’æœ‰ç¹¼çºŒé€²è¡Œäº¤æ˜“ï¼Œé‚£éº¼äº¤æ˜“å°‡çµæŸï¼Œä¹Ÿå°±æ˜¯èªªåªè¦å°šæœ‰æœªå®Œæˆè«‹æ±‚çš„è©±ï¼Œäº¤æ˜“å°±æœƒç¹¼çºŒå­˜æ´»ï¼Œå¦‚æœæ”¶åˆ° TRANSACTION_INACTIVE_ERR éŒ¯èª¤é‚£ä¾¿æ„è¬‚è‘—äº¤æ˜“æ—©å·²çµæŸï¼Œæˆ‘å€‘éŒ¯éäº†ç¹¼çºŒé€²è¡Œäº¤æ˜“çš„æ©Ÿæœƒã€‚</p>
<p>äº¤æ˜“èƒ½æ”¶åˆ°ä¸‰ç¨®äº‹ä»¶: éŒ¯èª¤(error)ã€ä¸­æ–·(abort)ä»¥åŠå®Œæˆ(complete)ï¼Œå…¶ä¸­éŒ¯èª¤äº‹ä»¶æœƒå‘ä¸Šå‚³éï¼Œæ‰€ä»¥ä»»ä½•ä¸€å€‹äº¤æ˜“ä¸‹è½„çš„è«‹æ±‚ç”¢ç”ŸéŒ¯èª¤äº‹ä»¶ï¼Œè©²äº¤æ˜“éƒ½æœƒæ”¶åˆ°ã€‚å¦‚æœäº¤æ˜“æ”¶åˆ°éŒ¯èª¤äº‹ä»¶æ™‚ï¼Œç€è¦½å™¨é è¨­è¡Œç‚ºæœƒä¸­æ–·äº¤æ˜“ï¼Œé™¤éæˆ‘å€‘æœ‰åœ¨éŒ¯èª¤äº‹ä»¶ä¸Šå‘¼å« preventDefault()é˜»æ“‹ç€è¦½å™¨é è¨­è¡Œå‹•ï¼Œå¦å‰‡æ•´ç­†äº¤æ˜“éƒ½å°‡å–æ¶ˆã€å¾©åŸï¼Œé€™æ¨£çš„è¨­è¨ˆå‘Šè¨´æˆ‘å€‘å¿…é ˆè¦æ€è€ƒå¦‚ä½•è™•è£¡éŒ¯èª¤ï¼Œæˆ–è€…èªªå¦‚æœå°æ¯ä¸€å€‹éŒ¯èª¤é€²è¡Œè™•è£¡éæ–¼éº»ç…©ï¼Œé‚£éº¼è‡³å°‘åŠ å…¥ä¸€å€‹æ¦‚æ‹¬æ€§çš„éŒ¯èª¤è™•ç†å™¨ä¹Ÿæ˜¯å¯ä»¥ã€‚åªè¦ä¸è™•è£¡éŒ¯èª¤æˆ–å‘¼å« abort()ï¼Œäº¤æ˜“å°‡å–æ¶ˆã€å¾©åŸï¼Œç„¶å¾Œä¸­æ–·äº‹ä»¶æ¥è‘—è§¸ç™¼ï¼Œåä¹‹ï¼Œç•¶æ‰€æœ‰è«‹æ±‚éƒ½å®Œæˆå¾Œï¼Œæˆ‘å€‘æœƒæ”¶åˆ°ä¸€å€‹å®Œæˆäº‹ä»¶ï¼Œæ‰€ä»¥èªªå¦‚æœæˆ‘å€‘åŒæ™‚ç™¼èµ·å¤šé …è«‹æ±‚æ™‚ï¼Œå¯ä»¥åªè¿½è¹¤å–®ä¸€äº¤æ˜“è€Œéå€‹åˆ¥è«‹æ±‚ï¼Œé€™æ¨£æœƒå¤§å¤§æ¸›è¼•æˆ‘å€‘çš„è² æ“”ã€‚</p>
<p>æœ‰äº†äº¤æ˜“ä¹‹å¾Œä¾¿èƒ½å¤ å¾ä¸­å–å¾—ç‰©ä»¶å­˜æª”ï¼Œæœ‰äº†ç‰©ä»¶å­˜æª”ä¾¿èƒ½å¤ æ–°å¢è³‡æ–™(è«‹æ³¨æ„å”¯æœ‰åœ¨å»ºç«‹äº¤æ˜“æ™‚æŒ‡å®šçš„ç‰©ä»¶å­˜æª”èƒ½å¤ å–å¾—)ã€‚</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// Do something when all the data is added to the database.</span>
transaction<span class="token punctuation">.</span><span class="token function-variable function">oncomplete</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"All done!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

transaction<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Don't forget to handle errors!</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> objectStore <span class="token operator">=</span> transaction<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">"customers"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> customerData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> request <span class="token operator">=</span> objectStore<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>customerData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// event.target.result == customerData[i].ssn;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>å‘¼å«<a href="/en-US/docs/Web/API/IDBObjectStore" class="only-in-en-us" title="Currently only available in English (US)">add (en-US)</a>æ–¹æ³•å¯ä»¥åŠ å…¥ä¸€ç­†æ–°è³‡æ–™ï¼Œå‘¼å«å¾Œæœƒå›å‚³ä¸€å€‹<a href="/zh-TW/docs/Web/API/IDBRequest?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBRequest" class="page-not-created" title="This is a link to an unwritten page">IDBRequest</a>ç‰©ä»¶ï¼Œå³ç‚ºä¸Šæ–¹ç¯„ä¾‹ä¸­çš„ requestï¼Œå¦‚æœæ–°å¢æˆåŠŸï¼Œrequest çš„æˆåŠŸäº‹ä»¶æœƒè¢«è§¸ç™¼ï¼Œè€ŒæˆåŠŸäº‹ä»¶ç‰©ä»¶ä¸­æœ‰ä¸€å€‹ result å±¬æ€§ï¼Œé€™å€‹ result å€¼å‰›å¥½å°±ç­‰æ–¼æ–°è³‡æ–™çš„è³‡æ–™éµï¼Œæ‰€ä»¥èªªä¸Šæ–¹ç¯„ä¾‹ä¸­çš„ event.target.result å‰›å¥½å°±ç­‰æ–¼é¡§å®¢çš„ ssn å€¼(å› ç‚ºæˆ‘å€‘ç”¨ ssn å±¬æ€§ä½œç‚ºè³‡æ–™éµè·¯å¾‘)ã€‚è«‹æ³¨æ„ add æ–¹æ³•åªåœ¨ç•¶ç‰©ä»¶å­˜æª”ä¸­æ²’æœ‰ç›¸åŒè³‡æ–™éµè³‡æ–™å­˜åœ¨æ™‚æœ‰ç”¨ï¼Œå¦‚æœæƒ³è¦æ›´å‹•æˆ–æ˜¯ç›´æ¥è¦†è“‹ç¾å­˜è³‡æ–™è«‹å‘¼å«<a href="/en-US/docs/Web/API/IDBObjectStore" class="only-in-en-us" title="Currently only available in English (US)">put (en-US)</a>æ–¹æ³•ã€‚</p></div><h2 id="ç§»é™¤è³‡æ–™"><a href="#ç§»é™¤è³‡æ–™" title="Permalink to ç§»é™¤è³‡æ–™">ç§»é™¤è³‡æ–™</a></h2><div><p>ç§»é™¤è³‡æ–™ååˆ†å®¹æ˜“:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">var</span> request <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"customers"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"readwrite"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">"customers"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">"444-44-4444"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// It's gone!</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div><h2 id="è®€å–è³‡æ–™"><a href="#è®€å–è³‡æ–™" title="Permalink to è®€å–è³‡æ–™">è®€å–è³‡æ–™</a></h2><div><p>è¦åœ–å–è³‡æ–™åº«å…§çš„è³‡æ–™æœ‰æ•¸ç¨®é€”å¾‘ï¼Œç¬¬ä¸€å€‹æœ€ç°¡å–®çš„é€”å¾‘å°±æ˜¯æä¾›è³‡æ–™éµï¼Œå‘¼å«<a href="/en-US/docs/Web/API/IDBObjectStore" class="only-in-en-us" title="Currently only available in English (US)">get (en-US)</a>æ–¹æ³•å–å¾—è³‡æ–™:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">var</span> transaction <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"customers"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> objectStore <span class="token operator">=</span> transaction<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">"customers"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> request <span class="token operator">=</span> objectStore<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"444-44-4444"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Handle errors!</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Do something with the request.result!</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Name for SSN 444-44-4444 is "</span> <span class="token operator">+</span> request<span class="token punctuation">.</span>result<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>å‡è¨­æˆ‘å€‘æŠŠéŒ¯èª¤è™•ç†æ”¾åœ¨è³‡æ–™åº«å±¤ç´šï¼Œæˆ‘å€‘å¯ä»¥å†ç¸®çŸ­ä¸Šé¢çš„ç¨‹å¼ç¢¼å¦‚ä¸‹:</p>
<div class="code-example"><pre class="brush: js notranslate"><code>db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token string">"customers"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">"customers"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"444-44-4444"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Name for SSN 444-44-4444 is "</span> <span class="token operator">+</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>å‘¼å« transcation æ–¹æ³•è€Œä¸æŒ‡å®šæ¨¡å¼æœƒé–‹å•Ÿè®€å–(readonly)æ¨¡å¼ï¼Œæ¥è‘—å–å¾—æˆ‘å€‘çš„ç›®æ¨™ç‰©ä»¶å­˜æª”ï¼Œè¼¸å…¥ç›®æ¨™è³‡æ–™çš„è³‡æ–™éµï¼Œå‘¼å« get æ–¹æ³•å–å¾—è«‹æ±‚ç‰©ä»¶ï¼Œç„¶å¾Œåœ¨è«‹æ±‚ç‰©ä»¶ä¸Šè¨»å†ŠæˆåŠŸäº‹ä»¶è™•ç†å™¨ï¼Œç•¶ä½œæ¥­æˆåŠŸå¾Œï¼ŒæˆåŠŸäº‹ä»¶æœƒè§¸ç™¼ï¼ŒæˆåŠŸäº‹ä»¶çš„ç‰©ä»¶ä¸­å«æœ‰è«‹æ±‚ç‰©ä»¶(event.target å¦‚ä¸Šè¿°ç¯„ä¾‹)ï¼Œè«‹æ±‚ç‰©ä»¶ä¸­å«æœ‰è«‹æ±‚çµæœ(event.target.result å¦‚ä¸Šè¿°ç¯„ä¾‹)ã€‚</p></div><h2 id="ä½¿ç”¨æŒ‡æ¨™cursor"><a href="#ä½¿ç”¨æŒ‡æ¨™cursor" title="Permalink to ä½¿ç”¨æŒ‡æ¨™(Cursor)">ä½¿ç”¨æŒ‡æ¨™(Cursor)</a></h2><div><p>ä½¿ç”¨ get æ–¹æ³•éœ€è¦çŸ¥é“è³‡æ–™éµï¼Œå¦‚æœæƒ³è¦ä¸€ä¸€å­˜å–ç‰©ä»¶å­˜æª”ä¸­çš„è³‡æ–™ï¼Œæˆ‘å€‘å¯ä»¥åˆ©ç”¨æŒ‡æ¨™:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">var</span> objectStore <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token string">"customers"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">"customers"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

objectStore<span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cursor <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Name for SSN "</span> <span class="token operator">+</span> cursor<span class="token punctuation">.</span>key <span class="token operator">+</span> <span class="token string">" is "</span> <span class="token operator">+</span> cursor<span class="token punctuation">.</span>value<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"No more entries!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p><a href="/en-US/docs/Web/API/IDBObjectStore" class="only-in-en-us" title="Currently only available in English (US)">openCursor (en-US)</a>æ–¹æ³•ç¬¬ä¸€å€‹åƒæ•¸ç”¨ä¾†æ¥å—è³‡æ–™éµç¯„åœç‰©ä»¶ä¾†é™åˆ¶å­˜å–è³‡æ–™ç¯„åœï¼Œç¬¬äºŒå€‹åƒæ•¸ç”¨ä¾†æŒ‡å®šå­˜å–é€²è¡Œæ–¹å‘ï¼Œåƒä¸Šé¢çš„ç¯„ä¾‹ç¨‹å¼ä¾¿æ˜¯ä»¥è³‡æ–™éµç”±å°åˆ°å¤§ä¹‹æ–¹å‘å­˜å–è³‡æ–™ï¼›å‘¼å« openCursor æ–¹æ³•å¾Œä¸€æ¨£æœƒå›å‚³ä¸€å€‹è«‹æ±‚ç‰©ä»¶ï¼ŒæˆåŠŸæ™‚æˆåŠŸäº‹ä»¶æœƒè§¸ç™¼ï¼Œä¸éé€™è£¡æœ‰äº›åœ°æ–¹è¦ç‰¹åˆ¥æ³¨æ„ï¼Œç•¶æˆåŠŸäº‹ä»¶è™•è£¡å‡½æ•¸è¢«å–šèµ·æ™‚ï¼ŒæŒ‡æ¨™ç‰©ä»¶(cursor)æœƒå­˜æ”¾åœ¨ result å±¬æ€§å…§(äº¦å³ä¸Šè¿° event.target.result)ï¼Œcursor ç‰©ä»¶ä¸‹æœ‰å…©å€‹å±¬æ€§ï¼Œkey å±¬æ€§æ˜¯è³‡æ–™éµï¼Œvalue å±¬æ€§æ˜¯è³‡æ–™å€¼ï¼Œå¦‚æœè¦å–å¾—ä¸‹ä¸€ä»½è³‡æ–™å°±å‘¼å« cursor çš„ continue()æ–¹æ³•ï¼Œç„¶å¾Œ cursor ç‰©ä»¶å°±æœƒæŒ‡å‘ä¸‹ä¸€ä»½è³‡æ–™ï¼Œç•¶æ²’æœ‰è³‡æ–™æ™‚ï¼Œcursor æœƒæ˜¯ undefinedï¼Œç•¶è«‹æ±‚ä¸€é–‹å§‹ä¾¿æ‰¾æ²’æœ‰è³‡æ–™ï¼Œresult å±¬æ€§ä¹Ÿæœƒæ˜¯ undefinedã€‚</p>
<p>ä»¥ä¸‹ç”¨ cursor å­˜å–ä¸€éè³‡æ–™å¾Œæ”¾åœ¨é™£åˆ—ä¸­çš„ä½œæ³•ç›¸ç•¶å¸¸è¦‹:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">var</span> customers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

objectStore<span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cursor <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    customers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Got all customers: "</span> <span class="token operator">+</span> customers<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<div class="notecard warning" id="sect2">
  <p><strong>è­¦å‘Šï¼š</strong> ä»¥ä¸‹ç¯„ä¾‹ä¸æ˜¯ IndexedDB æ¨™æº–!</p>
</div>
<p>Mozilla ç€è¦½å™¨è‡ªå·±åšäº†ä¸€å€‹ getAll()æ–¹æ³•ä¾†æ–¹ä¾¿ä¸€æ¬¡å–å¾—æ‰€æœ‰ cursor ä¸‹çš„è³‡æ–™å€¼ï¼Œé€™å€‹æ–¹æ³•ç›¸ç•¶æ–¹ä¾¿ï¼Œä¸éè«‹å°å¿ƒæœªä¾†å®ƒæœ‰å¯èƒ½æœƒæ¶ˆå¤±ã€‚ä»¥ä¸‹ç¨‹å¼ç¢¼çš„æ•ˆæœå’Œä¸Šé¢çš„ä¸€æ¨£:</p>
<div class="code-example"><pre class="brush: js notranslate"><code>objectStore<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Got all customers: "</span> <span class="token operator">+</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>ä¸€ä¸€æª¢æŸ¥ cursor çš„ value å±¬æ€§è¼ƒä¸åˆ©æ€§èƒ½è¡¨ç¾ï¼Œå› ç‚ºç‰©ä»¶æ˜¯è¢«å‹•ä¸€ä¸€å»ºç«‹ï¼Œç„¶è€Œå‘¼å« getAll()ï¼ŒGecko ä¸€å®šè¦ä¸€æ¬¡å»ºç«‹æ‰€æœ‰ç‰©ä»¶ï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦ä¸€æ¬¡å–å¾—æ‰€æœ‰ç‰©ä»¶çš„è³‡æ–™å€¼é™£åˆ—ä½¿ç”¨ getAll()æ¯”è¼ƒå¥½ï¼Œå¦‚æœæƒ³è¦ä¸€ä¸€æª¢æŸ¥æ¯ç­†è³‡æ–™å‰‡è«‹åˆ©ç”¨ cursor çš„æ–¹æ³•ã€‚</p></div><h3 id="ä½¿ç”¨ç´¢å¼•"><a href="#ä½¿ç”¨ç´¢å¼•" title="Permalink to ä½¿ç”¨ç´¢å¼•">ä½¿ç”¨ç´¢å¼•</a></h3><div><p>åˆ©ç”¨ä¸€å®šå”¯ä¸€çš„ ssn ç¢¼ä½œç‚ºè³‡æ–™éµç›¸ç•¶åˆä¹é‚è¼¯(éš±ç§æ¬Šçš„å•é¡Œå…ˆæ“±ç½®ä¸€æ”¾ï¼Œä¸åœ¨æœ¬æ–‡æ¢è¨ç¯„åœ)ã€‚ä¸éç•¶æˆ‘å€‘æƒ³è¦æŸ¥è©¢ä½¿ç”¨è€…çš„åå­—çš„æ™‚å€™ï¼Œå¦‚æœæ²’æœ‰ç´¢å¼•å°±éœ€è¦ä¸€ä¸€æª¢æŸ¥æ¯ä¸€ç­†è³‡æ–™ï¼Œååˆ†æ²’æœ‰æ•ˆç‡ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥å»ºç«‹ name çš„ç´¢å¼•ã€‚</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">var</span> index <span class="token operator">=</span> objectStore<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
index<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Donna"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Donna's SSN is "</span> <span class="token operator">+</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">.</span>ssn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>å› ç‚º name ä¸æ˜¯å”¯ä¸€å€¼ï¼Œæ‰€ä»¥å¯èƒ½æœƒæœ‰å¤šç­†è³‡æ–™ç¬¦åˆ"Donna"åå­—ï¼Œæ­¤æ™‚å‘¼å« get()æœƒå–å¾—è³‡æ–™éµæœ€å°å€¼çš„è³‡æ–™ã€‚</p>
<p>å¦‚æœæˆ‘å€‘æƒ³è¦æŸ¥çœ‹ç‰¹å®šåå­—ä¸‹æ‰€æœ‰çš„è³‡æ–™ï¼Œå¯ä»¥åˆ©ç”¨ cursorã€‚æœ‰å…©ç¨® cursor èƒ½ç”¨åœ¨ç´¢å¼•ä¸Šï¼Œç¬¬ä¸€ç¨®ä¸€èˆ¬ cursor æœƒæ¯”å°ç´¢å¼•å€¼ä¸¦å›å‚³æ•´ä»½è³‡æ–™(ç‰©ä»¶å­˜æª”ä¸­çš„ç‰©ä»¶)ï¼Œç¬¬äºŒç¨®è³‡æ–™éµ cursor å‰‡åªæœƒå›å‚³è³‡æ–™éµå€¼ï¼Œè«‹åƒè€ƒä¸‹æ–¹ç¯„ä¾‹æ¯”è¼ƒå…©è€…å·®ç•°:</p>
<div class="code-example"><pre class="brush: js notranslate"><code>index<span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cursor <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// cursor.key is a name, like "Bill", and cursor.value is the whole object.</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Name: "</span> <span class="token operator">+</span> cursor<span class="token punctuation">.</span>key <span class="token operator">+</span> <span class="token string">", SSN: "</span> <span class="token operator">+</span> cursor<span class="token punctuation">.</span>value<span class="token punctuation">.</span>ssn <span class="token operator">+</span> <span class="token string">", email: "</span> <span class="token operator">+</span> cursor<span class="token punctuation">.</span>value<span class="token punctuation">.</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

index<span class="token punctuation">.</span><span class="token function">openKeyCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cursor <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// cursor.key is a name, like "Bill", and cursor.value is the SSN.</span>
    <span class="token comment">// No way to directly get the rest of the stored object.</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Name: "</span> <span class="token operator">+</span> cursor<span class="token punctuation">.</span>key <span class="token operator">+</span> <span class="token string">", SSN: "</span> <span class="token operator">+</span> cursor<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div><h3 id="è¨­å®šæŒ‡æ¨™æŸ¥è©¢ç¯„åœå’Œæ–¹å‘"><a href="#è¨­å®šæŒ‡æ¨™æŸ¥è©¢ç¯„åœå’Œæ–¹å‘" title="Permalink to è¨­å®šæŒ‡æ¨™æŸ¥è©¢ç¯„åœå’Œæ–¹å‘">è¨­å®šæŒ‡æ¨™æŸ¥è©¢ç¯„åœå’Œæ–¹å‘</a></h3><div><p>å¦‚æœæƒ³è¦é™å®šæŒ‡æ¨™æŸ¥è©¢ç¯„åœï¼Œé‚£éº¼åœ¨ä¹å« openCursor()æˆ– openKeyCursor()æ™‚ç¬¬ä¸€å€‹åƒæ•¸è¦å‚³å…¥<a href="/zh-TW/IndexedDB/IDBKeyRange" class="page-not-created" title="This is a link to an unwritten page">IDBKeyRange</a>ç‰©ä»¶ä»¥é™åˆ¶ç¯„åœã€‚IDBKeyRange ç‰©ä»¶èƒ½å¤ åªèšç„¦åœ¨å–®ä¸€è³‡æ–™éµä¸Šæˆ–è€…ä¸€æ®µä¸Šä¸‹é™å€é–“ï¼›ä¸Šä¸‹é™å€é–“å¯ä»¥æ˜¯å°é–‰(å«ç•Œé™)æˆ–é–‹æ”¾(ä¸å«ç•Œé™)ï¼Œè«‹çœ‹ä»¥ä¸‹ç¯„ä¾‹:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// Only match "Donna"</span>
<span class="token keyword">var</span> singleKeyRange <span class="token operator">=</span> IDBKeyRange<span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span><span class="token string">"Donna"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Match anything past "Bill", including "Bill"</span>
<span class="token keyword">var</span> lowerBoundKeyRange <span class="token operator">=</span> IDBKeyRange<span class="token punctuation">.</span><span class="token function">lowerBound</span><span class="token punctuation">(</span><span class="token string">"Bill"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Match anything past "Bill", but don't include "Bill"</span>
<span class="token keyword">var</span> lowerBoundOpenKeyRange <span class="token operator">=</span> IDBKeyRange<span class="token punctuation">.</span><span class="token function">lowerBound</span><span class="token punctuation">(</span><span class="token string">"Bill"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Match anything up to, but not including, "Donna"</span>
<span class="token keyword">var</span> upperBoundOpenKeyRange <span class="token operator">=</span> IDBKeyRange<span class="token punctuation">.</span><span class="token function">upperBound</span><span class="token punctuation">(</span><span class="token string">"Donna"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Match anything between "Bill" and "Donna", but not including "Donna"</span>
<span class="token keyword">var</span> boundKeyRange <span class="token operator">=</span> IDBKeyRange<span class="token punctuation">.</span><span class="token function">bound</span><span class="token punctuation">(</span><span class="token string">"Bill"</span><span class="token punctuation">,</span> <span class="token string">"Donna"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

index<span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span>boundKeyRange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cursor <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something with the matches.</span>
    cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>æœ‰æ™‚å€™æˆ‘å€‘æœƒæƒ³è¦ç”±å¤§åˆ°å°æŸ¥çœ‹è³‡æ–™è€Œéé è¨­ç”±å°åˆ°å¤§æ–¹å‘ï¼Œå‚³å…¥ç¬¬äºŒå€‹"prev"å­—ä¸²ä¾¿èƒ½åšåˆ°:</p>
<div class="code-example"><pre class="brush: js notranslate"><code>objectStore<span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"prev"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cursor <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something with the entries.</span>
    cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>ç”±æ–¼"name"ç´¢å¼•ä¸å…·å”¯ä¸€æ€§ï¼Œæ‰€ä»¥ä¸€å€‹åå­—ä¸‹å¯èƒ½æœƒå‡ºç¾å¤šç­†è³‡æ–™ï¼Œæ­¤æ™‚å¦‚æœæƒ³è¦é¿é–‹é€™å¤šç­†è³‡æ–™ï¼Œè«‹å‚³å…¥"nextunique"æˆ–"prevunique"åšç‚ºç¬¬äºŒå€‹æ–¹å‘åƒæ•¸ï¼Œç•¶å‚³å…¥ä¹‹å¾Œï¼Œå¦‚ä¸€å€‹åå­—ä¸‹é‡åˆ°å¤šç­†è³‡æ–™ï¼Œå‰‡åªæœ‰è³‡æ–™éµæœ€å°çš„è³‡æ–™æœƒè¢«å›å‚³ã€‚</p>
<div class="code-example"><pre class="brush: js notranslate"><code>index<span class="token punctuation">.</span><span class="token function">openKeyCursor</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"nextunique"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cursor <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something with the entries.</span>
    cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<p>é—œæ–¼å¯å‚³å…¥çš„æ–¹å‘åƒæ•¸ï¼Œè«‹åƒè€ƒ<a href="/zh-TW/docs/Web/API/IDBCursor?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBCursor#Constants" class="page-not-created" title="This is a link to an unwritten page">IDBCursor</a>å¸¸æ•¸ã€‚</p></div><h2 id="ç•¶ç¶²é æ‡‰ç”¨ç¨‹å¼æ–¼ç€è¦½å™¨å¦ä¸€å€‹åˆ†é é–‹å•Ÿæ™‚è®Šæ›´ç‰ˆæœ¬"><a href="#ç•¶ç¶²é æ‡‰ç”¨ç¨‹å¼æ–¼ç€è¦½å™¨å¦ä¸€å€‹åˆ†é é–‹å•Ÿæ™‚è®Šæ›´ç‰ˆæœ¬" title="Permalink to ç•¶ç¶²é æ‡‰ç”¨ç¨‹å¼æ–¼ç€è¦½å™¨å¦ä¸€å€‹åˆ†é é–‹å•Ÿæ™‚è®Šæ›´ç‰ˆæœ¬">ç•¶ç¶²é æ‡‰ç”¨ç¨‹å¼æ–¼ç€è¦½å™¨å¦ä¸€å€‹åˆ†é é–‹å•Ÿæ™‚è®Šæ›´ç‰ˆæœ¬</a></h2><div><p>è«‹æ€è€ƒä»¥ä¸‹ç‹€æ³: ä½¿ç”¨è€…åœ¨ç¬¬ä¸€å€‹ç€è¦½å™¨åˆ†é ä¸­ä½¿ç”¨è‘—èˆŠç‰ˆæœ¬ï¼Œç„¶å¾Œä½¿ç”¨è€…åˆæ‰“é–‹ç¬¬äºŒå€‹åˆ†é è¼‰å…¥ç¶²é ï¼Œæ­¤æ™‚æˆ‘å€‘åœ¨æ–°åˆ†é éœ€è¦å°è³‡æ–™åº«é€²è¡Œå‡ç´šï¼Œæ‰€ä»¥å‘¼å« open()ä»¥æ›´æ–°ç‰ˆæœ¬é–‹å•Ÿè³‡æ–™åº«ï¼Œä½†æ˜¯ç”±æ–¼ç¬¬ä¸€å€‹ç€è¦½å™¨åˆ†é ä¸¦æ²’æœ‰é—œé–‰è³‡æ–™åº«ï¼Œå› æ­¤ç¬¬äºŒå€‹åˆ†é çš„è³‡æ–™åº«å‡ç´šä½œæ¥­æœƒè¢«æ“‹ä½ã€‚æ‰€ä»¥æˆ‘å€‘éœ€è¦æ³¨æ„å¤šå€‹åˆ†é åŒæ™‚é–‹å•Ÿçš„ç‹€æ³ï¼Œæ¯å€‹åˆ†é éƒ½å¾—æ³¨æ„ç•¶ç™¼ç”Ÿè³‡æ–™åº«å‡ç´šäº‹ä»¶æ™‚ï¼Œè¦è¨˜å¾—é—œé–‰è³‡æ–™åº«ï¼Œè®“è³‡æ–™åº«å‡ç´šä½œæ¥­å¾—ä»¥é€²è¡Œã€‚å¯¦éš›ä½œæ³•å¦‚ä¸‹:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">var</span> openReq <span class="token operator">=</span> mozIndexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"MyTestDatabase"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

openReq<span class="token punctuation">.</span><span class="token function-variable function">onblocked</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// If some other tab is loaded with the database, then it needs to be closed</span>
  <span class="token comment">// before we can proceed.</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Please close all other tabs with this site open!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

openReq<span class="token punctuation">.</span><span class="token function-variable function">onupgradeneeded</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// All other databases have been closed. Set everything up.</span>
  db<span class="token punctuation">.</span><span class="token function">createObjectStore</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useDatabase</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

openReq<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> db <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token function">useDatabase</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">useDatabase</span><span class="token punctuation">(</span><span class="token parameter">db</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Make sure to add a handler to be notified if another page requests a version</span>
  <span class="token comment">// change. We must close the database. This allows the other page to upgrade the database.</span>
  <span class="token comment">// If you don't do this then the upgrade won't happen until the user closes the tab.</span>
  db<span class="token punctuation">.</span><span class="token function-variable function">onversionchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    db<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"A new version of this page is ready. Please reload!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// Do stuff with the database.</span>
<span class="token punctuation">}</span>
</code></pre></div></div><h2 id="å®‰å…¨æ€§"><a href="#å®‰å…¨æ€§" title="Permalink to å®‰å…¨æ€§">å®‰å…¨æ€§</a></h2><div><p>
  IndexedDB éµå®ˆ<a href="/zh-TW/docs/Web/Security/Same-origin_policy">åŒæºæ”¿ç­–</a>ï¼Œæ‰€ä»¥å®ƒç¶å®šå‰µå»ºå®ƒçš„ä¾†æºç¶²ç«™ï¼Œå…¶ä»–ä¾†æºç¶²ç«™ç„¡æ³•å­˜å–ã€‚
  å°±åƒå°è¼‰å…¥<a class="only-in-en-us" title="Currently only available in English (US)" href="/en-US/docs/Web/HTML/Element/frame"><code>&lt;frame&gt;</code> <small>(en-US)</small></a>å’Œ<a class="only-in-en-us" title="Currently only available in English (US)" href="/en-US/docs/Web/HTML/Element/iframe"><code>&lt;iframe&gt;</code> <small>(en-US)</small></a>ç¶²é çš„ç¬¬ä¸‰æ–¹ cookie æ‰€è¨­ä¸‹çš„å®‰å…¨æ€§å’Œéš±ç§æ¬Šè€ƒé‡é™åˆ¶ï¼ŒIndexedDB ç„¡æ³•åœ¨è¼‰å…¥<a class="only-in-en-us" title="Currently only available in English (US)" href="/en-US/docs/Web/HTML/Element/frame"><code>&lt;frame&gt;</code> <small>(en-US)</small></a>å’Œ<a class="only-in-en-us" title="Currently only available in English (US)" href="/en-US/docs/Web/HTML/Element/iframe"><code>&lt;iframe&gt;</code> <small>(en-US)</small></a>ç¶²é ä¸Šé‹ä½œï¼Œè©³æƒ…è«‹è¦‹<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=595307" class="external" rel=" noopener">bug&nbsp;595307</a>ã€‚
</p></div><h2 id="ç€è¦½å™¨é—œé–‰é¢¨éšª"><a href="#ç€è¦½å™¨é—œé–‰é¢¨éšª" title="Permalink to ç€è¦½å™¨é—œé–‰é¢¨éšª">ç€è¦½å™¨é—œé–‰é¢¨éšª</a></h2><div><p>ç•¶ç€è¦½å™¨é—œé–‰ï¼Œä¾‹å¦‚ä½¿ç”¨è€…æŒ‰ä¸‹é—œé–‰éˆ•ï¼Œä»»ä½•æœªå®Œæˆ IndexedDB äº¤æ˜“éƒ½å°‡é»˜é»˜ä¸­æ­¢ï¼Œé€™äº›äº¤æ˜“ä¸æœƒå®Œæˆï¼ŒéŒ¯èª¤äº‹ä»¶ä¹Ÿä¸æœƒè§¸ç™¼ã€‚æ—¢ç„¶ç€è¦½å™¨å¯èƒ½éš¨æ™‚è¢«é—œé–‰ï¼Œæˆ‘å€‘ç„¡æ³•å®Œå…¨æŒ‡æœ›ä»»ä½•ç‰¹å®šäº¤æ˜“ä¸€å®šæœƒå®Œæˆï¼Œæˆ–æ˜¯ä¾è³´éŒ¯èª¤äº‹ä»¶åšå‡ºç›¸æ‡‰è™•ç†ï¼Œé‡å°é€™ç¨®ç‹€æ³ï¼Œæˆ‘å€‘éœ€è¦æ³¨æ„:</p>
<p>ç¬¬ä¸€ã€æ¯ä¸€ç­†äº¤æ˜“çµæŸå¾Œéƒ½æ‡‰è©²è¦ä¿æŒè³‡æ–™åº«å®Œæ•´æ€§ï¼Œä¾‹å¦‚èªªï¼Œæœ‰ä¸€ä¸²ä½¿ç”¨è€…ç·¨è¼¯é …ç›®æ¸…å–®æ­£è¦å­˜å…¥è³‡æ–™åº«ï¼Œæˆ‘å€‘å¦‚æœå…ˆåœ¨ä¸€å€‹äº¤æ˜“ä¸­æ¸…é™¤èˆŠæ¸…å–®ï¼Œç„¶å¾Œåœ¨å¦ä¸€å€‹äº¤æ˜“ä¸­å­˜å…¥æ–°æ¸…å–®ï¼Œé‚£å°±æœƒé¢è‡¨åˆ°æ¸…é™¤å®Œå°±æ¸…å–®å¾Œï¼Œæ–°æ¸…å–®å­˜å…¥äº¤æ˜“é‚„ä¾†ä¸åŠå›å­˜ï¼Œç€è¦½å™¨å°±é—œé–‰çš„é¢¨éšªï¼Œè€Œé€™å€‹æ™‚å€™è³‡æ–™åº«è£¡é¢çš„æ¸…å–®è³‡æ–™å°‡æ¶ˆå¤±ã€‚æ‰€ä»¥æ¯”è¼ƒå¥½çš„åšæ³•æ‡‰è©²æ˜¯åœ¨åŒä¸€ç­†äº¤æ˜“ä¸­å®Œæˆæ¸…é™¤èˆŠæ¸…å–®å’Œå­˜å…¥æ–°æ¸…å–®ã€‚</p>
<p>ç¬¬äºŒã€æ°¸é ä¸è¦åœ¨ unload äº‹ä»¶ä¸­åŸ·è¡Œè³‡æ–™åº«äº¤æ˜“ï¼Œå› ç‚ºå¦‚æœ unload äº‹ä»¶æ˜¯è§¸ç™¼åœ¨ç€è¦½å™¨é—œé–‰ä¸‹ï¼Œä»»ä½•è³‡æ–™åº«äº¤æ˜“éƒ½ä¸æœƒç™¼ç”Ÿï¼Œæˆ–è¨±ï¼Œç€è¦½å™¨(æˆ–åˆ†é )æ‰“é–‹æ™‚è®€å–è³‡æ–™åº«ï¼Œæ›´æ–°è³‡æ–™åº«ç•¶ä½¿ç”¨è€…ç·¨è¼¯è³‡æ–™ï¼Œç•¶ç€è¦½å™¨(æˆ–åˆ†é )é—œé–‰æ™‚å„²å­˜è³‡æ–™é€™æ¨£çš„åšæ³•æ¯”è¼ƒç›´è¦ºï¼Œä¸éè³‡æ–™åº«çš„æ“ä½œæ˜¯éåŒæ­¥é€²è¡Œåœ°ï¼Œæ‰€ä»¥ç€è¦½å™¨é—œé–‰çš„åŸ·è¡Œæœƒåœ¨è³‡æ–™åº«æ“ä½œå‰ç™¼ç”Ÿï¼Œé€²è€Œä¸­æ–·å¾ŒçºŒéåŒæ­¥çš„è³‡æ–™åº«äº¤æ˜“ï¼Œæ‰€ä»¥åœ¨ unload äº‹ä»¶ä¸­åŸ·è¡Œè³‡æ–™åº«äº¤æ˜“æ˜¯è¡Œä¸é€šåœ°ã€‚</p>
<p>äº‹å¯¦ä¸Šä¸è«–ç€è¦½å™¨æ˜¯å¦æ­£å¸¸é—œé–‰ï¼Œéƒ½æ²’æœ‰ä»»ä½•æ–¹æ³•ä¿è­‰ IndexedDB äº¤æ˜“èƒ½å¤ é †åˆ©å®Œæˆï¼Œè«‹è¦‹<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=870645" class="external" rel=" noopener">bug&nbsp;870645</a>ã€‚</p></div><h2 id="å®Œæ•´_indexeddb_ç¯„ä¾‹"><a href="#å®Œæ•´_indexeddb_ç¯„ä¾‹" title="Permalink to å®Œæ•´ IndexedDB ç¯„ä¾‹">å®Œæ•´ IndexedDB ç¯„ä¾‹</a></h2><div></div><h3 id="html"><a href="#html" title="Permalink to HTML">HTML</a></h3><div><div class="code-example"><pre class="brush: html notranslate"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>IndexedDB Demo: storing blobs, e-publication example<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>note<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
        Works and tested with:
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>compat<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>register-form<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-title<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                Title:
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-title<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-title<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-biblioid<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                Bibliographic ID:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>note<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>(ISBN, ISSN, etc.)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-biblioid<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-biblioid<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-year<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                Year:
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-year<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-year<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-file<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                File image:
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-file<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-file-url<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                Online-file image URL:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>note<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>(same origin URL)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-file-url<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-file-url<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button-pane<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add-button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Add Publication<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>reset<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>register-form-reset<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>delete-form<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-biblioid-to-delete<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                Bibliographic ID:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>note<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>(ISBN, ISSN, etc.)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-biblioid-to-delete<span class="token punctuation">"</span></span>
                     <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-biblioid-to-delete<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>key-to-delete<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                Key:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>note<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>(for example 1, 2, 3, etc.)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>key-to-delete<span class="token punctuation">"</span></span>
                     <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>key-to-delete<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button-pane<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>delete-button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Delete Publication<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clear-store-button<span class="token punctuation">"</span></span>
               <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Clear the whole store<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>destructive<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>search-form<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button-pane<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>search-list-button<span class="token punctuation">"</span></span>
               <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>List database content<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-msg<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-viewer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pub-list<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div><h3 id="css"><a href="#css" title="Permalink to CSS">CSS</a></h3><div><div class="code-example"><pre class="brush: css notranslate"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 0.8em<span class="token punctuation">;</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> Sans-Serif<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">form</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #cccccc<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0.3em<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 0.5em<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">table</span> <span class="token punctuation">{</span>
  <span class="token property">border-collapse</span><span class="token punctuation">:</span> collapse<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">input</span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0.3em<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> #cccccc<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0.3em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.required:after</span> <span class="token punctuation">{</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">"*"</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.button-pane</span> <span class="token punctuation">{</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">#pub-viewer</span> <span class="token punctuation">{</span>
  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 48%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 20em<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> solid #d092ff 0.1em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">#pub-viewer iframe</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">#pub-list</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 46%<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #eeeeee<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0.3em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">#pub-list li</span> <span class="token punctuation">{</span>
  <span class="token property">padding-top</span><span class="token punctuation">:</span> 0.5em<span class="token punctuation">;</span>
  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 0.5em<span class="token punctuation">;</span>
  <span class="token property">padding-right</span><span class="token punctuation">:</span> 0.5em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">#msg</span> <span class="token punctuation">{</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.action-success</span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0.5em<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #00d21e<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #eeeeee<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0.2em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.action-failure</span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0.5em<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #ff1408<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #eeeeee<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0.2em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.note</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> smaller<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.destructive</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> orange<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.destructive:hover</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #ff8000<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.destructive:active</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div><h3 id="javascript"><a href="#javascript" title="Permalink to JavaScript">JavaScript</a></h3><div><div class="code-example"><pre class="brush: js notranslate"><code><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> <span class="token constant">COMPAT_ENVS</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">'Firefox'</span><span class="token punctuation">,</span> <span class="token string">"&gt;= 16.0"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'Google Chrome'</span><span class="token punctuation">,</span>
     <span class="token string">"&gt;= 24.0 (you may need to get Google Chrome Canary), NO Blob storage support"</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> compat <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#compat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  compat<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  compat<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'&lt;ul id="compat-list"&gt;&lt;/ul&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token constant">COMPAT_ENVS</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> idx<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#compat-list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'&lt;li&gt;'</span> <span class="token operator">+</span> val<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> val<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'&lt;/li&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token constant">DB_NAME</span> <span class="token operator">=</span> <span class="token string">'mdn-demo-indexeddb-epublications'</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token constant">DB_VERSION</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// Use a long long for this value (don't use a float)</span>
  <span class="token keyword">const</span> <span class="token constant">DB_STORE_NAME</span> <span class="token operator">=</span> <span class="token string">'publications'</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> db<span class="token punctuation">;</span>

  <span class="token comment">// Used to keep track of which view is displayed to avoid uselessly reloading it</span>
  <span class="token keyword">var</span> current_view_pub_key<span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">openDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"openDb ..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> req <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token constant">DB_NAME</span><span class="token punctuation">,</span> <span class="token constant">DB_VERSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Better use "this" than "req" to get the result to avoid problems with</span>
      <span class="token comment">// garbage collection.</span>
      <span class="token comment">// db = req.result;</span>
      db <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"openDb DONE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"openDb:"</span><span class="token punctuation">,</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>errorCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    req<span class="token punctuation">.</span><span class="token function-variable function">onupgradeneeded</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"openDb.onupgradeneeded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> store <span class="token operator">=</span> evt<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>result<span class="token punctuation">.</span><span class="token function">createObjectStore</span><span class="token punctuation">(</span>
        <span class="token constant">DB_STORE_NAME</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">keyPath</span><span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token literal-property property">autoIncrement</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      store<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">'biblioid'</span><span class="token punctuation">,</span> <span class="token string">'biblioid'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      store<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      store<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @param {string} store_name
   * @param {string} mode either "readonly" or "readwrite"
   */</span>
  <span class="token keyword">function</span> <span class="token function">getObjectStore</span><span class="token punctuation">(</span><span class="token parameter">store_name<span class="token punctuation">,</span> mode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> tx <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span>store_name<span class="token punctuation">,</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> tx<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span>store_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">clearObjectStore</span><span class="token punctuation">(</span><span class="token parameter">store_name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> store <span class="token operator">=</span> <span class="token function">getObjectStore</span><span class="token punctuation">(</span><span class="token constant">DB_STORE_NAME</span><span class="token punctuation">,</span> <span class="token string">'readwrite'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> req <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">displayActionSuccess</span><span class="token punctuation">(</span><span class="token string">"Store cleared"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">displayPubList</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"clearObjectStore:"</span><span class="token punctuation">,</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>errorCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">displayActionFailure</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">getBlob</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> store<span class="token punctuation">,</span> success_callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> req <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> value <span class="token operator">=</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        <span class="token function">success_callback</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @param {IDBObjectStore=} store
   */</span>
  <span class="token keyword">function</span> <span class="token function">displayPubList</span><span class="token punctuation">(</span><span class="token parameter">store</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"displayPubList"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> store <span class="token operator">==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span>
      store <span class="token operator">=</span> <span class="token function">getObjectStore</span><span class="token punctuation">(</span><span class="token constant">DB_STORE_NAME</span><span class="token punctuation">,</span> <span class="token string">'readonly'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> pub_msg <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#pub-msg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pub_msg<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> pub_list <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#pub-list'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pub_list<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Resetting the iframe so that it doesn't display previous content</span>
    <span class="token function">newViewerFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> req<span class="token punctuation">;</span>
    req <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Requests are executed in the order in which they were made against the</span>
    <span class="token comment">// transaction, and their results are returned in the same order.</span>
    <span class="token comment">// Thus the count text below will be displayed before the actual pub list</span>
    <span class="token comment">// (not that it is algorithmically important in this case).</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      pub_msg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'&lt;p&gt;There are &lt;strong&gt;'</span> <span class="token operator">+</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result <span class="token operator">+</span>
                     <span class="token string">'&lt;/strong&gt; record(s) in the object store.&lt;/p&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"add error"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">displayActionFailure</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    req <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> cursor <span class="token operator">=</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>

      <span class="token comment">// If the cursor is pointing at something, ask for the data</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"displayPubList cursor:"</span><span class="token punctuation">,</span> cursor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        req <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        req<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> value <span class="token operator">=</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
          <span class="token keyword">var</span> list_item <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;li&gt;'</span> <span class="token operator">+</span>
                            <span class="token string">'['</span> <span class="token operator">+</span> cursor<span class="token punctuation">.</span>key <span class="token operator">+</span> <span class="token string">'] '</span> <span class="token operator">+</span>
                            <span class="token string">'(biblioid: '</span> <span class="token operator">+</span> value<span class="token punctuation">.</span>biblioid <span class="token operator">+</span> <span class="token string">') '</span> <span class="token operator">+</span>
                            value<span class="token punctuation">.</span>title <span class="token operator">+</span>
                            <span class="token string">'&lt;/li&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>year <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            list_item<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">' - '</span> <span class="token operator">+</span> value<span class="token punctuation">.</span>year<span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'blob'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
              <span class="token keyword">typeof</span> value<span class="token punctuation">.</span>blob <span class="token operator">!=</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> link <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;a href="'</span> <span class="token operator">+</span> cursor<span class="token punctuation">.</span>key <span class="token operator">+</span> <span class="token string">'"&gt;File&lt;/a&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            link<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            link<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseenter'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                      <span class="token function">setInViewer</span><span class="token punctuation">(</span>evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list_item<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">' / '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list_item<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            list_item<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" / No attached file"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          pub_list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>list_item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">// Move on to the next object in store</span>
        cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// This counter serves only to create distinct ids</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"No more entries"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">newViewerFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> viewer <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#pub-viewer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    viewer<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> iframe <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;iframe /&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    viewer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> iframe<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">setInViewer</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"setInViewer:"</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    key <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> current_view_pub_key<span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>

    current_view_pub_key <span class="token operator">=</span> key<span class="token punctuation">;</span>

    <span class="token keyword">var</span> store <span class="token operator">=</span> <span class="token function">getObjectStore</span><span class="token punctuation">(</span><span class="token constant">DB_STORE_NAME</span><span class="token punctuation">,</span> <span class="token string">'readonly'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">getBlob</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> store<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"setInViewer blob:"</span><span class="token punctuation">,</span> blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> iframe <span class="token operator">=</span> <span class="token function">newViewerFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// It is not possible to set a direct link to the</span>
      <span class="token comment">// blob to provide a mean to directly download it.</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>blob<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        reader<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> html <span class="token operator">=</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
          iframe<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        reader<span class="token punctuation">.</span><span class="token function">readAsText</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>blob<span class="token punctuation">.</span>type<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'image/'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        iframe<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> img_id <span class="token operator">=</span> <span class="token string">'image-'</span> <span class="token operator">+</span> key<span class="token punctuation">;</span>
          <span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;img id="'</span> <span class="token operator">+</span> img_id <span class="token operator">+</span> <span class="token string">'"/&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">var</span> obj_url <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">+</span> img_id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span> obj_url<span class="token punctuation">)</span><span class="token punctuation">;</span>
          window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>obj_url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>blob<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'application/pdf'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'cursor'</span><span class="token punctuation">,</span> <span class="token string">'wait'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> obj_url <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
        iframe<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'cursor'</span><span class="token punctuation">,</span> <span class="token string">'auto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        iframe<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span> obj_url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>obj_url<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        iframe<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">"No view available"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @param {string} biblioid
   * @param {string} title
   * @param {number} year
   * @param {string} url the URL of the image to download and store in the local
   *   IndexedDB database. The resource behind this URL is subjected to the
   *   "Same origin policy", thus for this method to work, the URL must come from
   *   the same origin as the web site/app this code is deployed on.
   */</span>
  <span class="token keyword">function</span> <span class="token function">addPublicationFromUrl</span><span class="token punctuation">(</span><span class="token parameter">biblioid<span class="token punctuation">,</span> title<span class="token punctuation">,</span> year<span class="token punctuation">,</span> url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"addPublicationFromUrl:"</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Setting the wanted responseType to "blob"</span>
    <span class="token comment">// http://www.w3.org/TR/XMLHttpRequest2/#the-response-attribute</span>
    xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token string">'blob'</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                           <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Blob retrieved"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                             <span class="token keyword">var</span> blob <span class="token operator">=</span> xhr<span class="token punctuation">.</span>response<span class="token punctuation">;</span>
                             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Blob:"</span><span class="token punctuation">,</span> blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
                             <span class="token function">addPublication</span><span class="token punctuation">(</span>biblioid<span class="token punctuation">,</span> title<span class="token punctuation">,</span> year<span class="token punctuation">,</span> blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
                           <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                             console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"addPublicationFromUrl error:"</span><span class="token punctuation">,</span>
                                           xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">,</span> xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
                           <span class="token punctuation">}</span>
                         <span class="token punctuation">}</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// We can't use jQuery here because as of jQuery 1.8.3 the new "blob"</span>
    <span class="token comment">// responseType is not handled.</span>
    <span class="token comment">// http://bugs.jquery.com/ticket/11461</span>
    <span class="token comment">// http://bugs.jquery.com/ticket/7248</span>
    <span class="token comment">// $.ajax({</span>
    <span class="token comment">//   url: url,</span>
    <span class="token comment">//   type: 'GET',</span>
    <span class="token comment">//   xhrFields: { responseType: 'blob' },</span>
    <span class="token comment">//   success: function(data, textStatus, jqXHR) {</span>
    <span class="token comment">//     console.log("Blob retrieved");</span>
    <span class="token comment">//     console.log("Blob:", data);</span>
    <span class="token comment">//     // addPublication(biblioid, title, year, data);</span>
    <span class="token comment">//   },</span>
    <span class="token comment">//   error: function(jqXHR, textStatus, errorThrown) {</span>
    <span class="token comment">//     console.error(errorThrown);</span>
    <span class="token comment">//     displayActionFailure("Error during blob retrieval");</span>
    <span class="token comment">//   }</span>
    <span class="token comment">// });</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @param {string} biblioid
   * @param {string} title
   * @param {number} year
   * @param {Blob=} blob
   */</span>
  <span class="token keyword">function</span> <span class="token function">addPublication</span><span class="token punctuation">(</span><span class="token parameter">biblioid<span class="token punctuation">,</span> title<span class="token punctuation">,</span> year<span class="token punctuation">,</span> blob</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"addPublication arguments:"</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">biblioid</span><span class="token operator">:</span> biblioid<span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> title<span class="token punctuation">,</span> <span class="token literal-property property">year</span><span class="token operator">:</span> year <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> blob <span class="token operator">!=</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span>
      obj<span class="token punctuation">.</span>blob <span class="token operator">=</span> blob<span class="token punctuation">;</span>

    <span class="token keyword">var</span> store <span class="token operator">=</span> <span class="token function">getObjectStore</span><span class="token punctuation">(</span><span class="token constant">DB_STORE_NAME</span><span class="token punctuation">,</span> <span class="token string">'readwrite'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> req<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      req <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">'DataCloneError'</span><span class="token punctuation">)</span>
        <span class="token function">displayActionFailure</span><span class="token punctuation">(</span><span class="token string">"This engine doesn't know how to clone a Blob, "</span> <span class="token operator">+</span>
                             <span class="token string">"use Firefox"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Insertion in DB successful"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">displayActionSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">displayPubList</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"addPublication error"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">displayActionFailure</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @param {string} biblioid
   */</span>
  <span class="token keyword">function</span> <span class="token function">deletePublicationFromBib</span><span class="token punctuation">(</span><span class="token parameter">biblioid</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"deletePublication:"</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> store <span class="token operator">=</span> <span class="token function">getObjectStore</span><span class="token punctuation">(</span><span class="token constant">DB_STORE_NAME</span><span class="token punctuation">,</span> <span class="token string">'readwrite'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> req <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">'biblioid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>biblioid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result <span class="token operator">==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">displayActionFailure</span><span class="token punctuation">(</span><span class="token string">"No matching record found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">deletePublication</span><span class="token punctuation">(</span>evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">.</span>id<span class="token punctuation">,</span> store<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"deletePublicationFromBib:"</span><span class="token punctuation">,</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>errorCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @param {number} key
   * @param {IDBObjectStore=} store
   */</span>
  <span class="token keyword">function</span> <span class="token function">deletePublication</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> store</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"deletePublication:"</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> store <span class="token operator">==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span>
      store <span class="token operator">=</span> <span class="token function">getObjectStore</span><span class="token punctuation">(</span><span class="token constant">DB_STORE_NAME</span><span class="token punctuation">,</span> <span class="token string">'readwrite'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// As per spec http://www.w3.org/TR/IndexedDB/#object-store-deletion-operation</span>
    <span class="token comment">// the result of the Object Store Deletion Operation algorithm is</span>
    <span class="token comment">// undefined, so it's not possible to know if some records were actually</span>
    <span class="token comment">// deleted by looking at the request result.</span>
    <span class="token keyword">var</span> req <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> record <span class="token operator">=</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"record:"</span><span class="token punctuation">,</span> record<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> record <span class="token operator">==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">displayActionFailure</span><span class="token punctuation">(</span><span class="token string">"No matching record found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// Warning: The exact same key used for creation needs to be passed for</span>
      <span class="token comment">// the deletion. If the key was a Number for creation, then it needs to</span>
      <span class="token comment">// be a Number for deletion.</span>
      req <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
      req<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"evt:"</span><span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"evt.target:"</span><span class="token punctuation">,</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"evt.target.result:"</span><span class="token punctuation">,</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"delete successful"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">displayActionSuccess</span><span class="token punctuation">(</span><span class="token string">"Deletion successful"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">displayPubList</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      req<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"deletePublication:"</span><span class="token punctuation">,</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>errorCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"deletePublication:"</span><span class="token punctuation">,</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>errorCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">displayActionSuccess</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    msg <span class="token operator">=</span> <span class="token keyword">typeof</span> msg <span class="token operator">!=</span> <span class="token string">'undefined'</span> <span class="token operator">?</span> <span class="token string">"Success: "</span> <span class="token operator">+</span> msg <span class="token operator">:</span> <span class="token string">"Success"</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#msg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">'&lt;span class="action-success"&gt;'</span> <span class="token operator">+</span> msg <span class="token operator">+</span> <span class="token string">'&lt;/span&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">displayActionFailure</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    msg <span class="token operator">=</span> <span class="token keyword">typeof</span> msg <span class="token operator">!=</span> <span class="token string">'undefined'</span> <span class="token operator">?</span> <span class="token string">"Failure: "</span> <span class="token operator">+</span> msg <span class="token operator">:</span> <span class="token string">"Failure"</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#msg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">'&lt;span class="action-failure"&gt;'</span> <span class="token operator">+</span> msg <span class="token operator">+</span> <span class="token string">'&lt;/span&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">resetActionStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"resetActionStatus ..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#msg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"resetActionStatus DONE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">addEventListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"addEventListeners"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#register-form-reset'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">resetActionStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#add-button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"add ..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#pub-title'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> biblioid <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#pub-biblioid'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>title <span class="token operator">||</span> <span class="token operator">!</span>biblioid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">displayActionFailure</span><span class="token punctuation">(</span><span class="token string">"Required field(s) missing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">var</span> year <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#pub-year'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>year <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Better use Number.isInteger if the engine has EcmaScript 6</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
          <span class="token function">displayActionFailure</span><span class="token punctuation">(</span><span class="token string">"Invalid year"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        year <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        year <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">var</span> file_input <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#pub-file'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> selected_file <span class="token operator">=</span> file_input<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"selected_file:"</span><span class="token punctuation">,</span> selected_file<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// Keeping a reference on how to reset the file input in the UI once we</span>
      <span class="token comment">// have its value, but instead of doing that we rather use a "reset" type</span>
      <span class="token comment">// input in the HTML form.</span>
      <span class="token comment">//file_input.val(null);</span>
      <span class="token keyword">var</span> file_url <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#pub-file-url'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>selected_file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">addPublication</span><span class="token punctuation">(</span>biblioid<span class="token punctuation">,</span> title<span class="token punctuation">,</span> year<span class="token punctuation">,</span> selected_file<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>file_url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">addPublicationFromUrl</span><span class="token punctuation">(</span>biblioid<span class="token punctuation">,</span> title<span class="token punctuation">,</span> year<span class="token punctuation">,</span> file_url<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">addPublication</span><span class="token punctuation">(</span>biblioid<span class="token punctuation">,</span> title<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#delete-button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"delete ..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> biblioid <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#pub-biblioid-to-delete'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#key-to-delete'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>biblioid <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">deletePublicationFromBib</span><span class="token punctuation">(</span>biblioid<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Better use Number.isInteger if the engine has EcmaScript 6</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">''</span> <span class="token operator">||</span> <span class="token function">isNaN</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
          <span class="token function">displayActionFailure</span><span class="token punctuation">(</span><span class="token string">"Invalid key"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        key <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">deletePublication</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#clear-store-button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearObjectStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> search_button <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#search-list-button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    search_button<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">displayPubList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>

  <span class="token function">openDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">addEventListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Immediately-Invoked Function Expression (IIFE)</span>
</code></pre></div><a href="https://yari-demos.prod.mdn.mozit.cloud/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB/_sample_.Full_IndexedDB_example.html" class="external" rel=" noopener">ç·šä¸Šç¯„ä¾‹</a></div><h2 id="ä¸‹ä¸€æ­¥"><a href="#ä¸‹ä¸€æ­¥" title="Permalink to ä¸‹ä¸€æ­¥">ä¸‹ä¸€æ­¥</a></h2><div><p>è«‹åƒè€ƒ<a href="/zh-TW/docs/Web/API/IndexedDB_API">IndexedDB æ–‡ä»¶</a>ï¼Œçœ‹çœ‹æœ‰ç”šéº¼ IndexedDB API å¯ä¾›ä½¿ç”¨ï¼Œå¯¦éš›è©¦ç©ä¸€ä¸‹å§ã€‚</p></div><h2 id="å»¶ä¼¸é–±è®€"><a href="#å»¶ä¼¸é–±è®€" title="Permalink to å»¶ä¼¸é–±è®€">å»¶ä¼¸é–±è®€</a></h2><div><p>åƒç…§</p>
<ul>
  <li><a href="/zh-TW/IndexedDB" class="page-not-created" title="This is a link to an unwritten page">IndexedDB API Reference</a></li>
  <li><a href="https://www.w3.org/TR/IndexedDB/" class="external" rel=" noopener">Indexed Database API Specification</a></li>
  <li><a href="/zh-TW/docs/IndexedDB/Using_IndexedDB_in_chrome" class="page-not-created" title="This is a link to an unwritten page">Using IndexedDB in chrome</a></li>
</ul>
<p>ç›¸é—œæ•™å­¸</p>
<ul>
  <li><a href="https://www.html5rocks.com/tutorials/indexeddb/todo/" class="external" rel=" noopener">A simple TODO list using HTML5 IndexedDB</a>.
    <div class="notecard note" id="sect3">
      <p><strong>å‚™è¨»ï¼š</strong> è«‹æ³¨æ„æ­¤æ•™å­¸ç¯„ä¾‹ç”¨åˆ°çš„å·²ç¶“å»¢æ£„çš„<code>setVersion()</code>æ–¹æ³•ã€‚</p>
    </div>
  </li>
  <li><a href="https://www.html5rocks.com/en/tutorials/indexeddb/uidatabinding/" class="external" rel=" noopener">Databinding UI Elements with IndexedDB</a></li>
</ul>
<p>ç›¸é—œæ–‡ç« </p>
<ul>
  <li><a href="http://msdn.microsoft.com/en-us/scriptjunkie/gg679063.aspx" class="external" rel=" noopener">IndexedDB â€” The Store in Your Browser</a></li>
</ul>
<p>Firefox</p>
<ul>
  <li>Mozilla <a href="https://mxr.mozilla.org/mozilla-central/find?text=&amp;string=dom%2FindexedDB%2F.*%5C.idl&amp;regexp=1" class="external" rel=" noopener">interface files</a></li>
</ul></div></article><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h3>Found a problem with this page?</h3><ul><li><a href="https://github.com/mdn/translated-content/edit/main/files/zh-tw/web/api/indexeddb_api/using_indexeddb/index.md" title="You're going to need to sign in to GitHub first (Opens in a new tab)" target="_blank" rel="noopener noreferrer">Edit on <b>GitHub</b></a></li><li><a href="https://github.com/mdn/translated-content/blob/main/files/zh-tw/web/api/indexeddb_api/using_indexeddb/index.md" title="Folder: zh-tw/web/api/indexeddb_api/using_indexeddb (Opens in a new tab)" target="_blank" rel="noopener noreferrer">Source on <b>GitHub</b></a></li><li><a href="https://github.com/mdn/translated-content/issues/new?body=MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-TW%2Fdocs%2FWeb%2FAPI%2FIndexedDB_API%2FUsing_IndexedDB%0A%0A%23%23%23%23+What+information+was+incorrect%2C+unhelpful%2C+or+incomplete%3F%0A%0A%0A%23%23%23%23+Specific+section+or+headline%3F%0A%0A%0A%23%23%23%23+What+did+you+expect+to+see%3F%0A%0A%0A%23%23%23%23+Did+you+test+this%3F+If+so%2C+how%3F%0A%0A%0A%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EMDN+Content+page+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60zh-tw%2Fweb%2Fapi%2Findexeddb_api%2Fusing_indexeddb%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-TW%2Fdocs%2FWeb%2FAPI%2FIndexedDB_API%2FUsing_IndexedDB%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Ftranslated-content%2Fblob%2Fmain%2Ffiles%2Fzh-tw%2Fweb%2Fapi%2Findexeddb_api%2Fusing_indexeddb%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Ftranslated-content%2Fcommit%2F921c46a374ab0a9f4cc809af0370f8c412e54701%0A*+Document+last+modified%3A+2022-10-01T03%3A41%3A16.000Z%0A%0A%3C%2Fdetails%3E&amp;title=Issue+with+%22%E4%BD%BF%E7%94%A8IndexedDB%22%3A+%28short+summary+here+please%29&amp;labels=needs-triage%2Cl10n-zh" title="This will take you to https://github.com/mdn/content to file a new issue" target="_blank" rel="noopener noreferrer">Report a problem with this content on <b>GitHub</b></a></li><li>Want to fix the problem yourself? See<!-- --> <a href="https://github.com/mdn/content/blob/main/README.md" target="_blank" rel="noopener noreferrer">our Contribution guide</a>.</li></ul></div><p class="last-modified-date"><b>Last modified:</b> <time datetime="2022-10-01T03:41:16.000Z">Oct 1, 2022</time>,<!-- --> <a href="/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB/contributors.txt">by MDN contributors</a></p><form class="language-menu"><fieldset id="select-language"><legend>Change your language</legend><label for="language-selector" class="visually-hidden">Select your preferred language</label> <select id="language-selector" name="language"><option selected="" value="zh-TW">æ­£é«”ä¸­æ–‡ (ç¹é«”)</option><option value="en-US">English (US)</option><option value="es">EspaÃ±ol</option><option value="fr">FranÃ§ais</option><option value="ja">æ—¥æœ¬èª</option><option value="ko">í•œêµ­ì–´</option><option value="pt-BR">PortuguÃªs (do&nbsp;Brasil)</option><option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option><option value="zh-CN">ä¸­æ–‡ (ç®€ä½“)</option></select> <button type="submit" class="button minimal">Change language</button></fieldset></form></div></aside></main></div><footer id="nav-footer" class="page-footer"><div class="content-container"><div class="page-footer-logo"><a href="/zh-TW/" class="logo" aria-label="MDN Web Docs"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451.74 135" fill="#fff"><path d="M7.14 8.35v111.06h111.05V8.35zm103.71 56c-.48.92-1 1.79-1.46 2.71a3.44 3.44 0 01-3.54 2 2.4 2.4 0 00-1.55.5c-1.37.9-2.76 1.79-4.18 2.63a7.33 7.33 0 01-6.35.34 29.71 29.71 0 00-10.63-2 11.7 11.7 0 00-9.46 4.31 14.84 14.84 0 00-2.13 4.29c-1.24 3.07-2.3 21.38-2.3 26.05 0 0-17.62-3.42-34.15-20.34l4.31-11.32h-13.5l9.76-10.35h-16.8l9.77-10.34H12.69L30.45 34a40.9 40.9 0 0119.77-10.83c7.1-1.22 8.93-.53 13.31.77l2.43.73.85.25 3.1.95a12.56 12.56 0 006.21.09 11.37 11.37 0 018.25 1 8.24 8.24 0 014.1 6.22 7.29 7.29 0 003.61 5.49 59.45 59.45 0 009.32 4.11c2.27.86 4.54 1.84 6.79 2.72a6.81 6.81 0 012.86 2.06 4.81 4.81 0 011.1 2.73c.14 2 .37 4 .47 6a15.24 15.24 0 01-1.77 8.03zM320.12 39.62a5.42 5.42 0 00-4.53 2.13 7.36 7.36 0 00-1.7 4.43v2.36a6.28 6.28 0 001.7 4.46 5.63 5.63 0 004.3 1.82 5.12 5.12 0 004.57-2.27A9.7 9.7 0 00326 47a8.11 8.11 0 00-1.67-5.52 5.36 5.36 0 00-4.21-1.86zM387.38 39.53a5.52 5.52 0 00-4.7 2.15 8.8 8.8 0 00-1.63 5.49 9.23 9.23 0 001.58 5.45 5.38 5.38 0 004.7 2.25 5.61 5.61 0 004.74-2.2 8.91 8.91 0 001.68-5.59 8.24 8.24 0 00-1.75-5.52 5.76 5.76 0 00-4.62-2.03zM299.47 41.35a4.34 4.34 0 00-4-1.92 4.55 4.55 0 00-3.89 1.73 8.37 8.37 0 00-1.58 4.17h10.48a6.3 6.3 0 00-1.01-3.98zM357.74 30.75H352v23.31h5.72q5.47 0 8.35-3t2.93-8.65q0-5.43-2.88-8.55t-8.38-3.11z"></path><path d="M121.55 8.35v70.8h323V8.35zm42.21 22.45h-4V54h3.68v3.73h-11.25V54h3.31V36.79h-.19l-9.63 19.12h-2.12l-10-19.4h-.19V54h3.45v3.73h-11.15V54h3.68V30.8h-4v-3.73H133l11.66 22.56h.19l11.18-22.56h7.7zm29.12 22.67q-4.11 4.28-11.38 4.28h-14.06v-3.69h3.73V30.75h-3.73v-3.68h13.83q7.59 0 11.66 4.29a15.4 15.4 0 014 11 15.33 15.33 0 01-4.05 11.11zm38.89-22.67h-3.68v27h-2.6L208.08 35h-.19v19h4.67v3.73h-12.22V54h3.49V30.8h-4v-3.73h7.08l16.9 22.09h.19V30.8h-4.58v-3.73h12.32zm43.8 27h-3.31l-7.83-23.18h-.19l-7.55 23.18h-3.35l-8.78-27h-2.65v-3.73H253v3.73h-3.87L255 50.71h.23l6.61-19.91H259v-3.73h11v3.73h-2.78l6.61 20.1h.23l5.43-20.1h-4.15v-3.73h11v3.73h-2.54zm26.71-1.51a9.66 9.66 0 01-6.42 2 10.2 10.2 0 01-7.41-2.74c-1.89-1.82-2.83-4.47-2.83-7.93a12.37 12.37 0 012.64-8.12 9 9 0 017.32-3.21 8.62 8.62 0 016.75 2.69 9.65 9.65 0 012.45 6.52 13.67 13.67 0 01-.28 2.69H290q.29 6.71 6.18 6.7a5.2 5.2 0 003.71-1.18 5.82 5.82 0 001.67-2.83l3.45.71a7.21 7.21 0 01-2.73 4.65zm25.77-1.63c-1.51 2.4-3.92 3.61-7.22 3.61s-5.84-1.29-7.22-3.87c0 .25-.1.82-.21 1.7s-.19 1.44-.22 1.7H309c.16-1 .31-2 .47-3.07a21.42 21.42 0 00.24-3.16v-23h-3.4v-3.3h7.55V40.9a9.76 9.76 0 012.67-3.28 7.33 7.33 0 014.74-1.4 8.48 8.48 0 016.5 2.78q2.55 2.74 2.55 7.74a14.6 14.6 0 01-2.27 7.87zm41.39-1.14q-4.11 4.28-11.37 4.28H344v-3.74h3.73V30.75H344v-3.68h13.83q7.59 0 11.66 4.29a15.41 15.41 0 014.06 11 15.34 15.34 0 01-4.11 11.11zm25.65 1.68a10.53 10.53 0 01-7.9 3.07 10 10 0 01-7.63-3 10.93 10.93 0 01-2.8-7.83 12.13 12.13 0 012.69-7.93q2.69-3.3 8-3.3t8 3.28a12 12 0 012.64 7.76 10.86 10.86 0 01-3 7.9zm22.61.57c-1.4 1.66-3.63 2.5-6.68 2.5a9.58 9.58 0 01-7.15-2.76q-2.72-2.76-2.71-7.91a12.25 12.25 0 012.69-8 9.17 9.17 0 017.5-3.28 15 15 0 013.82.48 10.37 10.37 0 013.5 1.65l.85 5.47-3.35.38-.76-3.54a8.07 8.07 0 00-4.11-1 4.9 4.9 0 00-4.39 2.15 9.93 9.93 0 00-1.41 5.55 8.9 8.9 0 001.5 5.38 5.23 5.23 0 004.44 2c2.92 0 4.67-1.7 5.23-5.1l3.5.71a10.34 10.34 0 01-2.47 5.27zm20.48.75a11.68 11.68 0 01-6.63 1.75 15.52 15.52 0 01-8.26-2.08L424 51l3.26.33-.1 2.74a7 7 0 002.06.66 12.63 12.63 0 002.19.19 8.68 8.68 0 003.66-.75 2.5 2.5 0 001.63-2.36 2.25 2.25 0 00-1.32-2.2 12.65 12.65 0 00-3.28-1 47.39 47.39 0 01-3.9-.82 7.5 7.5 0 01-3.25-1.7 4.67 4.67 0 01-1.33-3.66c0-2.36.88-4 2.62-4.91a12 12 0 015.6-1.37 15 15 0 014.08.55 16.65 16.65 0 013.47 1.39l.47 5.1-3.3.37-.48-3.3a9.5 9.5 0 00-4.06-.9 5.62 5.62 0 00-2.87.66 2.33 2.33 0 00-1.15 2.25 2.13 2.13 0 001.3 2.07 11.91 11.91 0 003.21.92 36.69 36.69 0 013.82.83 7.46 7.46 0 013.21 1.74 4.9 4.9 0 011.3 3.73 5.56 5.56 0 01-2.66 4.91z"></path><path d="M181.17 30.75h-5.71v23.31h5.71q5.47 0 8.36-3t2.88-8.61q0-5.43-2.88-8.55t-8.36-3.15zM121.63 119.32V81.74h114.91v37.58zM153.22 109h-2v-6.85a4.8 4.8 0 00-1.58-4 5.57 5.57 0 00-3.55-1.26 5 5 0 00-4.92 3.26 4.19 4.19 0 00-1.88-2.46 5.82 5.82 0 00-3-.8 4.89 4.89 0 00-4.56 2.56v-2.21h-6.28v3.26h2v8.5h-2v3.23h9.11V109h-2.86v-5.25a4.4 4.4 0 01.69-2.56 2.47 2.47 0 012.21-1q2.57 0 2.56 3.63v8.41h6.29V109h-2v-5.25a4.47 4.47 0 01.67-2.56 2.42 2.42 0 012.19-1q2.63 0 2.63 3.63v8.41h6.28zm9.88-12.07q-4 0-6 2.36a8.41 8.41 0 00-2 5.66 7.25 7.25 0 002.17 5.62 8 8 0 005.65 2 8.54 8.54 0 005.94-2.11 7.27 7.27 0 002.34-5.67 8.21 8.21 0 00-2-5.51q-2.07-2.34-6.1-2.34zm-.1 12.35a3 3 0 01-2.63-1.33 5.68 5.68 0 01-.9-3.26 5 5 0 011-3.28 3.23 3.23 0 012.61-1.18 3.5 3.5 0 012.59 1.08 4.56 4.56 0 011.07 3.31 5.21 5.21 0 01-1 3.41 3.33 3.33 0 01-2.74 1.25zm25-2.3l-3.39-.29-.7 2.32H179l8.32-9.54-.32-2.23h-13.19l-.53 5.25 3.16.34.67-2.36h4.65l-8.25 9.53.44 2.26h13.13zm7.62-9.74h-4.46v5.39h4.46zm0 9.61h-4.46v5.39h4.46zm13.54-17.49h-4.23l-6.48 22.88h4.22zm8.68 0h-4.23l-6.45 22.88h4.19zm15 22.51l-.07-2.26a1.22 1.22 0 01-.56.1c-.69 0-1-.39-1-1.16v-6.49a4.39 4.39 0 00-1.8-3.84 7 7 0 00-4.16-1.28 14.55 14.55 0 00-3.16.3 24.14 24.14 0 00-3.29 1.06l-.56 3.46 3.39.4.5-1.69a2.78 2.78 0 011.08-.37 11.3 11.3 0 011.25-.07c1.19 0 1.89.37 2.09 1.1a8.55 8.55 0 01.3 2.26v.5a8.91 8.91 0 00-1.18-.11h-1.21a12.64 12.64 0 00-4.81.88 3.53 3.53 0 00-2.18 3.64 3.66 3.66 0 001.48 3.33 5.63 5.63 0 003.11 1 4.67 4.67 0 003-.91 6.78 6.78 0 001.8-2 3 3 0 003.33 3 5.54 5.54 0 002.66-.85zm-9.25-2.32a1.69 1.69 0 01-1.36-.52 1.81 1.81 0 01-.43-1.21 1.67 1.67 0 01.86-1.68 4.63 4.63 0 012-.42 7.69 7.69 0 011.07.07l1.06.13a3.58 3.58 0 01-1.08 2.74 3.24 3.24 0 01-2.11.89z"></path></svg></a></div><ul class="link-list-mdn"><li><a href="/zh-TW/docs/Web">Web Technologies</a></li><li><a href="/zh-TW/docs/Learn">Learn Web Development</a></li><li><a href="/zh-TW/docs/MDN/About">About MDN</a></li><li><a href="/zh-TW/docs/MDN/Feedback">Feedback</a></li></ul><ul class="link-list-moz"><li><a href="https://www.mozilla.org/about/" target="_blank" rel="noopener noreferrer">About</a></li><li><a href="https://shop.spreadshirt.com/mdn-store/" target="_blank" rel="noopener noreferrer">MDN Web Docs Store</a></li><li><a href="https://www.mozilla.org/contact/" target="_blank" rel="noopener noreferrer">Contact Us</a></li><li><a href="https://www.mozilla.org/firefox/?utm_source=developer.mozilla.org&amp;utm_campaign=footer&amp;utm_medium=referral" target="_blank" rel="noopener noreferrer">Firefox</a></li></ul><div class="social social-mdn"><h4>MDN</h4><ul><li><a class="social-icon twitter" href="https://twitter.com/mozdevnet" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on Twitter</span></a></li><li><a class="social-icon github" href="https://github.com/mdn/" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">MDN on Github</span></a></li></ul></div><div class="social social-moz"><h4>Mozilla</h4><ul><li><a class="social-icon twitter" href="https://twitter.com/mozilla" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">Mozilla on Twitter</span></a></li><li><a class="social-icon instagram" href="https://www.instagram.com/mozillagram/" target="_blank" rel="noopener noreferrer"><span class="visually-hidden">Mozilla on Instagram</span></a></li></ul></div><p id="license" class="footer-license">Â© 2005-<!-- -->2022<!-- --> Mozilla and individual contributors. Content is available under<!-- --> <a href="/docs/MDN/About#Copyrights_and_licenses">these licenses</a>.</p><ul class="footer-legal"><li><a href="https://www.mozilla.org/about/legal/terms/mozilla" target="_blank" rel="noopener noreferrer">Terms</a></li><li><a href="https://www.mozilla.org/privacy/websites/" target="_blank" rel="noopener noreferrer">Privacy</a></li><li><a href="https://www.mozilla.org/privacy/websites/#cookies" target="_blank" rel="noopener noreferrer">Cookies</a></li></ul></div></footer><div class="page-overlay hidden"></div></div><script type="application/json" id="hydration">{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"ä½¿ç”¨IndexedDB","mdn_url":"/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB","locale":"zh-TW","native":"æ­£é«”ä¸­æ–‡ (ç¹é«”)","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>IndexedDB æä¾›äº†åœ¨ç€è¦½å™¨ä¸Šå„²å­˜ä¿ç•™è³‡æ–™çš„åŠŸèƒ½ï¼Œè—‰ç”±å®ƒï¼Œä¸è«–æ˜¯ç·šä¸Šæˆ–ç·šä¸‹æˆ‘å€‘çš„æ‡‰ç”¨éƒ½å¯ä»¥é€²è¡Œè³‡æ–™å­˜å–ã€‚</p>"}},{"type":"prose","value":{"id":"é—œæ–¼æœ¬æ–‡","title":"é—œæ–¼æœ¬æ–‡","isH3":false,"content":"<p>æœ¬æ–‡æœƒå¸¶é ˜å„ä½æ“ä½œéåŒæ­¥ IndexedDB çš„ APIï¼Œå¦‚æœä¸çŸ¥é“ç”šéº¼æ˜¯ IndexedDBï¼Œè«‹å…ˆçœ‹çœ‹<a href=\"/en-US/docs/Web/API/IndexedDB_API/Basic_Terminology\">\"IndexedDB åŸºæœ¬ç¤å¿µ\"</a>ã€‚</p>"}},{"type":"prose","value":{"id":"åŸºæœ¬æ“ä½œæ­¥é©Ÿ","title":"åŸºæœ¬æ“ä½œæ­¥é©Ÿ","isH3":false,"content":"<p>æ“ä½œ IndexedDB çš„åŸºæœ¬æ­¥é©Ÿå»ºè­°å¦‚ä¸‹:</p>\n<ol>\n  <li>é–‹å•Ÿè³‡æ–™åº«å’Œäº¤æ˜“(transaction)ã€‚</li>\n  <li>å»ºç«‹ç‰©ä»¶å­˜æª”(object store)</li>\n  <li>ç™¼å‡ºè³‡æ–™åº«æ“ä½œè«‹æ±‚ï¼Œä¾‹å¦‚æ–°å¢æˆ–å–å¾—è³‡æ–™ã€‚</li>\n  <li>è†è½å°æ‡‰ DOM äº‹ä»¶ç­‰å¾…æ“ä½œå®Œæˆã€‚</li>\n  <li>å¾ result ç‰©ä»¶ä¸Šå–å¾—çµæœé€²è¡Œå…¶ä»–å·¥ä½œã€‚</li>\n</ol>\n<p>å¥½äº†ï¼ŒçŸ¥é“äº†ä¸Šè¿°æ¦‚å¿µå¾Œï¼Œæˆ‘å€‘å¯ä»¥ä¾†å¯¦éš›åšäº›ç”šéº¼ã€‚</p>"}},{"type":"prose","value":{"id":"å»ºç«‹å’Œçµæ§‹è³‡æ–™åº«","title":"å»ºç«‹å’Œçµæ§‹è³‡æ–™åº«","isH3":false,"content":"<p>ç”±æ–¼ IndexedDB çš„æ¨™æº–ä»åœ¨æ¼”é€²ï¼Œæ‰€ä»¥ç›®å‰ä¸€äº›å¯¦ä½œé‚„éœ€è¦åŠ ä¸Šç€è¦½å™¨å‰ç¶´æ¨™ç¤º(å¦‚ Gecko åŸºç¤ç€è¦½å™¨çš„å‰ç¶´æ¨™ç¤ºç‚º mozï¼ŒWebKit åŸºç¤ç€è¦½å™¨çš„å‰ç¶´æ¨™ç¤ºç‚º webkit)ï¼Œç€è¦½å™¨çš„å¯¦ä½œä¹Ÿå¯èƒ½æœƒæœ‰æ‰€å·®ç•°ï¼Œä¸éä¸€æ—¦å…±è­˜æ¨™æº–é”æˆï¼Œç„¡ç€è¦½å™¨å‰ç¶´æ¨™ç¤ºå¯¦ä½œå°‡å‡ºç¾ã€‚å…¶å¯¦ï¼ŒInternet Explorer 10, Firefox 16, Chrome 24 å·²ç¶“æœ‰äº†ç„¡ç€è¦½å™¨å‰ç¶´æ¨™ç¤ºå¯¦ä½œã€‚</p>"}},{"type":"prose","value":{"id":"æ“ä½œå¯¦é©—æ€§è³ªçš„_indexeddb","title":"æ“ä½œå¯¦é©—æ€§è³ªçš„ IndexedDB","isH3":true,"content":"<p>å¦‚æœéœ€è¦è©¦é©—ç€è¦½å™¨çš„å‰ç¶´æ¨™ç¤ºï¼Œå¯ä»¥å¦‚ä¸‹:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// In the following line, you should include the prefixes of implementations you want to test.</span>\nwindow<span class=\"token punctuation\">.</span>indexedDB <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>indexedDB <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>mozIndexedDB <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>webkitIndexedDB <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>msIndexedDB<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// DON'T use \"var indexedDB = ...\" if you're not in a function.</span>\n<span class=\"token comment\">// Moreover, you may need references to some window.IDB* objects:</span>\nwindow<span class=\"token punctuation\">.</span>IDBTransaction <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>IDBTransaction <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>webkitIDBTransaction <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>msIDBTransaction<span class=\"token punctuation\">;</span>\nwindow<span class=\"token punctuation\">.</span>IDBKeyRange <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>IDBKeyRange <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>webkitIDBKeyRange <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>msIDBKeyRange<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// (Mozilla has never prefixed these objects, so we don't need window.mozIDB*)</span>\n</code></pre></div>\n<p>è«‹æ³¨æ„ç€è¦½å™¨å‰ç¶´æ¨™ç¤ºçš„å¯¦ä½œå¯èƒ½ä¸å®Œæ•´ã€æœ‰äº›å•é¡Œæˆ–ä»ç„¶éµå®ˆèˆŠç‰ˆæ¨™æº–ï¼Œå› æ­¤ä¸å»ºè­°åœ¨æ­£å¼ç‰ˆç¨‹å¼ç¢¼ä¸­ä½¿ç”¨ã€‚èˆ‡å…¶å®£ç¨±æ”¯æ´åˆæœ‰å•é¡Œï¼Œå€’ä¸å¦‚ç›´æ¥ä¸æ”¯æ´ã€‚</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>window<span class=\"token punctuation\">.</span>indexedDB<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"é–‹å•Ÿè³‡æ–™åº«","title":"é–‹å•Ÿè³‡æ–™åº«","isH3":true,"content":"<p>é–‹é ­å¦‚ä¸‹:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Let us open our database</span>\n<span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>indexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyTestDatabase\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>æ³¨æ„åˆ°äº†å—ï¼Œé–‹å•Ÿè³‡æ–™åº«å¿…é ˆè¦é€²è¡Œè«‹æ±‚ã€‚</p>\n<p>é–‹å•Ÿè«‹æ±‚ä¸¦ä¸æœƒç«‹åˆ»é–‹å•Ÿè³‡æ–™åº«æˆ–äº¤æ˜“ï¼Œå‘¼å« open()æ–¹æ³•æœƒå›å‚³ä¸€å€‹<a href=\"/en-US/docs/Web/API/IDBOpenDBRequest\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">IDBOpenDBRequest (en-US)</a>ç‰©ä»¶ï¼Œé€™å€‹ç‰©ä»¶æ“æœ‰å…©å€‹äº‹ä»¶(success å’Œ error)ã€‚å¤§éƒ¨åˆ† IndexedDB çš„éåŒæ­¥åŠŸèƒ½éƒ½æœƒå›å‚³ä¸€å€‹<a href=\"/en-US/docs/Web/API/IDBDatabase\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">IDBDatabase (en-US)</a>é¡ç‰©ä»¶ï¼Œç„¶å¾Œæˆ‘å€‘å¯ä»¥è¨»å†ŠæˆåŠŸå’Œå¤±æ•—äº‹ä»¶è™•ç†å™¨ã€‚</p>\n<p>Open æ–¹æ³•ç¬¬äºŒå€‹åƒæ•¸æ˜¯è³‡æ–™åº«ç‰ˆæœ¬ï¼Œè³‡æ–™åº«ç‰ˆæœ¬æ±ºå®šäº†è³‡æ–™åº«çµæ§‹ï¼Œä¹Ÿå°±æ˜¯è³‡æ–™åº«ç‰©ä»¶å­˜æª”çš„çµæ§‹ã€‚å¦‚æœè«‹æ±‚ç‰ˆæœ¬ä¸å­˜åœ¨(æ¯”å¦‚å› ç‚ºé€™æ˜¯ä¸€å€‹æ–°è³‡æ–™åº«æˆ–æ˜¯è³‡æ–™åº«ç‰ˆæœ¬å·²å‡ç´š)ï¼Œonupgradeneeded äº‹ä»¶æœƒè¢«è§¸ç™¼ï¼Œç„¶å¾Œæˆ‘å€‘å¯ä»¥åœ¨ onupgradeneeded äº‹ä»¶è™•ç†å™¨ä¸­å†å»ºç«‹æ–°çš„ç‰ˆæœ¬ï¼Œä¸‹é¢<a href=\"#updating_the_version_of_the_database\">å‡ç´šè³‡æ–™åº«ç‰ˆæœ¬</a>æœ‰æ›´è©³ç´°çš„èªªæ˜ã€‚</p>\n<h4 id=\"ç”¢ç”Ÿäº‹ä»¶è™•ç†å™¨\">ç”¢ç”Ÿäº‹ä»¶è™•ç†å™¨</h4>\n<p>å¹¾ä¹æ‰€æœ‰ç¬¬ä¸€ä»¶è¦å°è«‹æ±‚åšçš„äº‹éƒ½æ˜¯ç”¢ç”Ÿ success å’Œ error äº‹ä»¶è™•ç†å™¨:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>request<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Do something with request.errorCode!</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nrequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Do something with request.result!</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œsuccess äº‹ä»¶(ä¹Ÿå°±æ˜¯ DOM äº‹ä»¶çš„ type å±¬æ€§è¨­ç‚º success)æœƒä»¥ request ç‚ºç›®æ¨™è§¸ç™¼ï¼Œç„¶å¾Œ request ç‰©ä»¶ä¸Šçš„ onsuccess å‡½æ•¸æ¥è‘—è¢«å‘¼å«ï¼Œå…¶ä¸­ success äº‹ä»¶å°±æ˜¯åƒæ•¸ï¼›å¦å‰‡ error äº‹ä»¶(ä¹Ÿå°±æ˜¯ DOM äº‹ä»¶çš„ type å±¬æ€§è¨­ç‚º error)æœƒä»¥ request ç‚ºç›®æ¨™è§¸ç™¼ï¼Œç„¶å¾Œ request ç‰©ä»¶ä¸Šçš„ onerror å‡½æ•¸æ¥è‘—è¢«å‘¼å«ï¼Œå…¶ä¸­ error äº‹ä»¶å°±æ˜¯åƒæ•¸ã€‚</p>\n<p>IndexedDB çš„ API è¨­è¨ˆä¸Šç›¡é‡æ¸›å°‘éŒ¯èª¤è™•ç†ï¼Œæ‰€ä»¥ä¸å¤ªå¸¸çœ‹åˆ°éŒ¯èª¤äº‹ä»¶ï¼Œä¸éé–‹å•Ÿè³‡æ–™åº«çš„æ™‚å€™é‚„æ˜¯æœ‰ä¸€äº›ç‹€æ³æœƒç”¢ç”¢ç”ŸéŒ¯èª¤ï¼Œæœ€å¸¸è¦‹çš„ç‹€æ³æ˜¯ä½¿ç”¨è€…æ‹’çµ•æˆ‘å€‘å»ºç«‹è³‡æ–™åº«ã€‚</p>\n<p>IndexedDB è¨­è¨ˆç›®æ¨™ä¹‹ä¸€ç‚ºå­˜æ”¾å¤§é‡è³‡æ–™ä»¥ä¾›é›¢ç·šä½¿ç”¨(è«‹åƒè€ƒ<a href=\"/zh-TW/IndexedDB#Storage_limits\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">\"å„²å­˜é™åˆ¶\"</a>äº†è§£æ›´å¤šç´°ç¯€)ã€‚ä½†å¾ˆæ˜é¡¯åœ°ï¼Œç€è¦½å™¨åˆä¸æ¨‚è¦‹ä¸€äº›å»£å‘Šç¶²ç«™æˆ–æƒ¡æ„ç¶²ç«™æ±™æŸ“é›»è…¦ï¼Œæ‰€ä»¥ç•¶ä»»ä¸€å€‹ç¶²è·¯æ‡‰ç”¨ç¬¬ä¸€æ¬¡é–‹å•Ÿ IndexedDB è³‡æ–™åº«ï¼Œç€è¦½å™¨æœƒå¾µè©¢ä½¿ç”¨è€…æ˜¯å¦å‡†è¨±å…¶ä½œæ¥­ï¼›åŒæ™‚åœ¨ç§å¯†ç€è¦½ä¸­é–‹å•Ÿä½œæ¥­ä¹Ÿæœƒå¤±æ•—ï¼Œå› ç‚ºç§å¯†ç€è¦½ä¸æœƒç•™ä¸‹ä»»ä½•ç€è¦½ç—•è·¡ã€‚</p>\n<p>é€™è£¡å‘¼å« indexedDB.open()é–‹å•Ÿ indexedDB è³‡æ–™åº«ä¸¦å›å‚³ request ç‰©ä»¶ï¼Œå‡è¨­ä½¿ç”¨è€…å…è¨±æˆ‘å€‘å»ºç«‹ indexedDB è³‡æ–™åº«ï¼Œæˆ‘å€‘ä¹Ÿæ”¶åˆ° suceess äº‹ä»¶è§¸ç™¼äº† success å›å‘¼å‡½æ•¸(callback)ï¼Œrequest ç‰©ä»¶çš„ result å±¬æ€§æœƒæ˜¯ä¸€å€‹ IDBDatabase ç‰©ä»¶ ï¼Œæ¥ä¸‹ä¾†ä¾¿æ˜¯è¦å„²å­˜é€™å€‹ç‰©ä»¶ä¹‹å¾Œä½¿ç”¨ã€‚ä¸‹æ–¹æ˜¯æ•´å€‹ä½œæ¥­çš„ç¤ºç¯„ç¨‹å¼ç¢¼:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> db<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> indexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyTestDatabase\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nrequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Why didn't you allow my web app to use IndexedDB?!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nrequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  db <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h4 id=\"éŒ¯èª¤è™•ç†\">éŒ¯èª¤è™•ç†</h4>\n<p>éŒ¯èª¤äº‹ä»¶æœƒå‘ä¸Šå‚³éï¼›éŒ¯èª¤äº‹ä»¶ä»¥ç”¢ç”ŸéŒ¯èª¤ä¹‹è«‹æ±‚ç‚ºç›®æ¨™è§¸ç™¼ï¼Œç„¶å¾Œä¸€è·¯å‚³éåˆ°äº¤æ˜“ï¼Œæœ€å¾Œåˆ°è³‡æ–™åº«ç‰©ä»¶ï¼›å¦‚æœä¸æƒ³è¦ç‚ºæ¯ä¸€å€‹è«‹æ±‚æ–°å¢éŒ¯èª¤è™•ç†å™¨ï¼Œå¯ä»¥æ”¹ç‚ºè³‡æ–™åº«ç‰©ä»¶åŠ å…¥ä¸€å€‹éŒ¯èª¤è™•ç†å™¨ã€‚</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>db<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Generic error handler for all errors targeted at this database's</span>\n  <span class=\"token comment\">// requests!</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Database error: \"</span> <span class=\"token operator\">+</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>errorCode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>æœ€å¸¸è¦‹çš„éŒ¯èª¤ä¹‹ä¸€å°±æ˜¯ VER_ERRï¼Œè©²éŒ¯èª¤ä»£è¡¨ç¾åœ¨è³‡æ–™æ–™åº«ç‰ˆæœ¬å¤§æ–¼å˜—è©¦é–‹å•Ÿçš„è³‡æ–™åº«ç‰ˆæœ¬ï¼Œé€™é …éŒ¯èª¤å¿…é ˆè¦æœ‰éŒ¯èª¤è™•ç†å™¨è™•ç†ã€‚</p>"}},{"type":"prose","value":{"id":"å»ºç«‹æˆ–æ›´æ–°è³‡æ–™åº«ç‰ˆæœ¬","title":"å»ºç«‹æˆ–æ›´æ–°è³‡æ–™åº«ç‰ˆæœ¬","isH3":true,"content":"<p>æ–°ç‰ˆæœ¬è³‡æ–™åº«å»ºç«‹æœƒè§¸ç™¼ onupgradeneeded äº‹ä»¶ï¼Œåœ¨é€™å€‹äº‹ä»¶çš„è™•ç†å™¨ä¸­è¦å»ºç«‹é€™å€‹ç‰ˆæœ¬è³‡æ–™åº«éœ€è¦çš„ç‰©ä»¶å­˜æª”ã€‚</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// This event is only implemented in recent browsers</span>\nrequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onupgradeneeded</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> db <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Create an objectStore for this database</span>\n  <span class=\"token keyword\">var</span> objectStore <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">createObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">keyPath</span><span class=\"token operator\">:</span> <span class=\"token string\">\"myKey\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>è³‡æ–™åº«ç‰ˆæœ¬æ˜¯ unsigned long long çš„æ•¸å­—ï¼Œæ‰€ä»¥èƒ½å¤ éå¸¸é•·ã€‚</p>\n<div class=\"notecard warning\" id=\"sect1\">\n  <p><strong>è­¦å‘Šï¼š</strong> è«‹æ³¨æ„é€™ä¹Ÿæ„å‘³è‘—ç‰ˆæœ¬ä¸èƒ½ç‚ºæµ®é»æ•¸ï¼Œå¦å‰‡å°æ•¸é»éƒ¨åˆ†å°‡æœƒç„¡æ¢ä»¶æ¨å»ï¼Œè€Œäº¤æ˜“ä¹Ÿå¯èƒ½ä¸æœƒé–‹å§‹ï¼Œupgradeneeded äº‹ä»¶ä¹Ÿä¸æœƒè§¸ç™¼ã€‚ä¸è¦åƒä»¥ä¸‹ä¾‹å­ä»¥ 2.4 ä½œç‰ˆæœ¬:</p>\n  <div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> indexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyTestDatabase\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// don't do this, as the version will be rounded to 2</span>\n</code></pre></div>\n</div>\n<p>å‡ç´šç‰ˆæœ¬è³‡æ–™åº«å»ºç«‹æœƒè§¸ç™¼ onupgradeneeded äº‹ä»¶ï¼Œé€™å€‹æ™‚å€™è³‡æ–™åº«è£¡é¢å·²ç¶“å«æœ‰å‰ç‰ˆæœ¬ä¸‹çš„ç‰©ä»¶å­˜æª”ï¼Œæ‰€ä»¥èªªä¸éœ€è¦å†æ¬¡å»ºç«‹é€™äº›ç‰©ä»¶å­˜æª”äº†ï¼Œå‰©ä¸‹çš„æ˜¯æ–°å¢æˆ–åˆªé™¤ç‰©ä»¶å­˜æª”ã€‚å¦‚æœæƒ³è¦æ›´å‹•æ—¢å­˜ç‰©ä»¶å­˜æª”(ä¾‹å¦‚æ”¹è®Šè³‡æ–™éµè·¯å¾‘)ï¼Œé‚£éº¼æœƒéœ€è¦å…ˆåˆªé™¤èˆŠçš„å†ç”¢ç”Ÿä¸€å€‹æ–°çš„(è«‹æ³¨æ„é€™ä¹Ÿæœƒåˆªé™¤ç‰©ä»¶å­˜æª”è£¡çš„è³‡æ–™ï¼Œæ‰€ä»¥å¦‚æœè³‡æ–™éœ€è¦ä¿ç•™çš„è©±ï¼Œè«‹åœ¨å‡ç´šå‰å…ˆè®€å‡ºè³‡æ–™å‚™ä»½ã€‚)</p>\n<p>Webkit æ”¯æ´æœ€æ–°æ¨™æº–ä¸éåªæœ‰ Chrome 23 æ‰é–‹å§‹å°å…¥ï¼Œè€Œè¼ƒèˆŠä¸æ”¯æ´æœ€æ–°ç‰ˆæ¨™æº–çš„ç‰ˆæœ¬å‰‡ä¸æ”¯æ´ indexedDB.open(name, version).onupgradeneededã€‚é—œæ–¼å¦‚ä½•åœ¨èˆŠç‰ˆæ¨™æº–ä¸‹å‡ç´šè³‡æ–™åº«ç‰ˆæœ¬è«‹åƒè€ƒ<a href=\"/zh-TW/docs/Web/API/IDBDatabase?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBDatabase#setVersion%28%29_.0A.0ADeprecated\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">\"IDBDatabase åƒè€ƒæ–‡ç« \"</a>ã€‚</p>"}},{"type":"prose","value":{"id":"çµæ§‹åŒ–è³‡æ–™åº«","title":"çµæ§‹åŒ–è³‡æ–™åº«","isH3":true,"content":"<p>indexedDB ä¸ç”¨è³‡æ–™è¡¨è€Œæ˜¯ç‰©ä»¶å­˜æª”ï¼Œç‰©ä»¶å­˜æª”å¯ä»¥æœ‰å¾ˆå¤šã€‚ä¸€ç­†ç‰©ä»¶å­˜æª”è£¡çš„è³‡æ–™å€¼å°æ‡‰ä¸€ç­†è³‡æ–™éµï¼Œä¾æ“šä½¿ç”¨{è³‡æ–™éµè·¯å¾‘(<a href=\"/zh-TW/IndexedDB#gloss_key_path\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">key path</a>)}æˆ–{è³‡æ–™éµç”¢ç”Ÿå™¨(<a href=\"/zh-TW/IndexedDB#gloss_key_generator\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">key generator</a>)}ã€‚</p>\n<p>ä¸‹è¡¨åˆ—å‡ºè³‡æ–™å»ºå„é¡ç”¢ç”Ÿé€”å¾‘:</p>\n<table>\n  <thead>\n    <tr>\n      <th>Key Path</th>\n      <th>Key Generator</th>\n      <th>æè¿°</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>No</td>\n      <td>No</td>\n      <td>ç‰©ä»¶å­˜æª”è³‡æ–™å€¼èƒ½ç‚ºä»»ä½•å‹åˆ¥ï¼Œå³ä½¿åƒæ•¸å­—æˆ–å­—ä¸²ã€‚æ¯ç•¶æ–°å¢ä¸€ç­†è³‡æ–™ï¼Œå¿…é ˆæä¾›ä¸åŒçš„è³‡æ–™éµã€‚</td>\n    </tr>\n    <tr>\n      <td>Yes</td>\n      <td>No</td>\n      <td>ç‰©ä»¶å­˜æª”è³‡æ–™å€¼åƒ…èƒ½ç‚º Javacript ç‰©ä»¶ï¼Œè€Œè©²è³‡æ–™ç‰©ä»¶å¿…é ˆå«æœ‰å’Œè³‡æ–™éµè·¯å¾‘ç›¸åŒåç¨±ä¹‹å±¬æ€§æˆå“¡ã€‚</td>\n    </tr>\n    <tr>\n      <td>No</td>\n      <td>Yes</td>\n      <td>ç‰©ä»¶å­˜æª”è³‡æ–™å€¼èƒ½ç‚ºä»»ä½•å‹åˆ¥ï¼Œè³‡æ–™éµè‡ªå‹•ç”¢ç”Ÿï¼Œä½†å¦‚æœæƒ³è¦æŒ‡å®šè³‡æ–™éµä¹Ÿå¯ä»¥å¦å¤–æä¾›è³‡æ–™éµã€‚</td>\n    </tr>\n    <tr>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>ç‰©ä»¶å­˜æª”è³‡æ–™å€¼åƒ…èƒ½ç‚º Javascript ç‰©ä»¶ã€‚é€šå¸¸è¢«ç”¢ç”Ÿçš„æ–°è³‡æ–™éµçš„å€¼æœƒè¢«å­˜åœ¨ç‰©ä»¶å±¬æ€§åç¨±å’Œè³‡æ–™éµè·¯å¾‘åç¨±ç›¸åŒçš„ç‰©ä»¶å±¬æ€§ä¸‹ï¼Œå¦‚æœé€™å€‹å±¬æ€§å·²ç¶“å­˜åœ¨ï¼Œé€™å€‹å·²ç¶“å­˜åœ¨ä¹‹å±¬æ€§ä¹‹å€¼å°‡è¢«ç”¨ä½œç‚ºè³‡æ–™éµï¼Œè€Œéæ–°ç”¢ç”Ÿçš„è³‡æ–™éµã€‚</td>\n    </tr>\n  </tbody>\n</table>\n<p>æˆ‘å€‘å¯ä»¥æ›¿ä»»ä½•å„²å­˜è³‡æ–™ç‚ºç‰©ä»¶å‹æ…‹è€ŒéåŸå§‹è³‡æ–™å‹æ…‹çš„ç‰©ä»¶å­˜æª”å»ºç«‹ç´¢å¼•ï¼Œç´¢å¼•è®“æˆ‘å€‘èƒ½å¤ ç”¨ç‰©ä»¶å­˜æª”ä¸­è³‡æ–™ç‰©ä»¶å…§çš„æŸä¸€å€‹å±¬æ€§å€¼æŸ¥æ‰¾è³‡æ–™ï¼Œè€Œéåƒ…åƒ…ç‰©ä»¶çš„è³‡æ–™éµã€‚</p>\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œåˆ©ç”¨ç´¢å¼•é‚„å¯ä»¥æ–½åŠ ç°¡å–®çš„å„²å­˜é™åˆ¶ï¼›å»ºç«‹ç´¢å¼•æ™‚è¨­å®šç¨ç‰¹æ——æ¨™(flag)ï¼Œé€™å€‹ç´¢å¼•ä¿è­‰åœ¨æ­¤ç´¢å¼•è³‡æ–™éµä¸‹ä¸æœƒå­˜åœ¨å…©å€‹ç‰©ä»¶å­˜æª”æ“æœ‰åŒæ¨£è³‡æ–™å€¼ï¼Œæ¯”å¦‚èªªç¾åœ¨æœ‰ä¸€å€‹å­˜æ”¾è¨±å¤šä½¿ç”¨è€…çš„ç‰©ä»¶å­˜æª”ï¼Œè€Œä¸”æˆ‘å€‘å¸Œæœ›ä¿è­‰ä¸æœƒå­˜åœ¨æœ‰å…©å€‹ä½¿ç”¨è€…çš„é›»å­éƒµä»¶åœ°å€ä¸€æ¨£ï¼Œæ­¤ä½¿ç´¢å¼•çš„ç¨ç‰¹æ——æ¨™ä¾¿å¯ä»¥å¹«åŠ©æˆ‘å€‘é”æˆç›®æ¨™ã€‚</p>\n<p>ä»¥ä¸Šè½èµ·ä¾†å¯èƒ½æœƒæœ‰äº›è¤‡é›œï¼Œè«‹çœ‹ä¸€ä¸‹ä¸‹é¢çš„å¯¦ä¾‹:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// This is what our customer data looks like.</span>\n<span class=\"token keyword\">const</span> customerData <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">ssn</span><span class=\"token operator\">:</span> <span class=\"token string\">\"444-44-4444\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Bill\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">email</span><span class=\"token operator\">:</span> <span class=\"token string\">\"bill@company.com\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">ssn</span><span class=\"token operator\">:</span> <span class=\"token string\">\"555-55-5555\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Donna\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">email</span><span class=\"token operator\">:</span> <span class=\"token string\">\"donna@home.org\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> dbName <span class=\"token operator\">=</span> <span class=\"token string\">\"the_name\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> indexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>dbName<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nrequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Handle errors.</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nrequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onupgradeneeded</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> db <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Create an objectStore to hold information about our customers. We're</span>\n  <span class=\"token comment\">// going to use \"ssn\" as our key path because it's guaranteed to be</span>\n  <span class=\"token comment\">// unique.</span>\n  <span class=\"token keyword\">var</span> objectStore <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">createObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"customers\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">keyPath</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ssn\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Create an index to search customers by name. We may have duplicates</span>\n  <span class=\"token comment\">// so we can't use a unique index.</span>\n  objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">unique</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Create an index to search customers by email. We want to ensure that</span>\n  <span class=\"token comment\">// no two customers have the same email, so use a unique index.</span>\n  objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"email\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"email\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">unique</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Store values in the newly created objectStore.</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token keyword\">in</span> customerData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>customerData<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>è«‹æ³¨æ„ onupgradeneeded äº‹ä»¶æ˜¯å”¯ä¸€èƒ½å¤ è®Šæ›´è³‡æ–™åº«çµæ§‹ä¹‹è™•ï¼Œåœ¨æ­¤äº‹ä»¶æ‰èƒ½å»ºç«‹æˆ–åˆªé™¤ç‰©ä»¶å­˜æª”ä»¥åŠå»ºç«‹å’Œåˆªé™¤ç´¢å¼•ã€‚</p>\n<p>å‘¼å«<a href=\"/zh-TW/docs/Web/API/IDBDatabase?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBDatabase#setVersion%28%29_.0A.0ADeprecated\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">IDBDatabase</a>é¡åˆ¥ç‰©ä»¶çš„ createObjectStore æ–¹æ³•æœƒç«‹åˆ»å‰µé€ ä¸€å€‹ç‰©ä»¶å­˜æª”ï¼Œé€™å€‹æ–¹æ³•æ¥æ”¶å…©å€‹åƒæ•¸ï¼Œä¸€å€‹æ˜¯ç‰©ä»¶å­˜æª”åç¨±ï¼Œä¸€å€‹æ˜¯éå¿…å¡«çš„åƒæ•¸ç‰©ä»¶ï¼Œé›–ç„¶åƒæ•¸ç‰©ä»¶ä¸ç‚ºå¿…å¡«ä½†æ˜¯å»ç›¸ç•¶é‡è¦ï¼Œå› ç‚ºå®ƒè®“æˆ‘å€‘å®šç¾©äº†ä¸€äº›é‡è¦å±¬æ€§(è«‹åƒè€ƒ<a href=\"/zh-TW/docs/Web/API/IDBDatabase?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBDatabase#createObjectStore\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">createObjectStore</a>)ã€‚æœ¬ä¾‹ä¸­æˆ‘å€‘è¦æ±‚å»ºç«‹äº†ä¸€å€‹\"customer\"ç‰©ä»¶å­˜æª”ï¼Œå®šç¾©\"ssn\"å±¬æ€§ç‚ºè³‡æ–™ä»¶è·¯å¾‘ï¼Œä½¿ç”¨\"ssn\"ä½œç‚ºè³‡æ–™éµè·¯å¾‘æ˜¯å› ç‚ºæ¯å€‹å®¢æˆ¶çš„ ssn ç¢¼ä¸€å®šæ˜¯ç¨ç«‹çš„ã€‚ä¸€æ—¦æ±ºå®šäº†\"ssn\"ä½œç‚ºè³‡æ–™éµè·¯å¾‘ï¼Œé‚£éº¼æ¯ä¸€ç­†è³‡æ–™ä¸€å®šè¦å«æœ‰\"ssn\"ã€‚</p>\n<p>æœ¬ä¾‹é‚„å‰µå»ºä¸€å€‹ç¨±ç‚º\"name\"çš„ç´¢å¼•ï¼Œ\"name\"ç´¢å¼•æŸ¥æ‰¾ç›®æ¨™ç‚ºè³‡æ–™çš„\"name\"å±¬æ€§ï¼Œä¸”ä¸è¨­ç«‹å…¶ç¨ç‰¹æ——æ¨™(unique ç‚º false)ï¼ŒåŒæ¨£åœ°ï¼Œæˆ‘å€‘åˆå‘¼å«<a href=\"/zh-TW/docs/Web/API/IDBObjectStore?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBObjectStore#createIndex()\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">createIndex</a>æ–¹æ³•å‰µå»ºäº†ä¸€å€‹\"email\"ç´¢å¼•ï¼Œä¸é\"email\"ç´¢å¼•å…·å‚™ç¨ç‰¹æ——æ¨™(unique ç‚º true)ã€‚é›–ç„¶å­˜åœ¨\"name\"ç´¢å¼•ï¼Œä½†è³‡æ–™ä¸ä¸€å®šè¦å«æœ‰\"name\"å±¬æ€§ï¼Œåªæ˜¯ç•¶æœç´¢\"name\"ç´¢å¼•æ™‚è³‡æ–™ä¸æœƒå‡ºç¾ã€‚</p>\n<p>æ¥ä¸‹ä¾†æˆ‘å€‘å¯ä»¥é–‹å§‹ç”¨ ssn å¾ç‰©ä»¶å­˜æª”ä¸­å–å‡ºè³‡æ–™ï¼Œæˆ–æ˜¯ç”¨ç´¢å¼•æ‰¾å‡ºè³‡æ–™(è«‹åƒè€ƒ<a href=\"/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB#.e4.bd.bf.e7.94.a8.e7.b4.a2.e5.bc.95\">ä½¿ç”¨ç´¢å¼•</a>)ã€‚</p>"}},{"type":"prose","value":{"id":"ä½¿ç”¨è³‡æ–™éµç”¢ç”Ÿå™¨","title":"ä½¿ç”¨è³‡æ–™éµç”¢ç”Ÿå™¨","isH3":true,"content":"<p>ç•¶å»ºç«‹ç‰©ä»¶å­˜æª”æ™‚è¨­å®š autoIncrement æ——æ¨™ç‚º ture å°‡å•Ÿå‹•è³‡æ–™éµç”¢ç”Ÿå™¨ï¼Œé è¨­ä¸Šè©²æ——æ¨™ç‚º falseã€‚</p>\n<p>æœ‰äº†è³‡æ–™éµç”¢ç”Ÿå™¨ï¼Œç•¶æ–°å¢è³‡æ–™åˆ°ç‰©ä»¶å­˜æª”ä¸­ï¼Œè³‡æ–™éµç”¢ç”Ÿå™¨æœƒè‡ªå‹•å¹«æˆ‘å€‘ç”¢ç”Ÿè³‡æ–™éµã€‚è³‡æ–™éµç”¢ç”Ÿå™¨ç”¢ç”Ÿçš„è³‡æ–™éµç”±æ•´æ•¸ 1 é–‹å§‹ï¼Œè€ŒåŸºæœ¬ä¸Šæ–°ç”¢ç”Ÿçš„è³‡æ–™éµæ˜¯ç”±å‰ä¸€å€‹è³‡æ–™éµåŠ  1 ç”¢ç”Ÿã€‚è³‡æ–™éµçš„ç”¢ç”Ÿä¸æœƒå› ç‚ºè³‡æ–™åˆªé™¤æˆ–æ¸…ç©ºæ‰€æœ‰è³‡æ–™è€Œé‡æ–°é–‹å§‹èµ·ç®—ï¼Œæ‰€ä»¥è³‡æ–™éµå€¼æ˜¯ä¸€ç›´ç´¯åŠ ä¸Šå»çš„ï¼Œé™¤éè³‡æ–™åº«æ“ä½œä¸­æ–·ï¼Œæ•´å€‹äº¤æ˜“ä½œæ¥­è¢«å–æ¶ˆã€‚</p>\n<p>æˆ‘å€‘å¯ä»¥å»ºç«‹ä¸€å€‹æœ‰è³‡æ–™éµç”¢ç”Ÿå™¨çš„ç‰©ä»¶å­˜æª”å¦‚ä¸‹:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Open the indexedDB.</span>\n<span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> indexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>dbName<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nrequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onupgradeneeded</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> db <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Create another object store called \"names\" with the autoIncrement flag set as true.</span>\n    <span class=\"token keyword\">var</span> objStore <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">createObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"names\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">autoIncrement</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Because the \"names\" object store has the key generator, the key for the name value is generated automatically.</span>\n    <span class=\"token comment\">// The added records would be like:</span>\n    <span class=\"token comment\">// key : 1 =&gt; value : \"Bill\"</span>\n    <span class=\"token comment\">// key : 2 =&gt; value : \"Donna\"</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token keyword\">in</span> customerData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        objStore<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>customerData<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>é—œæ–¼è³‡æ–™éµç”¢ç”Ÿå™¨ç´°ç¯€ï¼Œè«‹åƒè€ƒ<a href=\"https://www.w3.org/TR/IndexedDB/#key-generator-concept\" class=\"external\" rel=\" noopener\">\"W3C Key Generators\"</a>ã€‚</p>"}},{"type":"prose","value":{"id":"æ–°å¢å’Œåˆªé™¤è³‡æ–™","title":"æ–°å¢å’Œåˆªé™¤è³‡æ–™","isH3":false,"content":"<p>åœ¨æ“ä½œè³‡æ–™åº«ä¹‹å‰å¿…é ˆè¦å…ˆé€²è¡Œäº¤æ˜“ï¼Œäº¤æ˜“ä¾†è‡ªè³‡æ–™åº«ç‰©ä»¶ï¼Œåœ¨äº¤æ˜“ä¸­è¦æŒ‡å®šæ¶µè“‹ç‰©ä»¶å­˜æª”ç¯„åœï¼Œç„¶å¾Œä¹Ÿè¦æ±ºå®šæ˜¯è¦è®Šæ›´è³‡æ–™åº«æˆ–ç´”ç²¹è®€å–è³‡æ–™ã€‚äº¤æ˜“å…±æœ‰ä¸‰ç¨®ç¨®é¡ï¼Œåˆ†åˆ¥æ˜¯è®€å–(read-only)ï¼Œè®€å¯«(read/write), ä»¥åŠç‰ˆæœ¬è®Šæ›´(versionchange)ï¼Œå¦‚æœåªéœ€è¦è®€è³‡æ–™æœ€å¥½åªä½¿ç”¨è®€å–(read-only)äº¤æ˜“ï¼Œå› ç‚ºè®€å–(read-only)äº¤æ˜“å¯ä»¥å¤šé‡åŒæ­¥é€²è¡Œã€‚</p>"}},{"type":"prose","value":{"id":"æ–°å¢è³‡æ–™åˆ°è³‡æ–™åº«","title":"æ–°å¢è³‡æ–™åˆ°è³‡æ–™åº«","isH3":true,"content":"<p>å‰µå»ºè³‡æ–™åº«å¾Œï¼Œå¦‚æœè¦å¯«å…¥è³‡æ–™è«‹é€™éº¼åš:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> transaction <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"customers\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"readwrite\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Note: Older experimental implementations use the deprecated constant IDBTransaction.READ_WRITE instead of \"readwrite\".</span>\n<span class=\"token comment\">// In case you want to support such an implementation, you can just write:</span>\n<span class=\"token comment\">// var transaction = db.transaction([\"customers\"], IDBTransaction.READ_WRITE);</span>\n</code></pre></div>\n<p>å‘¼å«<a href=\"/zh-TW/docs/Web/API/IDBDatabase#transaction\">transaction()</a>æ–¹æ³•æœƒå›å‚³ä¸€å€‹äº¤æ˜“ç‰©ä»¶ã€‚transaction()ç¬¬ä¸€å€‹æ¥å—åƒæ•¸ä»£è¡¨äº¤æ˜“æ¶µè“‹çš„ç‰©ä»¶å­˜æª”ï¼Œé›–ç„¶å‚³å…¥ç©ºé™£åˆ—æœƒè®“äº¤æ˜“æ¶µè“‹æ‰€æœ‰ç‰©ä»¶å­˜æª”ï¼Œä½†è«‹ä¸è¦é€™éº¼åšï¼Œå› ç‚ºæ ¹æ“šæ­£å¼æ¨™æº–å‚³å…¥ç©ºé™£åˆ—æ‡‰è©²è¦å°è‡´ InvalidAccessError éŒ¯èª¤ï¼›ç¬¬äºŒå€‹åƒæ•¸ä»£è¡¨äº¤æ˜“ç¨®é¡ï¼Œä¸å‚³å…¥çš„è©±é è¨­ç‚ºè®€å–äº¤æ˜“ï¼Œæœ¬ä¾‹è¦å¯«å…¥è³‡æ–™åº«æ‰€ä»¥å‚³å…¥è®€å¯«(\"readwrite\")ã€‚</p>\n<p>äº¤æ˜“çš„ç”Ÿå‘½é€±æœŸå’Œäº‹ä»¶å¾ªç’°é—œä¿‚å¯†åˆ‡ã€‚ç•¶æˆ‘å€‘ç™¼èµ·äº¤æ˜“åˆå›åˆ°äº‹ä»¶å¾ªç’°ä¸­å¾Œï¼Œå¦‚æœå¿½ç•¥ï¼Œé‚£éº¼äº¤æ˜“å°‡è½‰æˆçµæŸï¼Œå”¯ä¸€ä¿æŒäº¤æ˜“å­˜æ´»çš„æ–¹æ³•æ˜¯åœ¨äº¤æ˜“ä¸Šç™¼å‡ºè«‹æ±‚ï¼›ç•¶è«‹æ±‚å®Œæˆå¾Œæˆ‘å€‘æœƒæ”¶åˆ° DOM äº‹ä»¶ï¼Œå‡è¨­è«‹æ±‚çµæœæˆåŠŸï¼Œæˆ‘å€‘å¯ä»¥åœ¨äº‹ä»¶çš„å›å‘¼å‡½æ•¸(callback ä¸­)ç¹¼çºŒé€²è¡Œäº¤æ˜“ï¼Œåä¹‹ï¼Œå¦‚æœæˆ‘å€‘æ²’æœ‰ç¹¼çºŒé€²è¡Œäº¤æ˜“ï¼Œé‚£éº¼äº¤æ˜“å°‡çµæŸï¼Œä¹Ÿå°±æ˜¯èªªåªè¦å°šæœ‰æœªå®Œæˆè«‹æ±‚çš„è©±ï¼Œäº¤æ˜“å°±æœƒç¹¼çºŒå­˜æ´»ï¼Œå¦‚æœæ”¶åˆ° TRANSACTION_INACTIVE_ERR éŒ¯èª¤é‚£ä¾¿æ„è¬‚è‘—äº¤æ˜“æ—©å·²çµæŸï¼Œæˆ‘å€‘éŒ¯éäº†ç¹¼çºŒé€²è¡Œäº¤æ˜“çš„æ©Ÿæœƒã€‚</p>\n<p>äº¤æ˜“èƒ½æ”¶åˆ°ä¸‰ç¨®äº‹ä»¶: éŒ¯èª¤(error)ã€ä¸­æ–·(abort)ä»¥åŠå®Œæˆ(complete)ï¼Œå…¶ä¸­éŒ¯èª¤äº‹ä»¶æœƒå‘ä¸Šå‚³éï¼Œæ‰€ä»¥ä»»ä½•ä¸€å€‹äº¤æ˜“ä¸‹è½„çš„è«‹æ±‚ç”¢ç”ŸéŒ¯èª¤äº‹ä»¶ï¼Œè©²äº¤æ˜“éƒ½æœƒæ”¶åˆ°ã€‚å¦‚æœäº¤æ˜“æ”¶åˆ°éŒ¯èª¤äº‹ä»¶æ™‚ï¼Œç€è¦½å™¨é è¨­è¡Œç‚ºæœƒä¸­æ–·äº¤æ˜“ï¼Œé™¤éæˆ‘å€‘æœ‰åœ¨éŒ¯èª¤äº‹ä»¶ä¸Šå‘¼å« preventDefault()é˜»æ“‹ç€è¦½å™¨é è¨­è¡Œå‹•ï¼Œå¦å‰‡æ•´ç­†äº¤æ˜“éƒ½å°‡å–æ¶ˆã€å¾©åŸï¼Œé€™æ¨£çš„è¨­è¨ˆå‘Šè¨´æˆ‘å€‘å¿…é ˆè¦æ€è€ƒå¦‚ä½•è™•è£¡éŒ¯èª¤ï¼Œæˆ–è€…èªªå¦‚æœå°æ¯ä¸€å€‹éŒ¯èª¤é€²è¡Œè™•è£¡éæ–¼éº»ç…©ï¼Œé‚£éº¼è‡³å°‘åŠ å…¥ä¸€å€‹æ¦‚æ‹¬æ€§çš„éŒ¯èª¤è™•ç†å™¨ä¹Ÿæ˜¯å¯ä»¥ã€‚åªè¦ä¸è™•è£¡éŒ¯èª¤æˆ–å‘¼å« abort()ï¼Œäº¤æ˜“å°‡å–æ¶ˆã€å¾©åŸï¼Œç„¶å¾Œä¸­æ–·äº‹ä»¶æ¥è‘—è§¸ç™¼ï¼Œåä¹‹ï¼Œç•¶æ‰€æœ‰è«‹æ±‚éƒ½å®Œæˆå¾Œï¼Œæˆ‘å€‘æœƒæ”¶åˆ°ä¸€å€‹å®Œæˆäº‹ä»¶ï¼Œæ‰€ä»¥èªªå¦‚æœæˆ‘å€‘åŒæ™‚ç™¼èµ·å¤šé …è«‹æ±‚æ™‚ï¼Œå¯ä»¥åªè¿½è¹¤å–®ä¸€äº¤æ˜“è€Œéå€‹åˆ¥è«‹æ±‚ï¼Œé€™æ¨£æœƒå¤§å¤§æ¸›è¼•æˆ‘å€‘çš„è² æ“”ã€‚</p>\n<p>æœ‰äº†äº¤æ˜“ä¹‹å¾Œä¾¿èƒ½å¤ å¾ä¸­å–å¾—ç‰©ä»¶å­˜æª”ï¼Œæœ‰äº†ç‰©ä»¶å­˜æª”ä¾¿èƒ½å¤ æ–°å¢è³‡æ–™(è«‹æ³¨æ„å”¯æœ‰åœ¨å»ºç«‹äº¤æ˜“æ™‚æŒ‡å®šçš„ç‰©ä»¶å­˜æª”èƒ½å¤ å–å¾—)ã€‚</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Do something when all the data is added to the database.</span>\ntransaction<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">oncomplete</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"All done!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\ntransaction<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Don't forget to handle errors!</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> objectStore <span class=\"token operator\">=</span> transaction<span class=\"token punctuation\">.</span><span class=\"token function\">objectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"customers\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token keyword\">in</span> customerData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>customerData<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  request<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// event.target.result == customerData[i].ssn;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>å‘¼å«<a href=\"/en-US/docs/Web/API/IDBObjectStore\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">add (en-US)</a>æ–¹æ³•å¯ä»¥åŠ å…¥ä¸€ç­†æ–°è³‡æ–™ï¼Œå‘¼å«å¾Œæœƒå›å‚³ä¸€å€‹<a href=\"/zh-TW/docs/Web/API/IDBRequest?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBRequest\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">IDBRequest</a>ç‰©ä»¶ï¼Œå³ç‚ºä¸Šæ–¹ç¯„ä¾‹ä¸­çš„ requestï¼Œå¦‚æœæ–°å¢æˆåŠŸï¼Œrequest çš„æˆåŠŸäº‹ä»¶æœƒè¢«è§¸ç™¼ï¼Œè€ŒæˆåŠŸäº‹ä»¶ç‰©ä»¶ä¸­æœ‰ä¸€å€‹ result å±¬æ€§ï¼Œé€™å€‹ result å€¼å‰›å¥½å°±ç­‰æ–¼æ–°è³‡æ–™çš„è³‡æ–™éµï¼Œæ‰€ä»¥èªªä¸Šæ–¹ç¯„ä¾‹ä¸­çš„ event.target.result å‰›å¥½å°±ç­‰æ–¼é¡§å®¢çš„ ssn å€¼(å› ç‚ºæˆ‘å€‘ç”¨ ssn å±¬æ€§ä½œç‚ºè³‡æ–™éµè·¯å¾‘)ã€‚è«‹æ³¨æ„ add æ–¹æ³•åªåœ¨ç•¶ç‰©ä»¶å­˜æª”ä¸­æ²’æœ‰ç›¸åŒè³‡æ–™éµè³‡æ–™å­˜åœ¨æ™‚æœ‰ç”¨ï¼Œå¦‚æœæƒ³è¦æ›´å‹•æˆ–æ˜¯ç›´æ¥è¦†è“‹ç¾å­˜è³‡æ–™è«‹å‘¼å«<a href=\"/en-US/docs/Web/API/IDBObjectStore\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">put (en-US)</a>æ–¹æ³•ã€‚</p>"}},{"type":"prose","value":{"id":"ç§»é™¤è³‡æ–™","title":"ç§»é™¤è³‡æ–™","isH3":false,"content":"<p>ç§»é™¤è³‡æ–™ååˆ†å®¹æ˜“:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"customers\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"readwrite\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">objectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"customers\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"444-44-4444\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nrequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// It's gone!</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"è®€å–è³‡æ–™","title":"è®€å–è³‡æ–™","isH3":false,"content":"<p>è¦åœ–å–è³‡æ–™åº«å…§çš„è³‡æ–™æœ‰æ•¸ç¨®é€”å¾‘ï¼Œç¬¬ä¸€å€‹æœ€ç°¡å–®çš„é€”å¾‘å°±æ˜¯æä¾›è³‡æ–™éµï¼Œå‘¼å«<a href=\"/en-US/docs/Web/API/IDBObjectStore\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">get (en-US)</a>æ–¹æ³•å–å¾—è³‡æ–™:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> transaction <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"customers\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> objectStore <span class=\"token operator\">=</span> transaction<span class=\"token punctuation\">.</span><span class=\"token function\">objectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"customers\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> request <span class=\"token operator\">=</span> objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"444-44-4444\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nrequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Handle errors!</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nrequest<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Do something with the request.result!</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Name for SSN 444-44-4444 is \"</span> <span class=\"token operator\">+</span> request<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>å‡è¨­æˆ‘å€‘æŠŠéŒ¯èª¤è™•ç†æ”¾åœ¨è³‡æ–™åº«å±¤ç´šï¼Œæˆ‘å€‘å¯ä»¥å†ç¸®çŸ­ä¸Šé¢çš„ç¨‹å¼ç¢¼å¦‚ä¸‹:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"customers\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">objectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"customers\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"444-44-4444\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Name for SSN 444-44-4444 is \"</span> <span class=\"token operator\">+</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>å‘¼å« transcation æ–¹æ³•è€Œä¸æŒ‡å®šæ¨¡å¼æœƒé–‹å•Ÿè®€å–(readonly)æ¨¡å¼ï¼Œæ¥è‘—å–å¾—æˆ‘å€‘çš„ç›®æ¨™ç‰©ä»¶å­˜æª”ï¼Œè¼¸å…¥ç›®æ¨™è³‡æ–™çš„è³‡æ–™éµï¼Œå‘¼å« get æ–¹æ³•å–å¾—è«‹æ±‚ç‰©ä»¶ï¼Œç„¶å¾Œåœ¨è«‹æ±‚ç‰©ä»¶ä¸Šè¨»å†ŠæˆåŠŸäº‹ä»¶è™•ç†å™¨ï¼Œç•¶ä½œæ¥­æˆåŠŸå¾Œï¼ŒæˆåŠŸäº‹ä»¶æœƒè§¸ç™¼ï¼ŒæˆåŠŸäº‹ä»¶çš„ç‰©ä»¶ä¸­å«æœ‰è«‹æ±‚ç‰©ä»¶(event.target å¦‚ä¸Šè¿°ç¯„ä¾‹)ï¼Œè«‹æ±‚ç‰©ä»¶ä¸­å«æœ‰è«‹æ±‚çµæœ(event.target.result å¦‚ä¸Šè¿°ç¯„ä¾‹)ã€‚</p>"}},{"type":"prose","value":{"id":"ä½¿ç”¨æŒ‡æ¨™cursor","title":"ä½¿ç”¨æŒ‡æ¨™(Cursor)","isH3":false,"content":"<p>ä½¿ç”¨ get æ–¹æ³•éœ€è¦çŸ¥é“è³‡æ–™éµï¼Œå¦‚æœæƒ³è¦ä¸€ä¸€å­˜å–ç‰©ä»¶å­˜æª”ä¸­çš„è³‡æ–™ï¼Œæˆ‘å€‘å¯ä»¥åˆ©ç”¨æŒ‡æ¨™:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> objectStore <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"customers\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">objectStore</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"customers\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nobjectStore<span class=\"token punctuation\">.</span><span class=\"token function\">openCursor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> cursor <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Name for SSN \"</span> <span class=\"token operator\">+</span> cursor<span class=\"token punctuation\">.</span>key <span class=\"token operator\">+</span> <span class=\"token string\">\" is \"</span> <span class=\"token operator\">+</span> cursor<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">continue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No more entries!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p><a href=\"/en-US/docs/Web/API/IDBObjectStore\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">openCursor (en-US)</a>æ–¹æ³•ç¬¬ä¸€å€‹åƒæ•¸ç”¨ä¾†æ¥å—è³‡æ–™éµç¯„åœç‰©ä»¶ä¾†é™åˆ¶å­˜å–è³‡æ–™ç¯„åœï¼Œç¬¬äºŒå€‹åƒæ•¸ç”¨ä¾†æŒ‡å®šå­˜å–é€²è¡Œæ–¹å‘ï¼Œåƒä¸Šé¢çš„ç¯„ä¾‹ç¨‹å¼ä¾¿æ˜¯ä»¥è³‡æ–™éµç”±å°åˆ°å¤§ä¹‹æ–¹å‘å­˜å–è³‡æ–™ï¼›å‘¼å« openCursor æ–¹æ³•å¾Œä¸€æ¨£æœƒå›å‚³ä¸€å€‹è«‹æ±‚ç‰©ä»¶ï¼ŒæˆåŠŸæ™‚æˆåŠŸäº‹ä»¶æœƒè§¸ç™¼ï¼Œä¸éé€™è£¡æœ‰äº›åœ°æ–¹è¦ç‰¹åˆ¥æ³¨æ„ï¼Œç•¶æˆåŠŸäº‹ä»¶è™•è£¡å‡½æ•¸è¢«å–šèµ·æ™‚ï¼ŒæŒ‡æ¨™ç‰©ä»¶(cursor)æœƒå­˜æ”¾åœ¨ result å±¬æ€§å…§(äº¦å³ä¸Šè¿° event.target.result)ï¼Œcursor ç‰©ä»¶ä¸‹æœ‰å…©å€‹å±¬æ€§ï¼Œkey å±¬æ€§æ˜¯è³‡æ–™éµï¼Œvalue å±¬æ€§æ˜¯è³‡æ–™å€¼ï¼Œå¦‚æœè¦å–å¾—ä¸‹ä¸€ä»½è³‡æ–™å°±å‘¼å« cursor çš„ continue()æ–¹æ³•ï¼Œç„¶å¾Œ cursor ç‰©ä»¶å°±æœƒæŒ‡å‘ä¸‹ä¸€ä»½è³‡æ–™ï¼Œç•¶æ²’æœ‰è³‡æ–™æ™‚ï¼Œcursor æœƒæ˜¯ undefinedï¼Œç•¶è«‹æ±‚ä¸€é–‹å§‹ä¾¿æ‰¾æ²’æœ‰è³‡æ–™ï¼Œresult å±¬æ€§ä¹Ÿæœƒæ˜¯ undefinedã€‚</p>\n<p>ä»¥ä¸‹ç”¨ cursor å­˜å–ä¸€éè³‡æ–™å¾Œæ”¾åœ¨é™£åˆ—ä¸­çš„ä½œæ³•ç›¸ç•¶å¸¸è¦‹:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> customers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\nobjectStore<span class=\"token punctuation\">.</span><span class=\"token function\">openCursor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> cursor <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    customers<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">continue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Got all customers: \"</span> <span class=\"token operator\">+</span> customers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<div class=\"notecard warning\" id=\"sect2\">\n  <p><strong>è­¦å‘Šï¼š</strong> ä»¥ä¸‹ç¯„ä¾‹ä¸æ˜¯ IndexedDB æ¨™æº–!</p>\n</div>\n<p>Mozilla ç€è¦½å™¨è‡ªå·±åšäº†ä¸€å€‹ getAll()æ–¹æ³•ä¾†æ–¹ä¾¿ä¸€æ¬¡å–å¾—æ‰€æœ‰ cursor ä¸‹çš„è³‡æ–™å€¼ï¼Œé€™å€‹æ–¹æ³•ç›¸ç•¶æ–¹ä¾¿ï¼Œä¸éè«‹å°å¿ƒæœªä¾†å®ƒæœ‰å¯èƒ½æœƒæ¶ˆå¤±ã€‚ä»¥ä¸‹ç¨‹å¼ç¢¼çš„æ•ˆæœå’Œä¸Šé¢çš„ä¸€æ¨£:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Got all customers: \"</span> <span class=\"token operator\">+</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>ä¸€ä¸€æª¢æŸ¥ cursor çš„ value å±¬æ€§è¼ƒä¸åˆ©æ€§èƒ½è¡¨ç¾ï¼Œå› ç‚ºç‰©ä»¶æ˜¯è¢«å‹•ä¸€ä¸€å»ºç«‹ï¼Œç„¶è€Œå‘¼å« getAll()ï¼ŒGecko ä¸€å®šè¦ä¸€æ¬¡å»ºç«‹æ‰€æœ‰ç‰©ä»¶ï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦ä¸€æ¬¡å–å¾—æ‰€æœ‰ç‰©ä»¶çš„è³‡æ–™å€¼é™£åˆ—ä½¿ç”¨ getAll()æ¯”è¼ƒå¥½ï¼Œå¦‚æœæƒ³è¦ä¸€ä¸€æª¢æŸ¥æ¯ç­†è³‡æ–™å‰‡è«‹åˆ©ç”¨ cursor çš„æ–¹æ³•ã€‚</p>"}},{"type":"prose","value":{"id":"ä½¿ç”¨ç´¢å¼•","title":"ä½¿ç”¨ç´¢å¼•","isH3":true,"content":"<p>åˆ©ç”¨ä¸€å®šå”¯ä¸€çš„ ssn ç¢¼ä½œç‚ºè³‡æ–™éµç›¸ç•¶åˆä¹é‚è¼¯(éš±ç§æ¬Šçš„å•é¡Œå…ˆæ“±ç½®ä¸€æ”¾ï¼Œä¸åœ¨æœ¬æ–‡æ¢è¨ç¯„åœ)ã€‚ä¸éç•¶æˆ‘å€‘æƒ³è¦æŸ¥è©¢ä½¿ç”¨è€…çš„åå­—çš„æ™‚å€™ï¼Œå¦‚æœæ²’æœ‰ç´¢å¼•å°±éœ€è¦ä¸€ä¸€æª¢æŸ¥æ¯ä¸€ç­†è³‡æ–™ï¼Œååˆ†æ²’æœ‰æ•ˆç‡ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥å»ºç«‹ name çš„ç´¢å¼•ã€‚</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> index <span class=\"token operator\">=</span> objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nindex<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Donna\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Donna's SSN is \"</span> <span class=\"token operator\">+</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span>ssn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>å› ç‚º name ä¸æ˜¯å”¯ä¸€å€¼ï¼Œæ‰€ä»¥å¯èƒ½æœƒæœ‰å¤šç­†è³‡æ–™ç¬¦åˆ\"Donna\"åå­—ï¼Œæ­¤æ™‚å‘¼å« get()æœƒå–å¾—è³‡æ–™éµæœ€å°å€¼çš„è³‡æ–™ã€‚</p>\n<p>å¦‚æœæˆ‘å€‘æƒ³è¦æŸ¥çœ‹ç‰¹å®šåå­—ä¸‹æ‰€æœ‰çš„è³‡æ–™ï¼Œå¯ä»¥åˆ©ç”¨ cursorã€‚æœ‰å…©ç¨® cursor èƒ½ç”¨åœ¨ç´¢å¼•ä¸Šï¼Œç¬¬ä¸€ç¨®ä¸€èˆ¬ cursor æœƒæ¯”å°ç´¢å¼•å€¼ä¸¦å›å‚³æ•´ä»½è³‡æ–™(ç‰©ä»¶å­˜æª”ä¸­çš„ç‰©ä»¶)ï¼Œç¬¬äºŒç¨®è³‡æ–™éµ cursor å‰‡åªæœƒå›å‚³è³‡æ–™éµå€¼ï¼Œè«‹åƒè€ƒä¸‹æ–¹ç¯„ä¾‹æ¯”è¼ƒå…©è€…å·®ç•°:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>index<span class=\"token punctuation\">.</span><span class=\"token function\">openCursor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> cursor <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// cursor.key is a name, like \"Bill\", and cursor.value is the whole object.</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Name: \"</span> <span class=\"token operator\">+</span> cursor<span class=\"token punctuation\">.</span>key <span class=\"token operator\">+</span> <span class=\"token string\">\", SSN: \"</span> <span class=\"token operator\">+</span> cursor<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span>ssn <span class=\"token operator\">+</span> <span class=\"token string\">\", email: \"</span> <span class=\"token operator\">+</span> cursor<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">continue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nindex<span class=\"token punctuation\">.</span><span class=\"token function\">openKeyCursor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> cursor <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// cursor.key is a name, like \"Bill\", and cursor.value is the SSN.</span>\n    <span class=\"token comment\">// No way to directly get the rest of the stored object.</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Name: \"</span> <span class=\"token operator\">+</span> cursor<span class=\"token punctuation\">.</span>key <span class=\"token operator\">+</span> <span class=\"token string\">\", SSN: \"</span> <span class=\"token operator\">+</span> cursor<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">continue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"è¨­å®šæŒ‡æ¨™æŸ¥è©¢ç¯„åœå’Œæ–¹å‘","title":"è¨­å®šæŒ‡æ¨™æŸ¥è©¢ç¯„åœå’Œæ–¹å‘","isH3":true,"content":"<p>å¦‚æœæƒ³è¦é™å®šæŒ‡æ¨™æŸ¥è©¢ç¯„åœï¼Œé‚£éº¼åœ¨ä¹å« openCursor()æˆ– openKeyCursor()æ™‚ç¬¬ä¸€å€‹åƒæ•¸è¦å‚³å…¥<a href=\"/zh-TW/IndexedDB/IDBKeyRange\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">IDBKeyRange</a>ç‰©ä»¶ä»¥é™åˆ¶ç¯„åœã€‚IDBKeyRange ç‰©ä»¶èƒ½å¤ åªèšç„¦åœ¨å–®ä¸€è³‡æ–™éµä¸Šæˆ–è€…ä¸€æ®µä¸Šä¸‹é™å€é–“ï¼›ä¸Šä¸‹é™å€é–“å¯ä»¥æ˜¯å°é–‰(å«ç•Œé™)æˆ–é–‹æ”¾(ä¸å«ç•Œé™)ï¼Œè«‹çœ‹ä»¥ä¸‹ç¯„ä¾‹:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Only match \"Donna\"</span>\n<span class=\"token keyword\">var</span> singleKeyRange <span class=\"token operator\">=</span> IDBKeyRange<span class=\"token punctuation\">.</span><span class=\"token function\">only</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Donna\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Match anything past \"Bill\", including \"Bill\"</span>\n<span class=\"token keyword\">var</span> lowerBoundKeyRange <span class=\"token operator\">=</span> IDBKeyRange<span class=\"token punctuation\">.</span><span class=\"token function\">lowerBound</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Bill\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Match anything past \"Bill\", but don't include \"Bill\"</span>\n<span class=\"token keyword\">var</span> lowerBoundOpenKeyRange <span class=\"token operator\">=</span> IDBKeyRange<span class=\"token punctuation\">.</span><span class=\"token function\">lowerBound</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Bill\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Match anything up to, but not including, \"Donna\"</span>\n<span class=\"token keyword\">var</span> upperBoundOpenKeyRange <span class=\"token operator\">=</span> IDBKeyRange<span class=\"token punctuation\">.</span><span class=\"token function\">upperBound</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Donna\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Match anything between \"Bill\" and \"Donna\", but not including \"Donna\"</span>\n<span class=\"token keyword\">var</span> boundKeyRange <span class=\"token operator\">=</span> IDBKeyRange<span class=\"token punctuation\">.</span><span class=\"token function\">bound</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Bill\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Donna\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nindex<span class=\"token punctuation\">.</span><span class=\"token function\">openCursor</span><span class=\"token punctuation\">(</span>boundKeyRange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> cursor <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Do something with the matches.</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">continue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>æœ‰æ™‚å€™æˆ‘å€‘æœƒæƒ³è¦ç”±å¤§åˆ°å°æŸ¥çœ‹è³‡æ–™è€Œéé è¨­ç”±å°åˆ°å¤§æ–¹å‘ï¼Œå‚³å…¥ç¬¬äºŒå€‹\"prev\"å­—ä¸²ä¾¿èƒ½åšåˆ°:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>objectStore<span class=\"token punctuation\">.</span><span class=\"token function\">openCursor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"prev\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> cursor <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Do something with the entries.</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">continue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>ç”±æ–¼\"name\"ç´¢å¼•ä¸å…·å”¯ä¸€æ€§ï¼Œæ‰€ä»¥ä¸€å€‹åå­—ä¸‹å¯èƒ½æœƒå‡ºç¾å¤šç­†è³‡æ–™ï¼Œæ­¤æ™‚å¦‚æœæƒ³è¦é¿é–‹é€™å¤šç­†è³‡æ–™ï¼Œè«‹å‚³å…¥\"nextunique\"æˆ–\"prevunique\"åšç‚ºç¬¬äºŒå€‹æ–¹å‘åƒæ•¸ï¼Œç•¶å‚³å…¥ä¹‹å¾Œï¼Œå¦‚ä¸€å€‹åå­—ä¸‹é‡åˆ°å¤šç­†è³‡æ–™ï¼Œå‰‡åªæœ‰è³‡æ–™éµæœ€å°çš„è³‡æ–™æœƒè¢«å›å‚³ã€‚</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>index<span class=\"token punctuation\">.</span><span class=\"token function\">openKeyCursor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"nextunique\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> cursor <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Do something with the entries.</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">continue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>é—œæ–¼å¯å‚³å…¥çš„æ–¹å‘åƒæ•¸ï¼Œè«‹åƒè€ƒ<a href=\"/zh-TW/docs/Web/API/IDBCursor?redirectlocale=en-US&amp;redirectslug=IndexedDB%2FIDBCursor#Constants\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">IDBCursor</a>å¸¸æ•¸ã€‚</p>"}},{"type":"prose","value":{"id":"ç•¶ç¶²é æ‡‰ç”¨ç¨‹å¼æ–¼ç€è¦½å™¨å¦ä¸€å€‹åˆ†é é–‹å•Ÿæ™‚è®Šæ›´ç‰ˆæœ¬","title":"ç•¶ç¶²é æ‡‰ç”¨ç¨‹å¼æ–¼ç€è¦½å™¨å¦ä¸€å€‹åˆ†é é–‹å•Ÿæ™‚è®Šæ›´ç‰ˆæœ¬","isH3":false,"content":"<p>è«‹æ€è€ƒä»¥ä¸‹ç‹€æ³: ä½¿ç”¨è€…åœ¨ç¬¬ä¸€å€‹ç€è¦½å™¨åˆ†é ä¸­ä½¿ç”¨è‘—èˆŠç‰ˆæœ¬ï¼Œç„¶å¾Œä½¿ç”¨è€…åˆæ‰“é–‹ç¬¬äºŒå€‹åˆ†é è¼‰å…¥ç¶²é ï¼Œæ­¤æ™‚æˆ‘å€‘åœ¨æ–°åˆ†é éœ€è¦å°è³‡æ–™åº«é€²è¡Œå‡ç´šï¼Œæ‰€ä»¥å‘¼å« open()ä»¥æ›´æ–°ç‰ˆæœ¬é–‹å•Ÿè³‡æ–™åº«ï¼Œä½†æ˜¯ç”±æ–¼ç¬¬ä¸€å€‹ç€è¦½å™¨åˆ†é ä¸¦æ²’æœ‰é—œé–‰è³‡æ–™åº«ï¼Œå› æ­¤ç¬¬äºŒå€‹åˆ†é çš„è³‡æ–™åº«å‡ç´šä½œæ¥­æœƒè¢«æ“‹ä½ã€‚æ‰€ä»¥æˆ‘å€‘éœ€è¦æ³¨æ„å¤šå€‹åˆ†é åŒæ™‚é–‹å•Ÿçš„ç‹€æ³ï¼Œæ¯å€‹åˆ†é éƒ½å¾—æ³¨æ„ç•¶ç™¼ç”Ÿè³‡æ–™åº«å‡ç´šäº‹ä»¶æ™‚ï¼Œè¦è¨˜å¾—é—œé–‰è³‡æ–™åº«ï¼Œè®“è³‡æ–™åº«å‡ç´šä½œæ¥­å¾—ä»¥é€²è¡Œã€‚å¯¦éš›ä½œæ³•å¦‚ä¸‹:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> openReq <span class=\"token operator\">=</span> mozIndexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyTestDatabase\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nopenReq<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onblocked</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// If some other tab is loaded with the database, then it needs to be closed</span>\n  <span class=\"token comment\">// before we can proceed.</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Please close all other tabs with this site open!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nopenReq<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onupgradeneeded</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// All other databases have been closed. Set everything up.</span>\n  db<span class=\"token punctuation\">.</span><span class=\"token function\">createObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* ... */</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useDatabase</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nopenReq<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> db <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useDatabase</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useDatabase</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">db</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Make sure to add a handler to be notified if another page requests a version</span>\n  <span class=\"token comment\">// change. We must close the database. This allows the other page to upgrade the database.</span>\n  <span class=\"token comment\">// If you don't do this then the upgrade won't happen until the user closes the tab.</span>\n  db<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onversionchange</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    db<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"A new version of this page is ready. Please reload!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Do stuff with the database.</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"å®‰å…¨æ€§","title":"å®‰å…¨æ€§","isH3":false,"content":"<p>\n  IndexedDB éµå®ˆ<a href=\"/zh-TW/docs/Web/Security/Same-origin_policy\">åŒæºæ”¿ç­–</a>ï¼Œæ‰€ä»¥å®ƒç¶å®šå‰µå»ºå®ƒçš„ä¾†æºç¶²ç«™ï¼Œå…¶ä»–ä¾†æºç¶²ç«™ç„¡æ³•å­˜å–ã€‚\n  å°±åƒå°è¼‰å…¥<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/HTML/Element/frame\"><code>&lt;frame&gt;</code> <small>(en-US)</small></a>å’Œ<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/HTML/Element/iframe\"><code>&lt;iframe&gt;</code> <small>(en-US)</small></a>ç¶²é çš„ç¬¬ä¸‰æ–¹ cookie æ‰€è¨­ä¸‹çš„å®‰å…¨æ€§å’Œéš±ç§æ¬Šè€ƒé‡é™åˆ¶ï¼ŒIndexedDB ç„¡æ³•åœ¨è¼‰å…¥<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/HTML/Element/frame\"><code>&lt;frame&gt;</code> <small>(en-US)</small></a>å’Œ<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/HTML/Element/iframe\"><code>&lt;iframe&gt;</code> <small>(en-US)</small></a>ç¶²é ä¸Šé‹ä½œï¼Œè©³æƒ…è«‹è¦‹<a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=595307\" class=\"external\" rel=\" noopener\">bug&nbsp;595307</a>ã€‚\n</p>"}},{"type":"prose","value":{"id":"ç€è¦½å™¨é—œé–‰é¢¨éšª","title":"ç€è¦½å™¨é—œé–‰é¢¨éšª","isH3":false,"content":"<p>ç•¶ç€è¦½å™¨é—œé–‰ï¼Œä¾‹å¦‚ä½¿ç”¨è€…æŒ‰ä¸‹é—œé–‰éˆ•ï¼Œä»»ä½•æœªå®Œæˆ IndexedDB äº¤æ˜“éƒ½å°‡é»˜é»˜ä¸­æ­¢ï¼Œé€™äº›äº¤æ˜“ä¸æœƒå®Œæˆï¼ŒéŒ¯èª¤äº‹ä»¶ä¹Ÿä¸æœƒè§¸ç™¼ã€‚æ—¢ç„¶ç€è¦½å™¨å¯èƒ½éš¨æ™‚è¢«é—œé–‰ï¼Œæˆ‘å€‘ç„¡æ³•å®Œå…¨æŒ‡æœ›ä»»ä½•ç‰¹å®šäº¤æ˜“ä¸€å®šæœƒå®Œæˆï¼Œæˆ–æ˜¯ä¾è³´éŒ¯èª¤äº‹ä»¶åšå‡ºç›¸æ‡‰è™•ç†ï¼Œé‡å°é€™ç¨®ç‹€æ³ï¼Œæˆ‘å€‘éœ€è¦æ³¨æ„:</p>\n<p>ç¬¬ä¸€ã€æ¯ä¸€ç­†äº¤æ˜“çµæŸå¾Œéƒ½æ‡‰è©²è¦ä¿æŒè³‡æ–™åº«å®Œæ•´æ€§ï¼Œä¾‹å¦‚èªªï¼Œæœ‰ä¸€ä¸²ä½¿ç”¨è€…ç·¨è¼¯é …ç›®æ¸…å–®æ­£è¦å­˜å…¥è³‡æ–™åº«ï¼Œæˆ‘å€‘å¦‚æœå…ˆåœ¨ä¸€å€‹äº¤æ˜“ä¸­æ¸…é™¤èˆŠæ¸…å–®ï¼Œç„¶å¾Œåœ¨å¦ä¸€å€‹äº¤æ˜“ä¸­å­˜å…¥æ–°æ¸…å–®ï¼Œé‚£å°±æœƒé¢è‡¨åˆ°æ¸…é™¤å®Œå°±æ¸…å–®å¾Œï¼Œæ–°æ¸…å–®å­˜å…¥äº¤æ˜“é‚„ä¾†ä¸åŠå›å­˜ï¼Œç€è¦½å™¨å°±é—œé–‰çš„é¢¨éšªï¼Œè€Œé€™å€‹æ™‚å€™è³‡æ–™åº«è£¡é¢çš„æ¸…å–®è³‡æ–™å°‡æ¶ˆå¤±ã€‚æ‰€ä»¥æ¯”è¼ƒå¥½çš„åšæ³•æ‡‰è©²æ˜¯åœ¨åŒä¸€ç­†äº¤æ˜“ä¸­å®Œæˆæ¸…é™¤èˆŠæ¸…å–®å’Œå­˜å…¥æ–°æ¸…å–®ã€‚</p>\n<p>ç¬¬äºŒã€æ°¸é ä¸è¦åœ¨ unload äº‹ä»¶ä¸­åŸ·è¡Œè³‡æ–™åº«äº¤æ˜“ï¼Œå› ç‚ºå¦‚æœ unload äº‹ä»¶æ˜¯è§¸ç™¼åœ¨ç€è¦½å™¨é—œé–‰ä¸‹ï¼Œä»»ä½•è³‡æ–™åº«äº¤æ˜“éƒ½ä¸æœƒç™¼ç”Ÿï¼Œæˆ–è¨±ï¼Œç€è¦½å™¨(æˆ–åˆ†é )æ‰“é–‹æ™‚è®€å–è³‡æ–™åº«ï¼Œæ›´æ–°è³‡æ–™åº«ç•¶ä½¿ç”¨è€…ç·¨è¼¯è³‡æ–™ï¼Œç•¶ç€è¦½å™¨(æˆ–åˆ†é )é—œé–‰æ™‚å„²å­˜è³‡æ–™é€™æ¨£çš„åšæ³•æ¯”è¼ƒç›´è¦ºï¼Œä¸éè³‡æ–™åº«çš„æ“ä½œæ˜¯éåŒæ­¥é€²è¡Œåœ°ï¼Œæ‰€ä»¥ç€è¦½å™¨é—œé–‰çš„åŸ·è¡Œæœƒåœ¨è³‡æ–™åº«æ“ä½œå‰ç™¼ç”Ÿï¼Œé€²è€Œä¸­æ–·å¾ŒçºŒéåŒæ­¥çš„è³‡æ–™åº«äº¤æ˜“ï¼Œæ‰€ä»¥åœ¨ unload äº‹ä»¶ä¸­åŸ·è¡Œè³‡æ–™åº«äº¤æ˜“æ˜¯è¡Œä¸é€šåœ°ã€‚</p>\n<p>äº‹å¯¦ä¸Šä¸è«–ç€è¦½å™¨æ˜¯å¦æ­£å¸¸é—œé–‰ï¼Œéƒ½æ²’æœ‰ä»»ä½•æ–¹æ³•ä¿è­‰ IndexedDB äº¤æ˜“èƒ½å¤ é †åˆ©å®Œæˆï¼Œè«‹è¦‹<a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=870645\" class=\"external\" rel=\" noopener\">bug&nbsp;870645</a>ã€‚</p>"}},{"type":"prose","value":{"id":"å®Œæ•´_indexeddb_ç¯„ä¾‹","title":"å®Œæ•´ IndexedDB ç¯„ä¾‹","isH3":false,"content":""}},{"type":"prose","value":{"id":"html","title":"HTML","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span>IndexedDB Demo: storing blobs, e-publication example<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>note<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n        Works and tested with:\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>compat<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>msg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>register-form<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tbody</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-title<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>required<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                Title:\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-title<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-title<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-biblioid<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>required<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                Bibliographic ID:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">/&gt;</span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>note<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>(ISBN, ISSN, etc.)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-biblioid<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-biblioid<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-year<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                Year:\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>number<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-year<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-year<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tbody</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tbody</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-file<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                File image:\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-file<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-file-url<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                Online-file image URL:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">/&gt;</span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>note<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>(same origin URL)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-file-url<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-file-url<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tbody</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">&gt;</span></span>\n\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button-pane<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>add-button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Add Publication<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>reset<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>register-form-reset<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>delete-form<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tbody</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-biblioid-to-delete<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                Bibliographic ID:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">/&gt;</span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>note<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>(ISBN, ISSN, etc.)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-biblioid-to-delete<span class=\"token punctuation\">\"</span></span>\n                     <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-biblioid-to-delete<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>key-to-delete<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                Key:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">/&gt;</span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>note<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>(for example 1, 2, 3, etc.)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>key-to-delete<span class=\"token punctuation\">\"</span></span>\n                     <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>key-to-delete<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tbody</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button-pane<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>delete-button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Delete Publication<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>clear-store-button<span class=\"token punctuation\">\"</span></span>\n               <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Clear the whole store<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>destructive<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>search-form<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button-pane<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>search-list-button<span class=\"token punctuation\">\"</span></span>\n               <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>List database content<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-msg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-viewer<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pub-list<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"css","title":"CSS","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: css notranslate\"><code><span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 0.8em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-family</span><span class=\"token punctuation\">:</span> Sans-Serif<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">form</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #cccccc<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 0.3em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline-block<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span> 0.5em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 1em<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">table</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">border-collapse</span><span class=\"token punctuation\">:</span> collapse<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">input</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 0.3em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-color</span><span class=\"token punctuation\">:</span> #cccccc<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 0.3em<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.required:after</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"*\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.button-pane</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">margin-top</span><span class=\"token punctuation\">:</span> 1em<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">#pub-viewer</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">float</span><span class=\"token punctuation\">:</span> right<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 48%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 20em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> solid #d092ff 0.1em<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">#pub-viewer iframe</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">#pub-list</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 46%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #eeeeee<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 0.3em<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">#pub-list li</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">padding-top</span><span class=\"token punctuation\">:</span> 0.5em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">padding-bottom</span><span class=\"token punctuation\">:</span> 0.5em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">padding-right</span><span class=\"token punctuation\">:</span> 0.5em<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">#msg</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span> 1em<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.action-success</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 0.5em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #00d21e<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #eeeeee<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 0.2em<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.action-failure</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 0.5em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #ff1408<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #eeeeee<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 0.2em<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.note</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> smaller<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.destructive</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> orange<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.destructive:hover</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #ff8000<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.destructive:active</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"javascript","title":"JavaScript","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> <span class=\"token constant\">COMPAT_ENVS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'Firefox'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"&gt;= 16.0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'Google Chrome'</span><span class=\"token punctuation\">,</span>\n     <span class=\"token string\">\"&gt;= 24.0 (you may need to get Google Chrome Canary), NO Blob storage support\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> compat <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#compat'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  compat<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  compat<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;ul id=\"compat-list\"&gt;&lt;/ul&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token constant\">COMPAT_ENVS</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">val<span class=\"token punctuation\">,</span> idx<span class=\"token punctuation\">,</span> array</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#compat-list'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;li&gt;'</span> <span class=\"token operator\">+</span> val<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">': '</span> <span class=\"token operator\">+</span> val<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;/li&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">DB_NAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">'mdn-demo-indexeddb-epublications'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">DB_VERSION</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Use a long long for this value (don't use a float)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">DB_STORE_NAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">'publications'</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> db<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Used to keep track of which view is displayed to avoid uselessly reloading it</span>\n  <span class=\"token keyword\">var</span> current_view_pub_key<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">openDb</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"openDb ...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> req <span class=\"token operator\">=</span> indexedDB<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DB_NAME</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">DB_VERSION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Better use \"this\" than \"req\" to get the result to avoid problems with</span>\n      <span class=\"token comment\">// garbage collection.</span>\n      <span class=\"token comment\">// db = req.result;</span>\n      db <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"openDb DONE\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"openDb:\"</span><span class=\"token punctuation\">,</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>errorCode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onupgradeneeded</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"openDb.onupgradeneeded\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">var</span> store <span class=\"token operator\">=</span> evt<span class=\"token punctuation\">.</span>currentTarget<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span><span class=\"token function\">createObjectStore</span><span class=\"token punctuation\">(</span>\n        <span class=\"token constant\">DB_STORE_NAME</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">keyPath</span><span class=\"token operator\">:</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">autoIncrement</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      store<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">'biblioid'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'biblioid'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">unique</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      store<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'title'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">unique</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      store<span class=\"token punctuation\">.</span><span class=\"token function\">createIndex</span><span class=\"token punctuation\">(</span><span class=\"token string\">'year'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'year'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">unique</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * @param {string} store_name\n   * @param {string} mode either \"readonly\" or \"readwrite\"\n   */</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">getObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">store_name<span class=\"token punctuation\">,</span> mode</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> tx <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span>store_name<span class=\"token punctuation\">,</span> mode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> tx<span class=\"token punctuation\">.</span><span class=\"token function\">objectStore</span><span class=\"token punctuation\">(</span>store_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">clearObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">store_name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> store <span class=\"token operator\">=</span> <span class=\"token function\">getObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DB_STORE_NAME</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'readwrite'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> req <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">displayActionSuccess</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Store cleared\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">displayPubList</span><span class=\"token punctuation\">(</span>store<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"clearObjectStore:\"</span><span class=\"token punctuation\">,</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>errorCode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">displayActionFailure</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">getBlob</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key<span class=\"token punctuation\">,</span> store<span class=\"token punctuation\">,</span> success_callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> req <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> value <span class=\"token operator\">=</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">success_callback</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">.</span>blob<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * @param {IDBObjectStore=} store\n   */</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">displayPubList</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">store</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"displayPubList\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> store <span class=\"token operator\">==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span>\n      store <span class=\"token operator\">=</span> <span class=\"token function\">getObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DB_STORE_NAME</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'readonly'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">var</span> pub_msg <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#pub-msg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pub_msg<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> pub_list <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#pub-list'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pub_list<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Resetting the iframe so that it doesn't display previous content</span>\n    <span class=\"token function\">newViewerFrame</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">var</span> req<span class=\"token punctuation\">;</span>\n    req <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Requests are executed in the order in which they were made against the</span>\n    <span class=\"token comment\">// transaction, and their results are returned in the same order.</span>\n    <span class=\"token comment\">// Thus the count text below will be displayed before the actual pub list</span>\n    <span class=\"token comment\">// (not that it is algorithmically important in this case).</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      pub_msg<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;p&gt;There are &lt;strong&gt;'</span> <span class=\"token operator\">+</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result <span class=\"token operator\">+</span>\n                     <span class=\"token string\">'&lt;/strong&gt; record(s) in the object store.&lt;/p&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"add error\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">displayActionFailure</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    req <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">openCursor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> cursor <span class=\"token operator\">=</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// If the cursor is pointing at something, ask for the data</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"displayPubList cursor:\"</span><span class=\"token punctuation\">,</span> cursor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        req <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">var</span> value <span class=\"token operator\">=</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">var</span> list_item <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;li&gt;'</span> <span class=\"token operator\">+</span>\n                            <span class=\"token string\">'['</span> <span class=\"token operator\">+</span> cursor<span class=\"token punctuation\">.</span>key <span class=\"token operator\">+</span> <span class=\"token string\">'] '</span> <span class=\"token operator\">+</span>\n                            <span class=\"token string\">'(biblioid: '</span> <span class=\"token operator\">+</span> value<span class=\"token punctuation\">.</span>biblioid <span class=\"token operator\">+</span> <span class=\"token string\">') '</span> <span class=\"token operator\">+</span>\n                            value<span class=\"token punctuation\">.</span>title <span class=\"token operator\">+</span>\n                            <span class=\"token string\">'&lt;/li&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">.</span>year <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n            list_item<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">' - '</span> <span class=\"token operator\">+</span> value<span class=\"token punctuation\">.</span>year<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">'blob'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span>\n              <span class=\"token keyword\">typeof</span> value<span class=\"token punctuation\">.</span>blob <span class=\"token operator\">!=</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">var</span> link <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;a href=\"'</span> <span class=\"token operator\">+</span> cursor<span class=\"token punctuation\">.</span>key <span class=\"token operator\">+</span> <span class=\"token string\">'\"&gt;File&lt;/a&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            link<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            link<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mouseenter'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                      <span class=\"token function\">setInViewer</span><span class=\"token punctuation\">(</span>evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'href'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            list_item<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">' / '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            list_item<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>link<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            list_item<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" / No attached file\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n          pub_list<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>list_item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Move on to the next object in store</span>\n        cursor<span class=\"token punctuation\">.</span><span class=\"token function\">continue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// This counter serves only to create distinct ids</span>\n        i<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No more entries\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">newViewerFrame</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> viewer <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#pub-viewer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    viewer<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> iframe <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;iframe /&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    viewer<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>iframe<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> iframe<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">setInViewer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"setInViewer:\"</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    key <span class=\"token operator\">=</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">==</span> current_view_pub_key<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\n    current_view_pub_key <span class=\"token operator\">=</span> key<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">var</span> store <span class=\"token operator\">=</span> <span class=\"token function\">getObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DB_STORE_NAME</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'readonly'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">getBlob</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> store<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">blob</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"setInViewer blob:\"</span><span class=\"token punctuation\">,</span> blob<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">var</span> iframe <span class=\"token operator\">=</span> <span class=\"token function\">newViewerFrame</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// It is not possible to set a direct link to the</span>\n      <span class=\"token comment\">// blob to provide a mean to directly download it.</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>blob<span class=\"token punctuation\">.</span>type <span class=\"token operator\">==</span> <span class=\"token string\">'text/html'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        reader<span class=\"token punctuation\">.</span>onload <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">var</span> html <span class=\"token operator\">=</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n          iframe<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">contents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">'html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        reader<span class=\"token punctuation\">.</span><span class=\"token function\">readAsText</span><span class=\"token punctuation\">(</span>blob<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>blob<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'image/'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        iframe<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">var</span> img_id <span class=\"token operator\">=</span> <span class=\"token string\">'image-'</span> <span class=\"token operator\">+</span> key<span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">var</span> img <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;img id=\"'</span> <span class=\"token operator\">+</span> img_id <span class=\"token operator\">+</span> <span class=\"token string\">'\"/&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">contents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">'body'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">var</span> obj_url <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">.</span><span class=\"token function\">createObjectURL</span><span class=\"token punctuation\">(</span>blob<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">contents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#'</span> <span class=\"token operator\">+</span> img_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src'</span><span class=\"token punctuation\">,</span> obj_url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          window<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">.</span><span class=\"token function\">revokeObjectURL</span><span class=\"token punctuation\">(</span>obj_url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>blob<span class=\"token punctuation\">.</span>type <span class=\"token operator\">==</span> <span class=\"token string\">'application/pdf'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">css</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cursor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'wait'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> obj_url <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">.</span><span class=\"token function\">createObjectURL</span><span class=\"token punctuation\">(</span>blob<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        iframe<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">css</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cursor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'auto'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        iframe<span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src'</span><span class=\"token punctuation\">,</span> obj_url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        window<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">.</span><span class=\"token function\">revokeObjectURL</span><span class=\"token punctuation\">(</span>obj_url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        iframe<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">contents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token string\">'body'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No view available\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * @param {string} biblioid\n   * @param {string} title\n   * @param {number} year\n   * @param {string} url the URL of the image to download and store in the local\n   *   IndexedDB database. The resource behind this URL is subjected to the\n   *   \"Same origin policy\", thus for this method to work, the URL must come from\n   *   the same origin as the web site/app this code is deployed on.\n   */</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">addPublicationFromUrl</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">biblioid<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> year<span class=\"token punctuation\">,</span> url</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"addPublicationFromUrl:\"</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">var</span> xhr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XMLHttpRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    xhr<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Setting the wanted responseType to \"blob\"</span>\n    <span class=\"token comment\">// http://www.w3.org/TR/XMLHttpRequest2/#the-response-attribute</span>\n    xhr<span class=\"token punctuation\">.</span>responseType <span class=\"token operator\">=</span> <span class=\"token string\">'blob'</span><span class=\"token punctuation\">;</span>\n    xhr<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                           <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>xhr<span class=\"token punctuation\">.</span>status <span class=\"token operator\">==</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                             console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Blob retrieved\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                             <span class=\"token keyword\">var</span> blob <span class=\"token operator\">=</span> xhr<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">;</span>\n                             console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Blob:\"</span><span class=\"token punctuation\">,</span> blob<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                             <span class=\"token function\">addPublication</span><span class=\"token punctuation\">(</span>biblioid<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> year<span class=\"token punctuation\">,</span> blob<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                           <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                             console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"addPublicationFromUrl error:\"</span><span class=\"token punctuation\">,</span>\n                                           xhr<span class=\"token punctuation\">.</span>responseText<span class=\"token punctuation\">,</span> xhr<span class=\"token punctuation\">.</span>status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                           <span class=\"token punctuation\">}</span>\n                         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    xhr<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// We can't use jQuery here because as of jQuery 1.8.3 the new \"blob\"</span>\n    <span class=\"token comment\">// responseType is not handled.</span>\n    <span class=\"token comment\">// http://bugs.jquery.com/ticket/11461</span>\n    <span class=\"token comment\">// http://bugs.jquery.com/ticket/7248</span>\n    <span class=\"token comment\">// $.ajax({</span>\n    <span class=\"token comment\">//   url: url,</span>\n    <span class=\"token comment\">//   type: 'GET',</span>\n    <span class=\"token comment\">//   xhrFields: { responseType: 'blob' },</span>\n    <span class=\"token comment\">//   success: function(data, textStatus, jqXHR) {</span>\n    <span class=\"token comment\">//     console.log(\"Blob retrieved\");</span>\n    <span class=\"token comment\">//     console.log(\"Blob:\", data);</span>\n    <span class=\"token comment\">//     // addPublication(biblioid, title, year, data);</span>\n    <span class=\"token comment\">//   },</span>\n    <span class=\"token comment\">//   error: function(jqXHR, textStatus, errorThrown) {</span>\n    <span class=\"token comment\">//     console.error(errorThrown);</span>\n    <span class=\"token comment\">//     displayActionFailure(\"Error during blob retrieval\");</span>\n    <span class=\"token comment\">//   }</span>\n    <span class=\"token comment\">// });</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * @param {string} biblioid\n   * @param {string} title\n   * @param {number} year\n   * @param {Blob=} blob\n   */</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">addPublication</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">biblioid<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> year<span class=\"token punctuation\">,</span> blob</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"addPublication arguments:\"</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">biblioid</span><span class=\"token operator\">:</span> biblioid<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> title<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">year</span><span class=\"token operator\">:</span> year <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> blob <span class=\"token operator\">!=</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span>\n      obj<span class=\"token punctuation\">.</span>blob <span class=\"token operator\">=</span> blob<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">var</span> store <span class=\"token operator\">=</span> <span class=\"token function\">getObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DB_STORE_NAME</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'readwrite'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> req<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      req <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>name <span class=\"token operator\">==</span> <span class=\"token string\">'DataCloneError'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">displayActionFailure</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"This engine doesn't know how to clone a Blob, \"</span> <span class=\"token operator\">+</span>\n                             <span class=\"token string\">\"use Firefox\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">throw</span> e<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Insertion in DB successful\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">displayActionSuccess</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">displayPubList</span><span class=\"token punctuation\">(</span>store<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"addPublication error\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">displayActionFailure</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * @param {string} biblioid\n   */</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">deletePublicationFromBib</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">biblioid</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"deletePublication:\"</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> store <span class=\"token operator\">=</span> <span class=\"token function\">getObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DB_STORE_NAME</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'readwrite'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> req <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token string\">'biblioid'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>biblioid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result <span class=\"token operator\">==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">displayActionFailure</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No matching record found\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">deletePublication</span><span class=\"token punctuation\">(</span>evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> store<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"deletePublicationFromBib:\"</span><span class=\"token punctuation\">,</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>errorCode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * @param {number} key\n   * @param {IDBObjectStore=} store\n   */</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">deletePublication</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key<span class=\"token punctuation\">,</span> store</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"deletePublication:\"</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> store <span class=\"token operator\">==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span>\n      store <span class=\"token operator\">=</span> <span class=\"token function\">getObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DB_STORE_NAME</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'readwrite'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// As per spec http://www.w3.org/TR/IndexedDB/#object-store-deletion-operation</span>\n    <span class=\"token comment\">// the result of the Object Store Deletion Operation algorithm is</span>\n    <span class=\"token comment\">// undefined, so it's not possible to know if some records were actually</span>\n    <span class=\"token comment\">// deleted by looking at the request result.</span>\n    <span class=\"token keyword\">var</span> req <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> record <span class=\"token operator\">=</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">;</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"record:\"</span><span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> record <span class=\"token operator\">==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">displayActionFailure</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No matching record found\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token comment\">// Warning: The exact same key used for creation needs to be passed for</span>\n      <span class=\"token comment\">// the deletion. If the key was a Number for creation, then it needs to</span>\n      <span class=\"token comment\">// be a Number for deletion.</span>\n      req <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onsuccess</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"evt:\"</span><span class=\"token punctuation\">,</span> evt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"evt.target:\"</span><span class=\"token punctuation\">,</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"evt.target.result:\"</span><span class=\"token punctuation\">,</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"delete successful\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">displayActionSuccess</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Deletion successful\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">displayPubList</span><span class=\"token punctuation\">(</span>store<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"deletePublication:\"</span><span class=\"token punctuation\">,</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>errorCode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    req<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onerror</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"deletePublication:\"</span><span class=\"token punctuation\">,</span> evt<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>errorCode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">displayActionSuccess</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">msg</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    msg <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> msg <span class=\"token operator\">!=</span> <span class=\"token string\">'undefined'</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"Success: \"</span> <span class=\"token operator\">+</span> msg <span class=\"token operator\">:</span> <span class=\"token string\">\"Success\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#msg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;span class=\"action-success\"&gt;'</span> <span class=\"token operator\">+</span> msg <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;/span&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">displayActionFailure</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">msg</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    msg <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> msg <span class=\"token operator\">!=</span> <span class=\"token string\">'undefined'</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"Failure: \"</span> <span class=\"token operator\">+</span> msg <span class=\"token operator\">:</span> <span class=\"token string\">\"Failure\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#msg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;span class=\"action-failure\"&gt;'</span> <span class=\"token operator\">+</span> msg <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;/span&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">resetActionStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"resetActionStatus ...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#msg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"resetActionStatus DONE\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">addEventListeners</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"addEventListeners\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#register-form-reset'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">resetActionStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#add-button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"add ...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">var</span> title <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#pub-title'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">var</span> biblioid <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#pub-biblioid'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>title <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>biblioid<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">displayActionFailure</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Required field(s) missing\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">var</span> year <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#pub-year'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>year <span class=\"token operator\">!=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Better use Number.isInteger if the engine has EcmaScript 6</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">displayActionFailure</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid year\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        year <span class=\"token operator\">=</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        year <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">var</span> file_input <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#pub-file'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">var</span> selected_file <span class=\"token operator\">=</span> file_input<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"selected_file:\"</span><span class=\"token punctuation\">,</span> selected_file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// Keeping a reference on how to reset the file input in the UI once we</span>\n      <span class=\"token comment\">// have its value, but instead of doing that we rather use a \"reset\" type</span>\n      <span class=\"token comment\">// input in the HTML form.</span>\n      <span class=\"token comment\">//file_input.val(null);</span>\n      <span class=\"token keyword\">var</span> file_url <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#pub-file-url'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>selected_file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">addPublication</span><span class=\"token punctuation\">(</span>biblioid<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> year<span class=\"token punctuation\">,</span> selected_file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>file_url<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">addPublicationFromUrl</span><span class=\"token punctuation\">(</span>biblioid<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> year<span class=\"token punctuation\">,</span> file_url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">addPublication</span><span class=\"token punctuation\">(</span>biblioid<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> year<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#delete-button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"delete ...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">var</span> biblioid <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#pub-biblioid-to-delete'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">var</span> key <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#key-to-delete'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>biblioid <span class=\"token operator\">!=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">deletePublicationFromBib</span><span class=\"token punctuation\">(</span>biblioid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">!=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Better use Number.isInteger if the engine has EcmaScript 6</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">==</span> <span class=\"token string\">''</span> <span class=\"token operator\">||</span> <span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">displayActionFailure</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid key\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        key <span class=\"token operator\">=</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">deletePublication</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#clear-store-button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">clearObjectStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">var</span> search_button <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#search-list-button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    search_button<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">evt</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">displayPubList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">openDb</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">addEventListeners</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Immediately-Invoked Function Expression (IIFE)</span>\n</code></pre></div><a href=\"https://yari-demos.prod.mdn.mozit.cloud/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB/_sample_.Full_IndexedDB_example.html\" class=\"external\" rel=\" noopener\">ç·šä¸Šç¯„ä¾‹</a>"}},{"type":"prose","value":{"id":"ä¸‹ä¸€æ­¥","title":"ä¸‹ä¸€æ­¥","isH3":false,"content":"<p>è«‹åƒè€ƒ<a href=\"/zh-TW/docs/Web/API/IndexedDB_API\">IndexedDB æ–‡ä»¶</a>ï¼Œçœ‹çœ‹æœ‰ç”šéº¼ IndexedDB API å¯ä¾›ä½¿ç”¨ï¼Œå¯¦éš›è©¦ç©ä¸€ä¸‹å§ã€‚</p>"}},{"type":"prose","value":{"id":"å»¶ä¼¸é–±è®€","title":"å»¶ä¼¸é–±è®€","isH3":false,"content":"<p>åƒç…§</p>\n<ul>\n  <li><a href=\"/zh-TW/IndexedDB\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">IndexedDB API Reference</a></li>\n  <li><a href=\"https://www.w3.org/TR/IndexedDB/\" class=\"external\" rel=\" noopener\">Indexed Database API Specification</a></li>\n  <li><a href=\"/zh-TW/docs/IndexedDB/Using_IndexedDB_in_chrome\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Using IndexedDB in chrome</a></li>\n</ul>\n<p>ç›¸é—œæ•™å­¸</p>\n<ul>\n  <li><a href=\"https://www.html5rocks.com/tutorials/indexeddb/todo/\" class=\"external\" rel=\" noopener\">A simple TODO list using HTML5 IndexedDB</a>.\n    <div class=\"notecard note\" id=\"sect3\">\n      <p><strong>å‚™è¨»ï¼š</strong> è«‹æ³¨æ„æ­¤æ•™å­¸ç¯„ä¾‹ç”¨åˆ°çš„å·²ç¶“å»¢æ£„çš„<code>setVersion()</code>æ–¹æ³•ã€‚</p>\n    </div>\n  </li>\n  <li><a href=\"https://www.html5rocks.com/en/tutorials/indexeddb/uidatabinding/\" class=\"external\" rel=\" noopener\">Databinding UI Elements with IndexedDB</a></li>\n</ul>\n<p>ç›¸é—œæ–‡ç« </p>\n<ul>\n  <li><a href=\"http://msdn.microsoft.com/en-us/scriptjunkie/gg679063.aspx\" class=\"external\" rel=\" noopener\">IndexedDB â€” The Store in Your Browser</a></li>\n</ul>\n<p>Firefox</p>\n<ul>\n  <li>Mozilla <a href=\"https://mxr.mozilla.org/mozilla-central/find?text=&amp;string=dom%2FindexedDB%2F.*%5C.idl&amp;regexp=1\" class=\"external\" rel=\" noopener\">interface files</a></li>\n</ul>"}}],"toc":[{"text":"é—œæ–¼æœ¬æ–‡","id":"é—œæ–¼æœ¬æ–‡"},{"text":"åŸºæœ¬æ“ä½œæ­¥é©Ÿ","id":"åŸºæœ¬æ“ä½œæ­¥é©Ÿ"},{"text":"å»ºç«‹å’Œçµæ§‹è³‡æ–™åº«","id":"å»ºç«‹å’Œçµæ§‹è³‡æ–™åº«"},{"text":"æ–°å¢å’Œåˆªé™¤è³‡æ–™","id":"æ–°å¢å’Œåˆªé™¤è³‡æ–™"},{"text":"ç§»é™¤è³‡æ–™","id":"ç§»é™¤è³‡æ–™"},{"text":"è®€å–è³‡æ–™","id":"è®€å–è³‡æ–™"},{"text":"ä½¿ç”¨æŒ‡æ¨™(Cursor)","id":"ä½¿ç”¨æŒ‡æ¨™cursor"},{"text":"ç•¶ç¶²é æ‡‰ç”¨ç¨‹å¼æ–¼ç€è¦½å™¨å¦ä¸€å€‹åˆ†é é–‹å•Ÿæ™‚è®Šæ›´ç‰ˆæœ¬","id":"ç•¶ç¶²é æ‡‰ç”¨ç¨‹å¼æ–¼ç€è¦½å™¨å¦ä¸€å€‹åˆ†é é–‹å•Ÿæ™‚è®Šæ›´ç‰ˆæœ¬"},{"text":"å®‰å…¨æ€§","id":"å®‰å…¨æ€§"},{"text":"ç€è¦½å™¨é—œé–‰é¢¨éšª","id":"ç€è¦½å™¨é—œé–‰é¢¨éšª"},{"text":"å®Œæ•´ IndexedDB ç¯„ä¾‹","id":"å®Œæ•´_indexeddb_ç¯„ä¾‹"},{"text":"ä¸‹ä¸€æ­¥","id":"ä¸‹ä¸€æ­¥"},{"text":"å»¶ä¼¸é–±è®€","id":"å»¶ä¼¸é–±è®€"}],"summary":"IndexedDB æä¾›äº†åœ¨ç€è¦½å™¨ä¸Šå„²å­˜ä¿ç•™è³‡æ–™çš„åŠŸèƒ½ï¼Œè—‰ç”±å®ƒï¼Œä¸è«–æ˜¯ç·šä¸Šæˆ–ç·šä¸‹æˆ‘å€‘çš„æ‡‰ç”¨éƒ½å¯ä»¥é€²è¡Œè³‡æ–™å­˜å–ã€‚","popularity":0.0002,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Using IndexedDB","locale":"en-US","native":"English (US)"},{"title":"Usando IndexedDB","locale":"es","native":"EspaÃ±ol"},{"title":"Utiliser IndexedDB","locale":"fr","native":"FranÃ§ais"},{"title":"IndexedDB ã®ä½¿ç”¨","locale":"ja","native":"æ—¥æœ¬èª"},{"title":"IndexedDB ì‚¬ìš©í•˜ê¸°","locale":"ko","native":"í•œêµ­ì–´"},{"title":"Usando IndexedDB","locale":"pt-BR","native":"PortuguÃªs (doÂ Brasil)"},{"title":"Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ IndexedDB","locale":"ru","native":"Ğ ÑƒÑÑĞºĞ¸Ğ¹"},{"title":"ä½¿ç”¨ IndexedDB","locale":"zh-CN","native":"ä¸­æ–‡ (ç®€ä½“)"}],"source":{"folder":"zh-tw/web/api/indexeddb_api/using_indexeddb","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-tw/web/api/indexeddb_api/using_indexeddb/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-TW/docs/Web","title":"çµ¦é–‹ç™¼è€…çš„ç¶²é æŠ€è¡“æ–‡ä»¶"},{"uri":"/zh-TW/docs/Web/API","title":"Web APIs"},{"uri":"/zh-TW/docs/Web/API/IndexedDB_API","title":"IndexedDB"},{"uri":"/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB","title":"ä½¿ç”¨IndexedDB"}],"pageTitle":"ä½¿ç”¨IndexedDB - Web APIs | MDN","noIndexing":false}}</script></body></html>