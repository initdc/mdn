{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"地理位置定位 (Geolocation)","mdn_url":"/zh-TW/docs/Web/API/Geolocation_API","locale":"zh-TW","native":"正體中文 (繁體)","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>Web Apps 若需要使用者的位置，可透過 <strong>Geolocation API</strong> 取得相關資訊。而基於隱私權的考量，這些 Web Apps 均必須取得使用者的許可之後，才能發佈位置資訊。</p>"}},{"type":"prose","value":{"id":"地理位置定位_geolocation_物件","title":"地理位置定位 (Geolocation) 物件","isH3":false,"content":"<p>Geolocation API，是透過 <a href=\"/en-US/docs/Web/API/Navigator/geolocation\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">navigator.geolocation (en-US)</a> <code>物件</code>所發佈。</p>\n<p>若該物件可用，即可進行地理位置定位服務。因此可先測試地理位置定位是否存在：</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"geolocation\"</span> <span class=\"token keyword\">in</span> navigator<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* geolocation is available */</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* geolocation IS NOT available */</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>備註：</strong> 在 Firefox 24 之後的版本，即使停用此 API，<code>navigator</code> 中的「<code>geolocation</code>」也同樣回傳 <code>true</code>。此問題已根據規格而於` <a href=\"/zh-TW/docs/Mozilla/Firefox/Releases/25/Site_Compatibility\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Firefox 25</a> 中修正 (<a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=884921\" class=\"external\" rel=\" noopener\">bug 884921</a>)。</p>\n</div>"}},{"type":"prose","value":{"id":"取得目前位置","title":"取得目前位置","isH3":true,"content":"<p>\n  若要取得使用者目前的位置，可呼叫 <code>getCurrentPosition()</code> 函式。如此將啟動非同步化的請求，以偵測使用者的位置，並將查詢定位硬體而取得最新資訊。一旦決定位置，隨即執行特定的回呼常式 (Callback routine)。若發生錯誤，則可選擇是否提供第二次回呼。第三項參數為選項介面 (亦可選擇是否使用之)，可設定位置回傳的的最長時間，與請求的等待時間。\n  若不論定位精確度而想儘快固定單一位置，則可使用 <code>getCurrentPosition()</code>。以具備 GPS 的裝置為例，往往需耗時 1 分鐘或更長的時間而固定 GPS 資訊。也因此，<code>getCurrentPosition()</code> 可能取得較低精確度的資料 (IP 位置或 WiFi) 而隨即開始作業。\n</p>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>備註：</strong> 依預設值，<a href=\"/en-US/docs/Web/API/Geolocation/getCurrentPosition\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">getCurrentPosition() (en-US)</a> 將儘快回傳較低精確度的結果。若不論精確度而只要儘快獲得答案，則可使用 <a href=\"/en-US/docs/Web/API/Geolocation/getCurrentPosition\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">getCurrentPosition() (en-US)</a>。舉例來說，搭載 GPS 的裝置可能需要一段時間才能取得 GPS 定位資訊，所以可能將低精確度的資料 (IP 位置或 Wifi) 回傳至 <a href=\"/en-US/docs/Web/API/Geolocation/getCurrentPosition\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">getCurrentPosition() (en-US)</a>。</p>\n</div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>navigator<span class=\"token punctuation\">.</span>geolocation<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentPosition</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">position</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">do_something</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">.</span>coords<span class=\"token punctuation\">.</span>latitude<span class=\"token punctuation\">,</span> position<span class=\"token punctuation\">.</span>coords<span class=\"token punctuation\">.</span>longitude<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>一旦取得定位位置之後，上列範例隨即將執行 <code>do_something()</code> 函式。</p>"}},{"type":"prose","value":{"id":"觀看目前位置","title":"觀看目前位置","isH3":true,"content":"<p>如果定位資料改變 (可能是裝置移動，或取得更精確的地理位置資訊)，則可設定 1 組回呼函式，使其隨著更新過的定位資訊而呼叫之。而這個動作可透過 <code>watchPosition() 函式</code>完成。<a href=\"/en-US/docs/Web/API/Geolocation/watchPosition\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">watchPosition() (en-US)</a> 所具備的輸入參數與 <code>getCurrentPosition()</code>相同。回呼函式將呼叫數次，讓瀏覽器可於使用者移動期間更新位置，或可根據目前所使用的不同定位技術，提供更精確的定位資訊。若一直未回傳有效結果，則錯誤回呼 (Error Callback) 函式僅將呼叫 1 次。另請注意，錯誤回呼函式僅限於 <code>getCurrentPosition()，因此為選填</code>。</p>\n<div class=\"notecard note\" id=\"sect3\">\n  <p><strong>備註：</strong> 不需啟動 <a href=\"/en-US/docs/Web/API/Geolocation/getCurrentPosition\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">getCurrentPosition() (en-US)</a> 呼叫，亦可使用 <a href=\"/en-US/docs/Web/API/Geolocation/watchPosition\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">watchPosition() (en-US)</a>。</p>\n</div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> watchID <span class=\"token operator\">=</span> navigator<span class=\"token punctuation\">.</span>geolocation<span class=\"token punctuation\">.</span><span class=\"token function\">watchPosition</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">position</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">do_something</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">.</span>coords<span class=\"token punctuation\">.</span>latitude<span class=\"token punctuation\">,</span> position<span class=\"token punctuation\">.</span>coords<span class=\"token punctuation\">.</span>longitude<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p><code>watchPosition()</code> 函式將回傳 1 組 ID 編號，專用以識別必要的定位監看員 (Watcher)。而此數值若搭配 <code>clearWatch()</code> 函式，即可停止觀看使用者的位置。</p>\n<div class=\"code-example\"><pre class=\"brush: plain notranslate\">navigator.geolocation.clearWatch(watchID);\n</pre></div>"}},{"type":"prose","value":{"id":"微調回應","title":"微調回應","isH3":true,"content":"<p><a href=\"/en-US/docs/Web/API/Geolocation/getCurrentPosition\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">getCurrentPosition() (en-US)</a> 與 <a href=\"/en-US/docs/Web/API/Geolocation/watchPosition\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">watchPosition() (en-US)</a> 均可容納 1 組成功回呼、1 組錯誤回呼 (選填)、1 組 <code>PositionOptions</code> 物件 (選填)。</p>\n<p>對 <a href=\"/en-US/docs/Web/API/Geolocation/watchPosition\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">watchPosition (en-US)</a> 的呼叫應類似如下：</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">geo_success</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">position</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">do_something</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">.</span>coords<span class=\"token punctuation\">.</span>latitude<span class=\"token punctuation\">,</span> position<span class=\"token punctuation\">.</span>coords<span class=\"token punctuation\">.</span>longitude<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">geo_error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Sorry, no position available.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> geo_options <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">enableHighAccuracy</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">maximumAge</span>        <span class=\"token operator\">:</span> <span class=\"token number\">30000</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">timeout</span>           <span class=\"token operator\">:</span> <span class=\"token number\">27000</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> wpid <span class=\"token operator\">=</span> navigator<span class=\"token punctuation\">.</span>geolocation<span class=\"token punctuation\">.</span><span class=\"token function\">watchPosition</span><span class=\"token punctuation\">(</span>geo_success<span class=\"token punctuation\">,</span> geo_error<span class=\"token punctuation\">,</span> geo_options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>現成的 watchPosition Demo：<a href=\"http://www.thedotproduct.org/experiments/geo/\" class=\"external\" rel=\" noopener\">http://www.thedotproduct.org/experiments/geo/</a></p>"}},{"type":"prose","value":{"id":"敘述位置","title":"敘述位置","isH3":false,"content":"<p>以 <code>Position</code> 物件參照 <code>Coordinates</code> 物件，即可敘述使用者的位置。</p>"}},{"type":"prose","value":{"id":"處理錯誤","title":"處理錯誤","isH3":false,"content":"<p>在呼叫 <code>getCurrentPosition()</code> 或 <code>watchPosition() 時，</code>若獲得錯誤回呼函式，則<code>錯誤回呼函式的第一組參數將為 PositionError 物件：</code></p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">errorCallback</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ERROR('</span> <span class=\"token operator\">+</span> error<span class=\"token punctuation\">.</span>code <span class=\"token operator\">+</span> <span class=\"token string\">'): '</span> <span class=\"token operator\">+</span> error<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"地理位置定位實際範例","title":"地理位置定位實際範例","isH3":false,"content":""}},{"type":"prose","value":{"id":"html_內容","title":"HTML 內容","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">geoFindMe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span>Show my location<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>out<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"javascript_內容","title":"JavaScript 內容","isH3":true,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">geoFindMe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> output <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"out\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>navigator<span class=\"token punctuation\">.</span>geolocation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    output<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">\"&lt;p&gt;Geolocation is not supported by your browser&lt;/p&gt;\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">success</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">position</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> latitude  <span class=\"token operator\">=</span> position<span class=\"token punctuation\">.</span>coords<span class=\"token punctuation\">.</span>latitude<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> longitude <span class=\"token operator\">=</span> position<span class=\"token punctuation\">.</span>coords<span class=\"token punctuation\">.</span>longitude<span class=\"token punctuation\">;</span>\n\n    output<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;p&gt;Latitude is '</span> <span class=\"token operator\">+</span> latitude <span class=\"token operator\">+</span> <span class=\"token string\">'° &lt;br&gt;Longitude is '</span> <span class=\"token operator\">+</span> longitude <span class=\"token operator\">+</span> <span class=\"token string\">'°&lt;/p&gt;'</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">var</span> img <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Image</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    img<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span> <span class=\"token string\">\"http://maps.googleapis.com/maps/api/staticmap?center=\"</span> <span class=\"token operator\">+</span> latitude <span class=\"token operator\">+</span> <span class=\"token string\">\",\"</span> <span class=\"token operator\">+</span> longitude <span class=\"token operator\">+</span> <span class=\"token string\">\"&amp;zoom=13&amp;size=300x300&amp;sensor=false\"</span><span class=\"token punctuation\">;</span>\n\n    output<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    output<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">\"Unable to retrieve your location\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  output<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">\"&lt;p&gt;Locating…&lt;/p&gt;\"</span><span class=\"token punctuation\">;</span>\n\n  navigator<span class=\"token punctuation\">.</span>geolocation<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentPosition</span><span class=\"token punctuation\">(</span>success<span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"現場測試結果","title":"現場測試結果","isH3":true,"content":"<p>若無法顯示，可至本文右上角「Language」切換回英文原文觀看。</p><iframe class=\"sample-code-frame\" title=\"地理位置定位實際範例 sample\" id=\"frame_地理位置定位實際範例\" width=\"350\" height=\"150\" src=\"https://yari-demos.prod.mdn.mozit.cloud/zh-TW/docs/Web/API/Geolocation_API/_sample_.%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE%E5%AE%9A%E4%BD%8D%E5%AF%A6%E9%9A%9B%E7%AF%84%E4%BE%8B.html\" loading=\"lazy\"></iframe>"}},{"type":"prose","value":{"id":"請求權限","title":"請求權限","isH3":false,"content":"<p>addons.mozilla.org 上所提供的任何附加元件，只要使用地理位置定位資料，均必須明確取得許可才能繼續作業。下列函式詢問許可的方法，則類似網頁詢問許可的自動提示方法，但更為簡單。若為可套用的狀態，則使用者的回應將儲存於 <code>pref</code> 參數所指定的偏好中。於 <code>callback</code> 參數中所提供的函式，將透過 1 組代表使用者反應的布林值而呼叫之。若使用者的回應為 <code>true</code>，則附加元件才會存取地理位置定位資料。</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">prompt</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">window<span class=\"token punctuation\">,</span> pref<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> branch <span class=\"token operator\">=</span> Components<span class=\"token punctuation\">.</span>classes<span class=\"token punctuation\">[</span><span class=\"token string\">\"@mozilla.org/preferences-service;1\"</span><span class=\"token punctuation\">]</span>\n                           <span class=\"token punctuation\">.</span><span class=\"token function\">getService</span><span class=\"token punctuation\">(</span>Components<span class=\"token punctuation\">.</span>interfaces<span class=\"token punctuation\">.</span>nsIPrefBranch<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>branch<span class=\"token punctuation\">.</span><span class=\"token function\">getPrefType</span><span class=\"token punctuation\">(</span>pref<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> branch<span class=\"token punctuation\">.</span><span class=\"token constant\">PREF_STRING</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>branch<span class=\"token punctuation\">.</span><span class=\"token function\">getCharPref</span><span class=\"token punctuation\">(</span>pref<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">case</span> <span class=\"token string\">\"always\"</span><span class=\"token operator\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">case</span> <span class=\"token string\">\"never\"</span><span class=\"token operator\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">let</span> done <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">remember</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value<span class=\"token punctuation\">,</span> result</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            done <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            branch<span class=\"token punctuation\">.</span><span class=\"token function\">setCharPref</span><span class=\"token punctuation\">(</span>pref<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">let</span> self <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>PopupNotifications<span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span>\n        window<span class=\"token punctuation\">.</span>gBrowser<span class=\"token punctuation\">.</span>selectedBrowser<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"geolocation\"</span><span class=\"token punctuation\">,</span>\n        message<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"geo-notification-icon\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">label</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Share Location\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">accessKey</span><span class=\"token operator\">:</span> <span class=\"token string\">\"S\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token function-variable function\">callback</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">notification</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                done <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token literal-property property\">label</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Always Share\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">accessKey</span><span class=\"token operator\">:</span> <span class=\"token string\">\"A\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">callback</span><span class=\"token operator\">:</span> <span class=\"token function\">remember</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"always\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token literal-property property\">label</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Never Share\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">accessKey</span><span class=\"token operator\">:</span> <span class=\"token string\">\"N\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">callback</span><span class=\"token operator\">:</span> <span class=\"token function\">remember</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"never\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function-variable function\">eventCallback</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event <span class=\"token operator\">===</span> <span class=\"token string\">\"dismissed\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>done<span class=\"token punctuation\">)</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    done <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n                    window<span class=\"token punctuation\">.</span>PopupNotifications<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">persistWhileVisible</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">prompt</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">,</span>\n       <span class=\"token string\">\"extensions.foo-addon.allowGeolocation\"</span><span class=\"token punctuation\">,</span>\n       <span class=\"token string\">\"Foo Add-on wants to know your location.\"</span><span class=\"token punctuation\">,</span>\n       <span class=\"token keyword\">function</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">allowed</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>allowed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"規範","id":"規範","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/geolocation-api/#geolocation_interface","title":"Geolocation API"}],"query":"api.Geolocation"}},{"type":"browser_compatibility","value":{"title":"瀏覽器相容性","id":"瀏覽器相容性","isH3":false,"query":"api.Geolocation","dataURL":"/zh-TW/docs/Web/API/Geolocation_API/bcd.json"}},{"type":"prose","value":{"id":"gecko_註記","title":"Gecko 註記","isH3":false,"content":"<p>Firefox 可透過 Google 的定位服務 (Google Location Services，GLS)，根據使用者的 WiFi 資訊而找出使用者的位置。與 Google 之間所交換的資料，包含 WiFi 存取點 (Access Point) 資料、Access token (類似 2 個禮拜的 cookie)、使用者的 IP 位址。若需更多資訊，可參閱 <a href=\"http://www.mozilla.com/en-US/legal/privacy/\" class=\"external\" rel=\" noopener\">Mozilla 的隱私權政策</a>與 <a href=\"https://www.google.com/privacy-lsf.html\" class=\"external\" rel=\" noopener\">Google 的隱私權政策</a>。其內將詳述資料的使用方式。</p>\n<p>Firefox 3.6 (Gecko 1.9.2) 新支援了 <a href=\"http://catb.org/gpsd/\" class=\"external\" rel=\" noopener\">GPSD</a> (GPS daemon) 服務，適合 Linux 的地理位置定位。</p>"}},{"type":"prose","value":{"id":"另請參閱","title":"另請參閱","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/API/Navigator/geolocation\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">navigator.geolocation (en-US)</a></li>\n  <li><a href=\"https://www.w3.org/TR/geolocation-API/\" class=\"external\" rel=\" noopener\">w3.org 的 Geolocation API</a></li>\n  <li><a href=\"/zh-TW/docs/Web/Demos\">Geolocation API 相關 Demos</a></li>\n</ul>"}}],"toc":[{"text":"地理位置定位 (Geolocation) 物件","id":"地理位置定位_geolocation_物件"},{"text":"敘述位置","id":"敘述位置"},{"text":"處理錯誤","id":"處理錯誤"},{"text":"地理位置定位實際範例","id":"地理位置定位實際範例"},{"text":"請求權限","id":"請求權限"},{"text":"規範","id":"規範"},{"text":"瀏覽器相容性","id":"瀏覽器相容性"},{"text":"Gecko 註記","id":"gecko_註記"},{"text":"另請參閱","id":"另請參閱"}],"summary":"Web Apps 若需要使用者的位置，可透過 Geolocation API 取得相關資訊。而基於隱私權的考量，這些 Web Apps 均必須取得使用者的許可之後，才能發佈位置資訊。","popularity":0.0005,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Geolocation API","locale":"en-US","native":"English (US)"},{"title":"API de geolocalización","locale":"es","native":"Español"},{"title":"API Geolocation (géolocalisation)","locale":"fr","native":"Français"},{"title":"位置情報 API","locale":"ja","native":"日本語"},{"title":"Geolocation API","locale":"ko","native":"한국어"},{"title":"Usando geolocation","locale":"pt-BR","native":"Português (do Brasil)"},{"title":"Использование геолокации","locale":"ru","native":"Русский"},{"title":"地理位置 API","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"zh-tw/web/api/geolocation_api","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-tw/web/api/geolocation_api/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-TW/docs/Web","title":"給開發者的網頁技術文件"},{"uri":"/zh-TW/docs/Web/API","title":"Web APIs"},{"uri":"/zh-TW/docs/Web/API/Geolocation_API","title":"地理位置定位 (Geolocation)"}],"pageTitle":"地理位置定位 (Geolocation) - Web APIs | MDN","noIndexing":false}}