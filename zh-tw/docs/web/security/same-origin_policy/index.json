{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"同源政策 (Same-origin policy)","mdn_url":"/zh-TW/docs/Web/Security/Same-origin_policy","locale":"zh-TW","native":"正體中文 (繁體)","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>同源政策限制了程式碼和不同網域資源間的互動。</p>"}},{"type":"prose","value":{"id":"同源定義","title":"同源定義","isH3":false,"content":"<p>所謂同源是指兩份網頁具備相同協定、埠號 (如果有指定) 以及主機位置，下表提供了一些例子展示那些來源和 <code>http://store.company.com/dir/page.html</code> 屬於同源:</p>\n<table>\n  <thead>\n    <tr>\n      <th>URL</th>\n      <th>Outcome</th>\n      <th>Reason</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>http://store.company.com/dir2/other.html</code></td>\n      <td>同源</td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><code>http://store.company.com/dir/inner/another.html</code></td>\n      <td>同源</td>\n      <td></td>\n    </tr>\n    <tr>\n      <td><code>https://store.company.com/secure.html</code></td>\n      <td>不同源</td>\n      <td>協定不同</td>\n    </tr>\n    <tr>\n      <td><code>http://store.company.com:81/dir/etc.html</code></td>\n      <td>不同源</td>\n      <td>埠號不同</td>\n    </tr>\n    <tr>\n      <td><code>http://news.company.com/dir/other.html</code></td>\n      <td>不同源</td>\n      <td>主機位置不同</td>\n    </tr>\n  </tbody>\n</table>\n<p>另外請參考 <a href=\"/zh-TW/docs/Same-origin_policy_for_file:_URIs\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">file 來源定義: URL</a>。</p>\n<p>Cookie 的來源定義和上述不一樣。</p>"}},{"type":"prose","value":{"id":"變更來源","title":"變更來源","isH3":false,"content":"<p>網頁能夠有限地變更來源，我們可以將 <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Document/domain\"><code>document.domain</code> <small>(en-US)</small></a> 存為目前網域後半部，然後較短的網域就會作為之後來源檢查，譬如我們在 <code>http://store.company.com/dir/other.html</code> 的文件裡執行以下程式碼:</p>\n<div class=\"code-example\"><pre class=\"brush: plain notranslate\">document.domain = \"company.com\";\n</pre></div>\n<p>執行完後，網頁能以 <code>http://company.com/dir/page.html</code> 通過同源檢查。然而基於同源檢查，company.com 無法將 document.domain 存為 othercompany.com。</p>\n<p>任何變更 document.domain 行為，包括 document.domain = document.domain 都會導致埠號重置為 null，因此無法只藉由執行 document.domain = \"company.com\" 讓 company.com:8080 和 company.com 互動，必須兩邊都重新設定好讓埠號都一致重置為 null。</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>備註：</strong> 為了讓子網域可以安全的存取其母網域，我們需要一起改變子、母網域的 document.domain 為相同值，即使只是將母網域設回原始值也是必要，否則將會導致許可權錯誤 (Permission Error)。</p>\n</div>"}},{"type":"prose","value":{"id":"跨來源網路存取","title":"跨來源網路存取","isH3":false,"content":"<p>同源政策控制了兩個不同網域來源互動，例如當使用<a href=\"/zh-TW/docs/Web/API/XMLHttpRequest\"><code>XMLHttpRequest</code></a>。這些互動可分為以下三類:</p>\n<ul>\n  <li>跨來源寫(Cross-origin writes)通常被允許，例如有連結、重新導向以及表單送出。少數某些 HTTP 請求需要<a href=\"/zh-TW/docs/Web/HTTP/CORS#.e5.85.88.e5.b0.8e.e8.ab.8b.e6.b1.82\">先導請求</a>。</li>\n  <li>跨來源嵌入(Cross-origin embedding)通常被允許，例子請參照下方。</li>\n  <li>跨來源讀取(Cross-origin read) 通常不被允許，不過通常可以藉由嵌入來繞道讀取，例如嵌入影像寬高讀取、嵌入程式碼或<a href=\"https://grepular.com/Abusing_HTTP_Status_Codes_to_Expose_Private_Information\" class=\"external\" rel=\" noopener\">嵌入資源</a>。</li>\n</ul>\n<p>下面是一些能跨來源嵌入的資源:</p>\n<ul>\n  <li>&lt;script src=”…”&gt;&lt;/script&gt;內的 Javascript，但語法錯誤訊息只限於同源程式碼腳本。</li>\n  <li>CSS 的&lt;link rel=\"stylesheet\" href=\"...\"&gt;，由於 CSS 寬鬆語法規則，跨來源 CSS 要求正確的 Content-Type 標頭。限制在瀏覽器間各有差異: <a href=\"http://msdn.microsoft.com/en-us/library/ie/gg622939%28v=vs.85%29.aspx\" class=\"external\" rel=\" noopener\">IE</a>, <a href=\"https://www.mozilla.org/security/announce/2010/mfsa2010-46.html\" class=\"external\" rel=\" noopener\">Firefox</a>, <a href=\"https://code.google.com/p/chromium/issues/detail?id=9877\" class=\"external\" rel=\" noopener\">Chrome</a>, <a href=\"https://support.apple.com/kb/HT4070\" class=\"external\" rel=\" noopener\">Safari</a> (請至 CVE-2010-0051)以及<a href=\"https://www.opera.com/support/kb/view/943/\" class=\"external\" rel=\" noopener\">Opera</a>.</li>\n  <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/HTML/Element/img\"><code>&lt;img&gt;</code> <small>(en-US)</small></a>的影像；支援格式有 PNG, JPEG, GIF, BMP, SVG 等等</li>\n  <li><a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/HTML/Element/video\"><code>&lt;video&gt;</code> <small>(en-US)</small></a>和<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/HTML/Element/audio\"><code>&lt;audio&gt;</code> <small>(en-US)</small></a>媒體檔案</li>\n  <li><a href=\"/en-US/docs/Web/HTML/Element/object\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">&lt;object&gt; (en-US)</a>, <a href=\"/en-US/docs/Web/HTML/Element/embed\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">&lt;embed&gt; (en-US)</a>和<a href=\"/en-US/docs/Web/HTML/Element/applet\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">&lt;applet&gt; (en-US)</a>的外掛</li>\n  <li><a href=\"/zh-TW/docs/Web/CSS/@font-face\"><code>@font-face</code></a> 的字型；有些瀏覽器允許跨來源字型，有些則不。</li>\n  <li><a href=\"/en-US/docs/Web/HTML/Element/frame\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">&lt;frame&gt; (en-US)</a>以及<a href=\"/en-US/docs/Web/HTML/Element/iframe\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">&lt;iframe&gt; (en-US)</a>中的內容；如果一個網站想要避免跨來源載入互動，可以藉由<a href=\"/zh-TW/docs/Web/HTTP/Headers/X-Frame-Options\"><code>X-Frame-Options</code></a>標頭避免。</li>\n</ul>"}},{"type":"prose","value":{"id":"如何允許跨來源存取","title":"如何允許跨來源存取","isH3":true,"content":"<p>使用<a href=\"/zh-TW/docs/Web/HTTP/CORS\">CORS</a>允許跨來源存取</p>"}},{"type":"prose","value":{"id":"如何阻擋跨來源存取","title":"如何阻擋跨來源存取","isH3":true,"content":"<ul>\n  <li>藉由檢查請求中包含的無法猜測的特殊記號(token)可以避免跨來源寫入，還有跨來源讀取知道此記號的網頁，這個記號即為<a href=\"https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29\" class=\"external\" rel=\" noopener\">跨站偽造(Cross-Site Request Forgery, CSRF)</a>記號。</li>\n  <li>確保資源無法被嵌入來防止跨來源讀取。</li>\n  <li>為了防止跨來源嵌入，請確保資源不被解讀為上述可嵌入格式之一；瀏覽器通常不會理會 Content-Type，比如說有一個指向 HTML 文件的&lt;script&gt;標籤，瀏覽器還是會嘗試解析該 HTML 文件為 Javascript；當你的資源不是網站進入點，可以使用 CSRF 記號。</li>\n</ul>"}},{"type":"prose","value":{"id":"跨來源程式腳本存取","title":"跨來源程式腳本存取","isH3":false,"content":"<p>Javascript API 例如<a href=\"/en-US/docs/Web/API/HTMLIFrameElement\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">iframe.contentWindow (en-US)</a>, <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Window/parent\"><code>window.parent</code> <small>(en-US)</small></a>, <a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Window/open\"><code>window.open</code> <small>(en-US)</small></a>以及<a href=\"/zh-TW/docs/Web/API/Window/opener\"><code>window.opener</code></a>，允許文件之間直接互相參照，當兩份文件的來源不同，參照存取<a href=\"https://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html#security-window\" class=\"external\" rel=\" noopener\">Window</a>和<a href=\"https://www.whatwg.org/specs/web-apps/current-work/multipage/history.html#security-location\" class=\"external\" rel=\" noopener\">Location</a>物件將受到限制；一些瀏覽器比規範<a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=839867\" class=\"external\" rel=\" noopener\">准許存取更多屬性</a>。文件間的溝通也可以改用<a class=\"only-in-en-us\" title=\"Currently only available in English (US)\" href=\"/en-US/docs/Web/API/Window/postMessage\"><code>window.postMessage</code> <small>(en-US)</small></a>來進行。</p>"}},{"type":"prose","value":{"id":"延伸閱讀","title":"延伸閱讀","isH3":false,"content":"<ul>\n  <li><a href=\"/zh-TW/docs/Same-origin_policy_for_file:_URIs\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Same-origin policy for file: URIs</a></li>\n  <li><a href=\"https://www.w3.org/Security/wiki/Same_Origin_Policy\" class=\"external\" rel=\" noopener\">Same-Origin Policy at W3C</a></li>\n</ul>"}}],"toc":[{"text":"同源定義","id":"同源定義"},{"text":"變更來源","id":"變更來源"},{"text":"跨來源網路存取","id":"跨來源網路存取"},{"text":"跨來源程式腳本存取","id":"跨來源程式腳本存取"},{"text":"延伸閱讀","id":"延伸閱讀"}],"summary":"同源政策限制了程式碼和不同網域資源間的互動。","popularity":0.0004,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Same-origin policy","locale":"en-US","native":"English (US)"},{"title":"Política Same-origin","locale":"es","native":"Español"},{"title":"Same-origin policy","locale":"fr","native":"Français"},{"title":"同一オリジンポリシー","locale":"ja","native":"日本語"},{"title":"동일 출처 정책","locale":"ko","native":"한국어"},{"title":"Same-origin policy","locale":"ru","native":"Русский"},{"title":"浏览器的同源策略","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"zh-tw/web/security/same-origin_policy","github_url":"https://github.com/mdn/translated-content/blob/main/files/zh-tw/web/security/same-origin_policy/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/zh-TW/docs/Web","title":"給開發者的網頁技術文件"},{"uri":"/zh-TW/docs/Web/Security","title":"Web 安全"},{"uri":"/zh-TW/docs/Web/Security/Same-origin_policy","title":"同源政策 (Same-origin policy)"}],"pageTitle":"同源政策 (Same-origin policy) - Web 安全 | MDN","noIndexing":false}}