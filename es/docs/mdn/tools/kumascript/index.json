{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Introducción a KumaScript","mdn_url":"/es/docs/MDN/Tools/KumaScript","locale":"es","native":"Español","sidebarHTML":"\n  <ol>\n    <li><a href=\"/es/docs/MDN/About\">Acerca de MDN</a></li>\n    <li class=\"toggle\">\n        <details>\n            <summary>Ayudar a la MDN</summary>\n            <ol>\n                <li><a href=\"/es/docs/MDN/Contribute/Getting_started\">Primeros pasos en MDN</a></li>\n                <li><a href=\"/es/docs/MDN/Contribute\">Ayudar a la MDN</a></li>\n                <li><a href=\"/es/docs/MDN/Contribute/Howto\">Cosas que puedes hacer</a></li>\n                <li><a href=\"/es/docs/MDN/Contribute/Localize\">Adaptar/traducir MDN</a></li>\n                <li><a href=\"/es/docs/MDN/Guidelines\">Guías de preferencias</a></li>\n                <li><a href=\"/es/docs/MDN/Structures\">Estructura del contenido</a></li>\n             </ol>\n        </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":"vistazo_general","title":"Vistazo general","isH3":false,"content":"<p>En el verano de 2012, MDN cambió a una nueva plataforma wiki llamada <a href=\"https://wiki.mozilla.org/MDN/Kuma\" class=\"external\" rel=\" noopener\">Kuma</a>. Esta reemplaza el lenguaje de plantilla <a href=\"http://developer.mindtouch.com/en/docs/DekiScript\" class=\"external\" rel=\" noopener\">DekiScript</a> con un nuevo sistema llamado <a href=\"https://github.com/mozilla/kumascript\" class=\"external\" rel=\" noopener\">KumaScript</a>. KumaScript se alimenta de JavaScript del lado del servidor, usando <a href=\"https://nodejs.org/\" class=\"external\" rel=\" noopener\">Node.js</a>. Este artículo provee informaciónde cómo usar KumaScript y cómo actualizar scripts migrados parcialmente desde MindTouch.</p>\n<p>Para detalles y preguntas frecuentes sobre KumaScript, mira el <a href=\"https://vreplay.mozilla.com/replay/showRecordDetails.html?sortBy=date&amp;viewCount=1&amp;currentPage=1&amp;groupBy=combo&amp;roomFilter=&amp;usernameFilter=&amp;searchFilter=&amp;usernameFullFilter=&amp;myManager=-1&amp;adminManager=0&amp;webCast=0&amp;command=&amp;recId=1082&amp;auxMessage=&amp;auxMessage1=&amp;lang=en&amp;langChanged=&amp;tenantFilter=&amp;securityTab=\" class=\"external\" rel=\" noopener\">KumaScript Fireside Chat</a> del equipo de desarrolladores MDN.</p>\n<p>¿Qué es KumaScript?</p>\n<ul>\n  <li>Una forma de reutilizar y localizar contenido que aparece repetidamente entre los documentos (por ejemplo, rótulos de compatibilidad, navegación de secciones, carteles de advertencia).</li>\n  <li>Una manera de construir documentos sacados de otros documentos.</li>\n  <li>Una manera de buscar e incluir contenido de otros sitios web y servicios (por ejemplo, Bugzilla).</li>\n</ul>"}},{"type":"prose","value":{"id":"¿qué_no_es_kumascript","title":"¿Qué no es KumaScript?","isH3":true,"content":"<ul>\n  <li>KumaScript no soporta scripts interactivos del tipo que pueden aceptar las incripciones por formulario.</li>\n  <li>KumaScript no tiene acceso a bases de datos, archivos, ni a cualquier otra forma de guardar información persistentemente.</li>\n  <li>KumaScript no soporta la personalización basada en el usuario que tiene la sesión abierta.</li>\n  <li>KumaScript no tiene acceso a información de usuario, sólo al contenido y a los metadatos de una wiki que se esté visualizando.</li>\n</ul>"}},{"type":"prose","value":{"id":"aspectos_básicos","title":"Aspectos básicos","isH3":false,"content":"<p>KumaScript funciona permitiendo a <em>wiki de confianza</em> escribir <a href=\"https://github.com/visionmedia/ejs\" class=\"external\" rel=\" noopener\">plantillas JavaScript ensambladas</a>. Estas plantillas pueden ser invocadas en el contenido del documento por cualquier editor <em>wiki</em> mediante el uso de <a href=\"/es/docs/KumaTests/hello_test?raw=1\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">macros</a>.</p>\n<p>Una <a href=\"/es/docs/Template:hello\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">plantilla</a> se vé así:</p>\n<div class=\"code-example\"><pre class=\"brush: ejs notranslate\">&lt;% for (var i = 0; i &lt; $0; i++) { %&gt;\nHello #&lt;%= i %&gt;\n&lt;% } %&gt;\n</pre></div>\n<p>Una <a href=\"/es/docs/KumaTests/hello_test?raw=1\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">macro</a> se vé así:</p>\n<p><code>{{ hello(\"3\") }}</code></p>\n<p>El <a href=\"/es/docs/KumaTests/hello_test\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">resultado de una macro</a> sale así:</p>\n<pre class=\"notranslate\">Hello #0\nHello #1\nHello #2\n</pre>"}},{"type":"prose","value":{"id":"sintaxis_de_una_macro","title":"Sintaxis de una macro","isH3":true,"content":"<p>Las plantillas KumaScript se invocan en el contenido del documento con macros, como esta:</p>\n<pre class=\"notranslate\">{{ templateName(\"arg0\", \"arg1\", ..., \"argN\") }}\n</pre>\n<p>La sintaxis de una Macro se compone de estas reglas:</p>\n<ul>\n  <li>Las Macros comienzan y terminan con los caracteres <code>{{</code> y <code>}}</code>.</li>\n  <li>La primera parte de la macro es el nombre de la plantilla. Esta corresponde a una wiki en <code>/en-US/docs/Template:{name}</code>. Editar y crear estas páginas requiere un permiso especial que los administradores pueden otorgar a editores de confianza.</li>\n  <li>Una plantilla puede aceptar parámetros, y esta lista de parámetroa comienza y termina con paréntesis.</li>\n  <li>En una plantilla, los parámetros ingresados están disponibles dentro de la macro como las variables <code>$0</code>, <code>$1</code>, <code>$2</code>, y así sucesivamente.</li>\n  <li>Todos los parámetros no numéricos deber ir entre comillas. Los números pueden quedar sin ellas.</li>\n  <li>La lista completa de parámetros también está disponible en una plantilla como la variable <code>arguments</code>.</li>\n</ul>\n<h4 id=\"usando_json_parámetro_de_macro\">Usando JSON parámetro de macro</h4>\n<p>Hay una característica semi-experimental disponible para las macros. Puedes proveerlas de un objeto JSON como primero y único parámetro, así:</p>\n<pre class=\"notranslate\">{{ templateName({ \"Alpha\":\"one\", \"Beta\":[\"a\",\"b\",\"c\"], \"Foo\":\"http:\\/\\/mozilla.org\\/\" }) }}\n</pre>\n<p>Los datos de esta macro estarán disponibles en un código de plantilla como un objeto en el argumento <code>$0</code> (por ejemplo, <code>$0.Alpha</code>, <code>$0.Beta</code>, <code>$0.Foo</code>). Esto también te permite expresar estructuras de datos complejos en los parámetros de macro que son difíciles o imposibles de hacer con una simple lista de parámetros.</p>\n<p>Nota que el estilo de este parámetro es muy complejo. Se debe adherir exactamente a la <a href=\"http://json.org/\" class=\"external\" rel=\" noopener\">sintaxis JSON</a>, que tiene algunas exigencias escurridizas que son fáciles de pasar por alto (por ejemplo, todas las barras (/) llevan escapes). Cuando haya dudas, <a href=\"http://jsonlint.com/\" class=\"external\" rel=\" noopener\">intenta ejecutar tu JSON con un validador</a>.</p>\n<h4 id=\"cómo_escribir_\">Cómo escribir \"{{\"</h4>\n<p>Como la secuencia de caracteres \"<code>{{</code>\" se usa para indicar el comienzo de una macro, puede ser un problema si justo quieres usar \"<code>{{</code>\" and \"<code>}}</code>\" como texto de una página. Probablemente dará un mensaje de error <code>DocumentParsingError</code>.</p>\n<p>En este caso, puedes escapar la primer llave con una barra invertida, así: <code>\\{{</code></p>"}},{"type":"prose","value":{"id":"sintaxis_de_la_plantilla","title":"Sintaxis de la plantilla","isH3":true,"content":"<p>Las plantillas KumaScript son procesadas por un <a href=\"https://github.com/visionmedia/ejs\" class=\"external\" rel=\" noopener\">motor de plantillas JavaScript ensamblado</a> con estas simples reglas:</p>\n<ul>\n  <li>La mayoría del texto es tratado como salida e incluido en el flujo de salida.</li>\n  <li>Las expresiones y variables JavaScript pueden insertarse en el flujo de salida con estos bloques:\n    <ul>\n      <li><code>&lt;%= expr %&gt;</code> — el valor de la expresión JavaScript es escapado por el HTML antes de incluirse en la salida (por ejemplo, caracteres como <code>&lt;</code> y <code>&gt;</code> se convierten en <code>&amp;lt;</code> y <code>&amp;gt;</code>).</li>\n      <li><code>&lt;%- expr %&gt;</code> — el valor de una expresión JavaScript es incluído en la salida pero sin escape. (usa esto si quieres construir etiquetas HTML o usar los resultados de otra plantilla que puedan incluir etiquetas HTML.)</li>\n      <li>Es un error incluir punto y coma dentro de los bloques.</li>\n    </ul>\n  </li>\n  <li>Cualquier cosa dentro de un bloque <code>&lt;% %&gt;</code> se interpreta como JavaScript. Esto puede incluir bucles, condiciones, etc.</li>\n  <li>No hay nada dentro de un bloque <code>&lt;% %&gt;</code> que pueda contribuir al flujo de salida. Pero puedes hacer la transición desde el modo JS al modo de salida usando <code>&lt;% %&gt;</code> — Por ejemplo:\n    <div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> $0<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\nHello #<span class=\"token operator\">&lt;</span><span class=\"token operator\">%=</span> i <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n</code></pre></div>Nota como el JS está contenido entre <code>&lt;% ... %&gt;</code>, y la salida va en el espacio entre <code>%&gt; ... &lt;%</code>. El bucle <em>for</em> en JS puede comenzar en un bloque <code>&lt;% %&gt;</code> , luego el flujo de salida, y terminar en un segundo bloque JS <code>&lt;% %&gt;</code>.\n  </li>\n  <li>For more details on EJS syntax, <a href=\"https://github.com/visionmedia/ejs\" class=\"external\" rel=\" noopener\">check out the upstream module documentation</a>.</li>\n</ul>"}},{"type":"prose","value":{"id":"características_avanzadas","title":"Características avanzadas","isH3":false,"content":"<p>Más allá de los aspectos básicos, el sistema KumaScript ofrece algunas características avanzadas.</p>"}},{"type":"prose","value":{"id":"variables_de_entorno","title":"Variables de entorno","isH3":true,"content":"<p>Cuando la wiki hace una llamada al servicio KumaScript, <a href=\"https://github.com/mozilla/kuma/blob/master/apps/wiki/kumascript.py#L130\" class=\"external\" rel=\" noopener\">pasa por una part del contexto del documento actual</a> que KumaScript pone a disposición de las plantillas como variables:</p>\n<ul>\n  <li><code>env.path</code>\n    <ul>\n      <li>: La ruta del documento wiki actual</li>\n    </ul>\n  </li>\n  <li><code>env.url</code>\n    <ul>\n      <li>: La URL completa del documento wiki actual</li>\n    </ul>\n  </li>\n  <li><code>env.id</code>\n    <ul>\n      <li>: Un ID único corto para el documento wiki actual</li>\n    </ul>\n  </li>\n  <li><code>env.files</code>\n    <ul>\n      <li>debajo</li>\n    </ul>\n  </li>\n  <li><code>env.review_tags</code>\n    <ul>\n      <li>: Un arreglo con las etiquetas de revisión del artículo (\"technical\", \"editorial\", etc.)</li>\n    </ul>\n  </li>\n  <li><code>env.locale</code>\n    <ul>\n      <li>: El sitio del documento wiki actual</li>\n    </ul>\n  </li>\n  <li><code>env.title</code>\n    <ul>\n      <li>: El título del documento wiki actual</li>\n    </ul>\n  </li>\n  <li><code>env.slug</code>\n    <ul>\n      <li>: Una URL amigable del documento wiki actual</li>\n    </ul>\n  </li>\n  <li><code>env.tags</code>\n    <ul>\n      <li>: Una lista de nombers de etiquetas para el documento wiki actual</li>\n    </ul>\n  </li>\n  <li><code>env.modified</code>\n    <ul>\n      <li>: El último timestamp modificado para el documento wiki actual</li>\n    </ul>\n  </li>\n  <li><code>env.cache_control</code>\n    <ul>\n      <li>: <code>El encabezado Cache-Control</code> henviado en la solicitud para el documento wiki actual, útil para decidir si invalidar los caches</li>\n    </ul>\n  </li>\n</ul>\n<h4 id=\"objetos_de_archivos\">Objetos de archivos</h4>\n<p>Cada objeto de archivo tiene los siguientes campos:</p>\n<dl>\n  <dt id=\"title\"><code>title</code></dt>\n  <dd>\n    <p>El título del archivo adjunto</p>\n  </dd>\n  <dt id=\"description\"><code>description</code></dt>\n  <dd>\n    <p>Una descripción textual de la revisión actual del archivo</p>\n  </dd>\n  <dt id=\"filename\"><code>filename</code></dt>\n  <dd>\n    <p>El nombre del archivo</p>\n  </dd>\n  <dt id=\"size\"><code>size</code></dt>\n  <dd>\n    <p>El tamaños del archivo en bytes</p>\n  </dd>\n  <dt id=\"author\"><code>author</code></dt>\n  <dd>\n    <p>El nombre de usuario de la persona que subió el archivo</p>\n  </dd>\n  <dt id=\"mime\"><code>mime</code></dt>\n  <dd>\n    <p>El tipo MIME del archivo</p>\n  </dd>\n  <dt id=\"url\"><code>url</code></dt>\n  <dd>\n    <p>La URL en la que se puede encontrar el archivo</p>\n  </dd>\n</dl>\n<h4 id=\"trabajando_con_listas\">Trabajando con listas</h4>\n<p>Las variables <code>env.tags</code> y <code>env.review_tags</code> devuelven colecciones de etiqutas. Puedes trabajar con estas de varias maneras, por supuesto, pero aquí se dan un par de sugerencias.</p>\n<h5 id=\"buscar_si_se_colocó_una_etiqueta_específica\">Buscar si se colocó una etiqueta específica</h5>\n<p>Se puede buscar si una etiqueta específica existe en una página, así:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>env<span class=\"token punctuation\">.</span>tags<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tag\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> −<span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// The page has the tag \"tag\"</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h5 id=\"iterar_recorrer_todas_las_etiquetas_de_la_página\">Iterar (recorrer) todas las etiquetas de la página</h5>\n<p>Se pueden recorrer todas las etiquetas de la página, así:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>env<span class=\"token punctuation\">.</span>tag<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tag</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// haz cualquier cosa que necesites, tal como:</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tag<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// esta etiqueta empieza con \"a\" - woohoo!</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"apis_y_módulos","title":"APIs y Módulos","isH3":true,"content":"<p>KumaScript ofrece algunas APIs de utilidad incorporadas, como también la capacidad para definir nuevas APIs en módulos editables como documentos wiki.</p>\n<h4 id=\"métodos_incorporados\">Métodos incorporados</h4>\n<p>Es probable que esta documentación mantenida manualmente quede desactualizada con respecto al código. Teniendo en cuanta eso, <a href=\"https://github.com/mozilla/kumascript/blob/master/lib/kumascript/api.js#L208\" class=\"external\" rel=\" noopener\">siempre puedes verificar el último estado de las APIs incorporadas en la fuente de KumaScript</a>. Pero hay una selección de métodos útiles expuestos a plantillas:</p>\n<ul>\n  <li><code>md5(string)</code>\n    <ul>\n      <li>: Devuelve un resumen de hexadecimal MD5 de determinada cadena.</li>\n    </ul>\n  </li>\n  <li><code>template(\"name\", [\"arg0\", \"arg1\", ..., \"argN\"])</code>\n    <ul>\n      <li>: Ejecuta y devuelve el resultado de las plantillas mencionadas con la lista de parámetros provistos.</li>\n      <li>: Utilizado en plantillas así: <code>&lt;%- template(\"warning\", [\"foo\", \"bar\", \"baz\"]) %&gt;</code>.</li>\n      <li>: Esta es una función JavaScript. Así que, si uno de los parámetroses una variable arg como $2, no lo pongas entre comillas. Así: <code>&lt;%- template(\"warning\", [$1, $2, \"baz\"]) %&gt;</code>. Si necesitas llamar otra plantilla desde el interior de un bloque e código, no uses <code>&lt;%</code> ... <code>%&gt;</code>. Ejemplo: <code>myvar = \"&lt;li&gt;\" + template(\"LXRSearch\", [\"ident\", \"i\", $1]) + \"&lt;/li&gt;\";</code></li>\n    </ul>\n  </li>\n  <li><code>require(name)</code>\n    <ul>\n      <li>: Carga otra plantilla como un módulo. Cualquier resultadu es ignorado. Devuelce cualquier cosa asignada a <code>module.exports</code> en la plantilla.</li>\n      <li>: Utilizado en plantillas así: <code>&lt;% var my_module = require('MyModule'); %&gt;</code>.</li>\n    </ul>\n  </li>\n  <li><code>cacheFn(key, timeout, function_to_cache)</code>\n    <ul>\n      <li>: Usando la key y duración de entrada de caché proporcionadas, cachea los resultados de la función proporcionada. Prioriza el valor de <code>env.cache_control</code> para invalidar el cache en <code>no-cache</code>, que puede ser enviado por un usuario logueado que tipee shift-refresh.</li>\n    </ul>\n  </li>\n  <li><code>request</code>\n    <ul>\n      <li>: Acceso al <a href=\"https://github.com/mikeal/request\" class=\"external\" rel=\" noopener\"><code>mikeal/request</code></a>, una librería para hacer consultas HTTP. Usar este módulo en las plantillas KumaScriptno es muy amigable, así que quizá desees envolver uso en APIs de módulo que simplifiquen las cosas.</li>\n    </ul>\n  </li>\n</ul>\n<h4 id=\"módulos_de_api_incorporados\">Módulos de API incorporados</h4>\n<p>Sólo hay una API incorporada por el momento, en el espacio de nombres <code>kuma</code>:</p>\n<ul>\n  <li><code>kuma.htmlEscape(string)</code>\n    <ul>\n      <li>Escapa los caracteres <code>&amp;, &lt;, &gt;, \"</code> a <code>&amp;amp, &amp;lt;, &amp;gt;, &amp;quot;</code>, respectivamente.</li>\n    </ul>\n  </li>\n  <li><code>kuma.include(path)</code>\n    <ul>\n      <li>: Incluye contenido de la página en la ruta proporcionada. Cacheo pesado.</li>\n    </ul>\n  </li>\n  <li><code>kuma.pageExists(path)</code>\n    <ul>\n      <li>: Indica si existe la página en la ruta proporcionada. Cacheo pesado.</li>\n    </ul>\n  </li>\n</ul>\n<h4 id=\"creando_módulos\">Creando módulos</h4>\n<p>Usando el mátodo incorporado <code>require()</code>, puedes cargar una plantilla como módulo para compartir variables y métodos comunes entre plantillas. Un módulo puede definirse como una plantilla de la siguiente manera:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">add</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<p>Asumiendo que esta plantilla está guardada como <code>/en-US/docs/Template:MathLib</code>, puedes utilizarla en otra plantilla, así:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span>\n<span class=\"token keyword\">var</span> math_lib <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MathLib\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\nEl resultado de <span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">%=</span> math_lib<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<p>Y, el resultado de esta plantilla será:</p>\n<pre class=\"notranslate\">el resultado de 2 + 2 = 4\n</pre>\n<h4 id=\"módulos_cargados_automáticamente\">Módulos cargados automáticamente</h4>\n<p>Hay un grupo de módulos editables como plantillas wiki que se cargan automáticamente y quedan disponibles para cada plantilla. Este grupo está definido en el archivo de configuración para el servicio KumaScript. Cualquier cambio a este requiere un bug IT para editar la configuración y el reinicio del servicio.</p>\n<p>Para la mayor parte, estos intentos de proveer sustitutos para stand-ins for legacy DekiScript features to ease template migration. But, going forward, these can be used to share common variables and methods between templates:</p>\n<ul>\n  <li><code>mdn.*</code> - <a href=\"/es/docs/Template:MDN:Common\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:MDN:Common</a></li>\n  <li><code>Culture.*</code> - <a href=\"/es/docs/Template:DekiScript:Culture\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:Culture</a></li>\n  <li><code>Date.*</code> - <a href=\"/es/docs/Template:DekiScript:Date\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:Date</a></li>\n  <li><code>Json.*</code> - <a href=\"/es/docs/Template:DekiScript:Json\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:Json</a></li>\n  <li><code>List.*</code> - <a href=\"/es/docs/Template:DekiScript:List\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:List</a></li>\n  <li><code>Map.*</code> - <a href=\"/es/docs/Template:DekiScript:Map\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:Map</a></li>\n  <li><code>Meta.*</code> - <a href=\"/es/docs/Template:DekiScript:Meta\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:Meta</a></li>\n  <li><code>Num.*</code> - <a href=\"/es/docs/Template:DekiScript:Num\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:Num</a></li>\n  <li><code>Page.*</code> - <a href=\"/es/docs/Template:DekiScript:Page\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:Page</a></li>\n  <li><code>String.*</code> - <a href=\"/es/docs/Template:DekiScript:String\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:String</a></li>\n  <li><code>Uri.*</code> - <a href=\"/es/docs/Template:DekiScript:Uri\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:Uri</a></li>\n  <li><code>Web.*</code> - <a href=\"/es/docs/Template:DekiScript:Web\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:Web</a></li>\n  <li><code>Wiki.*</code> - <a href=\"/es/docs/Template:DekiScript:Wiki\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:Wiki</a></li>\n  <li><code>Xml.*</code> - <a href=\"/es/docs/Template:DekiScript:Xml\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Template:DekiScript:Xml</a></li>\n</ul>\n<p>The best way to see the current state and offerings of these modules is to <a href=\"/es/docs/tag/dekiscript\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">take a look at their source directly</a>.</p>\n<p><strong>Note:</strong> You might notice that the DekiScript modules use a built-in method named <code>buildAPI()</code>, like so:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token function\">buildAPI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">StartsWith</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">str<span class=\"token punctuation\">,</span> sub_str</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token operator\">+</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>sub_str<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<p>The reason for this is because DekiScript is case-insensitive when it comes to references to API methods, whereas JavaScript is strict about uppercase and lowercase in references. So, <code>buildAPI()</code> is a hack to try to cover common case variations in DekiScript calls found in legacy templates.</p>\n<p>With that in mind, please do not use <code>buildAPI()</code> in new modules.</p>"}},{"type":"prose","value":{"id":"tips_and_caveats","title":"Tips and caveats","isH3":false,"content":""}},{"type":"prose","value":{"id":"debugging","title":"Debugging","isH3":true,"content":"<p>A useful tip when debugging. You can use the <code>log.debug()</code> method to output text to the scripting messages area at the top of the page that's running your template. Note that you need to be really sure to remove these when you're done debugging, as they're visible to all users! To use it, just do something like this:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span><span class=\"token operator\">-</span> log<span class=\"token punctuation\">.</span><span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Some text goes here\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<p>You can, of course, create more complex output using script code if it's helpful.</p>"}},{"type":"prose","value":{"id":"limitations_of_content_migration_from_mindtouch","title":"Limitations of content migration from MindTouch","isH3":true,"content":"<p>When we make the move to Kuma, we will migrate content from the old MindTouch-based wiki to the new Kuma-based one. This script will do some basic work to attempt to convert scripts. But, there are many common code patterns that migration can't fix.</p>\n<p>So, this means that we'll need human intervention to carry template scripts over the rest of the way to being functional.</p>\n<p>To find templates in need of review and repair, <a href=\"/es/docs/needs-review/template\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">/en...eview/template</a>.</p>\n<p>To find examples of templates that have already been repaired, <a href=\"/es/docs/tag/ks-fixed\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">/en...s/tag/ks-fixed</a>.</p>\n<p>Check the <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=714804\" class=\"external\" rel=\" noopener\">template usage stats bug</a> file attachments to help prioritize templates to fix. If you know your way around <code>gzip</code> and <code>grep</code>, <a href=\"https://bugzilla.mozilla.org/attachment.cgi?id=591545\" class=\"external\" rel=\" noopener\">this attachment</a> (a 1.5MB tab-delimited file listing template/document pairs) can help tell you what templates are used on which pages.</p>\n<p>As you repair templates, please uncheck the \"Template\" review checkbox and add the tag \"ks-fixed\", which will keep the above lists accurate.</p>\n<p>You can also find templates in need of repair by simply browsing through wiki content and spotting where content looks garbled with code or otherwise incorrect. Editing the page should show you the name of a macro that's in need of help. You may also see scripting errors on pages, which should offer editing links to the templates causing issues.</p>"}},{"type":"prose","value":{"id":"changing_locale_identifiers","title":"Changing Locale Identifiers","isH3":true,"content":"<p>The identifiers for various locales have changed from MindTouch to Kuma:</p>\n<ul>\n  <li><code>en</code> -&gt; <code>en-US</code></li>\n  <li><code>cn</code> -&gt; <code>zh-CN</code></li>\n  <li><code>zh_cn</code> -&gt; <code>zh-CN</code></li>\n  <li><code>zh_tw</code> -&gt; <code>zh-TW</code></li>\n  <li><code>pt</code> -&gt; <code>pt-PT</code></li>\n</ul>\n<p>This list should not change in the future, assuming we've not missed any. These locale identifier changes become significant in legacy DekiWIki templates.</p>"}},{"type":"prose","value":{"id":"url_pattern_changes","title":"URL pattern changes","isH3":true,"content":"<p>The URL pattern for all wiki documents has changed:</p>\n<ul>\n  <li><code>/{locale}/{slug}</code> -&gt; <code>/{locale}/docs/{slug}</code></li>\n</ul>\n<p>So, for example:</p>\n<ul>\n  <li><code>/en/JavaScript</code> -&gt; <code>/en-US/docs/JavaScript</code></li>\n  <li><code>/de/JavaScript</code> -&gt; <code>/de/docs/JavaScript</code></li>\n  <li><code>/ja/JavaScript</code> -&gt; <code>/ja/docs/JavaScript</code></li>\n</ul>\n<p>To avoid breaking links, there is an attempt to automatically redirect requests to the legacy-style URLs to new-style URLs. But, efforts should be made to change links to the new-style URLs whenever possible.</p>"}},{"type":"prose","value":{"id":"differences_from_dekiscript","title":"Differences from DekiScript","isH3":true,"content":"<p>It's useful to note a few changes from templates in DekiScript, in case you encounter these in migrated content:</p>\n<ul>\n  <li>No more <code>&lt;span class=\"script\"&gt;</code></li>\n  <li>No more <code>template.</code> nor <code>wiki.template</code> prefixing</li>\n  <li>No more <code>template({name}[, arguments])</code> syntax</li>\n  <li>Arguments must be quoted - e.g., <code>bug(123456)</code> becomes <code>bug(\"123456\")</code> - unless you are calling the template from within another template, and the argument is one of the passed-in args like <code>$1</code> in this example: <code>template(\"LXRSearch\", [\"ident\", \"i\", $1])</code>.</li>\n</ul>"}},{"type":"prose","value":{"id":"caching","title":"Caching","isH3":true,"content":"<p>KumaScript templates are heavily cached to improve performance. For the most part, this works great to serve up content that doesn't change very often. But, as a logged in user, you have two options to force a page to be regenerated, in case you notice issues with scripting:</p>\n<ul>\n  <li>Hit Refresh in your browser. This causes KumaScript to invalidate its cache for the content on the current page by issuing a request with a <code>Cache-Control: max-age=0</code> header.</li>\n  <li>Hit Shift-Refresh in your browser. This causes KumaScript to invalidate cache for the current page, as well as for any templates or content used by the current page by issuing a request with a <code>Cache-Control: no-cache</code> header.</li>\n</ul>"}},{"type":"prose","value":{"id":"cookbook","title":"Cookbook","isH3":false,"content":"<p>This section will list examples of common patterns for templates used on MDN, including samples of legacy DekiScript templates and their new KumaScript equivalents.</p>"}},{"type":"prose","value":{"id":"force_templates_used_on_a_page_to_be_reloaded","title":"Force templates used on a page to be reloaded","isH3":true,"content":"<p>It bears repeating: To force templates used on a page to be reloaded after editing, hit Shift-Reload. Just using Reload by itself will cause the page contents to be regenerated, but using cached templates and included content. A Shift-Reload is necessary to invalidate caches beyond just the content of the page itself.</p>"}},{"type":"prose","value":{"id":"recovering_from_unknown_error","title":"Recovering from \"Unknown Error\"","isH3":true,"content":"<p>Sometimes, you'll see a scripting message like this when you load a page:</p>\n<pre class=\"notranslate\">Kumascript service failed unexpectedly: &lt;class 'httplib.BadStatusLine'&gt;\n</pre>\n<p>This is probably a temporary failure of the KumaScript service. If you Refresh the page, the error may disappear. If that doesn't work, try a Shift-Refresh. If, after a few tries, the error persists - <a href=\"https://bugzilla.mozilla.org/enter_bug.cgi?product=mozilla.org&amp;format=itrequest\" class=\"external\" rel=\" noopener\">file an IT bug</a> for Mozilla Developer Network to ask for an investigation.</p>"}},{"type":"prose","value":{"id":"broken_wiki.languages_macros","title":"Broken wiki.languages() macros","isH3":true,"content":"<p>On some pages, you'll see a scripting error like this:</p>\n<pre class=\"notranslate\">Syntax error at line 436, column 461: Expected valid JSON object as the parameter of the preceding macro but...\n</pre>\n<p>If you edit the page, you'll probably see a macro like this at the bottom of the page:</p>\n<pre class=\"notranslate\">{{ wiki.languages({ \"zh-tw\": \"zh_tw/Core_JavaScript_1.5_教學/JavaScript_概要\", ... }) }}\n</pre>\n<p>To fix the problem, just delete the macro. Or, replace the curly braces on either side with HTML comments <code>&lt;!-- --&gt;</code> to preserve the information, like so:</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token comment\">&lt;!-- wiki.languages({ \"zh-tw\": \"zh_tw/Core_JavaScript_1.5_教學/JavaScript_概要\", ... }) --&gt;</span>\n</code></pre></div>\n<p>Because Kuma supports localization differently, these macros aren't actually needed any more. But, they've been left intact in case we need to revisit the relationships between localized pages. Unfortunately, it seems like migration has failed to convert some of them properly.</p>"}},{"type":"prose","value":{"id":"unconverted_inline_script_blocks","title":"Unconverted inline script blocks","isH3":true,"content":"<p>Occasionally, you'll find some text like this at the bottom of a page, or even somewhere in the middle:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token function\">ottoPreviousNext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"JSGChapters\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwiki<span class=\"token punctuation\">.</span><span class=\"token function\">languages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"fr\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"fr/Guide_JavaScript_1.5/Expressions_rationnelles\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">\"ja\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ja/Core_JavaScript_1.5_Guide/Regular_Expressions\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>This is a script block that didn't get converted to a KumaScript macro during migration. It happens, unfortunately. If you switch to HTML source editing mode, you'll see this, a <code>&lt;pre class=\"script\"&gt;</code> element:</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>pre</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>script<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value css language-css\"><span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 16px<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span>\nottoPreviousNext(<span class=\"token entity named-entity\" title=\"&quot;\">&amp;quot;</span>JSGChapters<span class=\"token entity named-entity\" title=\"&quot;\">&amp;quot;</span>);\nwiki.languages({\n  <span class=\"token entity named-entity\" title=\"&quot;\">&amp;quot;</span>fr<span class=\"token entity named-entity\" title=\"&quot;\">&amp;quot;</span>: <span class=\"token entity named-entity\" title=\"&quot;\">&amp;quot;</span>fr/Guide_JavaScript_1.5/Expressions_rationnelles<span class=\"token entity named-entity\" title=\"&quot;\">&amp;quot;</span>,\n <span class=\"token entity named-entity\" title=\"&nbsp;\">&amp;nbsp;</span><span class=\"token entity named-entity\" title=\"&quot;\">&amp;quot;</span>ja<span class=\"token entity named-entity\" title=\"&quot;\">&amp;quot;</span>: <span class=\"token entity named-entity\" title=\"&quot;\">&amp;quot;</span>ja/Core_JavaScript_1.5_Guide/Regular_Expressions<span class=\"token entity named-entity\" title=\"&quot;\">&amp;quot;</span>\n});\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>pre</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>This is an inline script - previously allowed by DekiScript, no longer supported by KumaScript.</p>\n<p>For this particular example, common to the JavaScript Guide, you can fix it by removing the wiki.languages part (see <a href=\"#broken_wiki.languages_macros\">previous section</a>) and change the ottoPreviousNext() into a macro like so:</p>\n<pre class=\"notranslate\">{{ ottoPreviousNext(\"JSGChapters\") }}\n</pre>\n<p>If you see a block of code that's more complex than the above, you will need to create a new template, move the code there, and replace the code in its previous spot with a macro calling the new template.</p>"}},{"type":"prose","value":{"id":"finding_the_current_pages_language","title":"Finding the Current Page's Language","isH3":true,"content":"<p>In KumaScript, the locale of the current document is exposed as an environment variable:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> lang <span class=\"token operator\">=</span> env<span class=\"token punctuation\">.</span>locale<span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>In legacy DekiScript templates, coming up with the locale was a bit harder. You'll see chunks of code like this:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">/* accepts as input one required parameter: MathML element to create an xref to */</span>\n<span class=\"token keyword\">var</span> u <span class=\"token operator\">=</span> uri<span class=\"token punctuation\">.</span><span class=\"token function\">parts</span><span class=\"token punctuation\">(</span>Page<span class=\"token punctuation\">.</span>uri<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> lang <span class=\"token operator\">=</span> string<span class=\"token punctuation\">.</span><span class=\"token function\">tolower</span><span class=\"token punctuation\">(</span>u<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">,</span> <span class=\"token string\">\"project\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> string<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Project\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  lang <span class=\"token operator\">=</span> string<span class=\"token punctuation\">.</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">/* fall back to page.language on a user page */</span>\n<span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">.</span><span class=\"token function\">StartsWith</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">,</span> <span class=\"token string\">\"user:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  lang <span class=\"token operator\">=</span> page<span class=\"token punctuation\">.</span>language<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Please replace code like the above with the new KumaScript example. The <code>env.locale</code> variable should be reliable and defined for every document.</p>"}},{"type":"prose","value":{"id":"reading_the_contents_of_a_page_attachment","title":"Reading the contents of a page attachment","isH3":true,"content":"<p>You can read the contents of an attached file by using the <code>mdn.getFileContent()</code> function, like this:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span>\n  <span class=\"token keyword\">var</span> contents <span class=\"token operator\">=</span> mdn<span class=\"token punctuation\">.</span><span class=\"token function\">getFileContent</span><span class=\"token punctuation\">(</span>fileUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token operator\">...</span> <span class=\"token keyword\">do</span> stuff <span class=\"token keyword\">with</span> the contents <span class=\"token operator\">...</span>\n<span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<p>or</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span><span class=\"token operator\">-</span> mdn<span class=\"token punctuation\">.</span><span class=\"token function\">getFileContent</span><span class=\"token punctuation\">(</span>fileObject<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<p>In other words, you may specify either the URL of the file to read or as a file object. The file objects for a page can be accessed through the array <code>env.files</code>. So, for example, to embed the contents of the first file attached to the article, you can do this:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span><span class=\"token operator\">-</span> mdn<span class=\"token punctuation\">.</span><span class=\"token function\">getFileContent</span><span class=\"token punctuation\">(</span>env<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Nota:</strong> You probably don't want to try to embed the contents of a non-text file this way, as the raw contents would be injected as text. This is meant to let you access the contents of text attachments.</p>\n</div>\n<p>If the file isn't found, an empty string is returned. There is currently no way to tell the difference between an empty file and a nonexistent one. But if you're putting empty files on the wiki, you're doing it wrong.</p>"}},{"type":"prose","value":{"id":"localizing_template_content","title":"Localizing template content","isH3":true,"content":"<p>Templates cannot be translated like other wiki pages. KumaScript only looks for templates in the en-US locale (i.e., <code>/en-US/docs/Template:{name}</code>), and does not look for templates that have been translated to another locale (i.e., <code>/fr/docs/Template:{name}</code>).</p>\n<p>So the main way to output content tailored to the current document locale is to pivot on the value of <code>env.locale</code>. There are many ways to do this, but a few patterns are common in the conversion of legacy DekiScript templates:</p>\n<h4 id=\"ifelse_blocks_in_kumascript\">If/else blocks in KumaScript</h4>\n<p>The KumaScript equivalent of this can be achieved with simple if/else blocks, like so:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"fr\"</span> <span class=\"token operator\">==</span> env<span class=\"token punctuation\">.</span>locale<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span><span class=\"token operator\">-</span> <span class=\"token function\">template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"CSSRef\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span> « <span class=\"token operator\">&lt;</span>a title<span class=\"token operator\">=</span><span class=\"token string\">\"Référence_CSS/Extensions_Mozilla\"</span> href<span class=\"token operator\">=</span><span class=\"token string\">\"/fr/docs/Référence_CSS/Extensions_Mozilla\"</span><span class=\"token operator\">&gt;</span><span class=\"token constant\">R</span>éférence <span class=\"token constant\">CSS</span><span class=\"token operator\">:</span>Extensions Mozilla<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"ja\"</span> <span class=\"token operator\">==</span> env<span class=\"token punctuation\">.</span>locale<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span><span class=\"token operator\">-</span> <span class=\"token function\">template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"CSSRef\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span> « <span class=\"token operator\">&lt;</span>a title<span class=\"token operator\">=</span><span class=\"token string\">\"CSS_Reference/Mozilla_Extensions\"</span> href<span class=\"token operator\">=</span><span class=\"token string\">\"/ja/docs/CSS_Reference/Mozilla_Extensions\"</span><span class=\"token operator\">&gt;</span><span class=\"token constant\">CSS</span> <span class=\"token literal-property property\">リファレンス</span><span class=\"token operator\">:</span>Mozilla 拡張仕様<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"pl\"</span> <span class=\"token operator\">==</span> env<span class=\"token punctuation\">.</span>locale<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span><span class=\"token operator\">-</span> <span class=\"token function\">template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"CSSRef\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span> « <span class=\"token operator\">&lt;</span>a title<span class=\"token operator\">=</span><span class=\"token string\">\"Dokumentacja_CSS/Rozszerzenia_Mozilli\"</span> href<span class=\"token operator\">=</span><span class=\"token string\">\"/pl/docs/Dokumentacja_CSS/Rozszerzenia_Mozilli\"</span><span class=\"token operator\">&gt;</span>Dokumentacja <span class=\"token constant\">CSS</span><span class=\"token operator\">:</span>Rozszerzenia Mozilli<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"de\"</span> <span class=\"token operator\">==</span> env<span class=\"token punctuation\">.</span>locale<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span><span class=\"token operator\">-</span> <span class=\"token function\">template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"CSSRef\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span> « <span class=\"token operator\">&lt;</span>a title<span class=\"token operator\">=</span><span class=\"token string\">\"CSS_Referenz/Mozilla_CSS_Erweiterungen\"</span> href<span class=\"token operator\">=</span><span class=\"token string\">\"/de/docs/CSS_Referenz/Mozilla_CSS_Erweiterungen\"</span><span class=\"token operator\">&gt;</span><span class=\"token constant\">CSS</span> <span class=\"token literal-property property\">Referenz</span><span class=\"token operator\">:</span> Mozilla Erweiterungen<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span><span class=\"token operator\">-</span> <span class=\"token function\">template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"CSSRef\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span> « <span class=\"token operator\">&lt;</span>a title<span class=\"token operator\">=</span><span class=\"token string\">\"CSS_Reference/Mozilla_Extensions\"</span> href<span class=\"token operator\">=</span><span class=\"token string\">\"/en-US/docs/CSS_Reference/Mozilla_Extensions\"</span><span class=\"token operator\">&gt;</span><span class=\"token constant\">CSS</span> <span class=\"token literal-property property\">Reference</span><span class=\"token operator\">:</span>Mozilla Extensions<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<h5 id=\"legacy_dekiscript\">Legacy DekiScript</h5>\n<p>A similar way this was done in DekiScript was using <code>&lt;span&gt;</code>'s with <code>lang=\"{locale}\"</code> attributes, like so:</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>*<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-*<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>script<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>CSSRef()<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span> « <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en/CSS_Reference/Mozilla_Extensions<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/en/CSS_Reference/Mozilla_Extensions<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>CSS Reference:Mozilla Extensions<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>script<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>CSSRef()<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span> « <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en/CSS_Reference/Mozilla_Extensions<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/en/CSS_Reference/Mozilla_Extensions<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>CSS Reference:Mozilla Extensions<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>fr<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-fr<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>script<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>CSSRef()<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span> « <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>fr/Référence_CSS/Extensions_Mozilla<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/fr/Référence_CSS/Extensions_Mozilla<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Référence CSS:Extensions Mozilla<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ja<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-ja<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>script<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>CSSRef()<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span> « <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ja/CSS_Reference/Mozilla_Extensions<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/ja/CSS_Reference/Mozilla_Extensions<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>CSS リファレンス:Mozilla 拡張仕様<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pl<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-pl<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>script<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>CSSRef()<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span> « <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pl/Dokumentacja_CSS/Rozszerzenia_Mozilli<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/pl/Dokumentacja_CSS/Rozszerzenia_Mozilli<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Dokumentacja CSS:Rozszerzenia Mozilli<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>de<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-de<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>script<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>CSSRef()<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span> « <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>de/CSS_Referenz/Mozilla_CSS_Erweiterungen<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/de/CSS_Referenz/Mozilla_CSS_Erweiterungen<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>CSS Referenz: Mozilla Erweiterungen<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>This is no longer supported. If you encounter templates built using the legacy DekiScript approach, revise them to use the new KumaScript pattern.</p>\n<p>Depending on what text editor you use, you may be able to copy and paste from the browser-based editor and attack this pattern with a series of search/replace regexes to get you most of the way there.</p>\n<h4 id=\"string_variables_and_switch\">String variables and switch</h4>\n<p>Rather than switch between full chunks of markup, you can define a set of strings, switch them based on locale, and then use them to fill in placeholders in a single chunk of markup:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span>\n<span class=\"token keyword\">var</span> s_title <span class=\"token operator\">=</span> <span class=\"token string\">'Firefox for Developers'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>env<span class=\"token punctuation\">.</span>locale<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'de'</span><span class=\"token operator\">:</span>\n        s_title <span class=\"token operator\">=</span> <span class=\"token string\">\"Firefox für Entwickler\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'fr'</span><span class=\"token operator\">:</span>\n        s_title <span class=\"token operator\">=</span> <span class=\"token string\">\"Firefox pour les développeurs\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'es'</span><span class=\"token operator\">:</span>\n        s_title <span class=\"token operator\">=</span> <span class=\"token string\">\"Firefox para desarrolladores\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>span <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"title\"</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">%=</span> s_title <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<p>You'll see examples of this in legacy DekiScript templates. For the most part, this pattern should work as-is, but you may need to adjust the expected values of locales (e.g., <code>en</code>, <code>cn</code>, <code>pt</code> become <code>en-US</code>, <code>zh-CN</code>, <code>pt-PT</code> respectively).</p>\n<h4 id=\"use_mdn.localstring\">Use <code>mdn.localString()</code></h4>\n<p>A recent addition to the <code>Template:MDN:Common</code> module is <code>mdn.localString()</code>, used like this:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span>\n<span class=\"token keyword\">var</span> s_title <span class=\"token operator\">=</span> mdn<span class=\"token punctuation\">.</span><span class=\"token function\">localString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"en-US\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Firefox for Developers\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">\"de\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Firefox für Entwickler\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">\"es\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Firefox para desarrolladores\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>span <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"title\"</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">%=</span> s_title <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<p>This is more concise than the switch statement, and may be a better choice where a single string is concerned. However, if many strings need to be translated (e.g., as in <a href=\"/es/docs/Template:CSSRef\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">CSSRef</a>), a switch statement might help keep all the strings grouped by locale and more easily translated that way.</p>\n<p>When the object does not have the appropriate locale, the value of \"en-US\" is used as the initial value.</p>\n<h4 id=\"before_and_after_examples\">Before and after examples</h4>\n<p>Carriage returns added here and there for clarity.</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-en<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>DOM Level 0. Not part of any standard. <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-es<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>es<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>DOM Nivel 0. No es parte de ninguna norma. <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-*<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>*<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>DOM Level 0. Not part of any standard. <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-fr<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>fr<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>DOM Level 0. Ne fait partie d'aucune spécification. <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-ja<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ja<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>DOM Level 0。どの標準にも属しません。 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-pl<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pl<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>DOM Level 0. Nie jest częścią żadnego standardu. <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lang lang-zh-cn<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>zh-cn<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>DOM Level 0 不属于任何标准.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n \n// After: Kumascript version\n&lt;% if (\"fr\" == env.locale) { %&gt;\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span>DOM Level 0. Ne fait partie d'aucune spécification.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n&lt;% } else if (\"ja\" == env.locale) { %&gt;\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span>DOM Level 0。どの標準にも属しません。 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n&lt;% } else if (\"pl\" == env.locale) { %&gt;\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span>DOM Level 0. Nie jest częścią żadnego standardu.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n&lt;% } else if (\"es\" == env.locale) { %&gt;\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span>DOM Nivel 0. No es parte de ninguna norma.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n&lt;% } else if (\"zh-CN\" == env.locale) { %&gt;\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span>DOM Level 0 不属于任何标准.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n&lt;% } else { %&gt;\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span>DOM Level 0. Not part of any standard.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n&lt;% } %&gt;\n</code></pre></div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// From ReleaseChannelInfo() template</span>\n<span class=\"token comment\">// Before:</span>\nweb<span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;p&gt;Firefox \"</span> <span class=\"token operator\">+</span> $0 <span class=\"token operator\">+</span> <span class=\"token string\">\", based on Gecko \"</span> <span class=\"token operator\">+</span> $1 <span class=\"token operator\">+</span> <span class=\"token string\">\", will ship in \"</span> <span class=\"token operator\">+</span> $2 <span class=\"token operator\">+</span> <span class=\"token string\">\". This article provides information about the changes in this release that will affect developers. Nightly builds of what will become Firefox \"</span> <span class=\"token operator\">+</span> $0 <span class=\"token operator\">+</span> <span class=\"token string\">\" are \"</span> <span class=\"token operator\">+</span> web<span class=\"token punctuation\">.</span><span class=\"token function\">link</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> <span class=\"token string\">\"currently available\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" on the \"</span> <span class=\"token operator\">+</span> string<span class=\"token punctuation\">.</span><span class=\"token function\">ToUpperFirst</span><span class=\"token punctuation\">(</span>$3<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" channel.&lt;/p&gt;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// After:</span>\n<span class=\"token operator\">&lt;</span>p<span class=\"token operator\">&gt;</span>Firefox <span class=\"token operator\">&lt;</span><span class=\"token operator\">%=</span> $0 <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">,</span> based on Gecko <span class=\"token operator\">&lt;</span><span class=\"token operator\">%=</span> $1 <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">,</span> will ship <span class=\"token keyword\">in</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">%=</span> $2 <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">.</span> This\n article provides information about the changes <span class=\"token keyword\">in</span> <span class=\"token keyword\">this</span> release that will\n affect developers<span class=\"token punctuation\">.</span> Nightly builds <span class=\"token keyword\">of</span> what will become Firefox <span class=\"token operator\">&lt;</span><span class=\"token operator\">%=</span> $0 <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n are <span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span><span class=\"token operator\">-</span> web<span class=\"token punctuation\">.</span><span class=\"token function\">link</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> <span class=\"token string\">\"currently available\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>  on the\n <span class=\"token operator\">&lt;</span><span class=\"token operator\">%=</span> string<span class=\"token punctuation\">.</span><span class=\"token function\">ToUpperFirst</span><span class=\"token punctuation\">(</span>$3<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span> channel<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Before: old Dekiscript snippet</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>$1 <span class=\"token operator\">&amp;&amp;</span> string<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>$1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  optionsText <span class=\"token operator\">=</span> optionsText <span class=\"token operator\">+</span> <span class=\"token string\">\"&lt;li&gt;\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">LXRSearch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ident\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"i\"</span><span class=\"token punctuation\">,</span> $1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"&lt;/li&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// After: new Kumascript. Quote parameters to template() unless it is an arg variable (like $1).</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>$1 <span class=\"token operator\">&amp;&amp;</span> string<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>$1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  optionsText <span class=\"token operator\">=</span> optionsText <span class=\"token operator\">+</span> <span class=\"token string\">\"&lt;li&gt;\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"LXRSearch\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"ident\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"i\"</span><span class=\"token punctuation\">,</span> $1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"&lt;/li&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Note that template() within &lt;% ... %&gt; outputs nothing directly. If you want to call another</span>\n<span class=\"token comment\">// template and display its output, use &lt;%= %&gt; or &lt;%- %&gt; like this:</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span><span class=\"token operator\">-</span> <span class=\"token function\">template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"LXRSearch\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"ident\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"i\"</span><span class=\"token punctuation\">,</span> $1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token operator\">&gt;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/es/docs/Project:Getting_started_with_Kuma\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">Getting started with Kuma</a></li>\n  <li><a href=\"/es/docs/Project:KumaScript_reference\" class=\"page-not-created\" title=\"This is a link to an unwritten page\">KumaScript reference</a></li>\n  <li><a href=\"https://wiki.mozilla.org/MDN/Kuma\" class=\"external\" rel=\" noopener\">Kuma wiki</a></li>\n</ul>"}}],"toc":[{"text":"Vistazo general","id":"vistazo_general"},{"text":"Aspectos básicos","id":"aspectos_básicos"},{"text":"Características avanzadas","id":"características_avanzadas"},{"text":"Tips and caveats","id":"tips_and_caveats"},{"text":"Cookbook","id":"cookbook"},{"text":"See also","id":"see_also"}],"summary":"En el verano de 2012, MDN cambió a una nueva plataforma wiki llamada Kuma. Esta reemplaza el lenguaje de plantilla DekiScript con un nuevo sistema llamado KumaScript. KumaScript se alimenta de JavaScript del lado del servidor, usando Node.js. Este artículo provee informaciónde cómo usar KumaScript y cómo actualizar scripts migrados parcialmente desde MindTouch.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"KumaScript","locale":"en-US","native":"English (US)"},{"title":"KumaScript","locale":"ja","native":"日本語"},{"title":"KumaScript","locale":"pt-BR","native":"Português (do Brasil)"},{"title":"KumaScript","locale":"zh-TW","native":"正體中文 (繁體)"}],"source":{"folder":"es/mdn/tools/kumascript","github_url":"https://github.com/mdn/translated-content/blob/main/files/es/mdn/tools/kumascript/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/es/docs/MDN","title":"El proyecto MDN"},{"uri":"/es/docs/MDN/Tools","title":"Herramientas de MDN y Utilidades"},{"uri":"/es/docs/MDN/Tools/KumaScript","title":"Introducción a KumaScript"}],"pageTitle":"Introducción a KumaScript - El proyecto MDN | MDN","noIndexing":false}}