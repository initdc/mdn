{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Modify a web page","mdn_url":"/es/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page","locale":"es","native":"Español","sidebarHTML":"\n  <ol>\n    <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions\"><strong>Extensiónes del navegador</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Comenzar</summary>\n        <ol>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\">¿Qué son las extensiones?</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\">Tu primera extensión</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\">Tu segunda extensión</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\">Anatomía de una extensión</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Examples\">Extensiones de ejemplo</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/What_next_\">¿Qué sigue?</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Conceptos</summary>\n        <ol>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\">Uso de las API de JavaScript</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\">Guiones de contenido</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">Patrones de coincidencia</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\">Trabajar con archivos</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Internationalization\">Internacionalización</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\">Política de seguridad de contenido</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\">Mensajería nativa</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\">Diferencias entre implementaciones de API</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\">Incompatibilidades de Chrome</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Interfaz de usuario</summary>\n        <ol>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface\">Interfaz de usuario</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\">Botón de la barra de herramientas</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\">Botón de la barra de direcciones</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\">Barras laterales</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\">Elementos del menú contextual</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\">Página de opciones</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\">Páginas de extensión</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\">Notificaciones</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\">Sugerencias de la barra de direcciones</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\">Paneles de herramientas para desarrolladores</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Cómo hacer</summary>\n        <ol>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\">Interceptar solicitudes HTTP</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\">Modificar una página web</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\">Insertar contenido externo</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">Comparta objetos con scripts de página</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\">Agregar un botón a la barra de herramientas</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\">Implementar una página de configuración</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\">Trabajar con la API de pestañas</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\">Trabajar con la API de marcadores</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\">Trabajar con la API de Cookies</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\">Trabajar con identidades contextuales</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard\">Interactuar con el portapapeles</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\">Cree una extensión multinavegador</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\">Diferenciadores de Firefox</a></summary>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>API de JavaScript</summary>\n        <ol><li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\">Browser support for JavaScript APIs</a></li><li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/API/i18n\">i18n</a></li><li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/API/storage\">storage</a></li></ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n      <summary>Claves de manifiesto</summary>\n        <ol>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/manifest.json\">Introducción</a></li>\n        </ol>\n      <ol><li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons\">icons</a></li></ol>\n      </details>\n    </li>\n     <li class=\"toggle\">\n      <details>\n        <summary>Taller de Extensión</summary>\n        <ol>\n          <li><a href=\"https://extensionworkshop.com/documentation/develop/\">Desarrollar</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/publish/\">Publish</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/manage/\">Gestionar</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/enterprise/\">Empresa</a></li>\n        </ol>\n      </details>\n    </li>\n    <li><a href=\"/es/docs/Mozilla/Add-ons/Contact_us\"><strong>Contáctenos</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Canales de discusión</summary>\n        <ol>\n          <li><a href=\"https://blog.mozilla.org/addons\">Blog de complementos</a></li>\n          <li><a href=\"https://discourse.mozilla.org/c/add-ons\">Foro de complementos</a></li>\n          <li><a href=\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\">Chat de complementos</a></li>\n        </ol>\n      </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p></p>Uno de los usos más comunes para las extensiones es modificar páginas web. Por ejemplo, una extension puede querer cambiar el estilo de la página, esconder determinados nodos DOM o incluir otros nuevos.Existen dos maneras de hacer esto con extensiones Web y APIs:<p></p>\n<ul>\n  <li><strong>Declarativamente</strong>: Define un patrón que encaja con un conjunto de URLs y carga un conjunto de scripts a las páginas cuyos URL encajen con ese patrón.</li>\n  <li><strong>Programaticamente</strong>: Usando una Javascript API, carga una script en la página alojada en una lengüeta específica.</li>\n</ul>\n<p>De ambas formas, estos scripts se llaman scripts de contenido y son distintos del resto de scripts que constituyen una extensión.</p>\n<ul>\n  <li>Solamente tienen acceso a un grupo pequeño de extensiones web y APIs.</li>\n  <li>Obtienen acceso directo a la página web en la que han sido cargadas.</li>\n  <li>Se comunican con el resto de la extensión usando una API de mensajería.</li>\n</ul>\n<p>En este artículo hablaremos de los dos métodos para cargar una script..</p>"}},{"type":"prose","value":{"id":"modificando_páginas_que_encajen_con_un_patrón_url","title":"Modificando páginas que encajen con un patrón URL","isH3":false,"content":"<p>Para empezar, crea un nuevo directorio llamado \"modify-page\". En este directorio, crea un archivo llamado \"manifest.json\", con el siguiente contenido:</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n\n  <span class=\"token property\">\"manifest_version\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"modify-page\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0\"</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"content_scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"matches\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"https://developer.mozilla.org/*\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"js\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"page-eater.js\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>La llave <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\"><code>content_scripts</code></a> es el método de carga de scripts a páginas cuya URL encaje con los patrones. En este caso, <code>content_scripts</code> le dice al navegador que cargue una script llamada \"page-eater.js\" en todas las páginas con <a href=\"/\">https://developer.mozilla.org/</a>.</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Nota:</strong> Debido a que el atributo <code>\"js\"</code> de <code>content_scripts</code> es una array, puedes usarla para inyectar más de una script a las páginas que encajen con el patrón. Si haces esto las páginas compartiran el mismo campo de aplicación, igual que múltiples scripts cargadas por una página, y son cargadas en el mismo orden en las que están dispuestas en la array.</p>\n</div>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Nota:</strong> La llave <code>content_scripts</code> tambien tiene un atributo de <code>\"css\"</code> que puedes usar para inyectar código CSS.</p>\n</div>\n<p>Después, crea un archivo llamado \"page-eater.js\" dentro del directorio \"modify-page\" e introduce el contenido de a continuación:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> header <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'h1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nheader<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">\"This page has been eaten\"</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>header<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Ahora, <a href=\"/en-US/Add-ons/WebExtensions/Temporary_Installation_in_Firefox\">instala la extensión</a> y visita <a href=\"/\">https://developer.mozilla.org/</a>:</p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/lxf2Tkg6U1M\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\" loading=\"lazy\"></iframe>\n<div class=\"notecard note\" id=\"sect3\">\n  <p><strong>Nota:</strong> Ten en cuenta que aunque este video muestra el contenido de la script operando en <a href=\"https://addons.mozilla.org/en-US/firefox/\" class=\"external\" rel=\" noopener\">addons.mozilla.org</a>, las scripts de contenido están bloqueadas en esta página por el momento.</p>\n</div>"}},{"type":"prose","value":{"id":"modificando_las_páginas_programaticamente","title":"Modificando las páginas programaticamente","isH3":false,"content":"<p>Y si quieres comer páginas, pero solo cuando el usuario te lo pida? Actualicemos este ejemplo para que podamos enyectar el contenido de la script cuando el usuario haga click en un item del menu de contexto.</p>\n<p>Primero actualiza \"manifest.json\" para que incluya el contenido a continuación:</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n\n  <span class=\"token property\">\"manifest_version\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"modify-page\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0\"</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"permissions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"activeTab\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"contextMenus\"</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"background\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"background.js\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Aquí, hemos eliminado la llave <code>content_scripts</code> y hemos añadido dos nuevas llaves:</p>\n<ul>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\"><code>permissions</code></a>: Para inyectar scripts a las páginas necesitamos los permisos para la página que estamos modificando. El permiso <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions#activetab_permission\"><code>activeTab</code></a> es una manera de obtener el permiso temporalmente para la lengüeta que esté actualmente abierta. También necesitamos el permiso <code>contextMenus</code> para poder añadir items al menu de contexto.</li>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background\"><code>background</code></a>: Usamos esto para cargar un <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#background_scripts\">\"background script\"</a> persistente llamado \"background.js\", en el cual montamos el menu de contexto e inyectamos el script de contenido.</li>\n</ul>\n<p>Ahora generaremos este archivo. Crea un archivo llamado \"background.js\" en el directorio \"modify-page\" e introduce el siguiente contenido:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>browser<span class=\"token punctuation\">.</span>contextMenus<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token string\">\"eat-page\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Eat this page\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nbrowser<span class=\"token punctuation\">.</span>contextMenus<span class=\"token punctuation\">.</span>onClicked<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">info<span class=\"token punctuation\">,</span> tab</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>info<span class=\"token punctuation\">.</span>menuItemId <span class=\"token operator\">==</span> <span class=\"token string\">\"eat-page\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    browser<span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span><span class=\"token function\">executeScript</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">file</span><span class=\"token operator\">:</span> <span class=\"token string\">\"page-eater.js\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>En esta script estamos creando un <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/menus/create\">item del menu de contexto</a> y dándole una ID y un título específico (el texto que se estará expuesto en el menu de contexto). Después configuramos un evento de escucha para que cuando el usuario haga click en uno de los items del menu podamos comprobar si se trata de nuestro item <code>eat-page</code> . En caso afirmativo, inyectaremos \"page-eater.js\" a la lengüeta actual usando la API <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/executeScript\"><code>tabs.executeScript()</code></a>. Alternativamente, esta API puede tomar como argumento una ID. En este caso la hemos omitido lo cual quiere decir que la script es inyectada en la lengüeta que está actualmente abierta.</p>\n<p>Ahora mismo la extensión debería ser algo como esto:</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code>modify-page/\n    background.js\n    manifest.json\n    page-eater.js\n</code></pre></div>\n<p>Ahora <a href=\"/en-US/Add-ons/WebExtensions/Temporary_Installation_in_Firefox#Reloading_a_temporary_add-on\">recarga la extensión</a>, abre la página (cualquier página en esta ocasión), activa el menu de contexto y selecciona \"Eat this page\" (Comer esta página):</p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/zX4Bcv8VctA\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\" loading=\"lazy\"></iframe>\n<div class=\"notecard note\" id=\"sect4\">\n  <p><strong>Nota:</strong> Ten en cuenta que aunque este video muestra el contenido de la script operando en <a href=\"https://addons.mozilla.org/en-US/firefox/\" class=\"external\" rel=\" noopener\">addons.mozilla.org</a>, las scripts de contenido están bloqueadas en esta página por el momento.</p>\n</div>"}},{"type":"prose","value":{"id":"mensajería","title":"Mensajería","isH3":false,"content":"<p>Scripts de contenido y scripts de fondo no pueden acceder directamente al estado del otro. Sin embargo, pueden comunicarse mediante el uso de mensajes. Una terminal configura un escuchador de mensajes y la otra terminal puede mandarle un mensaje. La siguente tabla resume las APIs involucradas en cada parte:</p>\n<table>\n  <thead>\n    <tr>\n      <th></th>\n      <th>En el script de contenido</th>\n      <th>En el script de fondo</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Mandar un mensaje</td>\n      <td><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime#sendmessage()\"><code>browser.runtime.sendMessage()</code></a></td>\n      <td><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/Tabs/sendMessage\"><code>browser.tabs.sendMessage()</code></a></td>\n    </tr>\n    <tr>\n      <td>Recibir un mensaje</td>\n      <td><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\"><code>browser.runtime.onMessage</code></a></td>\n      <td><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime#onmessage\"><code>browser.runtime.onMessage</code></a></td>\n    </tr>\n  </tbody>\n</table>\n<p>Actualicemos nuestro ejemplo para ilustrar como mandar un mensaje desde una script de fondo.</p>\n<p>Primero, hemos de editar \"background.js\" para que tenga el siguiente contenido:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>browser<span class=\"token punctuation\">.</span>contextMenus<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token string\">\"eat-page\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Eat this page\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">messageTab</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tabs</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  browser<span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span><span class=\"token function\">sendMessage</span><span class=\"token punctuation\">(</span>tabs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">replacement</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Message from the extension!\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">onExecuted</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> querying <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">active</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">currentWindow</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    querying<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>messageTab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nbrowser<span class=\"token punctuation\">.</span>contextMenus<span class=\"token punctuation\">.</span>onClicked<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">info<span class=\"token punctuation\">,</span> tab</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>info<span class=\"token punctuation\">.</span>menuItemId <span class=\"token operator\">==</span> <span class=\"token string\">\"eat-page\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> executing <span class=\"token operator\">=</span> browser<span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span><span class=\"token function\">executeScript</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">file</span><span class=\"token operator\">:</span> <span class=\"token string\">\"page-eater.js\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    executing<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>onExecuted<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Ahora, después de inyectar \"page-eater.js\", hemos de usar <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/query\"><code>tabs.query()</code></a> para obtener la lengüeta actualmente activa y entonces usar <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/sendMessage\"><code>tabs.sendMessage()</code></a> para mandar un mensaje a las scripts de contenido cargadas en la lengüeta. El mensaje tiene el contenido <code>{replacement: \"Message from the extension!\"}</code>.</p>\n<p>Después, actualiza \"page-eater.js\" de esta forma:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">eatPageReceiver</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">request<span class=\"token punctuation\">,</span> sender<span class=\"token punctuation\">,</span> sendResponse</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> header <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'h1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  header<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>replacement<span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>header<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nbrowser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span>onMessage<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>eatPageReceiver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Ahora, en vez de simplemente comer la página, el contenido espera a un mensaje usando <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\"><code>runtime.onMessage</code></a>. Cuando el mensaje llega, el script de contenido ejecuta el mismo código de antes, exceptuando que el texto de reemplazo se obtenido de <code>request.replacement</code>.</p>\n<p>Debido a que <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/executeScript\"><code>tabs.executeScript()</code></a> es una función asincrónica y para asegurarnos de que mandamos el mensaje solo cuando el escuchador ha sido añadido en \"page-eater.js\", usamos <code>onExecuted</code> que sera llamado después de que \"page-eater.js\" se ejecute.</p>\n<div class=\"notecard note\" id=\"sect5\">\n  <p><strong>Nota:</strong> Pulsa Ctrl+Shift+J (o Cmd+Shift+J en el Mac) o <code>web-ext run --bc</code> para abrir la consola de navegación para ver <code>console.log</code> en la script de fondo. Alternativamente puedes usar el <a href=\"/en-US/docs/Mozilla/Add-ons/Add-on_Debugger\">Add-on Debugger</a>, el cual te permite poner un breakpoint. De momento no hay forma de iniciar un <a href=\"https://github.com/mozilla/web-ext/issues/759\" class=\"external\" rel=\" noopener\">Add-on Debugger directamente de una extensión web</a>.</p>\n</div>\n<p>Si queremos enviar mensajes directamente desde el contenido script de vuelta a la página de fondo, podríamos usar<a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage\"><code>runtime.sendMessage()</code></a> en vez de <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/sendMessage\"><code>tabs.sendMessage()</code></a>. Por ejemplo:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>browser<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span><span class=\"token function\">sendMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">\"from page-eater.js\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<div class=\"notecard note\" id=\"sect6\">\n  <p><strong>Nota:</strong> Todos estos ejemplos inyectan Javascript; también puedes inyectar CSS programaticamente usando la función<a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/insertCSS\"><code>tabs.insertCSS()</code></a>.</p>\n</div>"}},{"type":"prose","value":{"id":"aprende_más","title":"Aprende más","isH3":false,"content":"<ul>\n  <li>La guía de <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">scripts de contenido (en-US)</a></li>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\"><code>content_scripts</code></a> llave de manifiesto</li>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\"><code>permissions</code></a> llave de manifiesto</li>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/executeScript\"><code>tabs.executeScript()</code></a></li>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/insertCSS\"><code>tabs.insertCSS()</code></a></li>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/sendMessage\"><code>tabs.sendMessage()</code></a></li>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage\"><code>runtime.sendMessage()</code></a></li>\n  <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage\"><code>runtime.onMessage</code></a></li>\n  <li>Ejemplos con<code>content_scripts</code>:\n    <ul>\n      <li><a href=\"https://github.com/mdn/webextensions-examples/tree/master/borderify\" class=\"external\" rel=\" noopener\">borderify</a></li>\n      <li><a href=\"https://github.com/mdn/webextensions-examples/tree/master/notify-link-clicks-i18n\" class=\"external\" rel=\" noopener\">notify-link-clicks-i18n</a></li>\n      <li><a href=\"https://github.com/mdn/webextensions-examples/tree/master/page-to-extension-messaging\" class=\"external\" rel=\" noopener\">page-to-extension-messaging</a></li>\n    </ul>\n  </li>\n  <li>Ejemplos con<code>tabs.executeScript()</code>:\n    <ul>\n      <li><a href=\"https://github.com/mdn/webextensions-examples/tree/master/beastify\" class=\"external\" rel=\" noopener\">beastify</a></li>\n      <li><a href=\"https://github.com/mdn/webextensions-examples/tree/master/context-menu-demo\" class=\"external\" rel=\" noopener\">context-menu-demo</a></li>\n    </ul>\n  </li>\n</ul>"}}],"toc":[{"text":"Modificando páginas que encajen con un patrón URL","id":"modificando_páginas_que_encajen_con_un_patrón_url"},{"text":"Modificando las páginas programaticamente","id":"modificando_las_páginas_programaticamente"},{"text":"Mensajería","id":"mensajería"},{"text":"Aprende más","id":"aprende_más"}],"summary":"De ambas formas, estos scripts se llaman scripts de contenido y son distintos del resto de scripts que constituyen una extensión.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Modify a web page","locale":"en-US","native":"English (US)"},{"title":"Modifier une page web","locale":"fr","native":"Français"},{"title":"ウェブページを変更する","locale":"ja","native":"日本語"},{"title":"Модификация веб страницы","locale":"ru","native":"Русский"},{"title":"修改 web 页面","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"es/mozilla/add-ons/webextensions/modify_a_web_page","github_url":"https://github.com/mdn/translated-content/blob/main/files/es/mozilla/add-ons/webextensions/modify_a_web_page/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/es/docs/Mozilla","title":"Mozilla"},{"uri":"/es/docs/Mozilla/Add-ons","title":"Complementos"},{"uri":"/es/docs/Mozilla/Add-ons/WebExtensions","title":"Extensiones del navegador"},{"uri":"/es/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page","title":"Modify a web page"}],"pageTitle":"Modify a web page - Mozilla | MDN","noIndexing":false}}