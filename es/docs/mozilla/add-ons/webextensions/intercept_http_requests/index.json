{"doc":{"isMarkdown":true,"isTranslated":true,"isActive":true,"flaws":{},"title":"Interceptar peticiones HTTP","mdn_url":"/es/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests","locale":"es","native":"Español","sidebarHTML":"\n  <ol>\n    <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions\"><strong>Extensiónes del navegador</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Comenzar</summary>\n        <ol>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\">¿Qué son las extensiones?</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\">Tu primera extensión</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\">Tu segunda extensión</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\">Anatomía de una extensión</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Examples\">Extensiones de ejemplo</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/What_next_\">¿Qué sigue?</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Conceptos</summary>\n        <ol>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\">Uso de las API de JavaScript</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\">Guiones de contenido</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">Patrones de coincidencia</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\">Trabajar con archivos</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Internationalization\">Internacionalización</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\">Política de seguridad de contenido</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\">Mensajería nativa</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\">Diferencias entre implementaciones de API</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\">Incompatibilidades de Chrome</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Interfaz de usuario</summary>\n        <ol>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface\">Interfaz de usuario</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\">Botón de la barra de herramientas</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\">Botón de la barra de direcciones</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\">Barras laterales</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\">Elementos del menú contextual</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\">Página de opciones</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\">Páginas de extensión</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\">Notificaciones</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\">Sugerencias de la barra de direcciones</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\">Paneles de herramientas para desarrolladores</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Cómo hacer</summary>\n        <ol>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\">Interceptar solicitudes HTTP</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\">Modificar una página web</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\">Insertar contenido externo</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">Comparta objetos con scripts de página</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\">Agregar un botón a la barra de herramientas</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\">Implementar una página de configuración</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\">Trabajar con la API de pestañas</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\">Trabajar con la API de marcadores</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\">Trabajar con la API de Cookies</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\">Trabajar con identidades contextuales</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard\">Interactuar con el portapapeles</a></li>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\">Cree una extensión multinavegador</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\">Diferenciadores de Firefox</a></summary>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>API de JavaScript</summary>\n        <ol><li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\">Browser support for JavaScript APIs</a></li><li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/API/i18n\">i18n</a></li><li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/API/storage\">storage</a></li></ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n      <summary>Claves de manifiesto</summary>\n        <ol>\n          <li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/manifest.json\">Introducción</a></li>\n        </ol>\n      <ol><li><a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons\">icons</a></li></ol>\n      </details>\n    </li>\n     <li class=\"toggle\">\n      <details>\n        <summary>Taller de Extensión</summary>\n        <ol>\n          <li><a href=\"https://extensionworkshop.com/documentation/develop/\">Desarrollar</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/publish/\">Publish</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/manage/\">Gestionar</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/enterprise/\">Empresa</a></li>\n        </ol>\n      </details>\n    </li>\n    <li><a href=\"/es/docs/Mozilla/Add-ons/Contact_us\"><strong>Contáctenos</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Canales de discusión</summary>\n        <ol>\n          <li><a href=\"https://blog.mozilla.org/addons\">Blog de complementos</a></li>\n          <li><a href=\"https://discourse.mozilla.org/c/add-ons\">Foro de complementos</a></li>\n          <li><a href=\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\">Chat de complementos</a></li>\n        </ol>\n      </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>Para interceptar peticiones HTTP, utilice la API <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">webRequest (en-US)</a>. Esta API le permite agregar detector de eventos para varias etapas en la realización de las solicitudes HTTP. En los listeners, tu puedes:</p>\n<ul>\n  <li>Obtener acceso a la solicitud y respuesta de las cabeceras y cuerpos</li>\n  <li>Cancelar y redireccionar las solicitudes</li>\n  <li>Modificar las solicitudes y respuestas de las cabeceras</li>\n</ul>\n<p>En este artículo se verán los tres diferentes usos del módulo <code>webRequest</code>:</p>\n<ul>\n  <li>Registro de solicitudes de URLs a medida que se realizan.</li>\n  <li>Redireccionar las solicitudes.</li>\n  <li>Modificar las cabeceras de las solicitud.</li>\n</ul>"}},{"type":"prose","value":{"id":"registrar_solicitudes_de_urls","title":"Registrar solicitudes de URLs","isH3":false,"content":"<p>Crea un nuevo directorio llamado \"requests\". En ese directorio, crea un archivo llamado \"manifest.json\" el cual debe poseer el siguiente contenido:</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Demostrar webRequests\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"manifest_version\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"webRequest-demo\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0\"</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"permissions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"webRequest\"</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"background\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"background.js\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Luego, crea un archivo llamado \"background.js\" con el siguiente contenido:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">logURL</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">requestDetails</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Cargando: \"</span> <span class=\"token operator\">+</span> requestDetails<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nbrowser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeRequest<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>\n  logURL<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">urls</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"&lt;all_urls&gt;\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>En este punto se utiliza <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">onBeforeRequest (en-US)</a> para llamar la función <code>logURL()</code> junstamente después de realizar la solicitud. La función <code>logURL()</code> se apropia de la solicitud URL del objeto de eventos y lo registra en la consola del navegador. El <a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">patrón</a> <code>{urls: [\"&lt;all_urls&gt;\"]}</code> signinifica que se pueden interceptar todas las solicitudes HTTP de todas las URLs.</p>\n<p>Para probarlo, <a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Temporary_Installation_in_Firefox\">instala la WebExtension</a>, <a href=\"https://firefox-source-docs.mozilla.org/devtools-user/browser_console/index.html\" class=\"external\" rel=\" noopener\">abre la consola del navegador</a>, y abre algunas páginas Web. En la consola del navegador, deberías ver las URLs de cualquier recurso que el navegador solicita:</p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/X3rMgkRkB1Q\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\" loading=\"lazy\"></iframe>"}},{"type":"prose","value":{"id":"redireccionar_solicitudes","title":"Redireccionar solicitudes","isH3":false,"content":"<p>Ahora utilice <code>webRequest</code> para redireccionar todas las solicitudes HTTP. Primero, reemplace manifest.json con lo siguiente:</p>\n<div class=\"code-example\"><pre class=\"brush: json notranslate\"><code><span class=\"token punctuation\">{</span>\n\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Demostrar webRequests\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"manifest_version\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"webRequest-demo\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0\"</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"permissions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"webRequest\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"webRequestBlocking\"</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"background\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"background.js\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>El único cambio fue la adición de los <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">permisos (en-US)</a> <code>\"webRequestBlocking\"</code>. Se necesita preguntar por este extra-permiso todas las veces que se está activamente modificando una solicitud.</p>\n<p>Luego, reemplace \"background.js\" con esto:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> pattern <span class=\"token operator\">=</span> <span class=\"token string\">\"https://mdn.mozillademos.org/*\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">requestDetails</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Redireccionando: \"</span> <span class=\"token operator\">+</span> requestDetails<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">redirectUrl</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://38.media.tumblr.com/tumblr_ldbj01lZiP1qe0eclo1_500.gif\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nbrowser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeRequest<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>\n  redirect<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">urls</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>pattern<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">types</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"image\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">\"blocking\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>De nuevo, se utiliza el detector de eventos <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">onBeforeRequest (en-US)</a> para ejecutar una función justamente antes de que cada solicitud sea realizada. Esta función reemplazará el objetivo URL con <code>redirectUrl</code> que está definido en la función.</p>\n<p>Esta vez no se está interceptando cada solicitud: la opción <code>{urls:[pattern], types:[\"image\"]}</code> especifica que solo se debería interceptar solicitudes (1) de URLs que residen bajo \"https://developer.mozilla.org/\" (2) para recursos de imágenes. Vea <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/RequestFilter\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">webRequest.RequestFilter (en-US)</a> para más información sobre esto.</p>\n<p>Dése cuenta también, que se esta pasando la opción llamada <code>\"blocking\"</code>: se necesita pasar cada vez que se requiera modificar la solicitud. Esto hace que la función del escuchador bloquee la solicitud de la red, así que el navegador espera que el escuchador retorne antes de continuar. Vea la documentación <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">webRequest.onBeforeRequest (en-US)</a> para conocer más sobre <code>\"blocking\"</code>.</p>\n<p>Para probarlo, abra una página de MDN que contenga bastantes imágenes (por ejemplo <a href=\"/es/docs/Tools/Network_Monitor\">https://developer.mozilla.org/es/docs/Tools/Network_Monitor</a>), <a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Temporary_Installation_in_Firefox#reloading_a_temporary_add-on\">recargue la WebExtension</a>, y luego recargue la página de MDN:</p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/ix5RrXGr0wA\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\" loading=\"lazy\"></iframe>"}},{"type":"prose","value":{"id":"modificar_las_cabeceras_de_la_solicitud","title":"Modificar las cabeceras de la solicitud","isH3":false,"content":"<p>Finalmente se utilizará <code>webRequest</code> para modificar las cabeceras de las solicitudes. En este ejempo se modificará la cabecera \"User-Agent\" así que el navegador se identificará por sí mismo como Opera 12.16, pero solamente cuando se visitan páginas de \"http://useragentstring.com/\".</p>\n<p>El \"manifest.json\" puede permanecer igual que el ejemplo anterior.</p>\n<p>Reemplace \"background.js\" con el siguiente código:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">var</span> targetPage <span class=\"token operator\">=</span> <span class=\"token string\">\"http://useragentstring.com/*\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> ua <span class=\"token operator\">=</span> <span class=\"token string\">\"Opera/9.80 (X11; Linux i686; Ubuntu/14.10) Presto/2.12.388 Version/12.16\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">rewriteUserAgentHeader</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> header <span class=\"token keyword\">of</span> e<span class=\"token punctuation\">.</span>requestHeaders<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>header<span class=\"token punctuation\">.</span>name <span class=\"token operator\">==</span> <span class=\"token string\">\"User-Agent\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      header<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> ua<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">requestHeaders</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>requestHeaders<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nbrowser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeSendHeaders<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>\n  rewriteUserAgentHeader<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">urls</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>targetPage<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">\"blocking\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"requestHeaders\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Aquí se utiliza el escuchador de eventos <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeSendHeaders\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">onBeforeSendHeaders (en-US)</a> para ejecutar una función juntamente antes de que la solicitud de las cabeceras sean enviadas.</p>\n<p>La función escuchadora será llamada solamente por solicitudes de URLs que coincidan con el <a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">patrón</a> <code>targetPage</code>. Dése cuenta de nuevo que <code>\"blocking\"</code> se ha pasado como una opción. También se pasó <code>\"requestHeaders\"</code>, lo cual significa que al escuchador pasará un array conteniendo las cabeceras de la solicitud que se espera enviar. Vea <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeSendHeaders\" class=\"only-in-en-us\" title=\"Currently only available in English (US)\">webRequest.onBeforeSendHeaders (en-US)</a> para más información en estas opciones.</p>\n<p>La función escuchadora busca la cabecera \"User-Agent\" en el array de la solicitud de cabeceras, reemplaza el valor con el valor de la variable <code>ua</code>, y regresa el array modificado. Este array modificado será el enviado al servidor.</p>\n<p>Para comprobarlo, abra <a href=\"http://useragentstring.com/\" class=\"external\" rel=\" noopener\">useragentstring.com</a> y verifique que identifica al navegador como Firefox. Luego recargue el complemento, recargue <a href=\"http://useragentstring.com/\" class=\"external\" rel=\" noopener\">useragentstring.com</a>, y compruebe que Firefox es identificado ahora como Opera:</p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/SrSNS1-FIx0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\" loading=\"lazy\"></iframe>"}},{"type":"prose","value":{"id":"aprenda_más","title":"Aprenda más","isH3":false,"content":"<p>Para aprender más sobre todas las cosas que puede hacer con la API <code>webRequest</code>, vea su propia <a href=\"/es/docs/Mozilla/Add-ons/WebExtensions/API/WebRequest\">documentación de referencia</a>.</p>"}}],"toc":[{"text":"Registrar solicitudes de URLs","id":"registrar_solicitudes_de_urls"},{"text":"Redireccionar solicitudes","id":"redireccionar_solicitudes"},{"text":"Modificar las cabeceras de la solicitud","id":"modificar_las_cabeceras_de_la_solicitud"},{"text":"Aprenda más","id":"aprenda_más"}],"summary":"Para interceptar peticiones HTTP, utilice la API webRequest (en-US). Esta API le permite agregar detector de eventos para varias etapas en la realización de las solicitudes HTTP. En los listeners, tu puedes:","popularity":0.0003,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Intercept HTTP requests","locale":"en-US","native":"English (US)"},{"title":"Intercepter les requêtes HTTP","locale":"fr","native":"Français"},{"title":"HTTP リクエストへの介入","locale":"ja","native":"日本語"},{"title":"Interceptando requisições HTTP","locale":"pt-BR","native":"Português (do Brasil)"},{"title":"Intercept HTTP requests","locale":"ru","native":"Русский"},{"title":"拦截 HTTP 请求","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"es/mozilla/add-ons/webextensions/intercept_http_requests","github_url":"https://github.com/mdn/translated-content/blob/main/files/es/mozilla/add-ons/webextensions/intercept_http_requests/index.md","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.md"},"parents":[{"uri":"/es/docs/Mozilla","title":"Mozilla"},{"uri":"/es/docs/Mozilla/Add-ons","title":"Complementos"},{"uri":"/es/docs/Mozilla/Add-ons/WebExtensions","title":"Extensiones del navegador"},{"uri":"/es/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests","title":"Interceptar peticiones HTTP"}],"pageTitle":"Interceptar peticiones HTTP - Mozilla | MDN","noIndexing":false}}