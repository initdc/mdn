{"doc":{"isMarkdown":false,"isTranslated":true,"isActive":true,"flaws":{},"title":"Manipular video por medio de canvas","mdn_url":"/es/docs/Web/API/Canvas_API/Manipulating_video_using_canvas","locale":"es","native":"Español","sidebarHTML":"","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-3\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Al combinar las capacidades del elemento </span></span><a class=\"internal\" href=\"/en-US/HTML/Element/Video\" title=\"En/HTML/Element/Video\"><code>video</code></a><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-3\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\"> introducido en Firefox 3.5 con un elemento </span></span><a class=\"internal\" href=\"/en-US/HTML/Canvas\" title=\"En/Canvas\"><code>canvas</code></a><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-3\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\"> , puedes manipular los datos de video en tiempo real para incorporar una variedad de efectos visuales que se mostrarán en el video.</span></span>  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-4\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Este artículo, adaptado de <a class=\"external\" href=\"http://blog.mozbox.org/post/2009/02/25/video-canvas%3A-special-effects\" rel=\" noopener\">esta entrada del blog</a> de Paul Rouget, muestra cómo realizar una inserción croma (también conocida como el \"efecto pantalla verde\") utilizando el código JavaScript.</span></span></p>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-5\"><span class=\"goog-gtc-translatable goog-gtc-from-mt\" dir=\"ltr\" style=\"\"><a href=\"https://media.prod.mdn.mozit.cloud/samples/video/chroma-key/index.xhtml\" title=\"samples/video/chroma-key/index.xhtml\" class=\"external\" rel=\" noopener\">Ver este ejemplo en vivo</a> .</span></span></p>"}},{"type":"prose","value":{"id":"el_contenido_del_documento","title":"<span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-6\"><span class=\"goog-gtc-translatable goog-gtc-from-mt\" dir=\"ltr\" style=\"\">El contenido del documento</span></span>","isH3":false,"content":"<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-7\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">El documento XHTML que se utiliza para representar este contenido se muestra a continuación.</span></span></p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span> <span class=\"token name\">PUBLIC</span> <span class=\"token string\">\"-//W3C//DTD XHTML 1.0 Transitional//EN\"</span>\n        <span class=\"token string\">\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/1999/xhtml<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token style\"><span class=\"token language-css\">\n      <span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> black<span class=\"token punctuation\">;</span>\n        <span class=\"token property\">color</span><span class=\"token punctuation\">:</span>#CCCCCC<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token selector\">#c2</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>foo.png<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">;</span>\n        <span class=\"token property\">background-repeat</span><span class=\"token punctuation\">:</span> no-repeat<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token selector\">div</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">float</span><span class=\"token punctuation\">:</span> left<span class=\"token punctuation\">;</span>\n        <span class=\"token property\">border</span> <span class=\"token punctuation\">:</span>1px solid #444444<span class=\"token punctuation\">;</span>\n        <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span>10px<span class=\"token punctuation\">;</span>\n        <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\n        <span class=\"token property\">background</span><span class=\"token punctuation\">:</span>#3B3B3B<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/javascript;version=1.8<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>main.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onload</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\">processor<span class=\"token punctuation\">.</span><span class=\"token function\">doLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>video</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>video<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>video.ogv<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">controls</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>canvas</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>c1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>160<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>96<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>canvas</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>c2<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>160<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>96<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-42\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Los puntos clave a tener en cuenta son:</span></span></p>\n<ol>\n <li><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-43\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Este documento establece dos elemento <a class=\"internal\"><code>canvas</code></a> , con los identificadores de <code>c1</code> y <code>c2</code> .</span></span>  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-44\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Canvas <code>c1</code> se utiliza para mostrar la imagen actual del video original, mientras que <code>c2</code> se utiliza para mostrar el video después de realizar la manipulación con el efecto croma; <code>c2</code> se carga previamente con la imagen fija que se utilizará para sustituir el fondo verde en el video.</span></span></li>\n <li><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-45\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">El código JavaScript es importado de un script llamado <code>main.js</code> ; este script utiliza JavaScript 1.8 características, de modo que la versión se especifica en la línea 22 al importar la secuencia de comandos.</span></span></li>\n <li><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-46\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Cuando se carga el documento, se ejecuta el método <code>processor.doLoad()</code> de <code>main.js</code>.</span></span></li>\n</ol>","titleAsText":"El contenido del documento"}},{"type":"prose","value":{"id":"el_código_javascript","title":"<span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-47\"><span class=\"goog-gtc-translatable goog-gtc-from-mt\" dir=\"ltr\" style=\"\">El código JavaScript</span></span>","isH3":false,"content":"<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-48\"><span class=\"goog-gtc-translatable goog-gtc-from-mt\" dir=\"ltr\" style=\"\">El código JavaScript en <code>main.js</code> consta de tres métodos.</span></span></p>","titleAsText":"El código JavaScript"}},{"type":"prose","value":{"id":"inicializar_el_reproductor_de_croma","title":"<span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-49\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Inicializar el reproductor de croma</span></span>","isH3":true,"content":"<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-50\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">El método <code>doLoad()</code> se llama cuando el documento XHTML se carga inicialmente.</span></span>  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-51\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">La función de este método es preparar las variables necesarias para el código de procesamiento del croma y la creación de un detector de eventos para que podamos detectar cuándo inicia el usuario la reproducción del video.</span></span></p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>  <span class=\"token function-variable function\">doLoad</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>video <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"video\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>c1 <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx1 <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>c1<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2d\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>c2 <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx2 <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>c2<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2d\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> self <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>video<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"play\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        self<span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>video<span class=\"token punctuation\">.</span>videoWidth <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n        self<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>video<span class=\"token punctuation\">.</span>videoHeight <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n        self<span class=\"token punctuation\">.</span><span class=\"token function\">timerCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n</code></pre></div>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-65\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Este código obtiene referencias a los elementos del documento XHTML que son de particular interés, a saber, el elemento <code>video</code> y los dos elementos <code>canvas</code>.</span></span>  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-66\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">También recupera las referencias a los contextos gráficos para cada uno de los dos elementos canvas.</span></span>  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-67\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Estos serán utilizados cuando estamos haciendo de verdad el efecto croma.</span></span></p>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-68\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Luego <code>addEventListener()</code> es llamado para empezar a ver el elemento <code>video</code> de forma que podamos obtener una notificación cuando el usuario presione el botón de reproducción en el video.</span></span>  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-69\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">En respuesta al usuario que inicia la reproducción, el código obtiene la anchura y la altura de video, reduciendo a la mitad cada uno (vamos a reducir a la mitad el tamaño del video, cuando llevamos a cabo la manipulación efecto croma). A continuación, llama al método <code>timerCallback()</code> para iniciar el visionado del video y la computación del efecto visual.</span></span></p>","titleAsText":"Inicializar el reproductor de croma"}},{"type":"prose","value":{"id":"la_devolución_de_llamada_del_temporizador","title":"<span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-70\"><span class=\"goog-gtc-translatable goog-gtc-from-mt\" dir=\"ltr\" style=\"\">La devolución de llamada del temporizador</span></span>","isH3":true,"content":"<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-71\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">La devolución de llamada del temporizador se llama inicialmente cuando el video comienza a reproducirse (cuando tiene lugar el evento \"reproducir\"), a continuación, toma la responsabilidad por la que se establece a sí mismo para ser llamado periódicamente, a fin de poner en marcha el efecto croma para cada imagen.</span></span></p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>  <span class=\"token function-variable function\">timerCallback</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>video<span class=\"token punctuation\">.</span>paused <span class=\"token operator\">||</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>video<span class=\"token punctuation\">.</span>ended<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">computeFrame</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> self <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        self<span class=\"token punctuation\">.</span><span class=\"token function\">timerCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n</code></pre></div>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-82\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Lo primero que la devolución de llamada hace es comprobar si el video se está aún reproduciendo, y si no lo está, la devolución de llamada regresa inmediatamente sin hacer nada.</span></span></p>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-83\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">A continuación, llama al método <code>computeFrame()</code>, que lleva a cabo la manipulación del efecto croma en la imagen de video actual.</span></span></p>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-84\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Lo último que la devolución de llamada hace es llamar a <code>setTimeout()</code> para programarse para ser llamado lo más pronto posible.</span></span>  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-85\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">En el mundo real, es probable que programes esto en función de la velocidad de fotogramas del video.</span></span></p>","titleAsText":"La devolución de llamada del temporizador"}},{"type":"prose","value":{"id":"manipulación_de_los_datos_de_la_imagen_del_video","title":"<span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-86\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Manipulación de los datos de la imagen del video</span></span>","isH3":true,"content":"<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-87\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">El método <code>computeFrame()</code>, que se muestra a continuación, se encarga de ir a buscar realmente un fotograma de datos y realizar el efecto croma.</span></span></p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>  <span class=\"token function-variable function\">computeFrame</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx1<span class=\"token punctuation\">.</span><span class=\"token function\">drawImage</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>video<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> frame <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx1<span class=\"token punctuation\">.</span><span class=\"token function\">getImageData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> l <span class=\"token operator\">=</span> frame<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>length <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> l<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> r <span class=\"token operator\">=</span> frame<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">let</span> g <span class=\"token operator\">=</span> frame<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">let</span> b <span class=\"token operator\">=</span> frame<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>g <span class=\"token operator\">&gt;</span> <span class=\"token number\">100</span> <span class=\"token operator\">&amp;&amp;</span> r <span class=\"token operator\">&gt;</span> <span class=\"token number\">100</span> <span class=\"token operator\">&amp;&amp;</span> b <span class=\"token operator\">&lt;</span> <span class=\"token number\">43</span><span class=\"token punctuation\">)</span>\n        frame<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ctx2<span class=\"token punctuation\">.</span><span class=\"token function\">putImageData</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Cuando esta rutina es llamada, el elemento video muestra el fotograma de datos de video más reciente, que tiene este aspecto:</p>\n<p><img alt=\"video.png\" class=\"internal default\" src=\"/@api/deki/files/3282/=video.png\" loading=\"lazy\"></p>\n<p>En la línea 2, ese fotograma de video se copia al contexto gráfico <code>ctx1</code> del primer lienzo, especificando como alto y ancho los valores que previamente guardamos para dibujar el fotograma a mitad de tamaño.  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-104\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Ten en cuenta que puedes pasar simplemente el elemento de video al método <code>drawImage()</code> del contexto para dibujar el fotograma de video actual en dicho contexto.</span></span>  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-105\"><span class=\"goog-gtc-translatable goog-gtc-from-mt\" dir=\"ltr\" style=\"\">El resultado es:</span></span></p>\n<p><img alt=\"sourcectx.png\" class=\"internal default\" src=\"/@api/deki/files/3284/=sourcectx.png\" loading=\"lazy\"></p>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-106\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Línea 3 obtiene una copia de los datos gráficos del actual fotograma de video llamando al método <code>getImageData()</code> en el primer contexto.</span></span>  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-107\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Esto proporciona los datos de imagen en píxeles de 32 bits sin procesar que podemos después manipular.</span></span>  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-108\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Línea 4 calcula el número de píxeles de la imagen al dividir entre cuatro el tamaño total de los datos de la imagen del fotograma.</span></span></p>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-109\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">El bucle <code>for</code> que comienza en la línea 6 explora a través de los píxeles del fotograma, extrayendo los valores rojo, verde y azul para cada píxel, y compara los valores frente a números predeterminados que se utilizan para detectar la pantalla verde que se reemplazará por la imagen de fondo fija importada de <code>foo.png</code> .</span></span></p>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-110\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Cada píxel de datos de imagen del fotograma que se encuentra que está dentro de los parámetros que se consideran parte de la pantalla verde tiene su valor alfa reemplazado por un cero, lo que indica que el píxel es totalmente transparente.</span></span>  <span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-111\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Como resultado, la imagen final tiene toda el área de pantalla verde 100% transparente, de modo que cuando se dibuja en el contexto de destino en la línea 13, el resultado es una superposición sobre el fondo estático.</span></span></p>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-112\"><span class=\"goog-gtc-translatable goog-gtc-from-mt\" dir=\"ltr\" style=\"\">La imagen resultante tiene este aspecto:</span></span></p>\n<p><img alt=\"output.png\" class=\"internal default\" src=\"/@api/deki/files/3283/=output.png\" loading=\"lazy\"></p>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-113\"><span class=\"goog-gtc-translatable goog-gtc-from-human\" dir=\"ltr\" style=\"\">Esto se hace en varias ocasiones mientras el video se reproduce, de manera que fotograma tras fotograma se procesa y se muestra con el efecto de croma.</span></span></p>\n<p><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-114\"><span class=\"goog-gtc-translatable goog-gtc-from-mt\" dir=\"ltr\" style=\"\"><a href=\"https://media.prod.mdn.mozit.cloud/samples/video/chroma-key/index.xhtml\" title=\"samples/video/chroma-key/index.xhtml\" class=\"external\" rel=\" noopener\">Ver este ejemplo en vivo</a> .</span></span></p>","titleAsText":"Manipulación de los datos de la imagen del video"}},{"type":"prose","value":{"id":"consulta_también","title":"<span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-115\"><span class=\"goog-gtc-translatable goog-gtc-from-tm goog-gtc-from-tm-score-100\" dir=\"ltr\" style=\"\">Consulta también</span></span>","isH3":false,"content":"<ul>\n <li><a class=\"internal page-not-created\" href=\"/es/Usando_audio_y_video_en_Firefox\" title=\"This is a link to an unwritten page\"><span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-116\"><span class=\"goog-gtc-translatable goog-gtc-from-tm goog-gtc-from-tm-score-100\" dir=\"ltr\" style=\"\">Usar audio y video en Firefox</span></span></a></li>\n</ul>\n<p></p>","titleAsText":"Consulta también"}}],"toc":[{"text":"<span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-6\"><span class=\"goog-gtc-translatable goog-gtc-from-mt\" dir=\"ltr\" style=\"\">El contenido del documento</span></span>","id":"el_contenido_del_documento"},{"text":"<span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-47\"><span class=\"goog-gtc-translatable goog-gtc-from-mt\" dir=\"ltr\" style=\"\">El código JavaScript</span></span>","id":"el_código_javascript"},{"text":"<span class=\"goog-gtc-unit\" id=\"goog-gtc-unit-115\"><span class=\"goog-gtc-translatable goog-gtc-from-tm goog-gtc-from-tm-score-100\" dir=\"ltr\" style=\"\">Consulta también</span></span>","id":"consulta_también"}],"summary":"Al combinar las capacidades del elemento video introducido en Firefox 3.5 con un elemento canvas , puedes manipular los datos de video en tiempo real para incorporar una variedad de efectos visuales que se mostrarán en el video.  Este artículo, adaptado de esta entrada del blog de Paul Rouget, muestra cómo realizar una inserción croma (también conocida como el \"efecto pantalla verde\") utilizando el código JavaScript.","popularity":0,"modified":"2022-10-01T03:41:16.000Z","other_translations":[{"title":"Manipulating video using canvas","locale":"en-US","native":"English (US)"},{"title":"Manipulation vidéo avec la balise canvas","locale":"fr","native":"Français"},{"title":"캔버스(canvas)를 이용한 비디오 조작하기","locale":"ko","native":"한국어"},{"title":"使用 canvas 处理视频","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"es/web/api/canvas_api/manipulating_video_using_canvas","github_url":"https://github.com/mdn/translated-content/blob/main/files/es/web/api/canvas_api/manipulating_video_using_canvas/index.html","last_commit_url":"https://github.com/mdn/translated-content/commit/921c46a374ab0a9f4cc809af0370f8c412e54701","filename":"index.html"},"parents":[{"uri":"/es/docs/Web","title":"Tecnología para desarrolladores web"},{"uri":"/es/docs/Web/API","title":"Referencia de la API Web"},{"uri":"/es/docs/Web/API/Canvas_API","title":"API Canvas"},{"uri":"/es/docs/Web/API/Canvas_API/Manipulating_video_using_canvas","title":"Manipular video por medio de canvas"}],"pageTitle":"Manipular video por medio de canvas - Referencia de la API Web | MDN","noIndexing":false}}