<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="robots" content="noindex, nofollow">
        <style type="text/css">
            body {
              padding: 0;
              margin: 0;
            }

            svg:not(:root) {
              display: block;
            }

            .playable-code {
              background-color: #f4f7f8;
              border: none;
              border-left: 6px solid #558abb;
              border-width: medium medium medium 6px;
              color: #4d4e53;
              height: 100px;
              width: 90%;
              padding: 10px 10px 0;
            }

            .playable-canvas {
              border: 1px solid #4d4e53;
              border-radius: 2px;
            }

            .playable-buttons {
              text-align: right;
              width: 90%;
              padding: 5px 10px 5px 26px;
            }
        </style>
        
        <title>Promise - ejemplo_avanzado - code sample</title>
    </head>
    <body>
        
            <button id="make-promise">¡Crea una promesa!</button>
<div id="log"></div>

        
        
            <script>
                "use strict";
let promiseCount = 0;

function testPromise() {
  let thisPromiseCount = ++promiseCount;
  let log = document.getElementById('log');
  // inicio
  log.insertAdjacentHTML('beforeend', thisPromiseCount + ') Inicio<br>');
  // Hacemos una nueva promesa: prometemos un recuento numérico de esta promesa,
  // a partir de 1 (después de esperar 3 segundos)
  let p1 = new Promise((resolve, reject) => {
    // Se llama a la función ejecutora con la capacidad de resolver
    // o rechazar la promesa.
    log.insertAdjacentHTML('beforeend', thisPromiseCount + ') Promesa construida<br>');
    // Esto es solo un ejemplo para crear asincronismo.
    window.setTimeout(function() {
        // ¡Cumplimos la promesa!
        resolve(thisPromiseCount);
    }, Math.random() * 2000 + 1000);
  });

  // Definimos qué hacer cuando la promesa se resuelve con la llamada then()
  // y qué hacer cuando la promesa se rechaza con la llamada catch()
  p1.then(function(val) {
    // Mostrar el valor de cumplimiento
    log.insertAdjacentHTML('beforeend', val + ') Promesa completada<br>');
  }).catch((reason) => {
    // Mostrar el motivo del rechazo
    console.log(`Manejar la promesa rechazada (${reason}) aquí.`);
  });
  // fin
  log.insertAdjacentHTML('beforeend', thisPromiseCount + ') Promesa creada<br>');
}

if ("Promise" in window) {
  let btn = document.getElementById("make-promise");
  btn.addEventListener("click",testPromise);
} else {
  log = document.getElementById('log');
  log.textContent = "El ejemplo en vivo no está disponible porque su navegador no es compatible con la interfaz <code>Promise<code>.";
}

            </script>
        
    </body>
</html>